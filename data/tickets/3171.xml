<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">2</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-09-09T11:37:20+01:00</created-at>
  <creator-id type="integer">8853</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer" nil="true"></milestone-id>
  <number type="integer">3171</number>
  <permalink>integration-test-requests-with-bignums-raise-exceptions</permalink>
  <priority type="integer">139931</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>stale</state>
  <tag>234 30 patch test_process test_request</tag>
  <title>[PATCH] test request with Bignums in parameters raises exception</title>
  <updated-at type="datetime">2011-02-02T18:40:43+00:00</updated-at>
  <user-id type="integer">40272</user-id>
  <version type="integer">10</version>
  <user-name>Santiago Pastorino</user-name>
  <creator-name>Alovak</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/3171</url>
  <priority-name nil="true"></priority-name>
  <original-body>My functional test cases fail with message: TypeError: allocator undefined for Bignum

Test example:

  def test_should_get_edit
    get :edit, :id =&gt; @administrator.id #instantiated fixture
    assert_response :success
    assert_equal assigns(:account), @administrator
  end

I have found that ActionController::TestRequest method assign_parameters converts to String only Fixnum parameters. On 64 bits platform test passed without any failures, but on 32 bits test fail.

Here are the patchs with tests for Rails 3 and Rails 2.3.4</original-body>
  <latest-body>My functional test cases fail with message: TypeError: allocator undefined for Bignum

Test example:

  def test_should_get_edit
    get :edit, :id =&gt; @administrator.id #instantiated fixture
    assert_response :success
    assert_equal assigns(:account), @administrator
  end

I have found that ActionController::TestRequest method assign_parameters converts to String only Fixnum parameters. On 64 bits platform test passed without any failures, but on 32 bits test fail.

Here are the patchs with tests for Rails 3 and Rails 2.3.4</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;My functional test cases fail with message: TypeError: allocator
undefined for Bignum&lt;/p&gt;
&lt;p&gt;Test example:&lt;/p&gt;
&lt;p&gt;def test_should_get_edit&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;get :edit, :id =&amp;gt; @administrator.id #instantiated fixture
assert_response :success
assert_equal assigns(:account), @administrator&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;end&lt;/p&gt;
&lt;p&gt;I have found that ActionController::TestRequest method
assign_parameters converts to String only Fixnum parameters. On 64
bits platform test passed without any failures, but on 32 bits test
fail.&lt;/p&gt;
&lt;p&gt;Here are the patchs with tests for Rails 3 and Rails 2.3.4&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>My functional test cases fail with message: TypeError: allocator undefined for Bignum

Test example:

  def test_should_get_edit
    get :edit, :id =&gt; @administrator.id #instantiated fixture
    assert_response :success
    assert_equal assigns(:account), @administrator
  end

I have found that ActionController::TestRequest method assign_parameters converts to String only Fixnum parameters. On 64 bits platform test passed without any failures, but on 32 bits test fail.

Here are the patchs with tests for Rails 3 and Rails 2.3.4</body>
      <body-html>&lt;div&gt;&lt;p&gt;My functional test cases fail with message: TypeError: allocator
undefined for Bignum&lt;/p&gt;
&lt;p&gt;Test example:&lt;/p&gt;
&lt;p&gt;def test_should_get_edit&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;get :edit, :id =&amp;gt; @administrator.id #instantiated fixture
assert_response :success
assert_equal assigns(:account), @administrator&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;end&lt;/p&gt;
&lt;p&gt;I have found that ActionController::TestRequest method
assign_parameters converts to String only Fixnum parameters. On 64
bits platform test passed without any failures, but on 32 bits test
fail.&lt;/p&gt;
&lt;p&gt;Here are the patchs with tests for Rails 3 and Rails 2.3.4&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-09T11:37:20+01:00</created-at>
      <creator-id type="integer">8853</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3171</number>
      <permalink>integration-test-requests-with-bignums-raise-exceptions</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.4 3.0 test_process test_request</tag>
      <title>integration test requests with Bignums raise exceptions</title>
      <updated-at type="datetime">2009-09-09T11:37:28+01:00</updated-at>
      <user-id type="integer">8853</user-id>
      <version type="integer">1</version>
      <user-name>Alovak</user-name>
      <creator-name>Alovak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3171</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-09T11:38:47+01:00</created-at>
      <creator-id type="integer">8853</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 2.3.4 3.0 test_process test_request
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3171</number>
      <permalink>integration-test-requests-with-bignums-raise-exceptions</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.4 3.0 patch test_process test_request</tag>
      <title>integration test requests with Bignums raise exceptions</title>
      <updated-at type="datetime">2009-09-09T11:38:51+01:00</updated-at>
      <user-id type="integer">8853</user-id>
      <version type="integer">2</version>
      <user-name>Alovak</user-name>
      <creator-name>Alovak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3171</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-09T11:41:04+01:00</created-at>
      <creator-id type="integer">8853</creator-id>
      <diffable-attributes type="yaml">--- 
:title: integration test requests with Bignums raise exceptions
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3171</number>
      <permalink>integration-test-requests-with-bignums-raise-exceptions</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.4 3.0 patch test_process test_request</tag>
      <title>test request with Bignums in parameters raises exception</title>
      <updated-at type="datetime">2009-09-09T11:41:06+01:00</updated-at>
      <user-id type="integer">8853</user-id>
      <version type="integer">3</version>
      <user-name>Alovak</user-name>
      <creator-name>Alovak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3171</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-09T11:42:12+01:00</created-at>
      <creator-id type="integer">8853</creator-id>
      <diffable-attributes type="yaml">--- 
:title: test request with Bignums in parameters raises exception
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3171</number>
      <permalink>integration-test-requests-with-bignums-raise-exceptions</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.4 3.0 patch test_process test_request</tag>
      <title>[PATCH] test request with Bignums in parameters raises exception</title>
      <updated-at type="datetime">2009-09-09T11:42:14+01:00</updated-at>
      <user-id type="integer">8853</user-id>
      <version type="integer">4</version>
      <user-name>Alovak</user-name>
      <creator-name>Alovak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3171</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body nil="true"></body>
      <body-html nil="true"></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-25T12:28:54+01:00</created-at>
      <creator-id type="integer">8853</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 2.3.4 3.0 patch test_process test_request
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3171</number>
      <permalink>integration-test-requests-with-bignums-raise-exceptions</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.4 3.0 bugmash patch test_process test_request</tag>
      <title>[PATCH] test request with Bignums in parameters raises exception</title>
      <updated-at type="datetime">2009-09-25T12:49:25+01:00</updated-at>
      <user-id type="integer">7211</user-id>
      <version type="integer">5</version>
      <user-name>CancelProfileIsBroken</user-name>
      <creator-name>Alovak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3171</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>+1 verified that the patch works on 2-3-stable

The file in master has been refactored however and no longer applies - however the test included in the patch runs. This patch should no longer be necessary.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 verified that the patch works on 2-3-stable&lt;/p&gt;
&lt;p&gt;The file in master has been refactored however and no longer
applies - however the test included in the patch runs. This patch
should no longer be necessary.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-27T03:41:22+01:00</created-at>
      <creator-id type="integer">8853</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3171</number>
      <permalink>integration-test-requests-with-bignums-raise-exceptions</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.4 3.0 bugmash patch test_process test_request</tag>
      <title>[PATCH] test request with Bignums in parameters raises exception</title>
      <updated-at type="datetime">2009-09-27T03:41:27+01:00</updated-at>
      <user-id type="integer">64236</user-id>
      <version type="integer">6</version>
      <user-name>John Pignata</user-name>
      <creator-name>Alovak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3171</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Tests should not work in Rails3 :)

The error is still there:

if value.is_a? Fixnum
          value = value.to_s

I will check it again and provide patch for current Rails 3 file (lib/action_controller/testing/test_case.rb) if it's needed.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Tests should not work in Rails3 :)&lt;/p&gt;
&lt;p&gt;The error is still there:&lt;/p&gt;
&lt;p&gt;if value.is_a? Fixnum&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;      value = value.to_s&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;I will check it again and provide patch for current Rails 3 file
(lib/action_controller/testing/test_case.rb) if it's needed.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-10-01T10:22:38+01:00</created-at>
      <creator-id type="integer">8853</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3171</number>
      <permalink>integration-test-requests-with-bignums-raise-exceptions</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.4 3.0 bugmash patch test_process test_request</tag>
      <title>[PATCH] test request with Bignums in parameters raises exception</title>
      <updated-at type="datetime">2009-10-01T10:22:41+01:00</updated-at>
      <user-id type="integer">8853</user-id>
      <version type="integer">7</version>
      <user-name>Alovak</user-name>
      <creator-name>Alovak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3171</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/13645)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/13645&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-02-12T12:46:17+00:00</created-at>
      <creator-id type="integer">8853</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 2.3.4 3.0 bugmash patch test_process test_request
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3171</number>
      <permalink>integration-test-requests-with-bignums-raise-exceptions</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.4 3.0 patch test_process test_request</tag>
      <title>[PATCH] test request with Bignums in parameters raises exception</title>
      <updated-at type="datetime">2010-02-12T12:46:17+00:00</updated-at>
      <user-id type="integer">65556</user-id>
      <version type="integer">8</version>
      <user-name>Rizwan Reza</user-name>
      <creator-name>Alovak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3171</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>This issue has been automatically marked as stale because it has not been commented on for at least three months.

The resources of the Rails core team are limited, and so we are asking for your help. If you can still reproduce this error on the 3-0-stable branch or on master, please reply with all of the information you have about it and add &quot;[state:open]&quot; to your comment. This will reopen the ticket for review. Likewise, if you feel that this is a very important feature for Rails to include, please reply with your explanation so we can consider it.

Thank you for all your contributions, and we hope you will understand this step to focus our efforts where they are most helpful.</body>
      <body-html>&lt;div&gt;&lt;p&gt;This issue has been automatically marked as stale because it has
not been commented on for at least three months.&lt;/p&gt;
&lt;p&gt;The resources of the Rails core team are limited, and so we are
asking for your help. If you can still reproduce this error on the
3-0-stable branch or on master, please reply with all of the
information you have about it and add &quot;[state:open]&quot; to your
comment. This will reopen the ticket for review. Likewise, if you
feel that this is a very important feature for Rails to include,
please reply with your explanation so we can consider it.&lt;/p&gt;
&lt;p&gt;Thank you for all your contributions, and we hope you will
understand this step to focus our efforts where they are most
helpful.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2011-02-02T16:55:26+00:00</created-at>
      <creator-id type="integer">8853</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
:state: new
:tag: 2.3.4 3.0 patch test_process test_request
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3171</number>
      <permalink>integration-test-requests-with-bignums-raise-exceptions</permalink>
      <priority type="integer">139931</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>234 30 patch test_process test_request</tag>
      <title>[PATCH] test request with Bignums in parameters raises exception</title>
      <updated-at type="datetime">2011-02-02T18:40:43+00:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">9</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>Alovak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3171</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body nil="true"></body>
      <body-html nil="true"></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2011-02-02T16:55:28+00:00</created-at>
      <creator-id type="integer">8853</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3171</number>
      <permalink>integration-test-requests-with-bignums-raise-exceptions</permalink>
      <priority type="integer">139931</priority>
      <project-id type="integer">8994</project-id>
      <state>stale</state>
      <tag>234 30 patch test_process test_request</tag>
      <title>[PATCH] test request with Bignums in parameters raises exception</title>
      <updated-at type="datetime">2011-02-02T18:40:31+00:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">10</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>Alovak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3171</url>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>64fb80bcaf76902d85240d91f00514e2685f59d9</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-09-09T11:37:22+01:00</created-at>
      <filename>rails3-test-process-request-bignum-fix.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">264491</id>
      <size type="integer">1855</size>
      <uploader-id type="integer">8853</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/264491/rails3-test-process-request-bignum-fix.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>bfe2ccd209f0364b4b52156e7cf69b60f1fa5836</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-09-09T11:37:23+01:00</created-at>
      <filename>rails2.3.4-test-process-request-bignum-fix.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">264492</id>
      <size type="integer">1848</size>
      <uploader-id type="integer">8853</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/264492/rails2.3.4-test-process-request-bignum-fix.diff</url>
    </attachment>
  </attachments>
</ticket>
