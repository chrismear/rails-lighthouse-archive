<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">3</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2011-02-21T14:04:54+00:00</created-at>
  <creator-id type="integer">31422</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer" nil="true"></milestone-id>
  <number type="integer">3144</number>
  <permalink>undefined-method-for-string-ror-234</permalink>
  <priority type="integer">0</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
  <title>undefined method `^' for String  - RoR 2.3.4</title>
  <updated-at type="datetime">2011-02-21T14:04:54+00:00</updated-at>
  <user-id type="integer">34159</user-id>
  <version type="integer">34</version>
  <user-name>The Doctor What</user-name>
  <creator-name>Wojciech Wn&#281;trzak</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
  <priority-name nil="true"></priority-name>
  <original-body>In active_support/mesage_verifier.rb method secure_compare is trying to make exclusive or a[i] ^ b[i], where a and b are strings.
In Ruby 1.9 string[index] returns character not code of the character (like it was in 1.8).
The patch is coming.</original-body>
  <latest-body>In active_support/mesage_verifier.rb method secure_compare is trying to make exclusive or a[i] ^ b[i], where a and b are strings.
In Ruby 1.9 string[index] returns character not code of the character (like it was in 1.8).
The patch is coming.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;In active_support/mesage_verifier.rb method secure_compare is
trying to make exclusive or a[i] ^ b[i], where a and b are
strings.&lt;br&gt;
In Ruby 1.9 string[index] returns character not code of the
character (like it was in 1.8).&lt;br&gt;
The patch is coming.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>In active_support/mesage_verifier.rb method secure_compare is trying to make exclusive or a[i] ^ b[i], where a and b are strings.
In Ruby 1.9 string[index] returns character not code of the character (like it was in 1.8).</body>
      <body-html>&lt;div&gt;&lt;p&gt;In active_support/mesage_verifier.rb method secure_compare is
trying to make exclusive or a[i] ^ b[i], where a and b are
strings.&lt;br&gt;
In Ruby 1.9 string[index] returns character not code of the
character (like it was in 1.8).&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-04T08:42:30+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activesupport</tag>
      <title>[PATCH] undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-04T09:02:13+01:00</updated-at>
      <user-id type="integer">31422</user-id>
      <version type="integer">1</version>
      <user-name>Wojciech Wn&#281;trzak</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>The patch applies cleanly on the version from repository (tag v2.3.4), but there are some problems with applying it on the gem. The secure_compare now uses bytesize and each_byte methods when available (Ruby 1.8.7, 1.9.x, ...).</body>
      <body-html>&lt;div&gt;&lt;p&gt;The patch applies cleanly on the version from repository (tag
v2.3.4), but there are some problems with applying it on the gem.
The secure_compare now uses bytesize and each_byte methods when
available (Ruby 1.8.7, 1.9.x, ...).&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-04T08:55:51+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: activesupport
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-04T08:55:57+01:00</updated-at>
      <user-id type="integer">22814</user-id>
      <version type="integer">2</version>
      <user-name>qoobaa</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Checked again and it seems that everything works on gem version as well.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Checked again and it seems that everything works on gem version
as well.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-04T09:05:07+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-04T09:05:11+01:00</updated-at>
      <user-id type="integer">22814</user-id>
      <version type="integer">3</version>
      <user-name>qoobaa</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I just ran into the same problem on ruby 1.9 and fixed it quite differently. I'm not sure why you chose to make it so complicated to compare those two strings.

I would be highly interested to hear what you think about my version!

In the end you could just compare the strings in ruby versions below 1.8.7 (maybe even below 1.9). In 1.9 however it should be sufficient to compare the byte arrays as that would make sure it only returns true if they are of the same length, the same content and the same order.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I just ran into the same problem on ruby 1.9 and fixed it quite
differently. I'm not sure why you chose to make it so complicated
to compare those two strings.&lt;/p&gt;
&lt;p&gt;I would be highly interested to hear what you think about my
version!&lt;/p&gt;
&lt;p&gt;In the end you could just compare the strings in ruby versions
below 1.8.7 (maybe even below 1.9). In 1.9 however it should be
sufficient to compare the byte arrays as that would make sure it
only returns true if they are of the same length, the same content
and the same order.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-04T11:29:36+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-04T11:29:40+01:00</updated-at>
      <user-id type="integer">32378</user-id>
      <version type="integer">4</version>
      <user-name>hukl</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>hukl - Isn't the simple &quot;compare&quot; approach vulnerable to the timing attack that http://github.com/rails/rails/commit/1f07a89c5946910fc28ea5ccd1da6af8a0f972a0 was committed to address in the first place?</body>
      <body-html>&lt;div&gt;&lt;p&gt;hukl - Isn't the simple &quot;compare&quot; approach vulnerable to the
timing attack that &lt;a href=
&quot;http://github.com/rails/rails/commit/1f07a89c5946910fc28ea5ccd1da6af8a0f972a0&quot;&gt;
http://github.com/rails/rails/commit/1f07a89c5946910fc28ea5ccd1da6a...&lt;/a&gt;
was committed to address in the first place?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-04T12:22:59+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-04T12:23:04+01:00</updated-at>
      <user-id type="integer">7211</user-id>
      <version type="integer">5</version>
      <user-name>CancelProfileIsBroken</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-04T12:23:12+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-04T12:23:17+01:00</updated-at>
      <user-id type="integer">7211</user-id>
      <version type="integer">6</version>
      <user-name>CancelProfileIsBroken</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>@@@ ruby
irb(main):011:0&gt; puts Benchmark.measure { ([0] + [1] * 100_000_000) == ([1] + [1] * 100_000_000) }
 14.350000   1.590000  15.940000 ( 17.394467)
=&gt; nil
irb(main):012:0&gt; puts Benchmark.measure { ([1] * 100_000_000 + [0]) == ([1] * 100_000_000 + [1]) }
 16.430000   1.900000  18.330000 ( 21.816415)
=&gt; nil
@@@

Huki - your patch is also vulnerable to timing attack. The main difference between your code and the code from Rails is that RoR always checks every single byte, even if the first byte is different.

Method should use bytesize instead of size (size depends on the string encoding, it may cause some problems).</body>
      <body-html>&lt;div&gt;&lt;pre&gt;
&lt;code class=
&quot;ruby&quot;&gt;irb(main):011:0&amp;gt; puts Benchmark.measure { ([0] + [1] * 100_000_000) == ([1] + [1] * 100_000_000) }
 14.350000   1.590000  15.940000 ( 17.394467)
=&amp;gt; nil
irb(main):012:0&amp;gt; puts Benchmark.measure { ([1] * 100_000_000 + [0]) == ([1] * 100_000_000 + [1]) }
 16.430000   1.900000  18.330000 ( 21.816415)
=&amp;gt; nil&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Huki - your patch is also vulnerable to timing attack. The main
difference between your code and the code from Rails is that RoR
always checks every single byte, even if the first byte is
different.&lt;/p&gt;
&lt;p&gt;Method should use bytesize instead of size (size depends on the
string encoding, it may cause some problems).&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-04T12:53:43+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-04T12:53:45+01:00</updated-at>
      <user-id type="integer">22814</user-id>
      <version type="integer">7</version>
      <user-name>qoobaa</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>hrm okay, i don't understand that timing issue yet. The main concern is to fix it for ruby 1.9 without breaking this timing issue again. I'd be still interested in a detailed explanation for this issue.</body>
      <body-html>&lt;div&gt;&lt;p&gt;hrm okay, i don't understand that timing issue yet. The main
concern is to fix it for ruby 1.9 without breaking this timing
issue again. I'd be still interested in a detailed explanation for
this issue.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-04T14:11:12+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-04T14:11:14+01:00</updated-at>
      <user-id type="integer">32378</user-id>
      <version type="integer">8</version>
      <user-name>hukl</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>See http://codahale.com/a-lesson-in-timing-attacks/ - an article from the guy who reported the issue in Rails. It's a good introduction to the subject.</body>
      <body-html>&lt;div&gt;&lt;p&gt;See &lt;a href=
&quot;http://codahale.com/a-lesson-in-timing-attacks/&quot;&gt;http://codahale.com/a-lesson-in-timing-attacks/&lt;/a&gt;
- an article from the guy who reported the issue in Rails. It's a
good introduction to the subject.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-04T14:20:22+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-04T14:20:27+01:00</updated-at>
      <user-id type="integer">7211</user-id>
      <version type="integer">9</version>
      <user-name>CancelProfileIsBroken</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Huki: basically, comparing &quot;abbb&quot; and &quot;bbbb&quot; is faster than comparing &quot;bbba&quot; and &quot;bbbb&quot;. It means, that if you have some good way to measure the time taken by the comparison, you know how many bytes of your digest (of some password, signature, etc.) are correct. Theoretically you can guess the digest, measuring the time taken by processing request. http://en.wikipedia.org/wiki/Timing_attack</body>
      <body-html>&lt;div&gt;&lt;p&gt;Huki: basically, comparing &quot;abbb&quot; and &quot;bbbb&quot; is faster than
comparing &quot;bbba&quot; and &quot;bbbb&quot;. It means, that if you have some good
way to measure the time taken by the comparison, you know how many
bytes of your digest (of some password, signature, etc.) are
correct. Theoretically you can guess the digest, measuring the time
taken by processing request. &lt;a href=
&quot;http://en.wikipedia.org/wiki/Timing_attack&quot;&gt;http://en.wikipedia.org/wiki/Timing_attack&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-04T14:23:49+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-04T14:23:51+01:00</updated-at>
      <user-id type="integer">22814</user-id>
      <version type="integer">10</version>
      <user-name>qoobaa</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Okay I see! ;) Too bad! 

And iterating over it is the only way? Can't you still do something like this:

result = digest_a.bytes.to_a | digest_b.bytes.to_a

result.length == digest_a.bytes.to_a.length 

This would also compare the whole array. Well - I guess I can live with the iterating version - just looks so massive for an operation that should be so small ;)

Thank you for clueing me in ;)</body>
      <body-html>&lt;div&gt;&lt;p&gt;Okay I see! ;) Too bad!&lt;/p&gt;
&lt;p&gt;And iterating over it is the only way? Can't you still do
something like this:&lt;/p&gt;
&lt;p&gt;result = digest_a.bytes.to_a | digest_b.bytes.to_a&lt;/p&gt;
&lt;p&gt;result.length == digest_a.bytes.to_a.length&lt;/p&gt;
&lt;p&gt;This would also compare the whole array. Well - I guess I can
live with the iterating version - just looks so massive for an
operation that should be so small ;)&lt;/p&gt;
&lt;p&gt;Thank you for clueing me in ;)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-04T15:02:40+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-04T15:02:46+01:00</updated-at>
      <user-id type="integer">32378</user-id>
      <version type="integer">11</version>
      <user-name>hukl</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>This is a pretty severe bug that's been introduced going from 2.3.3 to 2.3.4. It means that anyone who's visited the site won't be able to access it anymore and will get this error message. 

This should be rescued and handled WAY more elegantly, perhaps just trashing the session and starting fresh or something.</body>
      <body-html>&lt;div&gt;&lt;p&gt;This is a pretty severe bug that's been introduced going from
2.3.3 to 2.3.4. It means that anyone who's visited the site won't
be able to access it anymore and will get this error message.&lt;/p&gt;
&lt;p&gt;This should be rescued and handled WAY more elegantly, perhaps
just trashing the session and starting fresh or something.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-04T20:47:39+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-04T20:47:44+01:00</updated-at>
      <user-id type="integer">58630</user-id>
      <version type="integer">12</version>
      <user-name>travis (at appoxy)</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Actually, this even happens after clearing cookies. I could get to the login page, but then after logging in and going to the next page, same error.  Rolling back to 2.3.3.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Actually, this even happens after clearing cookies. I could get
to the login page, but then after logging in and going to the next
page, same error. Rolling back to 2.3.3.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-04T20:52:32+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-04T20:52:36+01:00</updated-at>
      <user-id type="integer">58630</user-id>
      <version type="integer">13</version>
      <user-name>travis (at appoxy)</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I know it's only been a couple of days, but can we get this fixed soon?

I too can't move to 2.3.4 because of this bug.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I know it's only been a couple of days, but can we get this
fixed soon?&lt;/p&gt;
&lt;p&gt;I too can't move to 2.3.4 because of this bug.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-09T06:11:46+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-09T06:11:51+01:00</updated-at>
      <user-id type="integer">14688</user-id>
      <version type="integer">14</version>
      <user-name>Adam S</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>+1 patch applied cleanly.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 patch applied cleanly.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-09T07:19:43+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-09T07:19:49+01:00</updated-at>
      <user-id type="integer">14688</user-id>
      <version type="integer">15</version>
      <user-name>Adam S</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>@Adam S: This bug is fixed at github's master branch. Temporarily you can copy the fixed file to your local copy or build gem from source etc.</body>
      <body-html>&lt;div&gt;&lt;p&gt;@Adam S: This bug is fixed at github's master branch.
Temporarily you can copy the fixed file to your local copy or build
gem from source etc.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-09T07:22:35+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-09T07:22:40+01:00</updated-at>
      <user-id type="integer">32675</user-id>
      <version type="integer">16</version>
      <user-name>Priit Tamboom</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>When do you think 2.3.5 will come out with this patch?</body>
      <body-html>&lt;div&gt;&lt;p&gt;When do you think 2.3.5 will come out with this patch?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-09T07:31:38+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-09T07:31:40+01:00</updated-at>
      <user-id type="integer">58630</user-id>
      <version type="integer">17</version>
      <user-name>travis (at appoxy)</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>It's out of my scope, but I would suggest to release 2.3.4.1 instead.</body>
      <body-html>&lt;div&gt;&lt;p&gt;It's out of my scope, but I would suggest to release 2.3.4.1
instead.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-09T07:39:34+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-09T07:39:36+01:00</updated-at>
      <user-id type="integer">32675</user-id>
      <version type="integer">18</version>
      <user-name>Priit Tamboom</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>+1 for 2.3.4.1 !</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 for 2.3.4.1 !&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-09T09:35:35+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-09T09:35:38+01:00</updated-at>
      <user-id type="integer">18156</user-id>
      <version type="integer">19</version>
      <user-name>Nicolas Blanco</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>+1 for 2.3.4.1

The core difference is in the return type from Ruby 1.8 hexdigest and Ruby 1.9 hexdigest.  Ruby 1.8 returns an array of bytes and Ruby 1.9 returns a string.  By forcing generate_digest to always return a string, it makes it easy to compare.  Alternatively, it can be done by making generate_digest always return an array of bytes.  I fixed it manually by applying the following code:

      def secure_compare(a, b)
        return a == b
      end

      def generate_digest(data)
        require 'openssl' unless defined?(OpenSSL)
        OpenSSL::HMAC.hexdigest(OpenSSL::Digest::Digest.new(@digest), @secret, data).to_s
      end</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 for 2.3.4.1&lt;/p&gt;
&lt;p&gt;The core difference is in the return type from Ruby 1.8
hexdigest and Ruby 1.9 hexdigest. Ruby 1.8 returns an array of
bytes and Ruby 1.9 returns a string. By forcing generate_digest to
always return a string, it makes it easy to compare. Alternatively,
it can be done by making generate_digest always return an array of
bytes. I fixed it manually by applying the following code:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;  def secure_compare(a, b)
    return a == b
  end

  def generate_digest(data)
    require 'openssl' unless defined?(OpenSSL)
    OpenSSL::HMAC.hexdigest(OpenSSL::Digest::Digest.new(@digest), @secret, data).to_s
  end&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-09T20:56:21+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-09T20:56:28+01:00</updated-at>
      <user-id type="integer">62098</user-id>
      <version type="integer">20</version>
      <user-name>Berin Loritsch</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>OK, after reading up on the timing attack, and found out that Ruby 1.9 likes to automatically convert bytes to characters, I found an approach that will always work.  Not to mention, fix a particular bug in the implementation that violated the reason for the change to begin with:

      def secure_compare(a, b)
        result = a.length ^ b.length
        for i in 0..([a.length, b.length].max - 1)
          result |= a[i].to_i ^ b[i].to_i
        end
        result == 0
      end

The previous version would end early when the two digests were not identical.  With this information, an attacker can at least guess the size of the key.  This simpler version of the secure_compare() method takes advantage of a few things:

if you ask for a value outside the range of an array you will get a nil:

a = [10,20,101]
val = a[5]
val.nil? == true

When you convert nil.to_i you get the number zero (0).

This allows the loop to force every element of both arrays to be a number, whether it was a string (ruby 1.9) or a nil (arrays are different sizes).

The only way to make this more cryptographically secure from the sideband timing attack is to identify one of the arguments as the secret and the other argument as the item being compared to the secret.  You would always use the length of the item being compared to the secret so as not to reveal the length of the secret.  Using an empty array for the secret is protected from by including the length of the secret compared to the length of the array being compared.  This requires that the method be used consistently--which would suggest the need better argument names.</body>
      <body-html>&lt;div&gt;&lt;p&gt;OK, after reading up on the timing attack, and found out that
Ruby 1.9 likes to automatically convert bytes to characters, I
found an approach that will always work. Not to mention, fix a
particular bug in the implementation that violated the reason for
the change to begin with:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;  def secure_compare(a, b)
    result = a.length ^ b.length
    for i in 0..([a.length, b.length].max - 1)
      result |= a[i].to_i ^ b[i].to_i
    end
    result == 0
  end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;The previous version would end early when the two digests were
not identical. With this information, an attacker can at least
guess the size of the key. This simpler version of the
secure_compare() method takes advantage of a few things:&lt;/p&gt;
&lt;p&gt;if you ask for a value outside the range of an array you will
get a nil:&lt;/p&gt;
&lt;p&gt;a = [10,20,101]&lt;br&gt;
val = a[5]&lt;br&gt;
val.nil? == true&lt;/p&gt;
&lt;p&gt;When you convert nil.to_i you get the number zero (0).&lt;/p&gt;
&lt;p&gt;This allows the loop to force every element of both arrays to be
a number, whether it was a string (ruby 1.9) or a nil (arrays are
different sizes).&lt;/p&gt;
&lt;p&gt;The only way to make this more cryptographically secure from the
sideband timing attack is to identify one of the arguments as the
secret and the other argument as the item being compared to the
secret. You would always use the length of the item being compared
to the secret so as not to reveal the length of the secret. Using
an empty array for the secret is protected from by including the
length of the secret compared to the length of the array being
compared. This requires that the method be used consistently--which
would suggest the need better argument names.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-10T16:32:04+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-10T16:32:11+01:00</updated-at>
      <user-id type="integer">63473</user-id>
      <version type="integer">21</version>
      <user-name>bloritsch</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I think the suggestion &quot;always use the length of the item being compared to the secret so as not to reveal the length of the secret&quot; is a great idea. This means that small attacks can still return quickly, and the attacker basically has no way of guessing anything.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I think the suggestion &quot;always use the length of the item being
compared to the secret so as not to reveal the length of the
secret&quot; is a great idea. This means that small attacks can still
return quickly, and the attacker basically has no way of guessing
anything.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-11T02:56:13+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-11T02:56:18+01:00</updated-at>
      <user-id type="integer">14688</user-id>
      <version type="integer">22</version>
      <user-name>Adam S</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Jakub's original patch looks good, can you rebase it so it applies against master and 2-3-stable please.

We'll push a 2.3.5 once we know this is fixed *properly* on 1.9</body>
      <body-html>&lt;div&gt;&lt;p&gt;Jakub's original patch looks good, can you rebase it so it
applies against master and 2-3-stable please.&lt;/p&gt;
&lt;p&gt;We'll push a 2.3.5 once we know this is fixed &lt;em&gt;properly&lt;/em&gt;
on 1.9&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-11T04:31:51+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-11T04:31:57+01:00</updated-at>
      <user-id type="integer">141</user-id>
      <version type="integer">23</version>
      <user-name>Michael Koziarski</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Rebased to master and 2-3-stable.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Rebased to master and 2-3-stable.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-11T08:20:22+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-11T08:20:25+01:00</updated-at>
      <user-id type="integer">22814</user-id>
      <version type="integer">24</version>
      <user-name>qoobaa</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>I just thought of something last night.  Using the length of the requester provided HMAC to control the loop opens the door for a possible Denial of Service attack.  If the client provides a very long key it will negatively affect the response of the application.  So even better than using the length of the master key or the challenge key, use a constant length that is longer than both yet still reasonable.  The method would then look like this:

  def secure_compare(a, b)
    result = a.length ^ b.length
    for i in 0..99 # or some other constant
      result |= a[i].to_i ^ b[i].to_i
    end
    result == 0
  end

Which satisfies both 1.8.6 and 1.9.1 requirements without the complex logic of the last friendly-secure-compare.patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I just thought of something last night. Using the length of the
requester provided HMAC to control the loop opens the door for a
possible Denial of Service attack. If the client provides a very
long key it will negatively affect the response of the application.
So even better than using the length of the master key or the
challenge key, use a constant length that is longer than both yet
still reasonable. The method would then look like this:&lt;/p&gt;
&lt;p&gt;def secure_compare(a, b)&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;result = a.length ^ b.length
for i in 0..99 # or some other constant
  result |= a[i].to_i ^ b[i].to_i
end
result == 0&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;end&lt;/p&gt;
&lt;p&gt;Which satisfies both 1.8.6 and 1.9.1 requirements without the
complex logic of the last friendly-secure-compare.patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-11T13:39:09+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-11T13:39:14+01:00</updated-at>
      <user-id type="integer">63473</user-id>
      <version type="integer">25</version>
      <user-name>bloritsch</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>@@@ ruby
  def secure_compare(a, b)
    result = a.length ^ b.length
    for i in 0..([a.length, b.length].max - 1)
      result |= a[i].to_i ^ b[i].to_i
    end
    result == 0
  end
@@@</body>
      <body-html>&lt;div&gt;&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;  def secure_compare(a, b)
    result = a.length ^ b.length
    for i in 0..([a.length, b.length].max - 1)
      result |= a[i].to_i ^ b[i].to_i
    end
    result == 0
  end&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-11T13:40:06+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-11T13:40:13+01:00</updated-at>
      <user-id type="integer">63473</user-id>
      <version type="integer">26</version>
      <user-name>bloritsch</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>@@@ ruby
  def secure_compare(a, b)
    result = a.length ^ b.length
    for i in 0..99 # or some other constant
      result |= a[i].to_i ^ b[i].to_i
    end
    result == 0
  end
@@@

Is there some way to clean up the mistakes?  I can't delete the erroneous comment from before, or edit the formatting for one I made earlier.</body>
      <body-html>&lt;div&gt;&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;  def secure_compare(a, b)
    result = a.length ^ b.length
    for i in 0..99 # or some other constant
      result |= a[i].to_i ^ b[i].to_i
    end
    result == 0
  end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Is there some way to clean up the mistakes? I can't delete the
erroneous comment from before, or edit the formatting for one I
made earlier.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-11T13:41:36+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-11T13:41:43+01:00</updated-at>
      <user-id type="integer">63473</user-id>
      <version type="integer">27</version>
      <user-name>bloritsch</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Applied jakub's patches so I'm wrapping this one up.

Thanks for the feedback from everyone but I'm happy that this one is good enough now.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Applied jakub's patches so I'm wrapping this one up.&lt;/p&gt;
&lt;p&gt;Thanks for the feedback from everyone but I'm happy that this
one is good enough now.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-09-12T01:52:14+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-12T01:52:19+01:00</updated-at>
      <user-id type="integer">141</user-id>
      <version type="integer">28</version>
      <user-name>Michael Koziarski</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Google brought me to this page.  I guess I need this fix.  I'm an idiot, and I can't figure out how to apply the patch.  Can someone help me?

I've tried 

$ sudo patch /usr/local/lib/ruby/gems/1.9.1/gems/activesupport-2.3.3/lib/active_support/message_verifier.rb ~/Dev/0001-ruby-1.9-friendly-secure_compare.patch

and also with --force, neither works.  Hunk #1 FAILED at 40.  Reading the patch man-page and further googling hasn't helped me figure out how to get it patched.  Can someone give me a pointer?

Thanks</body>
      <body-html>&lt;div&gt;&lt;p&gt;Google brought me to this page. I guess I need this fix. I'm an
idiot, and I can't figure out how to apply the patch. Can someone
help me?&lt;/p&gt;
&lt;p&gt;I've tried&lt;/p&gt;
&lt;p&gt;$ sudo patch
/usr/local/lib/ruby/gems/1.9.1/gems/activesupport-2.3.3/lib/active_support/message_verifier.rb
~/Dev/0001-ruby-1.9-friendly-secure_compare.patch&lt;/p&gt;
&lt;p&gt;and also with --force, neither works. Hunk &lt;a href=
&quot;/projects/8994/tickets/1&quot; title=&quot;Ticket #1&quot;&gt;#1&lt;/a&gt; FAILED at 40.
Reading the patch man-page and further googling hasn't helped me
figure out how to get it patched. Can someone give me a
pointer?&lt;/p&gt;
&lt;p&gt;Thanks&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-09-21T02:20:42+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 141
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-21T02:20:48+01:00</updated-at>
      <user-id type="integer">70430</user-id>
      <version type="integer">29</version>
      <user-name>Joe Hannon</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Is this going to be pushed in a new patch level soon?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Is this going to be pushed in a new patch level soon?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-09-24T08:52:46+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-24T08:52:50+01:00</updated-at>
      <user-id type="integer">3825</user-id>
      <version type="integer">30</version>
      <user-name>Rob Sanheim</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Joe:

I ran into the same problem. You need to use the original patch file at the beginning of the thread if you are patching rails 2.3.4, that is what worked for me.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Joe:&lt;/p&gt;
&lt;p&gt;I ran into the same problem. You need to use the original patch
file at the beginning of the thread if you are patching rails
2.3.4, that is what worked for me.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-09-29T18:55:41+01:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-09-29T18:55:47+01:00</updated-at>
      <user-id type="integer">71459</user-id>
      <version type="integer">31</version>
      <user-name>alberto</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Just curious.  Is there a reason not to just change:
a[i] ^ b[i]
to:
a[i].ord ^ b[i].ord</body>
      <body-html>&lt;div&gt;&lt;p&gt;Just curious. Is there a reason not to just change:&lt;br&gt;
a[i] ^ b[i]&lt;br&gt;
to:&lt;br&gt;
a[i].ord ^ b[i].ord&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-11-04T19:01:41+00:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-11-04T19:01:45+00:00</updated-at>
      <user-id type="integer">34159</user-id>
      <version type="integer">32</version>
      <user-name>The Doctor What</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>I don't wish to sound rude, but how did this get through testing? It seems there must have been a gap in the process to let a bug like this through? Has something been done to make sure that future releases will be fully tested in Ruby 1.9.1 before being published?</body>
      <body-html>&lt;div&gt;&lt;p&gt;I don't wish to sound rude, but how did this get through
testing? It seems there must have been a gap in the process to let
a bug like this through? Has something been done to make sure that
future releases will be fully tested in Ruby 1.9.1 before being
published?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-11-04T20:34:20+00:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-11-04T20:34:23+00:00</updated-at>
      <user-id type="integer">50086</user-id>
      <version type="integer">33</version>
      <user-name>Julian Burgess</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>BTW: Was a unittest added when this was fixed?</body>
      <body-html>&lt;div&gt;&lt;p&gt;BTW: Was a unittest added when this was fixed?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-11-04T20:37:40+00:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2009-11-04T20:37:43+00:00</updated-at>
      <user-id type="integer">34159</user-id>
      <version type="integer">34</version>
      <user-name>The Doctor What</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Replica Tag Watches sell at low prices. Buy Tag Heuer Replica Watches, Fake TAG Heuer Watches please come to our &lt;a href=&quot;http://www.replicawatchesi.com/tag-heuer-watches&quot;&gt;Replica Tag Heuer watches&lt;/a&gt;.Look no further for &lt;a href=&quot;http://www.replicawatchesi.com/&quot;&gt;replica watches&lt;/a&gt;, &lt;a href=&quot;http://www.replicawatchesi.com/&quot;&gt;replica rolex&lt;/a&gt;, &lt;a href=&quot;http://www.replicawatchesi.com/&quot;&gt;replica watches uk&lt;/a&gt;, &lt;a href=&quot;http://www.replicawatchesi.com/breitling-watches&quot;&gt;Replica Breitling watches&lt;/a&gt;, Swiss Replica Rolex, fake watch, and swiss replica watch.Buy Omega Watch, Omega Replicas, Alpha Omega Watches, Ladies Omega Replica Watches from our &lt;a href='http://www.replicawatchesi.com/omega-watches&quot;&gt;Replica Omega watches&lt;/a&gt; store.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Replica Tag Watches sell at low prices. Buy Tag Heuer Replica
Watches, Fake TAG Heuer Watches please come to our &lt;a href=
&quot;http://www.replicawatchesi.com/tag-heuer-watches&quot;&gt;Replica Tag
Heuer watches&lt;/a&gt;.Look no further for &lt;a href=
&quot;http://www.replicawatchesi.com/&quot;&gt;replica watches&lt;/a&gt;, &lt;a href=
&quot;http://www.replicawatchesi.com/&quot;&gt;replica rolex&lt;/a&gt;, &lt;a href=
&quot;http://www.replicawatchesi.com/&quot;&gt;replica watches uk&lt;/a&gt;, &lt;a href=
&quot;http://www.replicawatchesi.com/breitling-watches&quot;&gt;Replica
Breitling watches&lt;/a&gt;, Swiss Replica Rolex, fake watch, and swiss
replica watch.Buy Omega Watch, Omega Replicas, Alpha Omega Watches,
Ladies Omega Replica Watches from our &lt;a href=
&quot;http://www.replicawatchesi.com/omega-watches&amp;quot;%3E&quot;&gt;Replica
Omega watches&lt;/a&gt; store.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2011-02-21T13:55:08+00:00</created-at>
      <creator-id type="integer">31422</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3144</number>
      <permalink>undefined-method-for-string-ror-234</permalink>
      <priority type="integer">137687</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>1.9 1.9.1 2.3.4 activesupport patch</tag>
      <title>undefined method `^' for String  - RoR 2.3.4</title>
      <updated-at type="datetime">2011-02-21T14:04:54+00:00</updated-at>
      <user-id type="integer">138022</user-id>
      <version type="integer">35</version>
      <user-name>benben</user-name>
      <creator-name>Wojciech Wn&#281;trzak</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3144</url>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>cdb51600acbf39a79e825c8401e6ee9d47616396</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-09-04T08:55:51+01:00</created-at>
      <filename>0001-ruby-1.9-friendly-secure_compare.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">261015</id>
      <size type="integer">1555</size>
      <uploader-id type="integer">22814</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/261015/0001-ruby-1.9-friendly-secure_compare.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>16b4ffd6ff9e8c7745d0ef569c72d887cf0507dd</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-09-04T11:29:36+01:00</created-at>
      <filename>0001-secure_compare-would-not-work-on-ruby-1.9-because-a-.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">261106</id>
      <size type="integer">1196</size>
      <uploader-id type="integer">32378</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/261106/0001-secure_compare-would-not-work-on-ruby-1.9-because-a-.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>1c8ab3815be1dc892dcde4463708495f46f29ec6</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-09-11T08:20:22+01:00</created-at>
      <filename>0001-ruby-1.9-friendly-secure_compare.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">266521</id>
      <size type="integer">1544</size>
      <uploader-id type="integer">22814</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/266521/0001-ruby-1.9-friendly-secure_compare.patch</url>
    </attachment>
  </attachments>
</ticket>
