<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">1366</assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-02-23T17:42:14+00:00</created-at>
  <creator-id type="integer">48412</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">9903</milestone-id>
  <number type="integer">2053</number>
  <permalink>has_many_assoc-and-invalid-associated-instances</permalink>
  <priority type="integer">1285</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>wontfix</state>
  <tag nil="true"></tag>
  <title>has_many_assoc= and invalid associated instances</title>
  <updated-at type="datetime">2009-05-18T21:10:41+01:00</updated-at>
  <user-id type="integer">1366</user-id>
  <version type="integer">4</version>
  <user-name>Pratik</user-name>
  <creator-name>ransom-briggs (at uiowa)</creator-name>
  <assigned-user-name>Pratik</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/2053</url>
  <milestone-title>2.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>See the attached test for example, but in english if you do the following...

a.posts = [p1, p2]

and p1 and p2 are invalid objects, the code in 

vendor/rails/activerecord/lib/active_record/associations/association_collection.rb:&lt;&lt;(*records)

at

result &amp;&amp;= insert_record(record) unless @owner.new_record?

runs for p1 but not p2, generating the side effect of p1 having author_id set, but p2 does not have author_id to be set.

this is the side result of the &amp;&amp;= which causes it not to run insert_record the second time.

My desired behavior would be that either both are set or neither are set (I would prefer both to be set for my purposes, but could see the opposite argument being made)

- Ransom</original-body>
  <latest-body>See the attached test for example, but in english if you do the following...

a.posts = [p1, p2]

and p1 and p2 are invalid objects, the code in 

vendor/rails/activerecord/lib/active_record/associations/association_collection.rb:&lt;&lt;(*records)

at

result &amp;&amp;= insert_record(record) unless @owner.new_record?

runs for p1 but not p2, generating the side effect of p1 having author_id set, but p2 does not have author_id to be set.

this is the side result of the &amp;&amp;= which causes it not to run insert_record the second time.

My desired behavior would be that either both are set or neither are set (I would prefer both to be set for my purposes, but could see the opposite argument being made)

- Ransom</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;See the attached test for example, but in english if you do the
following...&lt;/p&gt;
&lt;p&gt;a.posts = [p1, p2]&lt;/p&gt;
&lt;p&gt;and p1 and p2 are invalid objects, the code in&lt;/p&gt;
&lt;p&gt;
vendor/rails/activerecord/lib/active_record/associations/association_collection.rb:&amp;lt;&amp;lt;(*records)&lt;/p&gt;
&lt;p&gt;at&lt;/p&gt;
&lt;p&gt;result &amp;amp;&amp;amp;= insert_record(record) unless
@owner.new_record?&lt;/p&gt;
&lt;p&gt;runs for p1 but not p2, generating the side effect of p1 having
author_id set, but p2 does not have author_id to be set.&lt;/p&gt;
&lt;p&gt;this is the side result of the &amp;amp;&amp;amp;= which causes it not
to run insert_record the second time.&lt;/p&gt;
&lt;p&gt;My desired behavior would be that either both are set or neither
are set (I would prefer both to be set for my purposes, but could
see the opposite argument being made)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Ransom&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>See the attached test for example, but in english if you do the following...

a.posts = [p1, p2]

and p1 and p2 are invalid objects, the code in 

vendor/rails/activerecord/lib/active_record/associations/association_collection.rb:&lt;&lt;(*records)

at

result &amp;&amp;= insert_record(record) unless @owner.new_record?

runs for p1 but not p2, generating the side effect of p1 having author_id set, but p2 does not have author_id to be set.

this is the side result of the &amp;&amp;= which causes it not to run insert_record the second time.

My desired behavior would be that either both are set or neither are set (I would prefer both to be set for my purposes, but could see the opposite argument being made)

- Ransom</body>
      <body-html>&lt;div&gt;&lt;p&gt;See the attached test for example, but in english if you do the
following...&lt;/p&gt;
&lt;p&gt;a.posts = [p1, p2]&lt;/p&gt;
&lt;p&gt;and p1 and p2 are invalid objects, the code in&lt;/p&gt;
&lt;p&gt;
vendor/rails/activerecord/lib/active_record/associations/association_collection.rb:&amp;lt;&amp;lt;(*records)&lt;/p&gt;
&lt;p&gt;at&lt;/p&gt;
&lt;p&gt;result &amp;amp;&amp;amp;= insert_record(record) unless
@owner.new_record?&lt;/p&gt;
&lt;p&gt;runs for p1 but not p2, generating the side effect of p1 having
author_id set, but p2 does not have author_id to be set.&lt;/p&gt;
&lt;p&gt;this is the side result of the &amp;amp;&amp;amp;= which causes it not
to run insert_record the second time.&lt;/p&gt;
&lt;p&gt;My desired behavior would be that either both are set or neither
are set (I would prefer both to be set for my purposes, but could
see the opposite argument being made)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Ransom&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-23T17:42:14+00:00</created-at>
      <creator-id type="integer">48412</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2053</number>
      <permalink>has_many_assoc-and-invalid-associated-instances</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>has_many_assoc= and invalid associated instances</title>
      <updated-at type="datetime">2009-02-23T17:42:17+00:00</updated-at>
      <user-id type="integer">48412</user-id>
      <version type="integer">1</version>
      <user-name>ransom-briggs (at uiowa)</user-name>
      <creator-name>ransom-briggs (at uiowa)</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2053</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>result &amp;&amp;= insert_record(record) unless @owner.new_record?

in my eyes should be

              unless @owner.new_record?
                result = insert_record(record) &amp;&amp; result
              end</body>
      <body-html>&lt;div&gt;&lt;p&gt;result &amp;amp;&amp;amp;= insert_record(record) unless
@owner.new_record?&lt;/p&gt;
&lt;p&gt;in my eyes should be&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;          unless @owner.new_record?
            result = insert_record(record) &amp;amp;&amp;amp; result
          end
&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-24T14:18:21+00:00</created-at>
      <creator-id type="integer">48412</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2053</number>
      <permalink>has_many_assoc-and-invalid-associated-instances</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>has_many_assoc= and invalid associated instances</title>
      <updated-at type="datetime">2009-02-24T14:18:33+00:00</updated-at>
      <user-id type="integer">48412</user-id>
      <version type="integer">2</version>
      <user-name>ransom-briggs (at uiowa)</user-name>
      <creator-name>ransom-briggs (at uiowa)</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2053</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>assigning to last committer</body>
      <body-html>&lt;div&gt;&lt;p&gt;assigning to last committer&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-07T16:59:36+01:00</created-at>
      <creator-id type="integer">48412</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2053</number>
      <permalink>has_many_assoc-and-invalid-associated-instances</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>has_many_assoc= and invalid associated instances</title>
      <updated-at type="datetime">2009-04-07T16:59:39+01:00</updated-at>
      <user-id type="integer">48412</user-id>
      <version type="integer">3</version>
      <user-name>ransom-briggs (at uiowa)</user-name>
      <creator-name>ransom-briggs (at uiowa)</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2053</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Could you please submit a patch or a failing test ? http://guides.rubyonrails.org/contributing_to_rails.html is a start.

Thanks!</body>
      <body-html>&lt;div&gt;&lt;p&gt;Could you please submit a patch or a failing test ? &lt;a href=
&quot;http://guides.rubyonrails.org/contributing_to_rails.html&quot;&gt;http://guides.rubyonrails.org/contributing_to_rails.html&lt;/a&gt;
is a start.&lt;/p&gt;
&lt;p&gt;Thanks!&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-05-18T21:10:39+01:00</created-at>
      <creator-id type="integer">48412</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2053</number>
      <permalink>has_many_assoc-and-invalid-associated-instances</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>wontfix</state>
      <tag nil="true"></tag>
      <title>has_many_assoc= and invalid associated instances</title>
      <updated-at type="datetime">2009-05-18T21:10:41+01:00</updated-at>
      <user-id type="integer">1366</user-id>
      <version type="integer">4</version>
      <user-name>Pratik</user-name>
      <creator-name>ransom-briggs (at uiowa)</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2053</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>d3a6c13566a871dde0e70d1106c87a2d94ce7abe</code>
      <content-type>application/octet-stream</content-type>
      <created-at type="datetime">2009-02-23T17:42:14+00:00</created-at>
      <filename>has_many_test.rb</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">91911</id>
      <size type="integer">549</size>
      <uploader-id type="integer">48412</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/91911/has_many_test.rb</url>
    </attachment>
  </attachments>
</ticket>
