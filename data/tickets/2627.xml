<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">85</assigned-user-id>
  <attachments-count type="integer">8</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-05-09T07:03:08+01:00</created-at>
  <creator-id type="integer">25677</creator-id>
  <milestone-due-on type="datetime">2010-01-15T00:00:00+00:00</milestone-due-on>
  <milestone-id type="integer">50064</milestone-id>
  <number type="integer">2627</number>
  <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
  <priority type="integer">1758</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>committed</state>
  <tag>active_record dependent has_many module patch review</tag>
  <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
  <updated-at type="datetime">2010-04-19T23:31:43+01:00</updated-at>
  <user-id type="integer">78412</user-id>
  <version type="integer">21</version>
  <user-name>CDD Developers</user-name>
  <creator-name>Brian Samson</creator-name>
  <assigned-user-name>Jeremy Kemper</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
  <milestone-title>2.3.6</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>If a model that is declared inside a module is associated via a has_many to another model in the same module, and :dependent is set to :destroy or :nullify, an exception is thrown stating that &quot;(Module) is not missing Constant (class)&quot;

This is because the method that sets up the before_destroy handler just uses a text representation of the model name instead of the actual model class.  The example I've been using is this: 
&lt;code&gt;
class Astronomy::SolarSystem &amp;lt; ActiveRecord::Base
  has_man :planets, :dependent =&amp;gt; :destroy
end
&lt;/code&gt;
The before destroy handler ends up making a call to Planet.delete_all instead of Astronomy::Planet.delete_all.  I am attaching a patch with a test case that show this (and a similar flaw with :dependent =&amp;gt; :nullify) and a solution to the problem. 

I discovered this bug in rails 2.1 and it is still present in edge rails.  The patch is meant to be applied to edge. 

As an aside, I don't really like my particular solution because of its reliance on 'eval.'  I think it would be a better idea to change the dependent_conditions to be parameterized instead of a string that needs to be double-evaled, but I'm not sure that will play well will every database backend.  If it's ok to change that conditions clause to a parameterized query, let me know and I'll update the patch.</original-body>
  <latest-body>If a model that is declared inside a module is associated via a has_many to another model in the same module, and :dependent is set to :destroy or :nullify, an exception is thrown stating that &quot;(Module) is not missing Constant (class)&quot;

This is because the method that sets up the before_destroy handler just uses a text representation of the model name instead of the actual model class.  The example I've been using is this: 
&lt;code&gt;
class Astronomy::SolarSystem &amp;lt; ActiveRecord::Base
  has_man :planets, :dependent =&amp;gt; :destroy
end
&lt;/code&gt;
The before destroy handler ends up making a call to Planet.delete_all instead of Astronomy::Planet.delete_all.  I am attaching a patch with a test case that show this (and a similar flaw with :dependent =&amp;gt; :nullify) and a solution to the problem. 

I discovered this bug in rails 2.1 and it is still present in edge rails.  The patch is meant to be applied to edge. 

As an aside, I don't really like my particular solution because of its reliance on 'eval.'  I think it would be a better idea to change the dependent_conditions to be parameterized instead of a string that needs to be double-evaled, but I'm not sure that will play well will every database backend.  If it's ok to change that conditions clause to a parameterized query, let me know and I'll update the patch.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;If a model that is declared inside a module is associated via a
has_many to another model in the same module, and :dependent is set
to :destroy or :nullify, an exception is thrown stating that
&quot;(Module) is not missing Constant (class)&quot;&lt;/p&gt;
&lt;p&gt;This is because the method that sets up the before_destroy
handler just uses a text representation of the model name instead
of the actual model class. The example I've been using is this:&lt;/p&gt;
&lt;p&gt;class Astronomy::SolarSystem &amp;lt; ActiveRecord::Base has_man
:planets, :dependent =&amp;gt; :destroy end&lt;/p&gt;
&lt;p&gt;The before destroy handler ends up making a call to
Planet.delete_all instead of Astronomy::Planet.delete_all. I am
attaching a patch with a test case that show this (and a similar
flaw with :dependent =&amp;gt; :nullify) and a solution to the
problem.&lt;/p&gt;
&lt;p&gt;I discovered this bug in rails 2.1 and it is still present in
edge rails. The patch is meant to be applied to edge.&lt;/p&gt;
&lt;p&gt;As an aside, I don't really like my particular solution because
of its reliance on 'eval.' I think it would be a better idea to
change the dependent_conditions to be parameterized instead of a
string that needs to be double-evaled, but I'm not sure that will
play well will every database backend. If it's ok to change that
conditions clause to a parameterized query, let me know and I'll
update the patch.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>If a model that is declared inside a module is associated via a has_many to another model in the same module, and :dependent is set to :delete_all or :nullify, an exception is thrown stating that &quot;(Module) is not missing Constant (class)&quot;

This is because the method that sets up the before_destroy handler just uses a text representation of the model name instead of the actual model class.  The example I've been using is this: 
&lt;pre&gt;
class Astronomy::SolarSystem &amp;lt; ActiveRecord::Base
  has_many :planets, :dependent =&amp;gt; :delete_all
end
&lt;/pre&gt;
The before destroy handler ends up making a call to Planet.delete_all instead of Astronomy::Planet.delete_all.  I am attaching a patch with a test case that show this (and a similar flaw with :dependent =&amp;gt; :nullify) and a solution to the problem. 

I discovered this bug in rails 2.1 and it is still present in edge rails.  The patch is meant to be applied to edge. 

As an aside, I don't really like my particular solution because of its reliance on 'eval.'  I think it would be a better idea to change the dependent_conditions to be parameterized instead of a string that needs to be double-evaled, but I'm not sure that will play well will every database backend.  If it's ok to change that conditions clause to a parameterized query, let me know and I'll update the patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;If a model that is declared inside a module is associated via a
has_many to another model in the same module, and :dependent is set
to :delete_all or :nullify, an exception is thrown stating that
&quot;(Module) is not missing Constant (class)&quot;&lt;/p&gt;
&lt;p&gt;This is because the method that sets up the before_destroy
handler just uses a text representation of the model name instead
of the actual model class. The example I've been using is this:&lt;/p&gt;
&lt;pre&gt;
class Astronomy::SolarSystem &amp;lt; ActiveRecord::Base
  has_many :planets, :dependent =&amp;gt; :delete_all
end
&lt;/pre&gt;
The before destroy handler ends up making a call to
Planet.delete_all instead of Astronomy::Planet.delete_all. I am
attaching a patch with a test case that show this (and a similar
flaw with :dependent =&amp;gt; :nullify) and a solution to the problem.
&lt;p&gt;I discovered this bug in rails 2.1 and it is still present in
edge rails. The patch is meant to be applied to edge.&lt;/p&gt;
&lt;p&gt;As an aside, I don't really like my particular solution because
of its reliance on 'eval.' I think it would be a better idea to
change the dependent_conditions to be parameterized instead of a
string that needs to be double-evaled, but I'm not sure that will
play well will every database backend. If it's ok to change that
conditions clause to a parameterized query, let me know and I'll
update the patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-09T07:03:08+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>active_record dependent has_many module</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2009-05-09T08:50:32+01:00</updated-at>
      <user-id type="integer">25677</user-id>
      <version type="integer">1</version>
      <user-name>Brian Samson</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>+1</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-11T17:49:44+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>active_record dependent has_many module</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2009-05-11T17:49:45+01:00</updated-at>
      <user-id type="integer">25684</user-id>
      <version type="integer">2</version>
      <user-name>Geoff Coffey</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-06T14:34:34+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: active_record dependent has_many module
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>active_record bugmash dependent has_many module</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2009-08-06T14:34:38+01:00</updated-at>
      <user-id type="integer">7211</user-id>
      <version type="integer">3</version>
      <user-name>CancelProfileIsBroken</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>+1 verified 

this applies cleanly to master with a few whitespace warnings

test suite passes

note that it does add a few models</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 verified&lt;/p&gt;
&lt;p&gt;this applies cleanly to master with a few whitespace
warnings&lt;/p&gt;
&lt;p&gt;test suite passes&lt;/p&gt;
&lt;p&gt;note that it does add a few models&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-08T23:21:26+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>active_record bugmash dependent has_many module</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2009-08-08T23:21:29+01:00</updated-at>
      <user-id type="integer">22242</user-id>
      <version type="integer">4</version>
      <user-name>Dan Pickett</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>This bug still exists as far as I can tell.  I updated this patch to apply cleanly to edge, if somebody could double-check that for me quick I'd appreciate it.</body>
      <body-html>&lt;div&gt;&lt;p&gt;This bug still exists as far as I can tell. I updated this patch
to apply cleanly to edge, if somebody could double-check that for
me quick I'd appreciate it.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-10-12T20:14:27+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>active_record bugmash dependent has_many module</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2009-10-12T20:14:30+01:00</updated-at>
      <user-id type="integer">25677</user-id>
      <version type="integer">5</version>
      <user-name>Brian Samson</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>-1 fail

The patch fails when testing sqlite3 adapter but passes on MySQL. I've checked on the master branch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;-1 fail&lt;/p&gt;
&lt;p&gt;The patch fails when testing sqlite3 adapter but passes on
MySQL. I've checked on the master branch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-10-14T16:26:06+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>active_record bugmash dependent has_many module</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2009-10-14T16:26:09+01:00</updated-at>
      <user-id type="integer">65556</user-id>
      <version type="integer">6</version>
      <user-name>Rizwan Reza</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Good catch, Rizwan.  

I was using double quotes in the eval which threw off sqlite's quoting.  I changed it to %() which should work unless you know of a database that uses unmatched parentheses as a way to quote column names :)

If you have the time, it would be cool if you could retest, but I checked on sqlite3 and mysql and the tests all pass now.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Good catch, Rizwan.&lt;br&gt;&lt;/p&gt;
&lt;p&gt;I was using double quotes in the eval which threw off sqlite's
quoting. I changed it to %() which should work unless you know of a
database that uses unmatched parentheses as a way to quote column
names :)&lt;/p&gt;
&lt;p&gt;If you have the time, it would be cool if you could retest, but
I checked on sqlite3 and mysql and the tests all pass now.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-10-14T22:48:04+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>active_record bugmash dependent has_many module</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2009-10-14T22:48:06+01:00</updated-at>
      <user-id type="integer">25677</user-id>
      <version type="integer">7</version>
      <user-name>Brian Samson</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>+1 verified

The patch applies cleanly and passes tests all tests.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 verified&lt;/p&gt;
&lt;p&gt;The patch applies cleanly and passes tests all tests.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-11-03T16:17:22+00:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: active_record bugmash dependent has_many module
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>active_record bugmash dependent has_many module review</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2009-11-03T16:17:23+00:00</updated-at>
      <user-id type="integer">65556</user-id>
      <version type="integer">8</version>
      <user-name>Rizwan Reza</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Actually, isn't this another instance of this bug: https://rails.lighthouseapp.com/projects/8994/tickets/2283

Wouldn't it be better to fix the actual problem rather than patching around it all over the place in ActiveRecord?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Actually, isn't this another instance of this bug: &lt;a href=
&quot;https://rails.lighthouseapp.com/projects/8994/tickets/2283&quot;&gt;https://rails.lighthouseapp.com/projects/8994/tickets/2283&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Wouldn't it be better to fix the actual problem rather than
patching around it all over the place in ActiveRecord?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-11-03T17:10:53+00:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>active_record bugmash dependent has_many module review</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2009-11-03T17:10:55+00:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">9</version>
      <user-name>Andrew White</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/13645)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/13645&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-02-12T12:46:15+00:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: active_record bugmash dependent has_many module review
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>active_record dependent has_many module review</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2010-02-12T12:46:15+00:00</updated-at>
      <user-id type="integer">65556</user-id>
      <version type="integer">10</version>
      <user-name>Rizwan Reza</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>I think that perhaps Andrew's patch would fix this problem, but it looks like that has been pushed off to 3.0.  Basically my patch just makes this behavior ask for Mod::Class instead of just Class, which I think it should be doing anyway.  

Is there any way we can get this patch put in to 2.3.6?</body>
      <body-html>&lt;div&gt;&lt;p&gt;I think that perhaps Andrew's patch would fix this problem, but
it looks like that has been pushed off to 3.0. Basically my patch
just makes this behavior ask for Mod::Class instead of just Class,
which I think it should be doing anyway.&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Is there any way we can get this patch put in to 2.3.6?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-03-30T17:54:44+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>active_record dependent has_many module review</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2010-03-30T17:54:49+01:00</updated-at>
      <user-id type="integer">25677</user-id>
      <version type="integer">11</version>
      <user-name>Brian Samson</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">12714</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>My patch for compute_type from [2283](https://rails.lighthouseapp.com/projects/8994-ruby-on-rails/tickets/2283) is a necessary fix but some other changes are required as well. The attached patch provides those fixes and tests. The dependency callbacks were as you pointed out hardcoded, so I just defer the class lookup until the callback is executed. The patch is for master but I can do a backport once it's been accepted.

I did try and use existing schema and fixtures but it broke too many tests.</body>
      <body-html>&lt;div&gt;&lt;p&gt;My patch for compute_type from &lt;a href=
&quot;https://rails.lighthouseapp.com/projects/8994-ruby-on-rails/tickets/2283&quot;&gt;
2283&lt;/a&gt; is a necessary fix but some other changes are required as
well. The attached patch provides those fixes and tests. The
dependency callbacks were as you pointed out hardcoded, so I just
defer the class lookup until the callback is executed. The patch is
for master but I can do a backport once it's been accepted.&lt;/p&gt;
&lt;p&gt;I did try and use existing schema and fixtures but it broke too
many tests.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-03-31T07:50:53+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: active_record dependent has_many module review
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>active_record dependent has_many module patch review</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2010-03-31T07:51:06+01:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">12</version>
      <user-name>Andrew White</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name>Yehuda Katz (wycats)</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Thanks Andrew! I get two errors with the patch:
&lt;pre&gt;
  1) Error:
test_nested_models_should_not_raise_exception_when_using_delete_all_dependency_on_association(ModulesTest):
ArgumentError: Shop is not missing constant Product!

  2) Error:
test_nested_models_should_not_raise_exception_when_using_nullify_dependency_on_association(ModulesTest):
ArgumentError: Shop is not missing constant Variant!
&lt;/pre&gt;</body>
      <body-html>&lt;div&gt;&lt;p&gt;Thanks Andrew! I get two errors with the patch:&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;
  1) Error:
test_nested_models_should_not_raise_exception_when_using_delete_all_dependency_on_association(ModulesTest):
ArgumentError: Shop is not missing constant Product!

&lt;br&gt;
  2) Error:
test_nested_models_should_not_raise_exception_when_using_nullify_dependency_on_association(ModulesTest):
ArgumentError: Shop is not missing constant Variant!
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-03T15:52:38+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
:milestone: 9903
:assigned_user: 12714
</diffable-attributes>
      <milestone-id type="integer">50064</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>active_record dependent has_many module patch review</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2010-04-03T15:52:45+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">13</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.3.6</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Jeremy, that's because the compute type fix from from [2283](https://rails.lighthouseapp.com/projects/8994-ruby-on-rails/tickets/2283) is needed. Carl's recent [commit](http://github.com/rails/rails/commit/13004d4f849682772060371273fda3312dd3b884) makes my patch on this ticket redundant, though it still needs backporting to 2-3-stable.

I'll move the tests from here to the patches for master and 2-3-stable on 2283 and I'll add a patch here for master to test Carl's commit and then backport the commit and test to 2-3-stable and add it here also. Is this okay?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Jeremy, that's because the compute type fix from from &lt;a href=
&quot;https://rails.lighthouseapp.com/projects/8994-ruby-on-rails/tickets/2283&quot;&gt;
2283&lt;/a&gt; is needed. Carl's recent &lt;a href=
&quot;http://github.com/rails/rails/commit/13004d4f849682772060371273fda3312dd3b884&quot;&gt;
commit&lt;/a&gt; makes my patch on this ticket redundant, though it still
needs backporting to 2-3-stable.&lt;/p&gt;
&lt;p&gt;I'll move the tests from here to the patches for master and
2-3-stable on 2283 and I'll add a patch here for master to test
Carl's commit and then backport the commit and test to 2-3-stable
and add it here also. Is this okay?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-03T17:00:43+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">50064</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>active_record dependent has_many module patch review</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2010-04-03T17:00:47+01:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">14</version>
      <user-name>Andrew White</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.3.6</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Ah, I missed that dependency. That sounds great; thanks Andrew!</body>
      <body-html>&lt;div&gt;&lt;p&gt;Ah, I missed that dependency. That sounds great; thanks
Andrew!&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-03T21:12:23+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">50064</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>active_record dependent has_many module patch review</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2010-04-03T21:12:25+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">15</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.3.6</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Patch for master adding tests for preventing regression.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Patch for master adding tests for preventing regression.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-04T01:30:59+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">50064</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>active_record dependent has_many module patch review</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2010-04-04T01:31:21+01:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">16</version>
      <user-name>Andrew White</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.3.6</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">5</attachments-count>
      <body>Patch for 2-3-stable backporting changes from Carl's commits and adding tests from patch above</body>
      <body-html>&lt;div&gt;&lt;p&gt;Patch for 2-3-stable backporting changes from Carl's commits and
adding tests from patch above&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-04T01:32:38+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">50064</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>active_record dependent has_many module patch review</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2010-04-04T01:32:41+01:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">17</version>
      <user-name>Andrew White</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.3.6</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">6</attachments-count>
      <body>Updated backport patch - the previous patch didn't send the right class to the dependent_conditions method.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Updated backport patch - the previous patch didn't send the
right class to the dependent_conditions method.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-04T07:06:17+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">50064</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>active_record dependent has_many module patch review</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2010-04-04T07:06:19+01:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">18</version>
      <user-name>Andrew White</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.3.6</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">7</attachments-count>
      <body>(from [e617af13a2cee3278c6f76121bbb777fc7f0fea5]) Backport of lazy evaluation of has_many ..., :dependent =&gt; :___

[#2627 state:committed]

Signed-off-by: Jeremy Kemper &lt;jeremy@bitsweat.net&gt;
http://github.com/rails/rails/commit/e617af13a2cee3278c6f76121bbb777fc7f0fea5</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/e617af13a2cee3278c6f76121bbb777fc7f0fea5&quot;
title=
&quot;Changeset [e617af13a2cee3278c6f76121bbb777fc7f0fea5]&quot;&gt;[e617af13a2cee3278c6f76121bbb777fc7f0fea5]&lt;/a&gt;)
Backport of lazy evaluation of has_many ..., :dependent =&amp;gt;
:___&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;/projects/8994/tickets/2627&quot; title=
&quot;Ticket #2627&quot;&gt;#2627&lt;/a&gt; state:committed]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jeremy Kemper &lt;a href=
&quot;mailto:jeremy@bitsweat.net&quot;&gt;jeremy@bitsweat.net&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/e617af13a2cee3278c6f76121bbb777fc7f0fea5&quot;&gt;
http://github.com/rails/rails/commit/e617af13a2cee3278c6f76121bbb77...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-04-04T15:02:26+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer">50064</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>active_record dependent has_many module patch review</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2010-04-04T15:02:27+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">19</version>
      <user-name>Repository</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.3.6</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">7</attachments-count>
      <body>(from [98b4424141b4775183618bc307e0e7d09d74df6e]) Add tests to prevent regression of lazy evaluation of has_many ..., :dependent =&gt; :___

[#2627 state:committed]

Signed-off-by: Jeremy Kemper &lt;jeremy@bitsweat.net&gt;
http://github.com/rails/rails/commit/98b4424141b4775183618bc307e0e7d09d74df6e</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/98b4424141b4775183618bc307e0e7d09d74df6e&quot;
title=
&quot;Changeset [98b4424141b4775183618bc307e0e7d09d74df6e]&quot;&gt;[98b4424141b4775183618bc307e0e7d09d74df6e]&lt;/a&gt;)
Add tests to prevent regression of lazy evaluation of has_many ...,
:dependent =&amp;gt; :___&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;/projects/8994/tickets/2627&quot; title=
&quot;Ticket #2627&quot;&gt;#2627&lt;/a&gt; state:committed]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jeremy Kemper &lt;a&gt;jeremy@bitsweat.net&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/98b4424141b4775183618bc307e0e7d09d74df6e&quot;&gt;
http://github.com/rails/rails/commit/98b4424141b4775183618bc307e0e7...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-04-04T15:02:26+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">50064</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>active_record dependent has_many module patch review</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2010-04-04T15:02:29+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">20</version>
      <user-name>Repository</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.3.6</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">7</attachments-count>
      <body>The patch that was applied to the 2.3 branch introduced a regression bug when declaring a polymorphic association on a STI model hierarchy.

Making up a simple example:

class FileAssociation &lt; ActiveRecord:Base
  belongs_to :associated_record, :polymorphic =&gt; true
end

class Message &lt; ActiveRecord:Base
  has_many :file_associations, :as =&gt; :associated_record, :dependent =&gt; :delete_all
end

class Mail &lt; Message
end


some_mail = Mail.first
some_mail.file_associations.first # =&gt; some file associations
some_mail.file_associations.associated_record_type # =&gt; &quot;Message&quot;

some_mail.destroy # =&gt; does not destroy the file associations since the generated SQL checks for associated_record_type = 'Mail'

The attached patch fixes the previous commit by using the base_class of the model class. (The fix is only intended to fix the regression and does not handle the larger issue involving STI and polymorphic associations as described in https://rails.lighthouseapp.com/projects/8994/tickets/2756 that would require a different fix)</body>
      <body-html>&lt;div&gt;&lt;p&gt;The patch that was applied to the 2.3 branch introduced a
regression bug when declaring a polymorphic association on a STI
model hierarchy.&lt;/p&gt;
&lt;p&gt;Making up a simple example:&lt;/p&gt;
&lt;p&gt;class FileAssociation &amp;lt; ActiveRecord:Base&lt;br&gt;
belongs_to :associated_record, :polymorphic =&amp;gt; true end&lt;/p&gt;
&lt;p&gt;class Message &amp;lt; ActiveRecord:Base&lt;br&gt;
has_many :file_associations, :as =&amp;gt; :associated_record,
:dependent =&amp;gt; :delete_all end&lt;/p&gt;
&lt;p&gt;class Mail &amp;lt; Message&lt;br&gt;
end&lt;/p&gt;
&lt;p&gt;some_mail = Mail.first&lt;br&gt;
some_mail.file_associations.first # =&amp;gt; some file
associations&lt;br&gt;
some_mail.file_associations.associated_record_type # =&amp;gt;
&quot;Message&quot;&lt;/p&gt;
&lt;p&gt;some_mail.destroy # =&amp;gt; does not destroy the file associations
since the generated SQL checks for associated_record_type =
'Mail'&lt;/p&gt;
&lt;p&gt;The attached patch fixes the previous commit by using the
base_class of the model class. (The fix is only intended to fix the
regression and does not handle the larger issue involving STI and
polymorphic associations as described in &lt;a href=
&quot;https://rails.lighthouseapp.com/projects/8994/tickets/2756&quot;&gt;https://rails.lighthouseapp.com/projects/8994/tickets/2756&lt;/a&gt;
that would require a different fix)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-04-19T23:31:40+01:00</created-at>
      <creator-id type="integer">25677</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">50064</milestone-id>
      <number type="integer">2627</number>
      <permalink>has_many-dependent-gt-destroy-throws-exception-on-models-in-modules</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>active_record dependent has_many module patch review</tag>
      <title>has_many :dependent =&gt; :delete_all throws exception on models in modules</title>
      <updated-at type="datetime">2010-04-19T23:31:43+01:00</updated-at>
      <user-id type="integer">78412</user-id>
      <version type="integer">21</version>
      <user-name>CDD Developers</user-name>
      <creator-name>Brian Samson</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2627</url>
      <milestone-title>2.3.6</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>3344f7a3f52ab4db1a7fc5e0b6f2fd8db4ea472b</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-05-09T07:03:08+01:00</created-at>
      <filename>has_many_delete_all_in_modules.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">120686</id>
      <size type="integer">10033</size>
      <uploader-id type="integer">25677</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/120686/has_many_delete_all_in_modules.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>baa9a876ffc49240a9c5ea098d96b466ec363a3e</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-10-12T20:14:27+01:00</created-at>
      <filename>has_many_delete_all_in_modules_20091012.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">293256</id>
      <size type="integer">10268</size>
      <uploader-id type="integer">25677</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/293256/has_many_delete_all_in_modules_20091012.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>bfd225cc6beb8459d9218dca9c333d048865be82</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-10-14T22:48:04+01:00</created-at>
      <filename>has_many_delete_all_in_modules_20091014-1.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">296065</id>
      <size type="integer">10476</size>
      <uploader-id type="integer">25677</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/296065/has_many_delete_all_in_modules_20091014-1.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>f18cf691e09b456bc007aa0663e9a26e205a2435</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-03-31T07:50:53+01:00</created-at>
      <filename>0001-fix-delete-all-dependency.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">466275</id>
      <size type="integer">8805</size>
      <uploader-id type="integer">7697</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/466275/0001-fix-delete-all-dependency.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>3b244d8b195cd66b86292f119c5ad813d1725831</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-04-04T01:30:59+01:00</created-at>
      <filename>0001-test-has-many-dependency-is-lazily-evaluated.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">470613</id>
      <size type="integer">1628</size>
      <uploader-id type="integer">7697</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/470613/0001-test-has-many-dependency-is-lazily-evaluated.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>ec04a38f1c4c18cbaeb5f1099ece45e52d135ff2</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-04-04T01:32:38+01:00</created-at>
      <filename>0001-backport-of-lazy-evaluation-of-has-many-dependencies.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">470614</id>
      <size type="integer">6666</size>
      <uploader-id type="integer">7697</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/470614/0001-backport-of-lazy-evaluation-of-has-many-dependencies.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>d3a9780548b9c92d92fe5c4169685aab1b750dc1</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-04-04T07:06:17+01:00</created-at>
      <filename>0002-backport-of-lazy-evaluation-of-has-many-dependencies.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">470642</id>
      <size type="integer">6670</size>
      <uploader-id type="integer">7697</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/470642/0002-backport-of-lazy-evaluation-of-has-many-dependencies.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>2128f6d559ad6e5ec64f37b76fd11d9e2be43f24</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-04-19T23:31:40+01:00</created-at>
      <filename>fixed-regression-bug-with-lazy-evaluation-of.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">488617</id>
      <size type="integer">1813</size>
      <uploader-id type="integer">78412</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/488617/fixed-regression-bug-with-lazy-evaluation-of.patch</url>
    </attachment>
  </attachments>
</ticket>
