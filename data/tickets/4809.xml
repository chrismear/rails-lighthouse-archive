<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">19965</assigned-user-id>
  <attachments-count type="integer">3</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2010-06-09T17:04:32+01:00</created-at>
  <creator-id type="integer">12926</creator-id>
  <milestone-due-on type="datetime">2010-11-15T00:00:00+00:00</milestone-due-on>
  <milestone-id type="integer">88038</milestone-id>
  <number type="integer">4809</number>
  <permalink>table-name-not-escaped-on-dropping-index</permalink>
  <priority type="integer">3</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag nil="true"></tag>
  <title>[PATCH] Table name not escaped on dropping index</title>
  <updated-at type="datetime">2010-11-08T01:52:19+00:00</updated-at>
  <user-id type="integer">14998</user-id>
  <version type="integer">22</version>
  <user-name>Ryan Bigg</user-name>
  <creator-name>J. Pablo Fernandez</creator-name>
  <assigned-user-name>Jos&#233; Valim</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
  <milestone-title>3.0.2</milestone-title>
  <priority-name>Low</priority-name>
  <original-body>While this works just fine:

@@@
add_index :values, [:field_id, :user_id]
@@@

this doesn't work:

@@@
remove_index :values, :column =&gt; [:field_id, :user_id]
@@@

failing with this error:

&gt; Mysql::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'values' at line 1: DROP INDEX `index_values_on_field_id_and_user_id` ON values

I think the issue is that values is not escaped at the end of that query, if it generated

@@@
DROP INDEX `index_values_on_field_id_and_user_id` ON `values`
@@@

it might work.</original-body>
  <latest-body>While this works just fine:

@@@
add_index :values, [:field_id, :user_id]
@@@

this doesn't work:

@@@
remove_index :values, :column =&gt; [:field_id, :user_id]
@@@

failing with this error:

&gt; Mysql::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'values' at line 1: DROP INDEX `index_values_on_field_id_and_user_id` ON values

I think the issue is that values is not escaped at the end of that query, if it generated

@@@
DROP INDEX `index_values_on_field_id_and_user_id` ON `values`
@@@

it might work.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;While this works just fine:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;add_index :values, [:field_id, :user_id]&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;this doesn't work:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;remove_index :values, :column =&amp;gt; [:field_id, :user_id]&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;failing with this error:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Mysql::Error: You have an error in your SQL syntax; check the
manual that corresponds to your MySQL server version for the right
syntax to use near 'values' at line 1: DROP INDEX
&lt;code&gt;index_values_on_field_id_and_user_id&lt;/code&gt; ON values&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I think the issue is that values is not escaped at the end of
that query, if it generated&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;DROP INDEX `index_values_on_field_id_and_user_id` ON `values`&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;it might work.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>While this works just fine:

@@@
add_index :values, [:field_id, :user_id]
@@@

this doesn't work:

@@@
remove_index :values, :column =&gt; [:field_id, :user_id]
@@@

failing with this error:

&gt; Mysql::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'values' at line 1: DROP INDEX `index_values_on_field_id_and_user_id` ON values

I think the issue is that values is not escaped at the end of that query, if it generated

@@@
DROP INDEX `index_values_on_field_id_and_user_id` ON `values`
@@@

it might work.</body>
      <body-html>&lt;div&gt;&lt;p&gt;While this works just fine:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;add_index :values, [:field_id, :user_id]&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;this doesn't work:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;remove_index :values, :column =&amp;gt; [:field_id, :user_id]&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;failing with this error:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Mysql::Error: You have an error in your SQL syntax; check the
manual that corresponds to your MySQL server version for the right
syntax to use near 'values' at line 1: DROP INDEX
&lt;code&gt;index_values_on_field_id_and_user_id&lt;/code&gt; ON values&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I think the issue is that values is not escaped at the end of
that query, if it generated&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;DROP INDEX `index_values_on_field_id_and_user_id` ON `values`&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;it might work.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-09T17:04:32+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>&quot;mysql remove_index index&quot;</tag>
      <title>Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-09T17:04:46+01:00</updated-at>
      <user-id type="integer">12926</user-id>
      <version type="integer">1</version>
      <user-name>J. Pablo Fernandez</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I workarrounded it this way:

@@@
remove_index &quot;`values`&quot;, :name =&gt; &quot;index_values_on_field_id_and_user_id&quot;
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;I workarrounded it this way:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;remove_index &quot;`values`&quot;, :name =&amp;gt; &quot;index_values_on_field_id_and_user_id&quot;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-09T17:06:09+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: &quot;\&quot;mysql remove_index index\&quot;&quot;
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>database index mysql remove_index</tag>
      <title>Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-09T17:06:14+01:00</updated-at>
      <user-id type="integer">12926</user-id>
      <version type="integer">2</version>
      <user-name>J. Pablo Fernandez</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I'm attaching the patch that fixes this issue. It contains a test that shows the issue. I'm quite sure the way I wrote the test is not good, I've created another test class and I created the test as small and simple as possible. If it is not the correct way, can you tell me how you'd like me to do it and I'll make new patches.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I'm attaching the patch that fixes this issue. It contains a
test that shows the issue. I'm quite sure the way I wrote the test
is not good, I've created another test class and I created the test
as small and simple as possible. If it is not the correct way, can
you tell me how you'd like me to do it and I'll make new
patches.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-12T02:37:44+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: database index mysql remove_index
:title: Table name not escaped on dropping index
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>database index mysql patch remove_index</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-12T02:37:51+01:00</updated-at>
      <user-id type="integer">12926</user-id>
      <version type="integer">3</version>
      <user-name>J. Pablo Fernandez</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Oh, and it's also in this branch: http://github.com/pupeno/rails/tree/remove_index_from_values  It's this commit: http://github.com/pupeno/rails/commit/13f9869896f5b39dd3558a2938ffedb2f0eb9e9d</body>
      <body-html>&lt;div&gt;&lt;p&gt;Oh, and it's also in this branch: &lt;a href=
&quot;http://github.com/pupeno/rails/tree/remove_index_from_values&quot;&gt;http://github.com/pupeno/rails/tree/remove_index_from_values&lt;/a&gt;
It's this commit: &lt;a href=
&quot;http://github.com/pupeno/rails/commit/13f9869896f5b39dd3558a2938ffedb2f0eb9e9d&quot;&gt;
http://github.com/pupeno/rails/commit/13f9869896f5b39dd3558a2938ffe...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-12T02:38:32+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>database index mysql patch remove_index</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-12T02:38:33+01:00</updated-at>
      <user-id type="integer">12926</user-id>
      <version type="integer">4</version>
      <user-name>J. Pablo Fernandez</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Looks good, it's definitely a bug that should be fixed.  I've attached a new patch that slightly modifies the test so that it asserts that no exception is raised, rather than just stating that in a comment</body>
      <body-html>&lt;div&gt;&lt;p&gt;Looks good, it's definitely a bug that should be fixed. I've
attached a new patch that slightly modifies the test so that it
asserts that no exception is raised, rather than just stating that
in a comment&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-12T04:05:46+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>database index mysql patch remove_index</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-12T04:05:52+01:00</updated-at>
      <user-id type="integer">10193</user-id>
      <version type="integer">5</version>
      <user-name>Paul Barry</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Thanks Paul, I just updated my repo with your patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Thanks Paul, I just updated my repo with your patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-12T11:05:26+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>database index mysql patch remove_index</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-12T11:05:27+01:00</updated-at>
      <user-id type="integer">12926</user-id>
      <version type="integer">6</version>
      <user-name>J. Pablo Fernandez</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>It's a regression from http://github.com/rails/rails/commit/3809c80cd55ac2838f050346800889b6f8e041ef#L1L312 (sorry about that).

I would have put the test along the other ones in MigrationTest, though. And the call to `add_index` could also be in an `assert_nothing_raised` block.

But the patch as it is solves the problem and works under 1.8.7 and 1.9.1 on master and 2-3-stable (cherry-picking raises a conflict, but it's easy to solve).</body>
      <body-html>&lt;div&gt;&lt;p&gt;It's a regression from &lt;a href=
&quot;http://github.com/rails/rails/commit/3809c80cd55ac2838f050346800889b6f8e041ef#L1L312&quot;&gt;
http://github.com/rails/rails/commit/3809c80cd55ac2838f050346800889...&lt;/a&gt;
(sorry about that).&lt;/p&gt;
&lt;p&gt;I would have put the test along the other ones in MigrationTest,
though. And the call to &lt;code&gt;add_index&lt;/code&gt; could also be in an
&lt;code&gt;assert_nothing_raised&lt;/code&gt; block.&lt;/p&gt;
&lt;p&gt;But the patch as it is solves the problem and works under 1.8.7
and 1.9.1 on master and 2-3-stable (cherry-picking raises a
conflict, but it's easy to solve).&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-13T14:46:31+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>database index mysql patch remove_index</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-13T14:46:35+01:00</updated-at>
      <user-id type="integer">99481</user-id>
      <version type="integer">7</version>
      <user-name>&#201;tienne Barri&#233;</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>&#201;tienne,

Paul Barry added the assert_nothing_raised block. I'll look into the conflict.

Regarding MigrationTest, I should add the test here: activerecord/test/cases/migration_test.rb and then should I add a values table here: activerecord/test/schema/schema.rb?

With that second part I had some trouble: http://groups.google.com/group/rubyonrails-core/browse_thread/thread/a3af7acfba21c01a?hl=en</body>
      <body-html>&lt;div&gt;&lt;p&gt;&amp;Eacute;tienne,&lt;/p&gt;
&lt;p&gt;Paul Barry added the assert_nothing_raised block. I'll look into
the conflict.&lt;/p&gt;
&lt;p&gt;Regarding MigrationTest, I should add the test here:
activerecord/test/cases/migration_test.rb and then should I add a
values table here: activerecord/test/schema/schema.rb?&lt;/p&gt;
&lt;p&gt;With that second part I had some trouble: &lt;a href=
&quot;http://groups.google.com/group/rubyonrails-core/browse_thread/thread/a3af7acfba21c01a?hl=en&quot;&gt;
http://groups.google.com/group/rubyonrails-core/browse_thread/threa...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-14T12:04:35+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: database index mysql patch remove_index
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>database index migration mysql patch remove_index</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-14T12:04:39+01:00</updated-at>
      <user-id type="integer">12926</user-id>
      <version type="integer">8</version>
      <user-name>J. Pablo Fernandez</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Paul added the `assert_nothing_raised` block to `remove_index`, but not to `add_index`.
You added the test to migration_test.rb but in a new `TestCase`, outside of `MigrationTest`. I would have put it inside, at line 160 for example.
And I don't think you need to add a new table, just add/remove indices with reserved names to an existing table, like it was done in `test_add_index_length_limit` for
example.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Paul added the &lt;code&gt;assert_nothing_raised&lt;/code&gt; block to
&lt;code&gt;remove_index&lt;/code&gt;, but not to &lt;code&gt;add_index&lt;/code&gt;.&lt;br&gt;
You added the test to migration_test.rb but in a new
&lt;code&gt;TestCase&lt;/code&gt;, outside of &lt;code&gt;MigrationTest&lt;/code&gt;. I
would have put it inside, at line 160 for example.&lt;br&gt;
And I don't think you need to add a new table, just add/remove
indices with reserved names to an existing table, like it was done
in &lt;code&gt;test_add_index_length_limit&lt;/code&gt; for&lt;br&gt;
example.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-14T13:19:57+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>database index migration mysql patch remove_index</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-14T13:19:59+01:00</updated-at>
      <user-id type="integer">99481</user-id>
      <version type="integer">9</version>
      <user-name>&#201;tienne Barri&#233;</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>&#201;tienne, oh, got it regarding assert_nothing_raised. I'll fix it.

But the issue was the name of the table, not the name of the index. What wasn't being escaped was the name of the table, if the name of the table is not reserver it'll work just fine.</body>
      <body-html>&lt;div&gt;&lt;p&gt;&amp;Eacute;tienne, oh, got it regarding assert_nothing_raised. I'll
fix it.&lt;/p&gt;
&lt;p&gt;But the issue was the name of the table, not the name of the
index. What wasn't being escaped was the name of the table, if the
name of the table is not reserver it'll work just fine.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-14T13:48:25+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>database index migration mysql patch remove_index</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-14T13:48:29+01:00</updated-at>
      <user-id type="integer">12926</user-id>
      <version type="integer">10</version>
      <user-name>J. Pablo Fernandez</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>New patch that applies cleanly (I actually couldn't find the conflict) and puts the add_index inside the no exceptions zone.</body>
      <body-html>&lt;div&gt;&lt;p&gt;New patch that applies cleanly (I actually couldn't find the
conflict) and puts the add_index inside the no exceptions zone.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-15T22:39:35+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>database index migration mysql patch remove_index</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-15T22:39:42+01:00</updated-at>
      <user-id type="integer">12926</user-id>
      <version type="integer">11</version>
      <user-name>J. Pablo Fernandez</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>The conflict appears when you cherry-pick (or rebase --onto) your commits from master to 2-3-stable. But it's just a matter of removing the conflict markers.</body>
      <body-html>&lt;div&gt;&lt;p&gt;The conflict appears when you cherry-pick (or rebase --onto)
your commits from master to 2-3-stable. But it's just a matter of
removing the conflict markers.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-16T08:42:07+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>database index migration mysql patch remove_index</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-16T08:42:11+01:00</updated-at>
      <user-id type="integer">99481</user-id>
      <version type="integer">12</version>
      <user-name>&#201;tienne Barri&#233;</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Oh, right, I only worked in Rails 3 for this patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Oh, right, I only worked in Rails 3 for this patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-16T08:50:29+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>database index migration mysql patch remove_index</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-16T08:50:31+01:00</updated-at>
      <user-id type="integer">12926</user-id>
      <version type="integer">13</version>
      <user-name>J. Pablo Fernandez</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>+1

I just applied this patch in my copy of rails master; it applies cleanly and all of the tests which pass in master pass with the patch applied on SQLite3, MySQL and Postgres.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;
&lt;p&gt;I just applied this patch in my copy of rails master; it applies
cleanly and all of the tests which pass in master pass with the
patch applied on SQLite3, MySQL and Postgres.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-29T13:19:26+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: database index migration mysql patch remove_index
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>database index migration mysql patch remove_index verified</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-29T13:19:34+01:00</updated-at>
      <user-id type="integer">27160</user-id>
      <version type="integer">14</version>
      <user-name>Norman Clarke</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Can you rebase the patch to a single commit, rather than a group of three?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Can you rebase the patch to a single commit, rather than a group
of three?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-29T14:50:22+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>database index migration mysql patch remove_index verified</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-29T14:50:43+01:00</updated-at>
      <user-id type="integer">22589</user-id>
      <version type="integer">15</version>
      <user-name>Matt Jones</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Matt,

Yes, I can do that. Wouldn't that remove authorship from Paul Barry, and if so, is it acceptable for me to do it?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Matt,&lt;/p&gt;
&lt;p&gt;Yes, I can do that. Wouldn't that remove authorship from Paul
Barry, and if so, is it acceptable for me to do it?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-29T15:57:23+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>database index migration mysql patch remove_index verified</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-29T15:57:55+01:00</updated-at>
      <user-id type="integer">12926</user-id>
      <version type="integer">16</version>
      <user-name>J. Pablo Fernandez</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-29T18:17:51+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
:milestone: 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>database index migration mysql patch remove_index verified</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-29T18:18:00+01:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">17</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>It's ok to be three commits. I will apply it soon.</body>
      <body-html>&lt;div&gt;&lt;p&gt;It's ok to be three commits. I will apply it soon.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-29T18:26:09+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>database index migration mysql patch remove_index verified</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-29T18:26:20+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">18</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>(from [21957b72ea394c679d9b17e75b570cc99596322d]) Test that adding an index also doesn't raise an exception.

[#4809 state:resolved]

Signed-off-by: Jos&#233; Valim &lt;jose.valim@gmail.com&gt;
http://github.com/rails/rails/commit/21957b72ea394c679d9b17e75b570cc99596322d</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/21957b72ea394c679d9b17e75b570cc99596322d&quot;
title=
&quot;Changeset [21957b72ea394c679d9b17e75b570cc99596322d]&quot;&gt;[21957b72ea394c679d9b17e75b570cc99596322d]&lt;/a&gt;)
Test that adding an index also doesn't raise an exception.&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;/projects/8994/tickets/4809&quot; title=
&quot;Ticket #4809&quot;&gt;#4809&lt;/a&gt; state:resolved]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jos&amp;eacute; Valim &lt;a href=
&quot;mailto:jose.valim@gmail.com&quot;&gt;jose.valim@gmail.com&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/21957b72ea394c679d9b17e75b570cc99596322d&quot;&gt;
http://github.com/rails/rails/commit/21957b72ea394c679d9b17e75b570c...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-06-29T20:19:36+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>database index migration mysql patch remove_index verified</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-06-29T20:19:44+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">19</version>
      <user-name>Repository</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/31647)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/31647&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-10-15T23:01:55+01:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 27004
</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>database index migration mysql patch remove_index verified</tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-10-15T23:01:55+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">20</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Automatic cleanup of spam.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Automatic cleanup of spam.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-11-08T01:52:14+00:00</created-at>
      <creator-id type="integer">12926</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: database index migration mysql patch remove_index verified
</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">4809</number>
      <permalink>table-name-not-escaped-on-dropping-index</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>[PATCH] Table name not escaped on dropping index</title>
      <updated-at type="datetime">2010-11-08T01:52:18+00:00</updated-at>
      <user-id type="integer">14998</user-id>
      <version type="integer">22</version>
      <user-name>Ryan Bigg</user-name>
      <creator-name>J. Pablo Fernandez</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4809</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name>Low</priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>a10e0a5b50999c9f715b09d427b7c95ed61d3685</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-06-12T02:37:44+01:00</created-at>
      <filename>remove_index_from_values.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">556980</id>
      <size type="integer">2125</size>
      <uploader-id type="integer">12926</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/556980/remove_index_from_values.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>790487d1af806ec362a1fca1c6bed9323ceadcd9</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-06-12T04:05:46+01:00</created-at>
      <filename>4809-remove_index_not_escaped.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">556989</id>
      <size type="integer">3124</size>
      <uploader-id type="integer">10193</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/556989/4809-remove_index_not_escaped.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>9f1e9ce85be6f7fc9cc566d409bb58bbc9750851</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-06-15T22:39:35+01:00</created-at>
      <filename>remove_index_from_values.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">560752</id>
      <size type="integer">4085</size>
      <uploader-id type="integer">12926</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/560752/remove_index_from_values.patch</url>
    </attachment>
  </attachments>
</ticket>
