<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">3</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-08-10T00:05:00+01:00</created-at>
  <creator-id type="integer">65576</creator-id>
  <milestone-due-on type="datetime">2009-08-31T00:00:00+01:00</milestone-due-on>
  <milestone-id type="integer">41987</milestone-id>
  <number type="integer">3028</number>
  <permalink>activesupportmultibytechars</permalink>
  <priority type="integer">16</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>2-3-stable 2.3.x 3 3.0 multibyte</tag>
  <title>ActiveSupport::Multibyte::Chars</title>
  <updated-at type="datetime">2010-10-16T23:44:09+01:00</updated-at>
  <user-id type="integer">81551</user-id>
  <version type="integer">19</version>
  <user-name>Andrea Campi</user-name>
  <creator-name>Steve St. Martin</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
  <milestone-title>2.3.4</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>ActiveSupport::Multibyte::Chars does not support rindex() , this creates a bug in truncate when using multibyte strings and options[:seperator]

completion of ticket #2582 depends on this, also causes breakage in 3.0 implementation.</original-body>
  <latest-body>ActiveSupport::Multibyte::Chars does not support rindex() , this creates a bug in truncate when using multibyte strings and options[:seperator]

completion of ticket #2582 depends on this, also causes breakage in 3.0 implementation.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;ActiveSupport::Multibyte::Chars does not support rindex() , this
creates a bug in truncate when using multibyte strings and
options[:seperator]&lt;/p&gt;
&lt;p&gt;completion of ticket &lt;a href=&quot;/projects/8994/tickets/2582&quot; title=&quot;Ticket #2582&quot;&gt;#2582&lt;/a&gt; depends on this, also causes
breakage in 3.0 implementation.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>ActiveSupport::Multibyte::Chars does not support rindex() , this creates a bug in truncate when using multibyte strings and options[:seperator]

completion of ticket #2582 depends on this, also causes breakage in 3.0 implementation.</body>
      <body-html>&lt;div&gt;&lt;p&gt;ActiveSupport::Multibyte::Chars does not support rindex() , this
creates a bug in truncate when using multibyte strings and
options[:seperator]&lt;/p&gt;
&lt;p&gt;completion of ticket &lt;a href=&quot;/projects/8994/tickets/2582&quot;
title=&quot;Ticket #2582&quot;&gt;#2582&lt;/a&gt; depends on this, also causes
breakage in 3.0 implementation.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-10T00:05:00+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2 2.3.x 3 3.0 bugmash multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2009-08-10T00:05:02+01:00</updated-at>
      <user-id type="integer">65576</user-id>
      <version type="integer">1</version>
      <user-name>Steve St. Martin</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Verified, test and patch forthcoming.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Verified, test and patch forthcoming.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-10T02:38:21+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2 2.3.x 3 3.0 bugmash multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2009-08-10T02:38:27+01:00</updated-at>
      <user-id type="integer">23560</user-id>
      <version type="integer">2</version>
      <user-name>Erik Ostrom</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I've attached a patch (including a test).</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've attached a patch (including a test).&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-10T02:45:49+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2 2.3.x 3 3.0 bugmash multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2009-08-10T02:45:52+01:00</updated-at>
      <user-id type="integer">23560</user-id>
      <version type="integer">3</version>
      <user-name>Erik Ostrom</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Good catch. Could you use `git format-patch` instead of diff?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Good catch. Could you use &lt;code&gt;git format-patch&lt;/code&gt; instead
of diff?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-10T02:54:06+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
:milestone: 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">41987</milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2 2.3.x 3 3.0 bugmash multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2009-08-10T02:54:09+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">4</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title>2.3.4</milestone-title>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>&quot;Patch does not have a valid email address&quot;, attached a working patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;&quot;Patch does not have a valid email address&quot;, attached a working
patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-10T02:59:45+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 85
</diffable-attributes>
      <milestone-id type="integer">41987</milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2 2.3.x 3 3.0 bugmash multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2009-08-10T02:59:50+01:00</updated-at>
      <user-id type="integer">10379</user-id>
      <version type="integer">5</version>
      <user-name>Elad Meidar</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title>2.3.4</milestone-title>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Patch applies to master, tests pass as well.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Patch applies to master, tests pass as well.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-10T03:01:04+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">41987</milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2 2.3.x 3 3.0 bugmash multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2009-08-10T03:01:06+01:00</updated-at>
      <user-id type="integer">10379</user-id>
      <version type="integer">6</version>
      <user-name>Elad Meidar</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title>2.3.4</milestone-title>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I've attached a patch again, format-patch style.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've attached a patch again, format-patch style.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-10T03:01:48+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">41987</milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2 2.3.x 3 3.0 bugmash multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2009-08-10T03:01:49+01:00</updated-at>
      <user-id type="integer">23560</user-id>
      <version type="integer">7</version>
      <user-name>Erik Ostrom</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title>2.3.4</milestone-title>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>On Ruby 1.9:

&lt;pre&gt;
  1) Failure:
test_rindex_should_return_character_offset(MultibyteCharsUTF8BehaviourTest) [test/multibyte_chars_test.rb:241]:
12 expected but was
13.
&lt;/pre&gt;</body>
      <body-html>&lt;div&gt;&lt;p&gt;On Ruby 1.9:&lt;/p&gt;
&lt;pre&gt;
  1) Failure:
test_rindex_should_return_character_offset(MultibyteCharsUTF8BehaviourTest) [test/multibyte_chars_test.rb:241]:
12 expected but was
13.
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-10T03:07:27+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">41987</milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2 2.3.x 3 3.0 bugmash multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2009-08-10T03:07:32+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">8</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title>2.3.4</milestone-title>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Applied to master (prematurely): 4dda9b644df5e4386f693a4b7bd00fe787f41a28

Need to be compat with 1.9 before 2-3-stable backport.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Applied to master (prematurely):
4dda9b644df5e4386f693a4b7bd00fe787f41a28&lt;/p&gt;
&lt;p&gt;Need to be compat with 1.9 before 2-3-stable backport.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-10T03:37:55+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer">41987</milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>2 2.3.x 3 3.0 bugmash multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2009-08-10T03:37:57+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">9</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title>2.3.4</milestone-title>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>i was having a problem with the functionality using RTL languages as values, since rindex always scans left to right, strings were truncated in the wrong way.</body>
      <body-html>&lt;div&gt;&lt;p&gt;i was having a problem with the functionality using RTL
languages as values, since rindex always scans left to right,
strings were truncated in the wrong way.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-10T03:58:45+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 85
</diffable-attributes>
      <milestone-id type="integer">41987</milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>2 2.3.x 3 3.0 bugmash multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2009-08-10T03:58:50+01:00</updated-at>
      <user-id type="integer">10379</user-id>
      <version type="integer">10</version>
      <user-name>Elad Meidar</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title>2.3.4</milestone-title>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-10T04:19:54+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">41987</milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>2 2.3.x 3 3.0 bugmash multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2009-08-10T04:19:59+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">11</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title>2.3.4</milestone-title>
      <priority-name nil="true"></priority-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Ruby 1.9 helpfully points out that my test is wrong - which means my implementation is, too. Developing...</body>
      <body-html>&lt;div&gt;&lt;p&gt;Ruby 1.9 helpfully points out that my test is wrong - which
means my implementation is, too. Developing...&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-10T04:54:20+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 85
</diffable-attributes>
      <milestone-id type="integer">41987</milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>2 2.3.x 3 3.0 bugmash multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2009-08-10T04:54:23+01:00</updated-at>
      <user-id type="integer">23560</user-id>
      <version type="integer">12</version>
      <user-name>Erik Ostrom</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title>2.3.4</milestone-title>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I've attached a patch to be applied after my earlier one. The test is fixed so it passes on Ruby 1.9, and the implementation is fixed so it passes the fixed test. The offset parameter wasn't being translated into bytes before calling the underlying string method.

#index had an equivalent bug, which went unnoticed because the test cases all used the default offset, and a 0-character offset translates to 0 bytes. I added some offset tests and fixed the bug in #index.

I also threw in a couple of negative-offset tests, inspired by #2428, of which this ticket is a duplicate. (Andy Stewart's patch from that one no longer applies cleanly to master, but I wish I'd noticed it earlier.)

These tests passed (for me) on Ruby 1.9.2 Preview 1 and Ruby 1.8.6.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've attached a patch to be applied after my earlier one. The
test is fixed so it passes on Ruby 1.9, and the implementation is
fixed so it passes the fixed test. The offset parameter wasn't
being translated into bytes before calling the underlying string
method.&lt;/p&gt;
&lt;h1&gt;index had an equivalent bug, which went unnoticed because the
test cases all used the default offset, and a 0-character offset
translates to 0 bytes. I added some offset tests and fixed the bug
in #index.&lt;/h1&gt;
&lt;p&gt;I also threw in a couple of negative-offset tests, inspired by
&lt;a href=&quot;/projects/8994/tickets/2428&quot; title=
&quot;Ticket #2428&quot;&gt;#2428&lt;/a&gt;, of which this ticket is a duplicate.
(Andy Stewart's patch from that one no longer applies cleanly to
master, but I wish I'd noticed it earlier.)&lt;/p&gt;
&lt;p&gt;These tests passed (for me) on Ruby 1.9.2 Preview 1 and Ruby
1.8.6.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-10T07:19:08+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">41987</milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>2 2.3.x 3 3.0 bugmash multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2009-08-10T07:19:11+01:00</updated-at>
      <user-id type="integer">23560</user-id>
      <version type="integer">13</version>
      <user-name>Erik Ostrom</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title>2.3.4</milestone-title>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>(from [7d16e94d827197d030fdd611db4310396aeb0114]) Correctly handle offsets in Multibyte::Chars#index and #rindex.

The offset in codepoints was being passed directly to the wrapped string's index/rindex method. Now we translate the offset into bytes first.

[#3028 state:committed]

Signed-off-by: Jeremy Kemper &lt;jeremy@bitsweat.net&gt;
http://github.com/rails/rails/commit/7d16e94d827197d030fdd611db4310396aeb0114</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/7d16e94d827197d030fdd611db4310396aeb0114&quot;
title=
&quot;Changeset [7d16e94d827197d030fdd611db4310396aeb0114]&quot;&gt;[7d16e94d827197d030fdd611db4310396aeb0114]&lt;/a&gt;)
Correctly handle offsets in Multibyte::Chars#index and #rindex.&lt;/p&gt;
&lt;p&gt;The offset in codepoints was being passed directly to the
wrapped string's index/rindex method. Now we translate the offset
into bytes first.&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;/projects/8994/tickets/3028&quot; title=
&quot;Ticket #3028&quot;&gt;#3028&lt;/a&gt; state:committed]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jeremy Kemper &lt;a href=
&quot;mailto:jeremy@bitsweat.net&quot;&gt;jeremy@bitsweat.net&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/7d16e94d827197d030fdd611db4310396aeb0114&quot;&gt;
http://github.com/rails/rails/commit/7d16e94d827197d030fdd611db4310...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-10T07:33:26+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- 
:state: incomplete
</diffable-attributes>
      <milestone-id type="integer">41987</milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>2 2.3.x 3 3.0 bugmash multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2009-08-10T07:33:27+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">14</version>
      <user-name>Repository</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title>2.3.4</milestone-title>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>(from [4e014379a3c792281138c5a19a5bd74e9435fede]) Correctly handle offsets in Multibyte::Chars#index and #rindex.

The offset in codepoints was being passed directly to the wrapped string's index/rindex method. Now we translate the offset into bytes first.

[#3028 state:committed]

Signed-off-by: Jeremy Kemper &lt;jeremy@bitsweat.net&gt;
http://github.com/rails/rails/commit/4e014379a3c792281138c5a19a5bd74e9435fede</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/4e014379a3c792281138c5a19a5bd74e9435fede&quot;
title=
&quot;Changeset [4e014379a3c792281138c5a19a5bd74e9435fede]&quot;&gt;[4e014379a3c792281138c5a19a5bd74e9435fede]&lt;/a&gt;)
Correctly handle offsets in Multibyte::Chars#index and #rindex.&lt;/p&gt;
&lt;p&gt;The offset in codepoints was being passed directly to the
wrapped string's index/rindex method. Now we translate the offset
into bytes first.&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;/projects/8994/tickets/3028&quot; title=
&quot;Ticket #3028&quot;&gt;#3028&lt;/a&gt; state:committed]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jeremy Kemper &lt;a href=
&quot;mailto:jeremy@bitsweat.net&quot;&gt;jeremy@bitsweat.net&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/4e014379a3c792281138c5a19a5bd74e9435fede&quot;&gt;
http://github.com/rails/rails/commit/4e014379a3c792281138c5a19a5bd7...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-10T07:33:26+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">41987</milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>2 2.3.x 3 3.0 bugmash multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2009-08-10T07:33:27+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">15</version>
      <user-name>Repository</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title>2.3.4</milestone-title>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-10T07:34:01+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 2 2.3.x 3 3.0 bugmash multibyte
</diffable-attributes>
      <milestone-id type="integer">41987</milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>2 2.3.x 3 3.0 multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2009-08-10T07:34:04+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">16</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title>2.3.4</milestone-title>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-01-20T11:54:38+00:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- 
:state: committed
</diffable-attributes>
      <milestone-id type="integer">41987</milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>2 2.3.x 3 3.0 multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2010-01-20T11:54:39+00:00</updated-at>
      <user-id type="integer">65556</user-id>
      <version type="integer">17</version>
      <user-name>Rizwan Reza</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title>2.3.4</milestone-title>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Rizwan, committed == resolved.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Rizwan, committed == resolved.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-01-21T02:04:39+00:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">41987</milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>2 2.3.x 3 3.0 multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2010-01-21T02:04:43+00:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">18</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title>2.3.4</milestone-title>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-10-16T23:44:06+01:00</created-at>
      <creator-id type="integer">65576</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
:tag: 2 2.3.x 3 3.0 multibyte
</diffable-attributes>
      <milestone-id type="integer">41987</milestone-id>
      <number type="integer">3028</number>
      <permalink>activesupportmultibytechars</permalink>
      <priority type="integer">16</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>2-3-stable 2.3.x 3 3.0 multibyte</tag>
      <title>ActiveSupport::Multibyte::Chars</title>
      <updated-at type="datetime">2010-10-16T23:44:09+01:00</updated-at>
      <user-id type="integer">81551</user-id>
      <version type="integer">19</version>
      <user-name>Andrea Campi</user-name>
      <creator-name>Steve St. Martin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3028</url>
      <milestone-title>2.3.4</milestone-title>
      <priority-name nil="true"></priority-name>
      <assigned-user-name nil="true"></assigned-user-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>320fcc211ae8bbb702e349ee8dd0557904308524</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-08-10T02:59:45+01:00</created-at>
      <filename>3028_working_patch_for_2-3-stable.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">239498</id>
      <size type="integer">2259</size>
      <uploader-id type="integer">10379</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/239498/3028_working_patch_for_2-3-stable.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>9d0482c4510c9b1b23c28d2029ced73dc9bc39af</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-08-10T03:01:48+01:00</created-at>
      <filename>0001-Add-rindex-to-ActiveSupport-Multibyte-Chars.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">239501</id>
      <size type="integer">2263</size>
      <uploader-id type="integer">23560</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/239501/0001-Add-rindex-to-ActiveSupport-Multibyte-Chars.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>e284d9c310e1c17e0cf8289f04204c9044303907</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-08-10T07:19:08+01:00</created-at>
      <filename>0002-Correctly-handle-offsets-in-Multibyte-Chars-index-a.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">239589</id>
      <size type="integer">3093</size>
      <uploader-id type="integer">23560</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/239589/0002-Correctly-handle-offsets-in-Multibyte-Chars-index-a.patch</url>
    </attachment>
  </attachments>
</ticket>
