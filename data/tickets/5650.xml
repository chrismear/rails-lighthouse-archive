<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">19965</assigned-user-id>
  <attachments-count type="integer">3</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2010-10-02T10:55:27+01:00</created-at>
  <creator-id type="integer">116398</creator-id>
  <milestone-due-on type="datetime">2010-11-15T00:00:00+00:00</milestone-due-on>
  <milestone-id type="integer">88038</milestone-id>
  <number type="integer">5650</number>
  <permalink>callbacks-execution-order-reversed-in-after_</permalink>
  <priority type="integer">1</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>patch</tag>
  <title>callbacks execution order reversed in after_*</title>
  <updated-at type="datetime">2010-10-16T02:28:39+01:00</updated-at>
  <user-id type="integer">14998</user-id>
  <version type="integer">27</version>
  <user-name>Ryan Bigg</user-name>
  <creator-name>Pietro</creator-name>
  <assigned-user-name>Jos&#233; Valim</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
  <milestone-title>3.0.2</milestone-title>
  <priority-name>High</priority-name>
  <original-body>In rails 3.0.0 the callbacks &quot;after_*&quot; executes
the methods in reverse order.

If in a model you have

before_save :aa, :bb
after_save :aa, :bb

def aa; puts &quot;a&quot;; end
def bb; puts &quot;b&quot;; end

saving the object you get

a
b
b
a

In rails 2.x the result was

a
b
a
b</original-body>
  <latest-body>In rails 3.0.0 the callbacks &quot;after_*&quot; executes
the methods in reverse order.

If in a model you have

before_save :aa, :bb
after_save :aa, :bb

def aa; puts &quot;a&quot;; end
def bb; puts &quot;b&quot;; end

saving the object you get

a
b
b
a

In rails 2.x the result was

a
b
a
b</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;In rails 3.0.0 the callbacks &quot;after_*&quot; executes&lt;br&gt;
the methods in reverse order.&lt;/p&gt;
&lt;p&gt;If in a model you have&lt;/p&gt;
&lt;p&gt;before_save :aa, :bb&lt;br&gt;
after_save :aa, :bb&lt;/p&gt;
&lt;p&gt;def aa; puts &quot;a&quot;; end&lt;br&gt;
def bb; puts &quot;b&quot;; end&lt;/p&gt;
&lt;p&gt;saving the object you get&lt;/p&gt;
&lt;p&gt;a&lt;br&gt;
b&lt;br&gt;
b&lt;br&gt;
a&lt;/p&gt;
&lt;p&gt;In rails 2.x the result was&lt;/p&gt;
&lt;p&gt;a&lt;br&gt;
b&lt;br&gt;
a&lt;br&gt;
b&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>In rails 3.0.0 the callbacks &quot;after_*&quot; executes
the methods in reverse order.

If in a model you have

before_save :aa, :bb
after_save :aa, :bb

def aa; puts &quot;a&quot;; end
def bb; puts &quot;b&quot;; end

saving the object you get

a
b
b
a

In rails 2.x the result was

a
b
a
b</body>
      <body-html>&lt;div&gt;&lt;p&gt;In rails 3.0.0 the callbacks &quot;after_*&quot; executes&lt;br&gt;
the methods in reverse order.&lt;/p&gt;
&lt;p&gt;If in a model you have&lt;/p&gt;
&lt;p&gt;before_save :aa, :bb&lt;br&gt;
after_save :aa, :bb&lt;/p&gt;
&lt;p&gt;def aa; puts &quot;a&quot;; end&lt;br&gt;
def bb; puts &quot;b&quot;; end&lt;/p&gt;
&lt;p&gt;saving the object you get&lt;/p&gt;
&lt;p&gt;a&lt;br&gt;
b&lt;br&gt;
b&lt;br&gt;
a&lt;/p&gt;
&lt;p&gt;In rails 2.x the result was&lt;/p&gt;
&lt;p&gt;a&lt;br&gt;
b&lt;br&gt;
a&lt;br&gt;
b&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-18T00:30:40+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-18T00:30:41+01:00</updated-at>
      <user-id type="integer">116398</user-id>
      <version type="integer">1</version>
      <user-name>Pietro</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Confirmed on master. The after_ callback order get reversed:

@@@
class User &lt; ActiveRecord::Base
  before_save :aa, :bb, :cc
  after_save :aa, :bb, :cc

  def aa; puts &quot;a&quot;; end
  def bb; puts &quot;b&quot;; end
  def cc; puts &quot;c&quot;; end
end
@@@

@@@
&gt;&gt; User.create!
a
b
c
c
b
a
=&gt; #&lt;User id: 1, created_at: &quot;2010-09-19 12:57:03&quot;, updated_at: &quot;2010-09-19 12:57:03&quot;&gt;
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;Confirmed on master. The after_ callback order get reversed:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;class User &amp;lt; ActiveRecord::Base
  before_save :aa, :bb, :cc
  after_save :aa, :bb, :cc

  def aa; puts &quot;a&quot;; end
  def bb; puts &quot;b&quot;; end
  def cc; puts &quot;c&quot;; end
end&lt;/code&gt;
&lt;/pre&gt;
&lt;pre&gt;
&lt;code&gt;&amp;gt;&amp;gt; User.create!
a
b
c
c
b
a
=&amp;gt; #&amp;lt;User id: 1, created_at: &quot;2010-09-19 12:57:03&quot;, updated_at: &quot;2010-09-19 12:57:03&quot;&amp;gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-19T13:58:05+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-19T13:58:07+01:00</updated-at>
      <user-id type="integer">94458</user-id>
      <version type="integer">2</version>
      <user-name>Jeff Kreeftmeijer</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40263</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Looking into it.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Looking into it.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-19T15:38:24+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-19T15:38:25+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">3</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Neeraj Singh</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40263</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>In activesupport-3.0.0/lib/active_support/callbacks.rb
there is only one &quot;reverse&quot; (method &quot;compile&quot; in class &quot;CallbackChain&quot;)

changing 
&lt;code&gt;
reverse_each do |callback|
&lt;/code&gt;
in 
&lt;code&gt;
each do |callback|
&lt;/code&gt;
the order in after_* seems to be preserved.

Have no idea why it was reverse_each in the first
place.</body>
      <body-html>&lt;div&gt;&lt;p&gt;In activesupport-3.0.0/lib/active_support/callbacks.rb&lt;br&gt;
there is only one &quot;reverse&quot; (method &quot;compile&quot; in class
&quot;CallbackChain&quot;)&lt;/p&gt;
&lt;p&gt;changing&lt;br&gt;
&lt;code&gt;&lt;br&gt;
reverse_each do |callback|&lt;br&gt;&lt;/code&gt;&lt;br&gt;
in&lt;br&gt;
&lt;code&gt;&lt;br&gt;
each do |callback|&lt;br&gt;&lt;/code&gt;&lt;br&gt;
the order in after_* seems to be preserved.&lt;/p&gt;
&lt;p&gt;Have no idea why it was reverse_each in the first&lt;br&gt;
place.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-19T18:49:09+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-19T18:49:10+01:00</updated-at>
      <user-id type="integer">116398</user-id>
      <version type="integer">4</version>
      <user-name>Pietro</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Neeraj Singh</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40263</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>@Pietro

Now that you have the fix could you please attach a patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;@Pietro&lt;/p&gt;
&lt;p&gt;Now that you have the fix could you please attach a patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-19T18:58:44+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-19T18:58:48+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">5</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Neeraj Singh</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40263</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>@Neeraj

Here is the patch.

I'll try to find in git history when the reverse_each 
first appeared.</body>
      <body-html>&lt;div&gt;&lt;p&gt;@Neeraj&lt;/p&gt;
&lt;p&gt;Here is the patch.&lt;/p&gt;
&lt;p&gt;I'll try to find in git history when the reverse_each&lt;br&gt;
first appeared.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-19T19:36:53+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-19T19:36:55+01:00</updated-at>
      <user-id type="integer">116398</user-id>
      <version type="integer">6</version>
      <user-name>Pietro</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Neeraj Singh</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40263</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>@Pietro Can you add a test please? Thanks.</body>
      <body-html>&lt;div&gt;&lt;p&gt;@Pietro Can you add a test please? Thanks.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-19T19:38:33+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-19T19:38:34+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">7</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Neeraj Singh</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40263</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I think the code came from 

commit 21e7b8462113fc7c0fd1882dcc2bf7225de67b1a
Author: Joshua Peek 
Date:   Mon Oct 12 22:15:43 2009 -0500

Callbacks, DeprecatedCallbacks = NewCallbacks, Callbacks

Maybe Joshua can help since I have no experience
in testing activesuport :-)
I'll take a look to activesupport/test/callbacks_test.rb 
for inspiration...</body>
      <body-html>&lt;div&gt;&lt;p&gt;I think the code came from&lt;/p&gt;
&lt;p&gt;commit 21e7b8462113fc7c0fd1882dcc2bf7225de67b1a&lt;br&gt;
Author: Joshua Peek&lt;br&gt;
Date: Mon Oct 12 22:15:43 2009 -0500&lt;/p&gt;
&lt;p&gt;Callbacks, DeprecatedCallbacks = NewCallbacks, Callbacks&lt;/p&gt;
&lt;p&gt;Maybe Joshua can help since I have no experience&lt;br&gt;
in testing activesuport :-)&lt;br&gt;
I'll take a look to activesupport/test/callbacks_test.rb&lt;br&gt;
for inspiration...&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-19T19:59:35+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-19T19:59:39+01:00</updated-at>
      <user-id type="integer">116398</user-id>
      <version type="integer">8</version>
      <user-name>Pietro</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Neeraj Singh</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40263</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>In commit http://github.com/rails/rails/commit/21e7b8462113fc7c0fd1882dcc2bf7225de67b1a Johsua is refactoring the code. That commit  did not introduce reverse_each .

@Pietro your patch is breaking a number of tests. If you look at ActiveSupport tests it seems the author intended after_* callbacks to be in reverse order.

I will ping someone from core team to have their input.</body>
      <body-html>&lt;div&gt;&lt;p&gt;In commit &lt;a href=
&quot;http://github.com/rails/rails/commit/21e7b8462113fc7c0fd1882dcc2bf7225de67b1a&quot;&gt;
http://github.com/rails/rails/commit/21e7b8462113fc7c0fd1882dcc2bf7...&lt;/a&gt;
Johsua is refactoring the code. That commit did not introduce
reverse_each .&lt;/p&gt;
&lt;p&gt;@Pietro your patch is breaking a number of tests. If you look at
ActiveSupport tests it seems the author intended after_* callbacks
to be in reverse order.&lt;/p&gt;
&lt;p&gt;I will ping someone from core team to have their input.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-20T01:40:11+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-20T01:40:14+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">9</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Neeraj Singh</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Assigning it to Mr. Valim to get his input.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Assigning it to Mr. Valim to get his input.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-20T01:41:47+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 40263
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-20T01:41:50+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">10</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>The problem is this option forcing callbacks to be prepended:

http://github.com/rails/rails/blob/master/activemodel/lib/active_model/callbacks.rb#L130

Removing this line should fix it. :)</body>
      <body-html>&lt;div&gt;&lt;p&gt;The problem is this option forcing callbacks to be
prepended:&lt;/p&gt;
&lt;p&gt;&lt;a href=
&quot;http://github.com/rails/rails/blob/master/activemodel/lib/active_model/callbacks.rb#L130&quot;&gt;
http://github.com/rails/rails/blob/master/activemodel/lib/active_mo...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Removing this line should fix it. :)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-24T11:37:19+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
:priority: 3
:milestone: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-24T11:37:23+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">11</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Actually, I was wrong. Because of the reverse_each, we need that prepend line. I will investigate deeper.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Actually, I was wrong. Because of the reverse_each, we need that
prepend line. I will investigate deeper.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-25T10:09:40+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-25T10:09:46+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">12</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Btw, changing reverse_each is not the solution, as it will break controller callbacks.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Btw, changing reverse_each is not the solution, as it will break
controller callbacks.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-25T10:10:16+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-25T10:10:22+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">13</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Here is the fix:

http://github.com/rails/rails/blob/master/activesupport/lib/active_support/callbacks.rb#L485

It should actually be:

    options[:prepend] ? chain.unshift(*(mapped.reverse)) : chain.push(*mapped)

So when reverse_each is called the order is properly kept.

Anyone in mood for a patch with tests?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Here is the fix:&lt;/p&gt;
&lt;p&gt;&lt;a href=
&quot;http://github.com/rails/rails/blob/master/activesupport/lib/active_support/callbacks.rb#L485&quot;&gt;
http://github.com/rails/rails/blob/master/activesupport/lib/active_...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;It should actually be:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;options[:prepend] ? chain.unshift(*(mapped.reverse)) : chain.push(*mapped)&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;So when reverse_each is called the order is properly kept.&lt;/p&gt;
&lt;p&gt;Anyone in mood for a patch with tests?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-25T10:12:50+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-25T10:12:54+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">14</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Jos&#233; Valim: That did not fix it.

I have a failing test. And it is still failing :-( 

I will look into it more in the evening.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Jos&amp;eacute; Valim: That did not fix it.&lt;/p&gt;
&lt;p&gt;I have a failing test. And it is still failing :-(&lt;/p&gt;
&lt;p&gt;I will look into it more in the evening.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-25T17:07:38+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-25T17:07:40+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">15</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Neeraj, can you attach the failing test here? This way I can debug as well!</body>
      <body-html>&lt;div&gt;&lt;p&gt;Neeraj, can you attach the failing test here? This way I can
debug as well!&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-25T17:08:49+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-25T17:08:52+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">16</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-25T17:12:19+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-25T17:12:21+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">17</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Neeraj, by default, after callbacks in AS::Callbacks are executed like in controller: the ones added first are executed later. We can change this by passing :prepend as option to set_callback, as here:

http://github.com/rails/rails/blob/master/activemodel/lib/active_model/callbacks.rb#L130

The test case you added is in AS::Callbacks, which does not set prepend and therefore behaves as controllers. I believe that if you move the test case you added to ActiveModel::Callbacks, it will probably pass!</body>
      <body-html>&lt;div&gt;&lt;p&gt;Neeraj, by default, after callbacks in AS::Callbacks are
executed like in controller: the ones added first are executed
later. We can change this by passing :prepend as option to
set_callback, as here:&lt;/p&gt;
&lt;p&gt;&lt;a href=
&quot;http://github.com/rails/rails/blob/master/activemodel/lib/active_model/callbacks.rb#L130&quot;&gt;
http://github.com/rails/rails/blob/master/activemodel/lib/active_mo...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The test case you added is in AS::Callbacks, which does not set
prepend and therefore behaves as controllers. I believe that if you
move the test case you added to ActiveModel::Callbacks, it will
probably pass!&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-25T17:17:29+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-25T17:17:31+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">18</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I can try that in the evening.

However that raises the question of after_save behaving differently in controller and model. Is this inconsistency really desired?</body>
      <body-html>&lt;div&gt;&lt;p&gt;I can try that in the evening.&lt;/p&gt;
&lt;p&gt;However that raises the question of after_save behaving
differently in controller and model. Is this inconsistency really
desired?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-25T17:19:24+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-25T17:19:26+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">19</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Unfortunately this inconsistency exists since early versions of Rails. Notice that ActiveRecord in Rails 3 behaves exactly as in ActiveRecord in 2.3, the only exception is when you pass more than one parameter to after_save.

So this currently works as in Rails 2.3:

    after_save :aa
    after_save :bb
    after_save :cc

The only case which is broken (the one discussed in this ticket) is:

    after_save :aa, :bb, :cc</body>
      <body-html>&lt;div&gt;&lt;p&gt;Unfortunately this inconsistency exists since early versions of
Rails. Notice that ActiveRecord in Rails 3 behaves exactly as in
ActiveRecord in 2.3, the only exception is when you pass more than
one parameter to after_save.&lt;/p&gt;
&lt;p&gt;So this currently works as in Rails 2.3:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;after_save :aa
after_save :bb
after_save :cc&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;The only case which is broken (the one discussed in this ticket)
is:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;after_save :aa, :bb, :cc&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-25T17:31:30+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-25T17:31:34+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">20</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Attached is patch with test. All the hard work for this patch was done by Mr. Valim</body>
      <body-html>&lt;div&gt;&lt;p&gt;Attached is patch with test. All the hard work for this patch
was done by Mr. Valim&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-25T23:39:12+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>patched</tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-25T23:39:14+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">21</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>(from [72c1e19c33ca06008d5d64619a533bdf34e3fc2b]) after_create in ActiveModel should in the order specified

[#5650 state:resolved]

Signed-off-by: Jos&#233; Valim &lt;jose.valim@gmail.com&gt;
http://github.com/rails/rails/commit/72c1e19c33ca06008d5d64619a533bdf34e3fc2b</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/72c1e19c33ca06008d5d64619a533bdf34e3fc2b&quot;
title=
&quot;Changeset [72c1e19c33ca06008d5d64619a533bdf34e3fc2b]&quot;&gt;[72c1e19c33ca06008d5d64619a533bdf34e3fc2b]&lt;/a&gt;)
after_create in ActiveModel should in the order specified&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;/projects/8994/tickets/5650&quot; title=
&quot;Ticket #5650&quot;&gt;#5650&lt;/a&gt; state:resolved]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jos&amp;eacute; Valim &lt;a&gt;jose.valim@gmail.com&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/72c1e19c33ca06008d5d64619a533bdf34e3fc2b&quot;&gt;
http://github.com/rails/rails/commit/72c1e19c33ca06008d5d64619a533b...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-09-27T22:12:38+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>patched</tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-27T22:12:41+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">22</version>
      <user-name>Repository</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>(from [9e32b1cbe5fca3965919c7a604ee92426bf2bf5e]) after_create in ActiveModel should in the order specified

[#5650 state:resolved]

Signed-off-by: Jos&#233; Valim &lt;jose.valim@gmail.com&gt;
http://github.com/rails/rails/commit/9e32b1cbe5fca3965919c7a604ee92426bf2bf5e</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/9e32b1cbe5fca3965919c7a604ee92426bf2bf5e&quot;
title=
&quot;Changeset [9e32b1cbe5fca3965919c7a604ee92426bf2bf5e]&quot;&gt;[9e32b1cbe5fca3965919c7a604ee92426bf2bf5e]&lt;/a&gt;)
after_create in ActiveModel should in the order specified&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;/projects/8994/tickets/5650&quot; title=
&quot;Ticket #5650&quot;&gt;#5650&lt;/a&gt; state:resolved]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jos&amp;eacute; Valim &lt;a href=
&quot;mailto:jose.valim@gmail.com&quot;&gt;jose.valim@gmail.com&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/9e32b1cbe5fca3965919c7a604ee92426bf2bf5e&quot;&gt;
http://github.com/rails/rails/commit/9e32b1cbe5fca3965919c7a604ee92...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-09-27T22:22:45+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>patched</tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-09-27T22:22:47+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">23</version>
      <user-name>Repository</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>bulk tags cleanup</body>
      <body-html>&lt;div&gt;&lt;p&gt;bulk tags cleanup&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-10-11T07:23:14+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: patched
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>patch</tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-10-11T07:23:17+01:00</updated-at>
      <user-id type="integer">81551</user-id>
      <version type="integer">24</version>
      <user-name>Andrea Campi</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/31647)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/31647&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-10-15T23:02:03+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 82861
</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>patch</tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-10-15T23:02:03+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">25</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Automatic cleanup of spam.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Automatic cleanup of spam.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-10-16T02:28:34+01:00</created-at>
      <creator-id type="integer">116398</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: patch &quot;sheepskin boots&quot;
</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">5650</number>
      <permalink>callbacks-execution-order-reversed-in-after_</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>patch</tag>
      <title>callbacks execution order reversed in after_*</title>
      <updated-at type="datetime">2010-10-16T02:28:39+01:00</updated-at>
      <user-id type="integer">14998</user-id>
      <version type="integer">27</version>
      <user-name>Ryan Bigg</user-name>
      <creator-name>Pietro</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5650</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name>High</priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>43f65056a5bc4c7e3137940b44e2ba3662d02ee0</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-09-19T19:36:53+01:00</created-at>
      <filename>fix_callbacks_order.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">680282</id>
      <size type="integer">789</size>
      <uploader-id type="integer">116398</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/680282/fix_callbacks_order.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>1070df9b4486e82448f2a57a6823ecf32b51a5ac</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-09-25T17:12:19+01:00</created-at>
      <filename>5650_fix_for_edge.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">690918</id>
      <size type="integer">2078</size>
      <uploader-id type="integer">40263</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/690918/5650_fix_for_edge.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>7ad49b6a29fd9ca95c8c2b3551f9f95fbeb43ba2</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-09-25T23:39:12+01:00</created-at>
      <filename>5650_fix_for_edge.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">691024</id>
      <size type="integer">2246</size>
      <uploader-id type="integer">40263</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/691024/5650_fix_for_edge.diff</url>
    </attachment>
  </attachments>
</ticket>
