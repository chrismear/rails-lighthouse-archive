<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">85</assigned-user-id>
  <attachments-count type="integer">0</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-03-15T18:52:22+00:00</created-at>
  <creator-id type="integer">7315</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">71472</milestone-id>
  <number type="integer">2240</number>
  <permalink>let-users-decide-what-mock-framework-to-use</permalink>
  <priority type="integer">1427</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>invalid</state>
  <tag nil="true"></tag>
  <title>let users decide what mock framework to use</title>
  <updated-at type="datetime">2010-06-22T16:29:58+01:00</updated-at>
  <user-id type="integer">19965</user-id>
  <version type="integer">11</version>
  <user-name>Jos&#233; Valim</user-name>
  <creator-name>David Chelimsky</creator-name>
  <assigned-user-name>Jeremy Kemper</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/2240</url>
  <milestone-title>3.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>I see require 'mocha' in a bunch of the test case base classes. While mocha is an excellent choice (I use it too!), it adds methods to Object that conflict with other mocking frameworks.

What we did with rspec was to to make rspec's mock framework the default, but offer up a simple way to choose any other mock framework you wish to use for a project.

I think rails should offer something similar where mocha is the default, but a developer can say &quot;i want to use RR, or flexmock, or ....&quot;

If you're open to it, I'll be glad to submit a patch. I'm thinking of something like &quot;config.mock_framework = :mocha&quot; in config/test.rb - then you can just change that to whatever.

Of course, the really simple thing would be to just not have those requires in the test case classes to begin with. If you want to use mocha for rails' own test suite, those requires can go in test_helper.rb.</original-body>
  <latest-body>I see require 'mocha' in a bunch of the test case base classes. While mocha is an excellent choice (I use it too!), it adds methods to Object that conflict with other mocking frameworks.

What we did with rspec was to to make rspec's mock framework the default, but offer up a simple way to choose any other mock framework you wish to use for a project.

I think rails should offer something similar where mocha is the default, but a developer can say &quot;i want to use RR, or flexmock, or ....&quot;

If you're open to it, I'll be glad to submit a patch. I'm thinking of something like &quot;config.mock_framework = :mocha&quot; in config/test.rb - then you can just change that to whatever.

Of course, the really simple thing would be to just not have those requires in the test case classes to begin with. If you want to use mocha for rails' own test suite, those requires can go in test_helper.rb.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;I see require 'mocha' in a bunch of the test case base classes.
While mocha is an excellent choice (I use it too!), it adds methods
to Object that conflict with other mocking frameworks.&lt;/p&gt;
&lt;p&gt;What we did with rspec was to to make rspec's mock framework the
default, but offer up a simple way to choose any other mock
framework you wish to use for a project.&lt;/p&gt;
&lt;p&gt;I think rails should offer something similar where mocha is the
default, but a developer can say &quot;i want to use RR, or flexmock, or
....&quot;&lt;/p&gt;
&lt;p&gt;If you're open to it, I'll be glad to submit a patch. I'm
thinking of something like &quot;config.mock_framework = :mocha&quot; in
config/test.rb - then you can just change that to whatever.&lt;/p&gt;
&lt;p&gt;Of course, the really simple thing would be to just not have
those requires in the test case classes to begin with. If you want
to use mocha for rails' own test suite, those requires can go in
test_helper.rb.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I see require 'mocha' in a bunch of the test case base classes. While mocha is an excellent choice (I use it too!), it adds methods to Object that conflict with other mocking frameworks.

What we did with rspec was to to make rspec's mock framework the default, but offer up a simple way to choose any other mock framework you wish to use for a project.

I think rails should offer something similar where mocha is the default, but a developer can say &quot;i want to use RR, or flexmock, or ....&quot;

If you're open to it, I'll be glad to submit a patch. I'm thinking of something like &quot;config.mock_framework = :mocha&quot; in config/test.rb - then you can just change that to whatever.

Of course, the really simple thing would be to just not have those requires in the test case classes to begin with. If you want to use mocha for rails' own test suite, those requires can go in test_helper.rb.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I see require 'mocha' in a bunch of the test case base classes.
While mocha is an excellent choice (I use it too!), it adds methods
to Object that conflict with other mocking frameworks.&lt;/p&gt;
&lt;p&gt;What we did with rspec was to to make rspec's mock framework the
default, but offer up a simple way to choose any other mock
framework you wish to use for a project.&lt;/p&gt;
&lt;p&gt;I think rails should offer something similar where mocha is the
default, but a developer can say &quot;i want to use RR, or flexmock, or
....&quot;&lt;/p&gt;
&lt;p&gt;If you're open to it, I'll be glad to submit a patch. I'm
thinking of something like &quot;config.mock_framework = :mocha&quot; in
config/test.rb - then you can just change that to whatever.&lt;/p&gt;
&lt;p&gt;Of course, the really simple thing would be to just not have
those requires in the test case classes to begin with. If you want
to use mocha for rails' own test suite, those requires can go in
test_helper.rb.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-15T18:52:22+00:00</created-at>
      <creator-id type="integer">7315</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2240</number>
      <permalink>let-users-decide-what-mock-framework-to-use</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>let users decide what mock framework to use</title>
      <updated-at type="datetime">2009-03-15T18:52:25+00:00</updated-at>
      <user-id type="integer">7315</user-id>
      <version type="integer">1</version>
      <user-name>David Chelimsky</user-name>
      <creator-name>David Chelimsky</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2240</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>The best is probably just to not require mocha in any test cases. But Jeremy will probably have more thoughts on this.</body>
      <body-html>&lt;div&gt;&lt;p&gt;The best is probably just to not require mocha in any test
cases. But Jeremy will probably have more thoughts on this.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-15T19:36:36+00:00</created-at>
      <creator-id type="integer">7315</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2240</number>
      <permalink>let-users-decide-what-mock-framework-to-use</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>let users decide what mock framework to use</title>
      <updated-at type="datetime">2009-03-15T19:36:41+00:00</updated-at>
      <user-id type="integer">1366</user-id>
      <version type="integer">2</version>
      <user-name>Pratik</user-name>
      <creator-name>David Chelimsky</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2240</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Jeremy - any thoughts on this?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Jeremy - any thoughts on this?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-09T18:53:43+01:00</created-at>
      <creator-id type="integer">7315</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2240</number>
      <permalink>let-users-decide-what-mock-framework-to-use</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>let users decide what mock framework to use</title>
      <updated-at type="datetime">2009-04-09T18:53:45+01:00</updated-at>
      <user-id type="integer">7315</user-id>
      <version type="integer">3</version>
      <user-name>David Chelimsky</user-name>
      <creator-name>David Chelimsky</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2240</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>That'd be great. There's an older patch to do this that had to be reverted, though.

https://rails.lighthouseapp.com/projects/8994/tickets/403-mocha-is-required-by-setup_and_teardown-rb-in-all-environments-and-modes</body>
      <body-html>&lt;div&gt;&lt;p&gt;That'd be great. There's an older patch to do this that had to
be reverted, though.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://rails.lighthouseapp.com/projects/8994/tickets/403-mocha-is-required-by-setup_and_teardown-rb-in-all-environments-and-modes&quot;&gt;
https://rails.lighthouseapp.com/...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-09T19:12:07+01:00</created-at>
      <creator-id type="integer">7315</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2240</number>
      <permalink>let-users-decide-what-mock-framework-to-use</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>let users decide what mock framework to use</title>
      <updated-at type="datetime">2009-04-09T19:12:13+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">4</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>David Chelimsky</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2240</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Jeremy, that patch seems to be trying to do something more implicit. Are you saying something explicit that supports end-user configuration would be great? Or just something that allows rails own tests to function properly without implicitly requiring mocha for end-users?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Jeremy, that patch seems to be trying to do something more
implicit. Are you saying something explicit that supports end-user
configuration would be great? Or just something that allows rails
own tests to function properly without implicitly requiring mocha
for end-users?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-09T19:16:53+01:00</created-at>
      <creator-id type="integer">7315</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2240</number>
      <permalink>let-users-decide-what-mock-framework-to-use</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>let users decide what mock framework to use</title>
      <updated-at type="datetime">2009-04-09T19:16:56+01:00</updated-at>
      <user-id type="integer">7315</user-id>
      <version type="integer">5</version>
      <user-name>David Chelimsky</user-name>
      <creator-name>David Chelimsky</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2240</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Right. Our fixtures code breaks if Mocha is loaded after ActiveSupport::TestCase because Mocha overwrites #run. A comment in test/test_helper.rb to require 'mocha' (or whatever mocking lib) before require 'test_help' should be enough (no config option needed.)</body>
      <body-html>&lt;div&gt;&lt;p&gt;Right. Our fixtures code breaks if Mocha is loaded after
ActiveSupport::TestCase because Mocha overwrites #run. A comment in
test/test_helper.rb to require 'mocha' (or whatever mocking lib)
before require 'test_help' should be enough (no config option
needed.)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-09T19:36:46+01:00</created-at>
      <creator-id type="integer">7315</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2240</number>
      <permalink>let-users-decide-what-mock-framework-to-use</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>let users decide what mock framework to use</title>
      <updated-at type="datetime">2009-04-09T19:36:49+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">6</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>David Chelimsky</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2240</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Hey Jeremy, I just pulled edge and see 27 failures in actionpack, 3 in actionmailer, 1 in activerecord (running against mysql)

Can you peek at http://gist.github.com/93003 and tell me if anything jumps out at you. I'm hoping there is simply something wrong in my environment that you'll recognize immediately from the particular sets of failures.

I don't want to start working on this until I have 100% passing tests so I know I don't break anything :)

Cheers,
David</body>
      <body-html>&lt;div&gt;&lt;p&gt;Hey Jeremy, I just pulled edge and see 27 failures in
actionpack, 3 in actionmailer, 1 in activerecord (running against
mysql)&lt;/p&gt;
&lt;p&gt;Can you peek at &lt;a href=&quot;http://gist.github.com/93003&quot;&gt;http://gist.github.com/93003&lt;/a&gt; and
tell me if anything jumps out at you. I'm hoping there is simply
something wrong in my environment that you'll recognize immediately
from the particular sets of failures.&lt;/p&gt;
&lt;p&gt;I don't want to start working on this until I have 100% passing
tests so I know I don't break anything :)&lt;/p&gt;
&lt;p&gt;Cheers, David&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-10T09:30:21+01:00</created-at>
      <creator-id type="integer">7315</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2240</number>
      <permalink>let-users-decide-what-mock-framework-to-use</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>let users decide what mock framework to use</title>
      <updated-at type="datetime">2009-04-10T09:30:23+01:00</updated-at>
      <user-id type="integer">7315</user-id>
      <version type="integer">7</version>
      <user-name>David Chelimsky</user-name>
      <creator-name>David Chelimsky</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2240</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I don't think this is an issue any more with Rails 3 because the app developer needs to specify the mocha gem in the Gemfile to use it, so it won't be automatically loaded just because it is present on the file system.

If you agree, let's close this ticket.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I don't think this is an issue any more with Rails 3 because the
app developer needs to specify the mocha gem in the Gemfile to use
it, so it won't be automatically loaded just because it is present
on the file system.&lt;/p&gt;
&lt;p&gt;If you agree, let's close this ticket.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-02T21:02:31+01:00</created-at>
      <creator-id type="integer">7315</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2240</number>
      <permalink>let-users-decide-what-mock-framework-to-use</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>let users decide what mock framework to use</title>
      <updated-at type="datetime">2010-05-02T21:02:33+01:00</updated-at>
      <user-id type="integer">7315</user-id>
      <version type="integer">8</version>
      <user-name>David Chelimsky</user-name>
      <creator-name>David Chelimsky</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2240</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/19097)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/19097&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-04T18:48:42+01:00</created-at>
      <creator-id type="integer">7315</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 9903
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2240</number>
      <permalink>let-users-decide-what-mock-framework-to-use</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>let users decide what mock framework to use</title>
      <updated-at type="datetime">2010-05-04T18:48:42+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">9</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>David Chelimsky</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2240</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>What's the status on this ticket? Any more info?</body>
      <body-html>&lt;div&gt;&lt;p&gt;What's the status on this ticket? Any more info?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-15T10:57:35+01:00</created-at>
      <creator-id type="integer">7315</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2240</number>
      <permalink>let-users-decide-what-mock-framework-to-use</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>let users decide what mock framework to use</title>
      <updated-at type="datetime">2010-06-15T10:57:44+01:00</updated-at>
      <user-id type="integer">89656</user-id>
      <version type="integer">10</version>
      <user-name>Rohit Arondekar</user-name>
      <creator-name>David Chelimsky</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2240</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Let's close this. I will be glad to reopen it if needed.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Let's close this. I will be glad to reopen it if needed.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-06-22T16:29:53+01:00</created-at>
      <creator-id type="integer">7315</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2240</number>
      <permalink>let-users-decide-what-mock-framework-to-use</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag nil="true"></tag>
      <title>let users decide what mock framework to use</title>
      <updated-at type="datetime">2010-06-22T16:29:58+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">11</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>David Chelimsky</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2240</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
</ticket>
