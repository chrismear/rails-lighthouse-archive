From ed5436ea2f149ee9666dac39306e4110060a0dcc Mon Sep 17 00:00:00 2001
From: Miles Egan <milesegan@gmail.com>
Date: Sun, 11 Jul 2010 10:43:41 -0700
Subject: [PATCH] remove size attribute from tag generated by file_field helper [#5084 state:resolved]

---
 actionpack/lib/action_view/helpers/form_helper.rb |    2 +-
 actionpack/test/template/form_helper_test.rb      |    5 +++++
 2 files changed, 6 insertions(+), 1 deletions(-)

diff --git a/actionpack/lib/action_view/helpers/form_helper.rb b/actionpack/lib/action_view/helpers/form_helper.rb
index 6302491..711c455 100644
--- a/actionpack/lib/action_view/helpers/form_helper.rb
+++ b/actionpack/lib/action_view/helpers/form_helper.rb
@@ -676,7 +676,7 @@ module ActionView
       #   # => <input type="file" id="attachment_file" name="attachment[file]" class="file_input" />
       #
       def file_field(object_name, method, options = {})
-        InstanceTag.new(object_name, method, self, options.delete(:object)).to_input_field_tag("file", options)
+        InstanceTag.new(object_name, method, self, options.delete(:object)).to_input_field_tag("file", options.update({:size => nil}))
       end
 
       # Returns a textarea opening and closing tag set tailored for accessing a specified attribute (identified by +method+)
diff --git a/actionpack/test/template/form_helper_test.rb b/actionpack/test/template/form_helper_test.rb
index 4b9e418..9ddfa13 100644
--- a/actionpack/test/template/form_helper_test.rb
+++ b/actionpack/test/template/form_helper_test.rb
@@ -200,6 +200,11 @@ class FormHelperTest < ActionView::TestCase
     assert_equal object_name, "post[]"
   end
 
+  def test_file_field_has_no_size
+    expected = '<input id="user_avatar" name="user[avatar]" type="file" />'
+    assert_dom_equal expected, file_field("user", "avatar")
+  end
+
   def test_hidden_field
     assert_dom_equal '<input id="post_title" name="post[title]" type="hidden" value="Hello World" />',
       hidden_field("post", "title")
-- 
1.7.0.4

