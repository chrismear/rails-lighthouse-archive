<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">83</assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2008-04-27T23:11:09+01:00</created-at>
  <creator-id type="integer">17971</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer" nil="true"></milestone-id>
  <number type="integer">55</number>
  <permalink>remove-default-integer-limit-from-mysqladapter-native_database_types</permalink>
  <priority type="integer">11807</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag nil="true"></tag>
  <title>Remove default integer :limit from MysqlAdapter.native_database_types</title>
  <updated-at type="datetime">2008-07-03T21:30:20+01:00</updated-at>
  <user-id type="integer">23828</user-id>
  <version type="integer">6</version>
  <user-name>Bill Cleveland</user-name>
  <creator-name>matthuhiggins</creator-name>
  <assigned-user-name>DHH</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/55</url>
  <priority-name nil="true"></priority-name>
  <original-body>A &quot;recent change&quot;:http://rails.lighthouseapp.com/projects/8994/changesets/a37546517dad9f6d9a7de6e1dba4d960909d71e8 to the MySql adapter adds smallint and bigint support based on the specified :limit. Since the default integer limit is specified as 11, integer columns now default with type 'bigint(11)' rather than 'int(11)'. I assume this change was unintentional.

Patch is attached.</original-body>
  <latest-body>A &quot;recent change&quot;:http://rails.lighthouseapp.com/projects/8994/changesets/a37546517dad9f6d9a7de6e1dba4d960909d71e8 to the MySql adapter adds smallint and bigint support based on the specified :limit. Since the default integer limit is specified as 11, integer columns now default with type 'bigint(11)' rather than 'int(11)'. I assume this change was unintentional.

Patch is attached.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;
A &lt;a href=&quot;http://rails.lighthouseapp.com/projects/8994/changesets/a37546517dad9f6d9a7de6e1dba4d960909d71e8&quot;&gt;recent change&lt;/a&gt; to the MySql adapter adds smallint and bigint support based on the specified :limit. Since the default integer limit is specified as 11, integer columns now default with type 'bigint(11)' rather than 'int(11)'. I assume this change was unintentional.
&lt;/p&gt;&lt;p&gt;
Patch is attached.
&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>A &quot;recent change&quot;:http://rails.lighthouseapp.com/projects/8994/changesets/a37546517dad9f6d9a7de6e1dba4d960909d71e8 to the MySql adapter adds smallint and bigint support based on the specified :limit. Since the default integer limit is specified as 11, integer columns now default with type 'bigint(11)' rather than 'int(11)'. I assume this change was unintentional.

Patch is attached.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
A &lt;a href=&quot;http://rails.lighthouseapp.com/projects/8994/changesets/a37546517dad9f6d9a7de6e1dba4d960909d71e8&quot;&gt;recent change&lt;/a&gt; to the MySql adapter adds smallint and bigint support based on the specified :limit. Since the default integer limit is specified as 11, integer columns now default with type 'bigint(11)' rather than 'int(11)'. I assume this change was unintentional.
&lt;/p&gt;&lt;p&gt;
Patch is attached.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-04-27T23:11:09+01:00</created-at>
      <creator-id type="integer">17971</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">55</number>
      <permalink>remove-default-integer-limit-from-mysqladapter-native_database_types</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>Remove default integer :limit from MysqlAdapter.native_database_types</title>
      <updated-at type="datetime">2008-04-27T23:11:09+01:00</updated-at>
      <user-id type="integer">17971</user-id>
      <version type="integer">1</version>
      <user-name>matthuhiggins</user-name>
      <creator-name>matthuhiggins</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/55</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Closed by http://github.com/rails/rails/commit/0780563ae7b2df74613550f1438d13459cb10b1f</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Closed by &lt;a href=&quot;http://github.com/rails/rails/commit/0780563ae7b2df74613550f1438d13459cb10b1f&quot;&gt;http://github.com/rails/rails/co...&lt;/a&gt;
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-04-29T22:48:00+01:00</created-at>
      <creator-id type="integer">17971</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">55</number>
      <permalink>remove-default-integer-limit-from-mysqladapter-native_database_types</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>Remove default integer :limit from MysqlAdapter.native_database_types</title>
      <updated-at type="datetime">2008-04-29T22:48:00+01:00</updated-at>
      <user-id type="integer">83</user-id>
      <version type="integer">2</version>
      <user-name>DHH</user-name>
      <creator-name>matthuhiggins</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/55</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">83</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Actually this does not seem to be fixed. I am running into this issue as well:

When I run &quot;rake db:test:clone&quot; in Rails 2.0.991, it now creates foreign key integer columns as bigint(11) rather than int(11), which later causes problems for our foreign key constraints since the types don't match those of the primary keys.

Could it be that it infers the limit of 11 from my development database (even though my migrations don't explicitly specify a limit), and then applies this when cloning the test database, thus creating these columns as bigint instead of int?</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Actually this does not seem to be fixed. I am running into this issue as well:
&lt;/p&gt;&lt;p&gt;
When I run &quot;rake db:test:clone&quot; in Rails 2.0.991, it now creates foreign key integer columns as bigint(11) rather than int(11), which later causes problems for our foreign key constraints since the types don't match those of the primary keys.
&lt;/p&gt;&lt;p&gt;
Could it be that it infers the limit of 11 from my development database (even though my migrations don't explicitly specify a limit), and then applies this when cloning the test database, thus creating these columns as bigint instead of int?
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-05-21T21:39:07+01:00</created-at>
      <creator-id type="integer">17971</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">55</number>
      <permalink>remove-default-integer-limit-from-mysqladapter-native_database_types</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>Remove default integer :limit from MysqlAdapter.native_database_types</title>
      <updated-at type="datetime">2008-05-21T21:39:07+01:00</updated-at>
      <user-id type="integer">17377</user-id>
      <version type="integer">3</version>
      <user-name>Mirko Froehlich</user-name>
      <creator-name>matthuhiggins</creator-name>
      <assigned-user-name>DHH</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/55</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">83</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I am now convinced that this is the problem, i.e. rake db:test:clone results in integer columns that were originally created without an explicit limit in the migration script (and implicitly ended up as int(11)) to be created as bigint(11) in the test db, rendering them incompatible with primary keys of type int(11). This would never cause a problem in production or development, but it breaks the tests if you are using foreign key constraints.

I am not sure about a good solution, other than reverting the bigint change. For my purposes, I am currently monkey-patching this code to raise the bigint range from 9..20 to 12..20, which bypasses this problem.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
I am now convinced that this is the problem, i.e. rake db:test:clone results in integer columns that were originally created without an explicit limit in the migration script (and implicitly ended up as int(11)) to be created as bigint(11) in the test db, rendering them incompatible with primary keys of type int(11). This would never cause a problem in production or development, but it breaks the tests if you are using foreign key constraints.
&lt;/p&gt;&lt;p&gt;
I am not sure about a good solution, other than reverting the bigint change. For my purposes, I am currently monkey-patching this code to raise the bigint range from 9..20 to 12..20, which bypasses this problem.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-05-21T22:57:19+01:00</created-at>
      <creator-id type="integer">17971</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">55</number>
      <permalink>remove-default-integer-limit-from-mysqladapter-native_database_types</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>Remove default integer :limit from MysqlAdapter.native_database_types</title>
      <updated-at type="datetime">2008-05-21T22:57:19+01:00</updated-at>
      <user-id type="integer">17377</user-id>
      <version type="integer">4</version>
      <user-name>Mirko Froehlich</user-name>
      <creator-name>matthuhiggins</creator-name>
      <assigned-user-name>DHH</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/55</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">83</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Can we patch the mysql_adapter so that the primary index is a bigint(11) instead of a int(11)?

This would solve the following problems:

1. The 11 in int(11) is a formatting specification and not a datatype specification. Therefore even though we specified an integer being formatted to display 11 character wide, the key value can only store 9 digits (well 9 full digits) due to the index being only 32 bits wide.

2. The issue that Mirko is having would be resolved, since the foreign key integer columns would now correctly match the data type of the primary key.

3. Being a BIGINT the primary key data type inches closer to the standard data type that MySQL databases use as its primary key which is an UNSIGNED BIGINT

Thanks,
Bill</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Can we patch the mysql_adapter so that the primary index is a bigint(11) instead of a int(11)?
&lt;/p&gt;&lt;p&gt;
This would solve the following problems:
&lt;/p&gt;&lt;p&gt;
1. The 11 in int(11) is a formatting specification and not a datatype specification. Therefore even though we specified an integer being formatted to display 11 character wide, the key value can only store 9 digits (well 9 full digits) due to the index being only 32 bits wide.
&lt;/p&gt;&lt;p&gt;
2. The issue that Mirko is having would be resolved, since the foreign key integer columns would now correctly match the data type of the primary key.
&lt;/p&gt;&lt;p&gt;
3. Being a BIGINT the primary key data type inches closer to the standard data type that MySQL databases use as its primary key which is an UNSIGNED BIGINT
&lt;/p&gt;&lt;p&gt;
Thanks,
&lt;/p&gt;&lt;p&gt;
Bill
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-07-03T20:49:31+01:00</created-at>
      <creator-id type="integer">17971</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">55</number>
      <permalink>remove-default-integer-limit-from-mysqladapter-native_database_types</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>activerecord patch</tag>
      <title>Remove default integer :limit from MysqlAdapter.native_database_types</title>
      <updated-at type="datetime">2008-07-03T20:49:31+01:00</updated-at>
      <user-id type="integer">23828</user-id>
      <version type="integer">5</version>
      <user-name>Bill Cleveland</user-name>
      <creator-name>matthuhiggins</creator-name>
      <assigned-user-name>DHH</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/55</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">83</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Well since there is a move to change the interpretation of :limit to number of bytes instead of number of characters, please disregard some of my previous comment.

It would be nice if the primary_key was created using a &quot;key datatype&quot; like :uid, so that regardless of which database adapter is being used, it will be possible to create foreign_key columns with the same datatype as the primary key it references.

I would still like the MySQL adapter to use BIGINT as its primary key.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Well since there is a move to change the interpretation of :limit to number of bytes instead of number of characters, please disregard some of my previous comment.
&lt;/p&gt;&lt;p&gt;
It would be nice if the primary_key was created using a &quot;key datatype&quot; like :uid, so that regardless of which database adapter is being used, it will be possible to create foreign_key columns with the same datatype as the primary key it references.
&lt;/p&gt;&lt;p&gt;
I would still like the MySQL adapter to use BIGINT as its primary key.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-07-03T21:30:20+01:00</created-at>
      <creator-id type="integer">17971</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: activerecord patch
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">55</number>
      <permalink>remove-default-integer-limit-from-mysqladapter-native_database_types</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>Remove default integer :limit from MysqlAdapter.native_database_types</title>
      <updated-at type="datetime">2008-07-03T21:30:20+01:00</updated-at>
      <user-id type="integer">23828</user-id>
      <version type="integer">6</version>
      <user-name>Bill Cleveland</user-name>
      <creator-name>matthuhiggins</creator-name>
      <assigned-user-name>DHH</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/55</url>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>d3af71c9c8f0f4751ac2b15a54d06313abb856ff</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2008-04-27T23:11:09+01:00</created-at>
      <filename>remove_default_integer_limit_from_mysql.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">20371</id>
      <size type="integer">798</size>
      <uploader-id type="integer">17971</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/20371/remove_default_integer_limit_from_mysql.diff</url>
    </attachment>
  </attachments>
</ticket>
