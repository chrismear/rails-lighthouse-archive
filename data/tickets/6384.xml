<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">15316</assigned-user-id>
  <attachments-count type="integer">0</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2011-02-07T16:47:32+00:00</created-at>
  <creator-id type="integer">3839</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer" nil="true"></milestone-id>
  <number type="integer">6384</number>
  <permalink>activerecord-303-and-3-0-stable-generate-invalid-sql-for-has_many-through-association-with-conditions</permalink>
  <priority type="integer">3</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>arel has_many_through</tag>
  <title>ActiveRecord 3.0.3 and 3-0-stable generate invalid SQL for has_many :through association with :conditions</title>
  <updated-at type="datetime">2011-02-21T23:05:55+00:00</updated-at>
  <user-id type="integer">15316</user-id>
  <version type="integer">2</version>
  <user-name>Aaron Patterson</user-name>
  <creator-name>Raimonds Simanovskis</creator-name>
  <assigned-user-name>Aaron Patterson</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/6384</url>
  <priority-name>Low</priority-name>
  <original-body>If has_many :through association has :conditions option then generated SQL is missing either join conditions or specified additional conditions from :conditions

See test case how to reproduce the issue and the generated results by different versions of ActiveRecord and Arel
https://gist.github.com/ca8d82d1dd70f73c51de

If ActiveRecord from Rails master branch and Arel master branch is used then correct SQL is generated. It would be good to fix this bug also in upcoming Rails 3.0.4 version (current version from 3-0-stable branch is producing invalid SQL).</original-body>
  <latest-body>If has_many :through association has :conditions option then generated SQL is missing either join conditions or specified additional conditions from :conditions

See test case how to reproduce the issue and the generated results by different versions of ActiveRecord and Arel
https://gist.github.com/ca8d82d1dd70f73c51de

If ActiveRecord from Rails master branch and Arel master branch is used then correct SQL is generated. It would be good to fix this bug also in upcoming Rails 3.0.4 version (current version from 3-0-stable branch is producing invalid SQL).</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;If has_many :through association has :conditions option then
generated SQL is missing either join conditions or specified
additional conditions from :conditions&lt;/p&gt;
&lt;p&gt;See test case how to reproduce the issue and the generated
results by different versions of ActiveRecord and Arel&lt;br&gt;
&lt;a href=
&quot;https://gist.github.com/ca8d82d1dd70f73c51de&quot;&gt;https://gist.github.com/ca8d82d1dd70f73c51de&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;If ActiveRecord from Rails master branch and Arel master branch
is used then correct SQL is generated. It would be good to fix this
bug also in upcoming Rails 3.0.4 version (current version from
3-0-stable branch is producing invalid SQL).&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>If has_many :through association has :conditions option then generated SQL is missing either join conditions or specified additional conditions from :conditions

See test case how to reproduce the issue and the generated results by different versions of ActiveRecord and Arel
https://gist.github.com/ca8d82d1dd70f73c51de

If ActiveRecord from Rails master branch and Arel master branch is used then correct SQL is generated. It would be good to fix this bug also in upcoming Rails 3.0.4 version (current version from 3-0-stable branch is producing invalid SQL).</body>
      <body-html>&lt;div&gt;&lt;p&gt;If has_many :through association has :conditions option then
generated SQL is missing either join conditions or specified
additional conditions from :conditions&lt;/p&gt;
&lt;p&gt;See test case how to reproduce the issue and the generated
results by different versions of ActiveRecord and Arel&lt;br&gt;
&lt;a href=
&quot;https://gist.github.com/ca8d82d1dd70f73c51de&quot;&gt;https://gist.github.com/ca8d82d1dd70f73c51de&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;If ActiveRecord from Rails master branch and Arel master branch
is used then correct SQL is generated. It would be good to fix this
bug also in upcoming Rails 3.0.4 version (current version from
3-0-stable branch is producing invalid SQL).&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2011-02-07T16:47:32+00:00</created-at>
      <creator-id type="integer">3839</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">6384</number>
      <permalink>activerecord-303-and-3-0-stable-generate-invalid-sql-for-has_many-through-association-with-conditions</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>arel has_many_through</tag>
      <title>ActiveRecord 3.0.3 and 3-0-stable generate invalid SQL for has_many :through association with :conditions</title>
      <updated-at type="datetime">2011-02-07T16:47:37+00:00</updated-at>
      <user-id type="integer">3839</user-id>
      <version type="integer">1</version>
      <user-name>Raimonds Simanovskis</user-name>
      <creator-name>Raimonds Simanovskis</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6384</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I've fixed this in Arel here:

https://github.com/rails/arel/commit/64d21596950df4599bc6ea8a7b6356404b3b2737

It will be released with arel 2.0.9.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've fixed this in Arel here:&lt;/p&gt;
&lt;p&gt;&lt;a href=
&quot;https://github.com/rails/arel/commit/64d21596950df4599bc6ea8a7b6356404b3b2737&quot;&gt;
https://github.com/rails/arel/commit/64d21596950df4599bc6ea8a7b6356...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;It will be released with arel 2.0.9.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2011-02-21T23:05:47+00:00</created-at>
      <creator-id type="integer">3839</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
:state: new
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">6384</number>
      <permalink>activerecord-303-and-3-0-stable-generate-invalid-sql-for-has_many-through-association-with-conditions</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>arel has_many_through</tag>
      <title>ActiveRecord 3.0.3 and 3-0-stable generate invalid SQL for has_many :through association with :conditions</title>
      <updated-at type="datetime">2011-02-21T23:05:55+00:00</updated-at>
      <user-id type="integer">15316</user-id>
      <version type="integer">2</version>
      <user-name>Aaron Patterson</user-name>
      <creator-name>Raimonds Simanovskis</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6384</url>
      <priority-name>Low</priority-name>
    </version>
  </versions>
</ticket>
