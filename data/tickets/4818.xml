<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2010-06-10T10:58:26+01:00</created-at>
  <creator-id type="integer">20574</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer" nil="true"></milestone-id>
  <number type="integer">4818</number>
  <permalink>share-session-between-subdomains</permalink>
  <priority type="integer">0</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>3.x cookie_store session_store.rb</tag>
  <title>Share session between subdomains</title>
  <updated-at type="datetime">2010-12-02T16:34:40+00:00</updated-at>
  <user-id type="integer">8551</user-id>
  <version type="integer">10</version>
  <user-name>Fjan</user-name>
  <creator-name>Guillermo &#193;lvarez</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/4818</url>
  <priority-name nil="true"></priority-name>
  <original-body>Sessions cookies don't hace domain, so by default navigators use current HTTP_HOSTS.

If you want to share session between www.example.com and username.example.com you can't.

The next patch resolve this problem by adding a domain option in session_store initializar.


The syntax is:

@@@ ruby
  Rails.application.config.session_store :cookie_store, :key =&gt; '_app_session', :domain =&gt; :all
@@@</original-body>
  <latest-body>Sessions cookies don't hace domain, so by default navigators use current HTTP_HOSTS.

If you want to share session between www.example.com and username.example.com you can't.

The next patch resolve this problem by adding a domain option in session_store initializar.


The syntax is:

@@@ ruby
  Rails.application.config.session_store :cookie_store, :key =&gt; '_app_session', :domain =&gt; :all
@@@</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;Sessions cookies don't hace domain, so by default navigators use
current HTTP_HOSTS.&lt;/p&gt;
&lt;p&gt;If you want to share session between &lt;a href=
&quot;http://www.example.com&quot;&gt;www.example.com&lt;/a&gt; and
username.example.com you can't.&lt;/p&gt;
&lt;p&gt;The next patch resolve this problem by adding a domain option in
session_store initializar.&lt;/p&gt;
&lt;p&gt;The syntax is:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=
&quot;ruby&quot;&gt;  Rails.application.config.session_store :cookie_store, :key =&amp;gt; '_app_session', :domain =&amp;gt; :all&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Sessions cookies don't hace domain, so by default navigators use current HTTP_HOSTS.

If you want to share session between www.example.com and username.example.com you can't.

The next patch resolve this problem by adding a domain option in session_store initializar.


The syntax is:

@@@ ruby
  Rails.application.config.session_store :cookie_store, :key =&gt; '_app_session', :domain =&gt; :all
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;Sessions cookies don't hace domain, so by default navigators use
current HTTP_HOSTS.&lt;/p&gt;
&lt;p&gt;If you want to share session between &lt;a href=
&quot;http://www.example.com&quot;&gt;www.example.com&lt;/a&gt; and
username.example.com you can't.&lt;/p&gt;
&lt;p&gt;The next patch resolve this problem by adding a domain option in
session_store initializar.&lt;/p&gt;
&lt;p&gt;The syntax is:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=
&quot;ruby&quot;&gt;  Rails.application.config.session_store :cookie_store, :key =&amp;gt; '_app_session', :domain =&amp;gt; :all&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-10T10:58:26+01:00</created-at>
      <creator-id type="integer">20574</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4818</number>
      <permalink>share-session-between-subdomains</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>cookie_store session_store.rb</tag>
      <title>Share session between subdomains</title>
      <updated-at type="datetime">2010-06-10T10:58:32+01:00</updated-at>
      <user-id type="integer">20574</user-id>
      <version type="integer">1</version>
      <user-name>Guillermo &#193;lvarez</user-name>
      <creator-name>Guillermo &#193;lvarez</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4818</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Here is the patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Here is the patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-10T11:03:34+01:00</created-at>
      <creator-id type="integer">20574</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4818</number>
      <permalink>share-session-between-subdomains</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>cookie_store session_store.rb</tag>
      <title>Share session between subdomains</title>
      <updated-at type="datetime">2010-06-10T11:03:41+01:00</updated-at>
      <user-id type="integer">20574</user-id>
      <version type="integer">2</version>
      <user-name>Guillermo &#193;lvarez</user-name>
      <creator-name>Guillermo &#193;lvarez</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4818</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>This patch is so simple, and just cover most of the cases i know, so for most complicated cases like 3th level domain, you must be explicit. For example:

If you want to share session between *.google.co.uk you do:


@@@ ruby
  Rails.application.config.session_store :cookie_store, :key =&gt; '_app_session', :domain =&gt; &quot;.google.co.uk&quot;
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;This patch is so simple, and just cover most of the cases i
know, so for most complicated cases like 3th level domain, you must
be explicit. For example:&lt;/p&gt;
&lt;p&gt;If you want to share session between *.google.co.uk you do:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=
&quot;ruby&quot;&gt;  Rails.application.config.session_store :cookie_store, :key =&amp;gt; '_app_session', :domain =&amp;gt; &quot;.google.co.uk&quot;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-10T11:25:38+01:00</created-at>
      <creator-id type="integer">20574</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4818</number>
      <permalink>share-session-between-subdomains</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>cookie_store session_store.rb</tag>
      <title>Share session between subdomains</title>
      <updated-at type="datetime">2010-06-10T11:25:40+01:00</updated-at>
      <user-id type="integer">20574</user-id>
      <version type="integer">3</version>
      <user-name>Guillermo &#193;lvarez</user-name>
      <creator-name>Guillermo &#193;lvarez</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4818</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-10T15:23:28+01:00</created-at>
      <creator-id type="integer">20574</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: cookie_store session_store.rb
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4818</number>
      <permalink>share-session-between-subdomains</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>3.x cookie_store session_store.rb</tag>
      <title>Share session between subdomains</title>
      <updated-at type="datetime">2010-06-10T15:23:30+01:00</updated-at>
      <user-id type="integer">20574</user-id>
      <version type="integer">4</version>
      <user-name>Guillermo &#193;lvarez</user-name>
      <creator-name>Guillermo &#193;lvarez</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4818</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>(from [c4d6245e875bbb276c122a5a401422d341dac4df]) Add support for multi-subdomain session by setting cookie host in session cookie so you can share session between www.example.com, example.com and user.example.com. [#4818 state:resolved]

Signed-off-by: David Heinemeier Hansson &lt;david@loudthinking.com&gt;
http://github.com/rails/rails/commit/c4d6245e875bbb276c122a5a401422d341dac4df</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/c4d6245e875bbb276c122a5a401422d341dac4df&quot;
title=
&quot;Changeset [c4d6245e875bbb276c122a5a401422d341dac4df]&quot;&gt;[c4d6245e875bbb276c122a5a401422d341dac4df]&lt;/a&gt;)
Add support for multi-subdomain session by setting cookie host in
session cookie so you can share session between &lt;a href=
&quot;http://www.example.com&quot;&gt;www.example.com&lt;/a&gt;, example.com and
user.example.com. [&lt;a href=&quot;/projects/8994/tickets/4818&quot; title=
&quot;Ticket #4818&quot;&gt;#4818&lt;/a&gt; state:resolved]&lt;/p&gt;
&lt;p&gt;Signed-off-by: David Heinemeier Hansson &lt;a href=
&quot;mailto:david@loudthinking.com&quot;&gt;david@loudthinking.com&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/c4d6245e875bbb276c122a5a401422d341dac4df&quot;&gt;
http://github.com/rails/rails/commit/c4d6245e875bbb276c122a5a401422...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-06-10T17:05:40+01:00</created-at>
      <creator-id type="integer">20574</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4818</number>
      <permalink>share-session-between-subdomains</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>3.x cookie_store session_store.rb</tag>
      <title>Share session between subdomains</title>
      <updated-at type="datetime">2010-06-10T17:05:43+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">5</version>
      <user-name>Repository</user-name>
      <creator-name>Guillermo &#193;lvarez</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4818</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>(from [330a89072a493aafef1e07c3558964477f85adf0]) Revert &quot;Add support for multi-subdomain session by setting cookie host in session cookie so you can share session between www.example.com, example.com and user.example.com. [#4818 state:resolved]&quot;

It does not work for domains like co.uk and com.br.

This reverts commit c4d6245e875bbb276c122a5a401422d341dac4df.
http://github.com/rails/rails/commit/330a89072a493aafef1e07c3558964477f85adf0</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/330a89072a493aafef1e07c3558964477f85adf0&quot;
title=
&quot;Changeset [330a89072a493aafef1e07c3558964477f85adf0]&quot;&gt;[330a89072a493aafef1e07c3558964477f85adf0]&lt;/a&gt;)
Revert &quot;Add support for multi-subdomain session by setting cookie
host in session cookie so you can share session between &lt;a href=
&quot;http://www.example.com&quot;&gt;www.example.com&lt;/a&gt;, example.com and
user.example.com. [&lt;a href=&quot;/projects/8994/tickets/4818&quot; title=
&quot;Ticket #4818&quot;&gt;#4818&lt;/a&gt; state:resolved]&quot;&lt;/p&gt;
&lt;p&gt;It does not work for domains like co.uk and com.br.&lt;/p&gt;
&lt;p&gt;This reverts commit
c4d6245e875bbb276c122a5a401422d341dac4df.&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/330a89072a493aafef1e07c3558964477f85adf0&quot;&gt;
http://github.com/rails/rails/commit/330a89072a493aafef1e07c3558964...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-06-10T19:08:55+01:00</created-at>
      <creator-id type="integer">20574</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4818</number>
      <permalink>share-session-between-subdomains</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>3.x cookie_store session_store.rb</tag>
      <title>Share session between subdomains</title>
      <updated-at type="datetime">2010-06-10T19:08:58+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">6</version>
      <user-name>Repository</user-name>
      <creator-name>Guillermo &#193;lvarez</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4818</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>(from [44830ead1c88e1c45124133ce3e2ed9f890f42de]) Add support for multi-subdomain session by setting cookie host in session cookie so you can share session between www.example.com, example.com and user.example.com. [#4818 state:resolved]

This reverts commit 330a89072a493aafef1e07c3558964477f85adf0.
http://github.com/rails/rails/commit/44830ead1c88e1c45124133ce3e2ed9f890f42de</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/44830ead1c88e1c45124133ce3e2ed9f890f42de&quot;
title=
&quot;Changeset [44830ead1c88e1c45124133ce3e2ed9f890f42de]&quot;&gt;[44830ead1c88e1c45124133ce3e2ed9f890f42de]&lt;/a&gt;)
Add support for multi-subdomain session by setting cookie host in
session cookie so you can share session between &lt;a href=
&quot;http://www.example.com&quot;&gt;www.example.com&lt;/a&gt;, example.com and
user.example.com. [&lt;a href=&quot;/projects/8994/tickets/4818&quot; title=
&quot;Ticket #4818&quot;&gt;#4818&lt;/a&gt; state:resolved]&lt;/p&gt;
&lt;p&gt;This reverts commit
330a89072a493aafef1e07c3558964477f85adf0.&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/44830ead1c88e1c45124133ce3e2ed9f890f42de&quot;&gt;
http://github.com/rails/rails/commit/44830ead1c88e1c45124133ce3e2ed...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-06-11T15:36:04+01:00</created-at>
      <creator-id type="integer">20574</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4818</number>
      <permalink>share-session-between-subdomains</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>3.x cookie_store session_store.rb</tag>
      <title>Share session between subdomains</title>
      <updated-at type="datetime">2010-06-11T15:36:08+01:00</updated-at>
      <user-id type="integer">65556</user-id>
      <version type="integer">7</version>
      <user-name>Rizwan Reza</user-name>
      <creator-name>Guillermo &#193;lvarez</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4818</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I really like this new &quot;:domain =&gt; :all&quot; option, but I'm getting a &quot;ActionController::InvalidAuthenticityToken&quot; exception when trying to use it.  Everything works fine when specifying the domain directly.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I really like this new &quot;:domain =&amp;gt; :all&quot; option, but I'm
getting a &quot;ActionController::InvalidAuthenticityToken&quot; exception
when trying to use it. Everything works fine when specifying the
domain directly.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-06-19T20:44:12+01:00</created-at>
      <creator-id type="integer">20574</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4818</number>
      <permalink>share-session-between-subdomains</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>3.x cookie_store session_store.rb</tag>
      <title>Share session between subdomains</title>
      <updated-at type="datetime">2010-06-19T20:44:18+01:00</updated-at>
      <user-id type="integer">18202</user-id>
      <version type="integer">8</version>
      <user-name>Bryce Thornton</user-name>
      <creator-name>Guillermo &#193;lvarez</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4818</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Here is a list of all domains with several levels (like .co.uk): http://publicsuffix.org/ It's maintained by the Mozilla Project.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Here is a list of all domains with several levels (like .co.uk):
&lt;a href=&quot;http://publicsuffix.org/&quot;&gt;http://publicsuffix.org/&lt;/a&gt;
It's maintained by the Mozilla Project.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-09-07T19:35:37+01:00</created-at>
      <creator-id type="integer">20574</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4818</number>
      <permalink>share-session-between-subdomains</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>3.x cookie_store session_store.rb</tag>
      <title>Share session between subdomains</title>
      <updated-at type="datetime">2010-09-07T19:35:39+01:00</updated-at>
      <user-id type="integer">18453</user-id>
      <version type="integer">9</version>
      <user-name>iGEL</user-name>
      <creator-name>Guillermo &#193;lvarez</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4818</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>This patch doe produce a cookie that doesn't conform to specs if the host you are accessing is &quot;localhost&quot; or an IP address. The browsers I tried don't seem to care about this but Unix' wget will complain about it.</body>
      <body-html>&lt;div&gt;&lt;p&gt;This patch doe produce a cookie that doesn't conform to specs if
the host you are accessing is &quot;localhost&quot; or an IP address. The
browsers I tried don't seem to care about this but Unix' wget will
complain about it.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-12-02T16:34:32+00:00</created-at>
      <creator-id type="integer">20574</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4818</number>
      <permalink>share-session-between-subdomains</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>3.x cookie_store session_store.rb</tag>
      <title>Share session between subdomains</title>
      <updated-at type="datetime">2010-12-02T16:34:40+00:00</updated-at>
      <user-id type="integer">8551</user-id>
      <version type="integer">10</version>
      <user-name>Fjan</user-name>
      <creator-name>Guillermo &#193;lvarez</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4818</url>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>657180e630e103ab92c6a4a0d8f238c2f9a2bbfa</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-06-10T11:03:34+01:00</created-at>
      <filename>add_host_option_to_cookie_session_store.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">554027</id>
      <size type="integer">3842</size>
      <uploader-id type="integer">20574</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/554027/add_host_option_to_cookie_session_store.patch</url>
    </attachment>
  </attachments>
</ticket>
