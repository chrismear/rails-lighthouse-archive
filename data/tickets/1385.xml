<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2008-11-16T06:24:36+00:00</created-at>
  <creator-id type="integer">7697</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">9903</milestone-id>
  <number type="integer">1385</number>
  <permalink>fix-current_page-to-work-with-multiple-parameters-in-the-query-string</permalink>
  <priority type="integer">778</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>committed</state>
  <tag>actionpack actionview bug helper url_helper</tag>
  <title>Fix current_page? to work with multiple parameters in the query string</title>
  <updated-at type="datetime">2009-02-05T19:38:33+00:00</updated-at>
  <user-id type="integer">17393</user-id>
  <version type="integer">4</version>
  <user-name>Repository</user-name>
  <creator-name>Andrew White</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/1385</url>
  <milestone-title>2.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>The current_page? helper method currently doesn't work correctly if you have multiple params in the url as the CGI.escapeHTML call turns the ampersands into html entities which will fail to match the url from the request.

The attached patch changes the CGI.escapeHTML to a CGI.unescapeHTML so that any url passed to the current_page? method that may have been generated by a named route helper method will match as these are already escaped by default.

Includes three tests - the first is just a baseline test to make sure that current_page? is working with simple urls. The second test checks the recently added ability to ignore url params which fails when passing a hash as the route generated includes the params from the current request. The third test checks for explicitly passed urls with multiple params.</original-body>
  <latest-body>The current_page? helper method currently doesn't work correctly if you have multiple params in the url as the CGI.escapeHTML call turns the ampersands into html entities which will fail to match the url from the request.

The attached patch changes the CGI.escapeHTML to a CGI.unescapeHTML so that any url passed to the current_page? method that may have been generated by a named route helper method will match as these are already escaped by default.

Includes three tests - the first is just a baseline test to make sure that current_page? is working with simple urls. The second test checks the recently added ability to ignore url params which fails when passing a hash as the route generated includes the params from the current request. The third test checks for explicitly passed urls with multiple params.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;The current_page? helper method currently doesn't work correctly
if you have multiple params in the url as the CGI.escapeHTML call
turns the ampersands into html entities which will fail to match
the url from the request.&lt;/p&gt;
&lt;p&gt;The attached patch changes the CGI.escapeHTML to a
CGI.unescapeHTML so that any url passed to the current_page? method
that may have been generated by a named route helper method will
match as these are already escaped by default.&lt;/p&gt;
&lt;p&gt;Includes three tests - the first is just a baseline test to make
sure that current_page? is working with simple urls. The second
test checks the recently added ability to ignore url params which
fails when passing a hash as the route generated includes the
params from the current request. The third test checks for
explicitly passed urls with multiple params.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>The current_page? helper method currently doesn't work correctly if you have multiple params in the url as the CGI.escapeHTML call turns the ampersands into html entities which will fail to match the url from the request.

The attached patch changes the CGI.escapeHTML to a CGI.unescapeHTML so that any url passed to the current_page? method that may have been generated by a named route helper method will match as these are already escaped by default.

Includes three tests - the first is just a baseline test to make sure that current_page? is working with simple urls. The second test checks the recently added ability to ignore url params which fails when passing a hash as the route generated includes the params from the current request. The third test checks for explicitly passed urls with multiple params.</body>
      <body-html>&lt;div&gt;&lt;p&gt;The current_page? helper method currently doesn't work correctly
if you have multiple params in the url as the CGI.escapeHTML call
turns the ampersands into html entities which will fail to match
the url from the request.&lt;/p&gt;
&lt;p&gt;The attached patch changes the CGI.escapeHTML to a
CGI.unescapeHTML so that any url passed to the current_page? method
that may have been generated by a named route helper method will
match as these are already escaped by default.&lt;/p&gt;
&lt;p&gt;Includes three tests - the first is just a baseline test to make
sure that current_page? is working with simple urls. The second
test checks the recently added ability to ignore url params which
fails when passing a hash as the route generated includes the
params from the current request. The third test checks for
explicitly passed urls with multiple params.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-11-16T06:24:36+00:00</created-at>
      <creator-id type="integer">7697</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1385</number>
      <permalink>fix-current_page-to-work-with-multiple-parameters-in-the-query-string</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionpack actionview bug helper url_helper</tag>
      <title>Fix current_page? to work with multiple parameters in the query string</title>
      <updated-at type="datetime">2008-11-16T06:24:38+00:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">1</version>
      <user-name>Andrew White</user-name>
      <creator-name>Andrew White</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1385</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>That's actually a bug and I wonder why there has been so little interest in it. The fix is simple.

Should go into 2.3 imo, so:
+1</body>
      <body-html>&lt;div&gt;&lt;p&gt;That's actually a bug and I wonder why there has been so little
interest in it. The fix is simple.&lt;/p&gt;
&lt;p&gt;Should go into 2.3 imo, so: +1&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-04T13:48:48+00:00</created-at>
      <creator-id type="integer">7697</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1385</number>
      <permalink>fix-current_page-to-work-with-multiple-parameters-in-the-query-string</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionpack actionview bug helper url_helper</tag>
      <title>Fix current_page? to work with multiple parameters in the query string</title>
      <updated-at type="datetime">2009-02-04T13:48:49+00:00</updated-at>
      <user-id type="integer">19954</user-id>
      <version type="integer">2</version>
      <user-name>Pascal Ehlert</user-name>
      <creator-name>Andrew White</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1385</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>+1</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-04T19:11:54+00:00</created-at>
      <creator-id type="integer">7697</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1385</number>
      <permalink>fix-current_page-to-work-with-multiple-parameters-in-the-query-string</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionpack actionview bug helper url_helper</tag>
      <title>Fix current_page? to work with multiple parameters in the query string</title>
      <updated-at type="datetime">2009-02-04T19:11:59+00:00</updated-at>
      <user-id type="integer">24394</user-id>
      <version type="integer">3</version>
      <user-name>chris finne</user-name>
      <creator-name>Andrew White</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1385</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>(from [6db78e8c02442080d2be93faeeb42be97b09fb53]) Added tests from Andrew Whites fix [#1385 state:committed]
http://github.com/rails/rails/commit/6db78e8c02442080d2be93faeeb42be97b09fb53</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from [6db78e8c02442080d2be93faeeb42be97b09fb53]) Added tests
from Andrew Whites fix [&lt;a href=&quot;/projects/8994/tickets/1385&quot; title=&quot;Ticket #1385&quot;&gt;#1385&lt;/a&gt; state:committed] &lt;a href=&quot;http://github.com/rails/rails/commit/6db78e8c02442080d2be93faeeb42be97b09fb53&quot;&gt;
http://github.com/rails/rails/co...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-02-05T19:38:30+00:00</created-at>
      <creator-id type="integer">7697</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1385</number>
      <permalink>fix-current_page-to-work-with-multiple-parameters-in-the-query-string</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>actionpack actionview bug helper url_helper</tag>
      <title>Fix current_page? to work with multiple parameters in the query string</title>
      <updated-at type="datetime">2009-02-05T19:38:33+00:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">4</version>
      <user-name>Repository</user-name>
      <creator-name>Andrew White</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1385</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>241cf3b1b446e27e83fd735e3330378d6cdd9cf4</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2008-11-16T06:24:36+00:00</created-at>
      <filename>current_page_with_params_fix.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">62599</id>
      <size type="integer">2864</size>
      <uploader-id type="integer">7697</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/62599/current_page_with_params_fix.diff</url>
    </attachment>
  </attachments>
</ticket>
