<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2008-10-15T14:41:43+01:00</created-at>
  <creator-id type="integer">23933</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">9903</milestone-id>
  <number type="integer">1217</number>
  <permalink>actionmailerbaseperform_deliveries-to-accept-a-proc</permalink>
  <priority type="integer">624</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>wontfix</state>
  <tag>actionmailer patch tested</tag>
  <title>ActionMailer::Base.perform_deliveries to accept a proc</title>
  <updated-at type="datetime">2008-10-16T15:36:33+01:00</updated-at>
  <user-id type="integer">1366</user-id>
  <version type="integer">5</version>
  <user-name>Pratik</user-name>
  <creator-name>Darragh Curran</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/1217</url>
  <milestone-title>2.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>Here's a patch so that ActionMailer::Base.perform_deliveries will accept a proc - 

currently it expects a boolean - 

I wanted to easily perform deliveries conditionally in my staging environment - only sending mails where recipient is in certain domain. I can achieve this with a quick but brittle monkey patch.

ActionMailer::Base.perform_deliveries = lambda {|mail| mail.header['to'].to_s =~ /@example.com$/}</original-body>
  <latest-body>Here's a patch so that ActionMailer::Base.perform_deliveries will accept a proc - 

currently it expects a boolean - 

I wanted to easily perform deliveries conditionally in my staging environment - only sending mails where recipient is in certain domain. I can achieve this with a quick but brittle monkey patch.

ActionMailer::Base.perform_deliveries = lambda {|mail| mail.header['to'].to_s =~ /@example.com$/}</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;Here's a patch so that ActionMailer::Base.perform_deliveries
will accept a proc -&lt;/p&gt;
&lt;p&gt;currently it expects a boolean -&lt;/p&gt;
&lt;p&gt;I wanted to easily perform deliveries conditionally in my
staging environment - only sending mails where recipient is in
certain domain. I can achieve this with a quick but brittle monkey
patch.&lt;/p&gt;
&lt;p&gt;ActionMailer::Base.perform_deliveries = lambda {|mail|
mail.header['to'].to_s =~ /@example.com$/}&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Here's a patch so that ActionMailer::Base.perform_deliveries will accept a proc - 

currently it expects a boolean - 

I wanted to easily perform deliveries conditionally in my staging environment - only sending mails where recipient is in certain domain. I can achieve this with a quick but brittle monkey patch.

ActionMailer::Base.perform_deliveries = lambda {|mail| mail.header['to'].to_s =~ /@example.com$/}</body>
      <body-html>&lt;div&gt;&lt;p&gt;Here's a patch so that ActionMailer::Base.perform_deliveries
will accept a proc -&lt;/p&gt;
&lt;p&gt;currently it expects a boolean -&lt;/p&gt;
&lt;p&gt;I wanted to easily perform deliveries conditionally in my
staging environment - only sending mails where recipient is in
certain domain. I can achieve this with a quick but brittle monkey
patch.&lt;/p&gt;
&lt;p&gt;ActionMailer::Base.perform_deliveries = lambda {|mail|
mail.header['to'].to_s =~ /@example.com$/}&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-10-15T14:41:43+01:00</created-at>
      <creator-id type="integer">23933</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1217</number>
      <permalink>actionmailerbaseperform_deliveries-to-accept-a-proc</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionmailer patch tested</tag>
      <title>ActionMailer::Base.perform_deliveries to accept a proc</title>
      <updated-at type="datetime">2008-10-15T14:41:47+01:00</updated-at>
      <user-id type="integer">23933</user-id>
      <version type="integer">1</version>
      <user-name>Darragh Curran</user-name>
      <creator-name>Darragh Curran</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1217</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>If http://www.elevatedrails.com/articles/2006/10/25/email-delivery-in-test-environments/ works for you, we can close this ticket ?

Thanks.</body>
      <body-html>&lt;div&gt;&lt;p&gt;If &lt;a href=&quot;http://www.elevatedrails.com/articles/2006/10/25/email-delivery-in-test-environments/&quot;&gt;
http://www.elevatedrails.com/art...&lt;/a&gt; works for you, we can close
this ticket ?&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-10-16T14:12:06+01:00</created-at>
      <creator-id type="integer">23933</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1217</number>
      <permalink>actionmailerbaseperform_deliveries-to-accept-a-proc</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionmailer patch tested</tag>
      <title>ActionMailer::Base.perform_deliveries to accept a proc</title>
      <updated-at type="datetime">2008-10-16T14:12:10+01:00</updated-at>
      <user-id type="integer">1366</user-id>
      <version type="integer">2</version>
      <user-name>Pratik</user-name>
      <creator-name>Darragh Curran</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1217</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Yep Mike's suggestion works - as does what I do currently

class ActionMailer::Base
  def perform_deliveries
    @mail.header['to'].to_s =~ /@example.com$/
  end
end

If you don't think it's a worthwhile change then please close the ticket,

Cheers,
Darragh</body>
      <body-html>&lt;div&gt;&lt;p&gt;Yep Mike's suggestion works - as does what I do currently&lt;/p&gt;
&lt;p&gt;class ActionMailer::Base def perform_deliveries&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;@mail.header['to'].to_s =~ /@example.com$/
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;end end&lt;/p&gt;
&lt;p&gt;If you don't think it's a worthwhile change then please close
the ticket,&lt;/p&gt;
&lt;p&gt;Cheers, Darragh&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-10-16T15:33:55+01:00</created-at>
      <creator-id type="integer">23933</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1217</number>
      <permalink>actionmailerbaseperform_deliveries-to-accept-a-proc</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionmailer patch tested</tag>
      <title>ActionMailer::Base.perform_deliveries to accept a proc</title>
      <updated-at type="datetime">2008-10-16T15:34:01+01:00</updated-at>
      <user-id type="integer">23933</user-id>
      <version type="integer">3</version>
      <user-name>Darragh Curran</user-name>
      <creator-name>Darragh Curran</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1217</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-10-16T15:36:07+01:00</created-at>
      <creator-id type="integer">23933</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1217</number>
      <permalink>actionmailerbaseperform_deliveries-to-accept-a-proc</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>wontfix</state>
      <tag>actionmailer patch tested</tag>
      <title>ActionMailer::Base.perform_deliveries to accept a proc</title>
      <updated-at type="datetime">2008-10-16T15:36:12+01:00</updated-at>
      <user-id type="integer">1366</user-id>
      <version type="integer">4</version>
      <user-name>Pratik</user-name>
      <creator-name>Darragh Curran</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1217</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>We can reevaluate if there's more ineterest in this.

Thanks.</body>
      <body-html>&lt;div&gt;&lt;p&gt;We can reevaluate if there's more ineterest in this.&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-10-16T15:36:31+01:00</created-at>
      <creator-id type="integer">23933</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1217</number>
      <permalink>actionmailerbaseperform_deliveries-to-accept-a-proc</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>wontfix</state>
      <tag>actionmailer patch tested</tag>
      <title>ActionMailer::Base.perform_deliveries to accept a proc</title>
      <updated-at type="datetime">2008-10-16T15:36:33+01:00</updated-at>
      <user-id type="integer">1366</user-id>
      <version type="integer">5</version>
      <user-name>Pratik</user-name>
      <creator-name>Darragh Curran</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1217</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>4d3a8751e5f48a4b3f78a5b5ec68910f0058b71b</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2008-10-15T14:41:43+01:00</created-at>
      <filename>action_mailer_perform_deliveries_takes_proc.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">54285</id>
      <size type="integer">4122</size>
      <uploader-id type="integer">23933</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/54285/action_mailer_perform_deliveries_takes_proc.diff</url>
    </attachment>
  </attachments>
</ticket>
