<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">1366</assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2008-09-18T07:00:06+01:00</created-at>
  <creator-id type="integer">8621</creator-id>
  <milestone-due-on type="datetime">2008-10-23T00:00:00+01:00</milestone-due-on>
  <milestone-id type="integer">17920</milestone-id>
  <number type="integer">1066</number>
  <permalink>associationssum-no-longer-returns-a-bigdecimal</permalink>
  <priority type="integer">3</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>2.1.1 activerecord bug patch</tag>
  <title>Associations#sum no longer returns a BigDecimal</title>
  <updated-at type="datetime">2008-10-04T20:14:29+01:00</updated-at>
  <user-id type="integer">17393</user-id>
  <version type="integer">12</version>
  <user-name>Repository</user-name>
  <creator-name>crafterm</creator-name>
  <assigned-user-name>Pratik</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/1066</url>
  <milestone-title>2.1.2</milestone-title>
  <priority-name>Low</priority-name>
  <original-body>Hi All,

Hope all is going well.

Integrity tests in our application started failing after an upgrade from Rails 2.1.0 to 2.1.1 due to a change in Associations#sum. In 2.1.0 Associations#sum returned a BigDecimal, in Rails 2.1.1 returns a Float.

I think returning a big decimal should be preferred due to the imprecise nature of floats.

Cheers,

Marcus</original-body>
  <latest-body>Hi All,

Hope all is going well.

Integrity tests in our application started failing after an upgrade from Rails 2.1.0 to 2.1.1 due to a change in Associations#sum. In 2.1.0 Associations#sum returned a BigDecimal, in Rails 2.1.1 returns a Float.

I think returning a big decimal should be preferred due to the imprecise nature of floats.

Cheers,

Marcus</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;Hi All,&lt;/p&gt;
&lt;p&gt;Hope all is going well.&lt;/p&gt;
&lt;p&gt;Integrity tests in our application started failing after an
upgrade from Rails 2.1.0 to 2.1.1 due to a change in
Associations#sum. In 2.1.0 Associations#sum returned a BigDecimal,
in Rails 2.1.1 returns a Float.&lt;/p&gt;
&lt;p&gt;I think returning a big decimal should be preferred due to the
imprecise nature of floats.&lt;/p&gt;
&lt;p&gt;Cheers,&lt;/p&gt;
&lt;p&gt;Marcus&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Hi All,

Hope all is going well.

Integrity tests in our application started failing after an upgrade from Rails 2.1.0 to 2.1.1 due to a change in Associations#sum. In 2.1.0 Associations#sum returned a BigDecimal, in Rails 2.1.1 returns a Float.

I think returning a big decimal should be preferred due to the imprecise nature of floats.

Cheers,

Marcus</body>
      <body-html>&lt;div&gt;&lt;p&gt;Hi All,&lt;/p&gt;
&lt;p&gt;Hope all is going well.&lt;/p&gt;
&lt;p&gt;Integrity tests in our application started failing after an
upgrade from Rails 2.1.0 to 2.1.1 due to a change in
Associations#sum. In 2.1.0 Associations#sum returned a BigDecimal,
in Rails 2.1.1 returns a Float.&lt;/p&gt;
&lt;p&gt;I think returning a big decimal should be preferred due to the
imprecise nature of floats.&lt;/p&gt;
&lt;p&gt;Cheers,&lt;/p&gt;
&lt;p&gt;Marcus&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-09-18T07:00:06+01:00</created-at>
      <creator-id type="integer">8621</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1066</number>
      <permalink>associationssum-no-longer-returns-a-bigdecimal</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.1.1 activerecord bug</tag>
      <title>Associations#sum no longer returns a BigDecimal</title>
      <updated-at type="datetime">2008-09-18T07:00:11+01:00</updated-at>
      <user-id type="integer">8621</user-id>
      <version type="integer">1</version>
      <user-name>crafterm</user-name>
      <creator-name>crafterm</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1066</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Patch to fix and update tests</body>
      <body-html>&lt;div&gt;&lt;p&gt;Patch to fix and update tests&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-09-18T08:40:29+01:00</created-at>
      <creator-id type="integer">8621</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: &quot;\&quot;2.1.1\&quot; activerecord bug&quot;
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1066</number>
      <permalink>associationssum-no-longer-returns-a-bigdecimal</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.1.1 activerecord bug patch</tag>
      <title>Associations#sum no longer returns a BigDecimal</title>
      <updated-at type="datetime">2008-09-18T08:40:30+01:00</updated-at>
      <user-id type="integer">8621</user-id>
      <version type="integer">2</version>
      <user-name>crafterm</user-name>
      <creator-name>crafterm</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1066</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Are you sure that in 2.1.0 it returned a BigDecimal? The tests in the attached patch seem to fail when run on 2.1.0 without the change to calculations.rb. Looking through the history of type_cast_calculated_value there don't appear to be any references to BigDecimal or to_d.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Are you sure that in 2.1.0 it returned a BigDecimal? The tests
in the attached patch seem to fail when run on 2.1.0 without the
change to calculations.rb. Looking through the history of
type_cast_calculated_value there don't appear to be any references
to BigDecimal or to_d.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-09-19T05:05:16+01:00</created-at>
      <creator-id type="integer">8621</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 9903
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1066</number>
      <permalink>associationssum-no-longer-returns-a-bigdecimal</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.1.1 activerecord bug patch</tag>
      <title>Associations#sum no longer returns a BigDecimal</title>
      <updated-at type="datetime">2008-09-19T05:05:20+01:00</updated-at>
      <user-id type="integer">14890</user-id>
      <version type="integer">3</version>
      <user-name>Tarmo T&#228;nav</user-name>
      <creator-name>crafterm</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1066</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Looking at the commit history it used to be the case that sum was using the default behaviour to typecast to the column type which is where the confusion is arising.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Looking at the commit history it used to be the case that sum
was using the default behaviour to typecast to the column type
which is where the confusion is arising.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-09-19T08:04:02+01:00</created-at>
      <creator-id type="integer">8621</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1066</number>
      <permalink>associationssum-no-longer-returns-a-bigdecimal</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.1.1 activerecord bug patch</tag>
      <title>Associations#sum no longer returns a BigDecimal</title>
      <updated-at type="datetime">2008-09-19T08:04:07+01:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">4</version>
      <user-name>Andrew White</user-name>
      <creator-name>crafterm</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1066</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Aha, indeed that makes sense, but this means it may not be a good idea to make everything BigDecimal, in 2.1.2. Though we may have to restore the typecast behavior.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Aha, indeed that makes sense, but this means it may not be a
good idea to make everything BigDecimal, in 2.1.2. Though we may
have to restore the typecast behavior.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-09-19T08:12:04+01:00</created-at>
      <creator-id type="integer">8621</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1066</number>
      <permalink>associationssum-no-longer-returns-a-bigdecimal</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.1.1 activerecord bug patch</tag>
      <title>Associations#sum no longer returns a BigDecimal</title>
      <updated-at type="datetime">2008-09-19T08:12:05+01:00</updated-at>
      <user-id type="integer">14890</user-id>
      <version type="integer">5</version>
      <user-name>Tarmo T&#228;nav</user-name>
      <creator-name>crafterm</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1066</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-09-19T08:13:19+01:00</created-at>
      <creator-id type="integer">8621</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 
</diffable-attributes>
      <milestone-id type="integer">17920</milestone-id>
      <number type="integer">1066</number>
      <permalink>associationssum-no-longer-returns-a-bigdecimal</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.1.1 activerecord bug patch</tag>
      <title>Associations#sum no longer returns a BigDecimal</title>
      <updated-at type="datetime">2008-09-19T08:13:23+01:00</updated-at>
      <user-id type="integer">14890</user-id>
      <version type="integer">6</version>
      <user-name>Tarmo T&#228;nav</user-name>
      <creator-name>crafterm</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1066</url>
      <milestone-title>2.1.2</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>So which changeset introduced this bug?  The more focussed fix sounds correct to me</body>
      <body-html>&lt;div&gt;&lt;p&gt;So which changeset introduced this bug? The more focussed fix
sounds correct to me&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-09-24T17:37:55+01:00</created-at>
      <creator-id type="integer">8621</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">17920</milestone-id>
      <number type="integer">1066</number>
      <permalink>associationssum-no-longer-returns-a-bigdecimal</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>&quot;2.1.1&quot; activerecord bug patch</tag>
      <title>Associations#sum no longer returns a BigDecimal</title>
      <updated-at type="datetime">2008-09-24T17:37:57+01:00</updated-at>
      <user-id type="integer">141</user-id>
      <version type="integer">7</version>
      <user-name>Michael Koziarski</user-name>
      <creator-name>crafterm</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1066</url>
      <milestone-title>2.1.2</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Was it this one?

http://github.com/rails/rails/commit/604a58807eeb5d6e162678b7c79fe7a56a79fa24

Is it broken in edge rails too?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Was it this one?&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/rails/rails/commit/604a58807eeb5d6e162678b7c79fe7a56a79fa24&quot;&gt;
http://github.com/rails/rails/co...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Is it broken in edge rails too?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-09-24T17:53:15+01:00</created-at>
      <creator-id type="integer">8621</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">17920</milestone-id>
      <number type="integer">1066</number>
      <permalink>associationssum-no-longer-returns-a-bigdecimal</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>&quot;2.1.1&quot; activerecord bug patch</tag>
      <title>Associations#sum no longer returns a BigDecimal</title>
      <updated-at type="datetime">2008-09-24T17:53:19+01:00</updated-at>
      <user-id type="integer">141</user-id>
      <version type="integer">8</version>
      <user-name>Michael Koziarski</user-name>
      <creator-name>crafterm</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1066</url>
      <milestone-title>2.1.2</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Actually it was [this one](http://github.com/rails/rails/commit/4210d85a3f3ce4e980f473e9ed2becb84b58363b). Looks like it was  introduced to make sure sum returned zero when getting empty results from the database.

[Your one](http://github.com/rails/rails/commit/604a58807eeb5d6e162678b7c79fe7a56a79fa24) was introduced to fix the first one typecasting to integer.

The way I've handled this in the past in my own apps is to add a to_d method to NilClass, Fixnum, BigDecimal and Bignum and then just call to_d on the result of the sum method. This way it doesn't matter if there are no items in the sum result set.

The problem with type casting to float for decimal columns and then back to decimal is that you may introduce floating point precision errors. My view would be that if we are doing a straightforward sum on a column then typecast to that column's type otherwise return a string and leave it to the developer to cast to whatever they want. This would also apply to average as well.

As for edge, it has exactly the same behaviour.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Actually it was &lt;a href=&quot;http://github.com/rails/rails/commit/4210d85a3f3ce4e980f473e9ed2becb84b58363b&quot;&gt;
this one&lt;/a&gt;. Looks like it was introduced to make sure sum
returned zero when getting empty results from the database.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/rails/rails/commit/604a58807eeb5d6e162678b7c79fe7a56a79fa24&quot;&gt;
Your one&lt;/a&gt; was introduced to fix the first one typecasting to
integer.&lt;/p&gt;
&lt;p&gt;The way I've handled this in the past in my own apps is to add a
to_d method to NilClass, Fixnum, BigDecimal and Bignum and then
just call to_d on the result of the sum method. This way it doesn't
matter if there are no items in the sum result set.&lt;/p&gt;
&lt;p&gt;The problem with type casting to float for decimal columns and
then back to decimal is that you may introduce floating point
precision errors. My view would be that if we are doing a
straightforward sum on a column then typecast to that column's type
otherwise return a string and leave it to the developer to cast to
whatever they want. This would also apply to average as well.&lt;/p&gt;
&lt;p&gt;As for edge, it has exactly the same behaviour.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-09-25T06:52:22+01:00</created-at>
      <creator-id type="integer">8621</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">17920</milestone-id>
      <number type="integer">1066</number>
      <permalink>associationssum-no-longer-returns-a-bigdecimal</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>&quot;2.1.1&quot; activerecord bug patch</tag>
      <title>Associations#sum no longer returns a BigDecimal</title>
      <updated-at type="datetime">2008-09-25T06:52:24+01:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">9</version>
      <user-name>Andrew White</user-name>
      <creator-name>crafterm</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1066</url>
      <milestone-title>2.1.2</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>OK, 

so we need a fix for this as it's blocking 2.1.2, or it could always slip to 2.1.3.

Any volunteers to fix up the typecasting and nil handling?</body>
      <body-html>&lt;div&gt;&lt;p&gt;OK,&lt;/p&gt;
&lt;p&gt;so we need a fix for this as it's blocking 2.1.2, or it could
always slip to 2.1.3.&lt;/p&gt;
&lt;p&gt;Any volunteers to fix up the typecasting and nil handling?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-09-26T17:34:47+01:00</created-at>
      <creator-id type="integer">8621</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">17920</milestone-id>
      <number type="integer">1066</number>
      <permalink>associationssum-no-longer-returns-a-bigdecimal</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>&quot;2.1.1&quot; activerecord bug patch</tag>
      <title>Associations#sum no longer returns a BigDecimal</title>
      <updated-at type="datetime">2008-09-26T17:34:51+01:00</updated-at>
      <user-id type="integer">141</user-id>
      <version type="integer">10</version>
      <user-name>Michael Koziarski</user-name>
      <creator-name>crafterm</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1066</url>
      <milestone-title>2.1.2</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>(from [78feaf6be75a5fcb766a7d1dcedd52e890561081]) Ensure Model.sum and Model.avg typecast appropriately. [#1066 state:resolved]

Model.sum delegates typecasting to the column being summed. If that's not feasible, returns a string.
Model.avg always returns big decimal.
http://github.com/rails/rails/commit/78feaf6be75a5fcb766a7d1dcedd52e890561081</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from [78feaf6be75a5fcb766a7d1dcedd52e890561081]) Ensure
Model.sum and Model.avg typecast appropriately. [&lt;a href=&quot;/projects/8994/tickets/1066&quot; title=&quot;Ticket #1066&quot;&gt;#1066&lt;/a&gt;
state:resolved]&lt;/p&gt;
&lt;p&gt;Model.sum delegates typecasting to the column being summed. If
that's not feasible, returns a string. Model.avg always returns big
decimal. &lt;a href=&quot;http://github.com/rails/rails/commit/78feaf6be75a5fcb766a7d1dcedd52e890561081&quot;&gt;
http://github.com/rails/rails/co...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-10-04T20:12:20+01:00</created-at>
      <creator-id type="integer">8621</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer">17920</milestone-id>
      <number type="integer">1066</number>
      <permalink>associationssum-no-longer-returns-a-bigdecimal</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>&quot;2.1.1&quot; activerecord bug patch</tag>
      <title>Associations#sum no longer returns a BigDecimal</title>
      <updated-at type="datetime">2008-10-04T20:12:22+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">11</version>
      <user-name>Repository</user-name>
      <creator-name>crafterm</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1066</url>
      <milestone-title>2.1.2</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>(from [9599948fbcd67c1c2c5fecc2dca148e998479e33]) Ensure Model.sum and Model.avg typecast appropriately. [#1066 state:resolved]

Model.sum delegates typecasting to the column being summed. If that's not feasible, returns a string.
Model.avg always returns big decimal.
http://github.com/rails/rails/commit/9599948fbcd67c1c2c5fecc2dca148e998479e33</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from [9599948fbcd67c1c2c5fecc2dca148e998479e33]) Ensure
Model.sum and Model.avg typecast appropriately. [&lt;a href=&quot;/projects/8994/tickets/1066&quot; title=&quot;Ticket #1066&quot;&gt;#1066&lt;/a&gt;
state:resolved]&lt;/p&gt;
&lt;p&gt;Model.sum delegates typecasting to the column being summed. If
that's not feasible, returns a string. Model.avg always returns big
decimal. &lt;a href=&quot;http://github.com/rails/rails/commit/9599948fbcd67c1c2c5fecc2dca148e998479e33&quot;&gt;
http://github.com/rails/rails/co...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-10-04T20:14:26+01:00</created-at>
      <creator-id type="integer">8621</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">17920</milestone-id>
      <number type="integer">1066</number>
      <permalink>associationssum-no-longer-returns-a-bigdecimal</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>&quot;2.1.1&quot; activerecord bug patch</tag>
      <title>Associations#sum no longer returns a BigDecimal</title>
      <updated-at type="datetime">2008-10-04T20:14:29+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">12</version>
      <user-name>Repository</user-name>
      <creator-name>crafterm</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1066</url>
      <milestone-title>2.1.2</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>ec4f5beeae1932e15ffe0f30026df51e8455d640</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2008-09-18T08:40:29+01:00</created-at>
      <filename>0001-Ensure-that-Calculations-sum-avg-return-BigDecimal-i.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">46795</id>
      <size type="integer">2157</size>
      <uploader-id type="integer">8621</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/46795/0001-Ensure-that-Calculations-sum-avg-return-BigDecimal-i.patch</url>
    </attachment>
  </attachments>
</ticket>
