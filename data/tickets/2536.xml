<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">19965</assigned-user-id>
  <attachments-count type="integer">0</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-04-21T15:47:48+01:00</created-at>
  <creator-id type="integer">13081</creator-id>
  <milestone-due-on type="datetime">2010-11-15T00:00:00+00:00</milestone-due-on>
  <milestone-id type="integer">88038</milestone-id>
  <number type="integer">2536</number>
  <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
  <priority type="integer">1679</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>committed</state>
  <tag>format routes routing</tag>
  <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
  <updated-at type="datetime">2010-10-15T23:01:31+01:00</updated-at>
  <user-id type="integer">85</user-id>
  <version type="integer">24</version>
  <user-name>Jeremy Kemper</user-name>
  <creator-name>Tyler Jennings</creator-name>
  <assigned-user-name>Jos&#233; Valim</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
  <milestone-title>3.0.2</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>Section 3.3 (http://www.ietf.org/rfc/rfc1738.txt): 

*&quot;Within the &lt;path&gt; and &lt;searchpart&gt; components, &quot;/&quot;, &quot;;&quot;, &quot;?&quot; are reserved.  The &quot;/&quot; character may be used within HTTP to designate a hierarchical structure.&quot;*

&quot;.&quot; is not a reserved character in the path component of an http schemed url, however Rails treats it as such by default.  

I have a requirement to include &quot;.&quot; in url path segments that is compliant with the rfc, but doesn't work in Rails.

A mechanism to turn this feature off both globally and on a per-route basis to achieve compliance when needed would be useful.

You can work around this problem by specifying your own :requirements hash for the path segments in a url that will contain &quot;.&quot;, but this has other implications. Example: 

@@@ ruby
map.manual_models '/owner_manuals/:brand/:type', :controller =&gt; 'owner_manuals', :action =&gt; 'list', :requirements =&gt; { :brand =&gt; /([^\/?]+)/, :type =&gt; /([^\/?]+)/ }
@@@

Specifying :requirements for a route does two things:  First, it checks arguments to url generating functions and throws an exception if the arguments do not match the regex.  Second, it changes the route recognition to use the provided regex for a path segment instead of the default.  The second behavior is the &quot;fix&quot;, but the first causes issues in this context.

The smallest regex you can use with :requirements that will not break normal parsing for other path segments is /[^\/?]/.  Now you can use &quot;.&quot; freely, but the special characters &quot;/&quot; and &quot;?&quot; are not allowed.

I took a look under the hood and it appears this could mean some significant changes to the routing code.  I wanted to get everyone's thoughts before I attempted to work up a solution.</original-body>
  <latest-body>Section 3.3 (http://www.ietf.org/rfc/rfc1738.txt): 

*&quot;Within the &lt;path&gt; and &lt;searchpart&gt; components, &quot;/&quot;, &quot;;&quot;, &quot;?&quot; are reserved.  The &quot;/&quot; character may be used within HTTP to designate a hierarchical structure.&quot;*

&quot;.&quot; is not a reserved character in the path component of an http schemed url, however Rails treats it as such by default.  

I have a requirement to include &quot;.&quot; in url path segments that is compliant with the rfc, but doesn't work in Rails.

A mechanism to turn this feature off both globally and on a per-route basis to achieve compliance when needed would be useful.

You can work around this problem by specifying your own :requirements hash for the path segments in a url that will contain &quot;.&quot;, but this has other implications. Example: 

@@@ ruby
map.manual_models '/owner_manuals/:brand/:type', :controller =&gt; 'owner_manuals', :action =&gt; 'list', :requirements =&gt; { :brand =&gt; /([^\/?]+)/, :type =&gt; /([^\/?]+)/ }
@@@

Specifying :requirements for a route does two things:  First, it checks arguments to url generating functions and throws an exception if the arguments do not match the regex.  Second, it changes the route recognition to use the provided regex for a path segment instead of the default.  The second behavior is the &quot;fix&quot;, but the first causes issues in this context.

The smallest regex you can use with :requirements that will not break normal parsing for other path segments is /[^\/?]/.  Now you can use &quot;.&quot; freely, but the special characters &quot;/&quot; and &quot;?&quot; are not allowed.

I took a look under the hood and it appears this could mean some significant changes to the routing code.  I wanted to get everyone's thoughts before I attempted to work up a solution.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;Section 3.3 (&lt;a href=&quot;http://www.ietf.org/rfc/rfc1738.txt)&quot;&gt;http://www.ietf.org/rfc/rfc1738....&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&quot;Within the and components, &quot;/&quot;, &quot;;&quot;, &quot;?&quot; are reserved. The
&quot;/&quot; character may be used within HTTP to designate a hierarchical
structure.&quot;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&quot;.&quot; is not a reserved character in the path component of an http
schemed url, however Rails treats it as such by default.&lt;br&gt;&lt;/p&gt;
&lt;p&gt;I have a requirement to include &quot;.&quot; in url path segments that is
compliant with the rfc, but doesn't work in Rails.&lt;/p&gt;
&lt;p&gt;A mechanism to turn this feature off both globally and on a
per-route basis to achieve compliance when needed would be
useful.&lt;/p&gt;
&lt;p&gt;You can work around this problem by specifying your own
:requirements hash for the path segments in a url that will contain
&quot;.&quot;, but this has other implications. Example:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
map.manual_models '/owner_manuals/:brand/:type', :controller =&amp;gt; 'owner_manuals', :action =&amp;gt; 'list', :requirements =&amp;gt; { :brand =&amp;gt; /([^\/?]+)/, :type =&amp;gt; /([^\/?]+)/ }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Specifying :requirements for a route does two things: First, it
checks arguments to url generating functions and throws an
exception if the arguments do not match the regex. Second, it
changes the route recognition to use the provided regex for a path
segment instead of the default. The second behavior is the &quot;fix&quot;,
but the first causes issues in this context.&lt;/p&gt;
&lt;p&gt;The smallest regex you can use with :requirements that will not
break normal parsing for other path segments is /[^\/?]/. Now you
can use &quot;.&quot; freely, but the special characters &quot;/&quot; and &quot;?&quot; are not
allowed.&lt;/p&gt;
&lt;p&gt;I took a look under the hood and it appears this could mean some
significant changes to the routing code. I wanted to get everyone's
thoughts before I attempted to work up a solution.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Section 3.3 http://www.ietf.org/rfc/rfc1738.txt: 

*&quot;Within the path and searchpart components, &quot;/&quot;, &quot;;&quot;, &quot;?&quot; are reserved.  The &quot;/&quot; character may be used within HTTP to designate a hierarchical structure.&quot;*

&quot;.&quot; is not a reserved character in the path component of an http schemed url, however Rails treats it as such by default.  

I have a requirement to include &quot;.&quot; in url path segments that is compliant with the rfc, but doesn't work in Rails.

A mechanism to turn this feature off both globally and on a per-route basis to achieve compliance when needed would be useful.

You can work around this problem by specifying your own :requirements hash for the path segments in a url that will contain &quot;.&quot;, but this has other implications. Example: 

@@@ ruby
map.manual_models '/owner_manuals/:brand/:type', :controller =&gt; 'owner_manuals', :action =&gt; 'list', :requirements =&gt; { :brand =&gt; /([^\/?]+)/, :type =&gt; /([^\/?]+)/ }
@@@

Specifying :requirements for a route does two things:  First, it checks arguments to url generating functions and throws an exception if the arguments do not match the regex.  Second, it changes the route recognition to use the provided regex for a path segment instead of the default.  The second behavior is the &quot;fix&quot;, but the first causes issues in this context.

The smallest regex you can use with :requirements that will not break normal parsing for other path segments is /[^\/?]/.  Now you can use &quot;.&quot; freely, but the special characters &quot;/&quot; and &quot;?&quot; are not allowed.

I took a look under the hood and it appears this could mean some significant changes to the routing code.  I wanted to get everyone's thoughts before I attempted to work up a solution.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Section 3.3 &lt;a href=&quot;http://www.ietf.org/rfc/rfc1738.txt&quot;&gt;http://www.ietf.org/rfc/rfc1738.txt&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&quot;Within the path and searchpart components, &quot;/&quot;, &quot;;&quot;, &quot;?&quot;
are reserved. The &quot;/&quot; character may be used within HTTP to
designate a hierarchical structure.&quot;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&quot;.&quot; is not a reserved character in the path component of an http
schemed url, however Rails treats it as such by default.&lt;br&gt;&lt;/p&gt;
&lt;p&gt;I have a requirement to include &quot;.&quot; in url path segments that is
compliant with the rfc, but doesn't work in Rails.&lt;/p&gt;
&lt;p&gt;A mechanism to turn this feature off both globally and on a
per-route basis to achieve compliance when needed would be
useful.&lt;/p&gt;
&lt;p&gt;You can work around this problem by specifying your own
:requirements hash for the path segments in a url that will contain
&quot;.&quot;, but this has other implications. Example:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
map.manual_models '/owner_manuals/:brand/:type', :controller =&amp;gt; 'owner_manuals', :action =&amp;gt; 'list', :requirements =&amp;gt; { :brand =&amp;gt; /([^\/?]+)/, :type =&amp;gt; /([^\/?]+)/ }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Specifying :requirements for a route does two things: First, it
checks arguments to url generating functions and throws an
exception if the arguments do not match the regex. Second, it
changes the route recognition to use the provided regex for a path
segment instead of the default. The second behavior is the &quot;fix&quot;,
but the first causes issues in this context.&lt;/p&gt;
&lt;p&gt;The smallest regex you can use with :requirements that will not
break normal parsing for other path segments is /[^\/?]/. Now you
can use &quot;.&quot; freely, but the special characters &quot;/&quot; and &quot;?&quot; are not
allowed.&lt;/p&gt;
&lt;p&gt;I took a look under the hood and it appears this could mean some
significant changes to the routing code. I wanted to get everyone's
thoughts before I attempted to work up a solution.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-21T15:47:48+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-04-21T15:50:54+01:00</updated-at>
      <user-id type="integer">13081</user-id>
      <version type="integer">1</version>
      <user-name>Tyler Jennings</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>lighthouse ate my rfc url and I can't seem to edit the ticket.  Here is the link: http://www.ietf.org/rfc/rfc1738.txt</body>
      <body-html>&lt;div&gt;&lt;p&gt;lighthouse ate my rfc url and I can't seem to edit the ticket.
Here is the link: &lt;a href=&quot;http://www.ietf.org/rfc/rfc1738.txt&quot;&gt;http://www.ietf.org/rfc/rfc1738.txt&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-21T15:49:36+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-04-21T15:49:41+01:00</updated-at>
      <user-id type="integer">13081</user-id>
      <version type="integer">2</version>
      <user-name>Tyler Jennings</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>+1</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-21T17:40:05+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-04-21T17:40:09+01:00</updated-at>
      <user-id type="integer">10008</user-id>
      <version type="integer">3</version>
      <user-name>Dave Hoover</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>+1

I've found this particularly annoying when trying to define routes for a versioned api.  /api/1.2/foos.json</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;
&lt;p&gt;I've found this particularly annoying when trying to define
routes for a versioned api. /api/1.2/foos.json&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-21T18:17:40+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-04-21T18:17:45+01:00</updated-at>
      <user-id type="integer">43512</user-id>
      <version type="integer">4</version>
      <user-name>Joe Banks</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>+1 -- Rails shouldn't stumble over routes involving/user.names/with/dots, for example.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 -- Rails shouldn't stumble over routes
involving/user.names/with/dots, for example.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-21T19:36:30+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-04-21T19:36:35+01:00</updated-at>
      <user-id type="integer">54761</user-id>
      <version type="integer">5</version>
      <user-name>Ryan Platte</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>+1</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-22T14:31:33+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-04-22T14:31:38+01:00</updated-at>
      <user-id type="integer">45541</user-id>
      <version type="integer">6</version>
      <user-name>Jake Scruggs</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>+1 

Even if the '.' was restricted to the last segment before the query string for format determination, I'd be happy. 

What are other peoples' thoughts on the form that the &quot;fix&quot; for this should take?</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;
&lt;p&gt;Even if the '.' was restricted to the last segment before the
query string for format determination, I'd be happy.&lt;/p&gt;
&lt;p&gt;What are other peoples' thoughts on the form that the &quot;fix&quot; for
this should take?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-22T14:55:17+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-04-22T14:55:21+01:00</updated-at>
      <user-id type="integer">21359</user-id>
      <version type="integer">7</version>
      <user-name>Ryan Kinderman</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-06T14:06:30+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: format routes routing
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-08-06T14:06:32+01:00</updated-at>
      <user-id type="integer">7211</user-id>
      <version type="integer">8</version>
      <user-name>CancelProfileIsBroken</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>+1

i wouldn't add dots in resources, so this leaves:
* namespaces
* named routes
* identifiers (ex. name.lastname)
where the controller can still be given without the use of dots.

the named routes containing dots are no problem

the namespaces are, because there's metaprogramming magic: when the routeset is created, a method hash_for_x_route_path is dynamically defined, and if x contains a dot, this makes for an error.  Maybe exchanging the '.' for something else would help, though this would obviously need to be researched carefully.

identifiers, if they are at the end of the url, also are a problem, since they can be mixed up with formats.  This is difficult to solve.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;
&lt;p&gt;i wouldn't add dots in resources, so this leaves:&lt;br&gt;
* namespaces * named routes * identifiers (ex. name.lastname) where
the controller can still be given without the use of dots.&lt;/p&gt;
&lt;p&gt;the named routes containing dots are no problem&lt;/p&gt;
&lt;p&gt;the namespaces are, because there's metaprogramming magic: when
the routeset is created, a method hash_for_x_route_path is
dynamically defined, and if x contains a dot, this makes for an
error. Maybe exchanging the '.' for something else would help,
though this would obviously need to be researched carefully.&lt;/p&gt;
&lt;p&gt;identifiers, if they are at the end of the url, also are a
problem, since they can be mixed up with formats. This is difficult
to solve.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-09T15:13:17+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-08-09T15:13:21+01:00</updated-at>
      <user-id type="integer">36650</user-id>
      <version type="integer">9</version>
      <user-name>Elise Huard</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>+1 was beating around that bush for a long time with api version urls.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 was beating around that bush for a long time with api version
urls.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-09T15:31:57+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-08-09T15:31:59+01:00</updated-at>
      <user-id type="integer">10379</user-id>
      <version type="integer">10</version>
      <user-name>Elad Meidar</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>+1, on account of having head-desk moments trying to figure out why a route wasn't working, only to have there be a '.' in a param somewhere.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1, on account of having head-desk moments trying to figure out
why a route wasn't working, only to have there be a '.' in a param
somewhere.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-10T04:08:24+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-08-10T04:08:29+01:00</updated-at>
      <user-id type="integer">10504</user-id>
      <version type="integer">11</version>
      <user-name>Josh Nichols</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>+1

Worthwhile fix.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;
&lt;p&gt;Worthwhile fix.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-27T19:05:39+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-09-27T19:05:44+01:00</updated-at>
      <user-id type="integer">71135</user-id>
      <version type="integer">12</version>
      <user-name>Blue Box Jesse</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>+1

I've had a few surprises trying to use version numbers in resource urls in the past.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;
&lt;p&gt;I've had a few surprises trying to use version numbers in
resource urls in the past.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-27T19:15:32+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-09-27T19:15:35+01:00</updated-at>
      <user-id type="integer">71121</user-id>
      <version type="integer">13</version>
      <user-name>sr.iniv.t</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>+1 
Particularly for version numbers and usernames</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 Particularly for version numbers and usernames&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-28T00:58:13+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-09-28T01:07:12+01:00</updated-at>
      <user-id type="integer">15704</user-id>
      <version type="integer">14</version>
      <user-name>Gaius Centus Novus</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>It does, however, raise some hard questions. What are you going to do with the following?

    /people/I.really.love.xml
    /gems/shoulda/versions/1.2
    /tags/ASP.Net</body>
      <body-html>&lt;div&gt;&lt;p&gt;It does, however, raise some hard questions. What are you going
to do with the following?&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;/people/I.really.love.xml
/gems/shoulda/versions/1.2
/tags/ASP.Net&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-28T01:01:39+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-09-28T01:07:20+01:00</updated-at>
      <user-id type="integer">15704</user-id>
      <version type="integer">15</version>
      <user-name>Gaius Centus Novus</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>+1
It would be nice for this to work by default without configuration.

The .:format feature should be configurable by setting a list of formats.  I don't see any advantages to having an unlimited and dynamic list of formats.  Most people will only use a few formats.

For example the following route:

@@@
map.connect &quot;/users/:full_name&quot;, :controller =&gt; &quot;users&quot;, :action =&gt; &quot;show&quot;
@@@

By default, the URL &quot;/users/mike.enriquez&quot; would be recognized and would set params[:full_name] to &quot;mike.enriquez&quot;.  If the .:format feature has the format &quot;enriquez&quot; configured in the list of formats, then the same URL would set params[:format] to &quot;enriquez&quot;.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 It would be nice for this to work by default without
configuration.&lt;/p&gt;
&lt;p&gt;The .:format feature should be configurable by setting a list of
formats. I don't see any advantages to having an unlimited and
dynamic list of formats. Most people will only use a few
formats.&lt;/p&gt;
&lt;p&gt;For example the following route:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;map.connect &quot;/users/:full_name&quot;, :controller =&amp;gt; &quot;users&quot;, :action =&amp;gt; &quot;show&quot;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;By default, the URL &quot;/users/mike.enriquez&quot; would be recognized
and would set params[:full_name] to &quot;mike.enriquez&quot;. If the
.:format feature has the format &quot;enriquez&quot; configured in the list
of formats, then the same URL would set params[:format] to
&quot;enriquez&quot;.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-28T08:23:58+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-09-28T08:24:01+01:00</updated-at>
      <user-id type="integer">46426</user-id>
      <version type="integer">16</version>
      <user-name>Mike Enriquez</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>+1

I had issues with that, too.

Gaius: I think Mikes idea of restricting the matched formats to the configured ones could be a good default. But a malicious user could set his username to &quot;johndoe.xml&quot; which would break some routes. This should be handled by validation of the username.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;
&lt;p&gt;I had issues with that, too.&lt;/p&gt;
&lt;p&gt;Gaius: I think Mikes idea of restricting the matched formats to
the configured ones could be a good default. But a malicious user
could set his username to &quot;johndoe.xml&quot; which would break some
routes. This should be handled by validation of the username.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-10-09T12:27:06+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2009-10-09T12:32:44+01:00</updated-at>
      <user-id type="integer">38348</user-id>
      <version type="integer">17</version>
      <user-name>Christopher Hlubek</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/13645)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/13645&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-02-12T12:46:14+00:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: bugmash format routes routing
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2010-02-12T12:46:14+00:00</updated-at>
      <user-id type="integer">65556</user-id>
      <version type="integer">18</version>
      <user-name>Rizwan Reza</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>+1 because the behavior of :requirements actually makes my scenario impossible. Admittedly, my scenario is a little weird. Basically, I want to allow urls like:

@@@
/foos/bar.html # =&gt; :id =&gt; &quot;bar&quot;, :format =&gt; &quot;html&quot;
/foos/bar.html.html # =&gt; :id =&gt; &quot;bar.html&quot;, :format =&gt; &quot;html&quot;
/foos/bar.html.xml # =&gt; :id =&gt; &quot;bar.html&quot;, :format =&gt; &quot;xml&quot;
@@@

You can achieve *routing* of URLs with an `:id` requirements regexp like `/([^\?\/](?!(xml|html)(?!\.(xml|html))))+/`, but because route *generation* uses the same regexp, it can't tell that args like `:id =&gt; &quot;foobar.html&quot;, :format =&gt; &quot;xml&quot;` are perfectly valid.

Ideally, you could say something like

@@@
map.resources :foos,
  :parse =&gt; {:id =&gt; /([^\?\/](?!(xml|html)(?!\.(xml|html))))+/},
  :requirements =&gt; {:id =&gt; /[^\?\/]+/}
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 because the behavior of :requirements actually makes my
scenario impossible. Admittedly, my scenario is a little weird.
Basically, I want to allow urls like:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;/foos/bar.html # =&amp;gt; :id =&amp;gt; &quot;bar&quot;, :format =&amp;gt; &quot;html&quot;
/foos/bar.html.html # =&amp;gt; :id =&amp;gt; &quot;bar.html&quot;, :format =&amp;gt; &quot;html&quot;
/foos/bar.html.xml # =&amp;gt; :id =&amp;gt; &quot;bar.html&quot;, :format =&amp;gt; &quot;xml&quot;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;You can achieve &lt;em&gt;routing&lt;/em&gt; of URLs with an
&lt;code&gt;:id&lt;/code&gt; requirements regexp like
&lt;code&gt;/([^\?\/](?!(xml|html)(?!\.(xml|html))))+/&lt;/code&gt;, but
because route &lt;em&gt;generation&lt;/em&gt; uses the same regexp, it can't
tell that args like &lt;code&gt;:id =&amp;gt; &quot;foobar.html&quot;, :format =&amp;gt;
&quot;xml&quot;&lt;/code&gt; are perfectly valid.&lt;/p&gt;
&lt;p&gt;Ideally, you could say something like&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;map.resources :foos,
  :parse =&amp;gt; {:id =&amp;gt; /([^\?\/](?!(xml|html)(?!\.(xml|html))))+/},
  :requirements =&amp;gt; {:id =&amp;gt; /[^\?\/]+/}&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-14T18:54:43+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2010-04-14T18:54:48+01:00</updated-at>
      <user-id type="integer">73137</user-id>
      <version type="integer">19</version>
      <user-name>Ian</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/19097)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/19097&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-04T18:48:47+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 9903
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2010-05-04T18:48:47+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">20</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I've had a good go at fixing this today and I've determined that's it's not possible to do it in such a way that works well for the general case. The main stumbling block is that if the :id parameter can take a period then there's no easy way without hinting to tell the format apart from the id.

However if I can get [this commit](http://github.com/pixeltrix/rack-mount/commit/adaa86944f50a839aef4e031be9ab6326fde2e50) applied to rack-mount you can work around it easily enough, e.g:

@@@ ruby
  namespace :api do
    scope(':version', :version =&gt; /.+/) do
      resources :users, :id =&gt; /.+?/, :format =&gt; /json|xml/
    end
  end
@@@

Ian, you'd be able to do the following to get what you want:

@@@ ruby
  resources :foos, :id =&gt; /.+?/, :format =&gt; /html|xml/
@@@

I think this would be a satisfactory solution</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've had a good go at fixing this today and I've determined
that's it's not possible to do it in such a way that works well for
the general case. The main stumbling block is that if the :id
parameter can take a period then there's no easy way without
hinting to tell the format apart from the id.&lt;/p&gt;
&lt;p&gt;However if I can get &lt;a href=
&quot;http://github.com/pixeltrix/rack-mount/commit/adaa86944f50a839aef4e031be9ab6326fde2e50&quot;&gt;
this commit&lt;/a&gt; applied to rack-mount you can work around it easily
enough, e.g:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;  namespace :api do
    scope(':version', :version =&amp;gt; /.+/) do
      resources :users, :id =&amp;gt; /.+?/, :format =&amp;gt; /json|xml/
    end
  end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Ian, you'd be able to do the following to get what you want:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=
&quot;ruby&quot;&gt;  resources :foos, :id =&amp;gt; /.+?/, :format =&amp;gt; /html|xml/&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;I think this would be a satisfactory solution&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-25T12:31:56+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2010-06-25T12:32:06+01:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">21</version>
      <user-name>Andrew White</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Tests to make sure the above solution can work
Patch inline as uploads aren't working

@@@
From 01510e1a8edae61955c6112a33fb103f0507395e Mon Sep 17 00:00:00 2001
From: Andrew White &lt;andyw@pixeltrix.co.uk&gt;
Date: Fri, 25 Jun 2010 12:16:43 +0100
Subject: [PATCH] Add failing test case for parameters with periods

---
 actionpack/test/dispatch/routing_test.rb |   27 +++++++++++++++++++++++++++
 1 files changed, 27 insertions(+), 0 deletions(-)

diff --git a/actionpack/test/dispatch/routing_test.rb b/actionpack/test/dispatch/routing_test.rb
index 8f43b5f..915c51a 100644
--- a/actionpack/test/dispatch/routing_test.rb
+++ b/actionpack/test/dispatch/routing_test.rb
@@ -213,6 +213,9 @@ class TestRoutingMapper &lt; ActionDispatch::IntegrationTest
           get &quot;profile&quot; =&gt; &quot;customers#profile&quot;, :as =&gt; :profile, :on =&gt; :member
           post &quot;preview&quot; =&gt; &quot;customers#preview&quot;, :as =&gt; :preview, :on =&gt; :new
         end
+        scope(':version', :version =&gt; /.+/) do
+          resources :users, :id =&gt; /.+?/, :format =&gt; /json|xml/
+        end
       end
 
       match 'sprockets.js' =&gt; ::TestRoutingMapper::SprocketsApp
@@ -1421,6 +1424,30 @@ class TestRoutingMapper &lt; ActionDispatch::IntegrationTest
     end
   end
 
+  def test_non_greedy_regexp
+    with_test_routes do
+      get '/api/1.0/users'
+      assert_equal 'api/users#index', @response.body
+      assert_equal '/api/1.0/users', api_users_path(:version =&gt; '1.0')
+
+      get '/api/1.0/users.json'
+      assert_equal 'api/users#index', @response.body
+      assert_equal true, @request.format.json?
+      assert_equal '/api/1.0/users.json', api_users_path(:version =&gt; '1.0', :format =&gt; :json)
+
+      get '/api/1.0/users/first.last'
+      assert_equal 'api/users#show', @response.body
+      assert_equal 'first.last', @request.params[:id]
+      assert_equal '/api/1.0/users/first.last', api_user_path(:version =&gt; '1.0', :id =&gt; 'first.last')
+
+      get '/api/1.0/users/first.last.xml'
+      assert_equal 'api/users#show', @response.body
+      assert_equal 'first.last', @request.params[:id]
+      assert_equal true, @request.format.xml?
+      assert_equal '/api/1.0/users/first.last.xml', api_user_path(:version =&gt; '1.0', :id =&gt; 'first.last', :format =&gt; :xml)
+    end
+  end
+
   private
     def with_test_routes
       yield
-- 
1.7.1

@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;Tests to make sure the above solution can work&lt;br&gt;
Patch inline as uploads aren't working&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;From 01510e1a8edae61955c6112a33fb103f0507395e Mon Sep 17 00:00:00 2001
From: Andrew White &amp;lt;andyw@pixeltrix.co.uk&amp;gt;
Date: Fri, 25 Jun 2010 12:16:43 +0100
Subject: [PATCH] Add failing test case for parameters with periods

---
 actionpack/test/dispatch/routing_test.rb |   27 +++++++++++++++++++++++++++
 1 files changed, 27 insertions(+), 0 deletions(-)

diff --git a/actionpack/test/dispatch/routing_test.rb b/actionpack/test/dispatch/routing_test.rb
index 8f43b5f..915c51a 100644
--- a/actionpack/test/dispatch/routing_test.rb
+++ b/actionpack/test/dispatch/routing_test.rb
@@ -213,6 +213,9 @@ class TestRoutingMapper &amp;lt; ActionDispatch::IntegrationTest
           get &quot;profile&quot; =&amp;gt; &quot;customers#profile&quot;, :as =&amp;gt; :profile, :on =&amp;gt; :member
           post &quot;preview&quot; =&amp;gt; &quot;customers#preview&quot;, :as =&amp;gt; :preview, :on =&amp;gt; :new
         end
+        scope(':version', :version =&amp;gt; /.+/) do
+          resources :users, :id =&amp;gt; /.+?/, :format =&amp;gt; /json|xml/
+        end
       end
 
       match 'sprockets.js' =&amp;gt; ::TestRoutingMapper::SprocketsApp
@@ -1421,6 +1424,30 @@ class TestRoutingMapper &amp;lt; ActionDispatch::IntegrationTest
     end
   end
 
+  def test_non_greedy_regexp
+    with_test_routes do
+      get '/api/1.0/users'
+      assert_equal 'api/users#index', @response.body
+      assert_equal '/api/1.0/users', api_users_path(:version =&amp;gt; '1.0')
+
+      get '/api/1.0/users.json'
+      assert_equal 'api/users#index', @response.body
+      assert_equal true, @request.format.json?
+      assert_equal '/api/1.0/users.json', api_users_path(:version =&amp;gt; '1.0', :format =&amp;gt; :json)
+
+      get '/api/1.0/users/first.last'
+      assert_equal 'api/users#show', @response.body
+      assert_equal 'first.last', @request.params[:id]
+      assert_equal '/api/1.0/users/first.last', api_user_path(:version =&amp;gt; '1.0', :id =&amp;gt; 'first.last')
+
+      get '/api/1.0/users/first.last.xml'
+      assert_equal 'api/users#show', @response.body
+      assert_equal 'first.last', @request.params[:id]
+      assert_equal true, @request.format.xml?
+      assert_equal '/api/1.0/users/first.last.xml', api_user_path(:version =&amp;gt; '1.0', :id =&amp;gt; 'first.last', :format =&amp;gt; :xml)
+    end
+  end
+
   private
     def with_test_routes
       yield
-- 
1.7.1&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-25T17:31:55+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 71472
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2010-06-25T17:32:07+01:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">22</version>
      <user-name>Andrew White</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-06-25T23:29:21+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2010-06-25T23:29:38+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">23</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/31647)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/31647&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-10-15T23:01:31+01:00</created-at>
      <creator-id type="integer">13081</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
:milestone: 74033
</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">2536</number>
      <permalink>format-feature-breaks-url-compliance-rfc1738-should-be-optional</permalink>
      <priority type="integer">1679</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>format routes routing</tag>
      <title>.:format feature breaks URL compliance (rfc1738) - should be optional</title>
      <updated-at type="datetime">2010-10-15T23:01:31+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">24</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Tyler Jennings</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2536</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
</ticket>
