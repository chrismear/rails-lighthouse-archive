<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">1366</assigned-user-id>
  <attachments-count type="integer">2</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-02-27T11:44:41+00:00</created-at>
  <creator-id type="integer">48772</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">9903</milestone-id>
  <number type="integer">2093</number>
  <permalink>session-cookie-appearing-in-content</permalink>
  <priority type="integer">1319</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>invalid</state>
  <tag>2.3-rc1 2.3.0 rack session</tag>
  <title>Session-Cookie appearing in content</title>
  <updated-at type="datetime">2009-03-08T12:01:15+00:00</updated-at>
  <user-id type="integer">1366</user-id>
  <version type="integer">9</version>
  <user-name>Pratik</user-name>
  <creator-name>Tobsch</creator-name>
  <assigned-user-name>Pratik</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/2093</url>
  <milestone-title>2.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>Hi there,

I have a problem with session cookies appearing in the content (on beginning of html output). like this:
Set-Cookie: _wgspion_session=BAh7CjoPc2Vzc2lvbl9pZCIlY2FlOTg0YWY5M2FkNmI5Zjc2MmQ4OGQyMDgyM2EyYzQ6D3RyYWNrZWRfaXBUOgx1c2VyX2lkaQL6HCIKZmxhc2hJQzonQWN0aW9uQ29udHJvbGxlcjo6Rmxhc2g6OkZsYXNoSGFzaHsGOgplcnJvciIWZmxhc2gubG9naW4uZXJyb3IGOgpAdXNlZHsGOwlUOgljaXR5IgxIYW1idXJn--b3e3d16abded5ecf6612e1ff9e9c2afab4d85e66; path=/; HttpOnly

Its the latest Edge.
I'm using Rack 0.9.0, the newest mod_rails and apache 2.

Best,

Tobias</original-body>
  <latest-body>Hi there,

I have a problem with session cookies appearing in the content (on beginning of html output). like this:
Set-Cookie: _wgspion_session=BAh7CjoPc2Vzc2lvbl9pZCIlY2FlOTg0YWY5M2FkNmI5Zjc2MmQ4OGQyMDgyM2EyYzQ6D3RyYWNrZWRfaXBUOgx1c2VyX2lkaQL6HCIKZmxhc2hJQzonQWN0aW9uQ29udHJvbGxlcjo6Rmxhc2g6OkZsYXNoSGFzaHsGOgplcnJvciIWZmxhc2gubG9naW4uZXJyb3IGOgpAdXNlZHsGOwlUOgljaXR5IgxIYW1idXJn--b3e3d16abded5ecf6612e1ff9e9c2afab4d85e66; path=/; HttpOnly

Its the latest Edge.
I'm using Rack 0.9.0, the newest mod_rails and apache 2.

Best,

Tobias</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;Hi there,&lt;/p&gt;
&lt;p&gt;I have a problem with session cookies appearing in the content
(on beginning of html output). like this: Set-Cookie:
_wgspion_session=BAh7CjoPc2Vzc2lvbl9pZCIlY2FlOTg0YWY5M2FkNmI5Zjc2MmQ4OGQyMDgyM2EyYzQ6D3RyYWNrZWRfaXBUOgx1c2VyX2lkaQL6HCIKZmxhc2hJQzonQWN0aW9uQ29udHJvbGxlcjo6Rmxhc2g6OkZsYXNoSGFzaHsGOgplcnJvciIWZmxhc2gubG9naW4uZXJyb3IGOgpAdXNlZHsGOwlUOgljaXR5IgxIYW1idXJn--b3e3d16abded5ecf6612e1ff9e9c2afab4d85e66;
path=/; HttpOnly&lt;/p&gt;
&lt;p&gt;Its the latest Edge. I'm using Rack 0.9.0, the newest mod_rails
and apache 2.&lt;/p&gt;
&lt;p&gt;Best,&lt;/p&gt;
&lt;p&gt;Tobias&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Hi there,

I have a problem with session cookies appearing in the content (on beginning of html output). like this:
Set-Cookie: _wgspion_session=BAh7CjoPc2Vzc2lvbl9pZCIlY2FlOTg0YWY5M2FkNmI5Zjc2MmQ4OGQyMDgyM2EyYzQ6D3RyYWNrZWRfaXBUOgx1c2VyX2lkaQL6HCIKZmxhc2hJQzonQWN0aW9uQ29udHJvbGxlcjo6Rmxhc2g6OkZsYXNoSGFzaHsGOgplcnJvciIWZmxhc2gubG9naW4uZXJyb3IGOgpAdXNlZHsGOwlUOgljaXR5IgxIYW1idXJn--b3e3d16abded5ecf6612e1ff9e9c2afab4d85e66; path=/; HttpOnly

Its the latest Edge.
I'm using Rack 0.9.0, the newest mod_rails and apache 2.

Best,

Tobias</body>
      <body-html>&lt;div&gt;&lt;p&gt;Hi there,&lt;/p&gt;
&lt;p&gt;I have a problem with session cookies appearing in the content
(on beginning of html output). like this: Set-Cookie:
_wgspion_session=BAh7CjoPc2Vzc2lvbl9pZCIlY2FlOTg0YWY5M2FkNmI5Zjc2MmQ4OGQyMDgyM2EyYzQ6D3RyYWNrZWRfaXBUOgx1c2VyX2lkaQL6HCIKZmxhc2hJQzonQWN0aW9uQ29udHJvbGxlcjo6Rmxhc2g6OkZsYXNoSGFzaHsGOgplcnJvciIWZmxhc2gubG9naW4uZXJyb3IGOgpAdXNlZHsGOwlUOgljaXR5IgxIYW1idXJn--b3e3d16abded5ecf6612e1ff9e9c2afab4d85e66;
path=/; HttpOnly&lt;/p&gt;
&lt;p&gt;Its the latest Edge. I'm using Rack 0.9.0, the newest mod_rails
and apache 2.&lt;/p&gt;
&lt;p&gt;Best,&lt;/p&gt;
&lt;p&gt;Tobias&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-27T11:44:41+00:00</created-at>
      <creator-id type="integer">48772</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2093</number>
      <permalink>session-cookie-appearing-in-content</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3-rc1 2.3.0 rack session</tag>
      <title>Session-Cookie appearing in content</title>
      <updated-at type="datetime">2009-02-27T11:44:45+00:00</updated-at>
      <user-id type="integer">48772</user-id>
      <version type="integer">1</version>
      <user-name>Tobsch</user-name>
      <creator-name>Tobsch</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2093</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>See the attached image...</body>
      <body-html>&lt;div&gt;&lt;p&gt;See the attached image...&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-27T11:45:10+00:00</created-at>
      <creator-id type="integer">48772</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2093</number>
      <permalink>session-cookie-appearing-in-content</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3-rc1 2.3.0 rack session</tag>
      <title>Session-Cookie appearing in content</title>
      <updated-at type="datetime">2009-02-27T11:45:14+00:00</updated-at>
      <user-id type="integer">48772</user-id>
      <version type="integer">2</version>
      <user-name>Tobsch</user-name>
      <creator-name>Tobsch</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2093</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I am also seeing this issue, will investigate</body>
      <body-html>&lt;div&gt;&lt;p&gt;I am also seeing this issue, will investigate&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-02T13:56:11+00:00</created-at>
      <creator-id type="integer">48772</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2093</number>
      <permalink>session-cookie-appearing-in-content</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3-rc1 2.3.0 rack session</tag>
      <title>Session-Cookie appearing in content</title>
      <updated-at type="datetime">2009-03-02T13:56:13+00:00</updated-at>
      <user-id type="integer">468</user-id>
      <version type="integer">3</version>
      <user-name>David Smalley</user-name>
      <creator-name>Tobsch</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2093</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I wasn't able to precisely pin down at what point the Set-Cookie line gets added into the body. I was able to fix the issue by switching to the :active_record_store instead of using the cookie sessions.

It seems the issue only appears in cookie based sessions and only if you start setting extra cookies.

In my case I am using an old version of the restful_authentication plugin and it is only if the remember_me cookie is set that the session cookie gets printed into the body.

e.g.
cookies[:auth_token] = { :value =&gt; self.current_user.remember_token , :expires =&gt; self.current_user.remember_token_expires_at }

Then the Set-Cookie line appears in the body of the page, but only contains the session cookie.

Checking headers in Firebug the &quot;Cookie:&quot; header contains both the auth_token and the session cookie.

Will continue to investigate...</body>
      <body-html>&lt;div&gt;&lt;p&gt;I wasn't able to precisely pin down at what point the Set-Cookie
line gets added into the body. I was able to fix the issue by
switching to the :active_record_store instead of using the cookie
sessions.&lt;/p&gt;
&lt;p&gt;It seems the issue only appears in cookie based sessions and
only if you start setting extra cookies.&lt;/p&gt;
&lt;p&gt;In my case I am using an old version of the
restful_authentication plugin and it is only if the remember_me
cookie is set that the session cookie gets printed into the
body.&lt;/p&gt;
&lt;p&gt;e.g. cookies[:auth_token] = { :value =&amp;gt;
self.current_user.remember_token , :expires =&amp;gt;
self.current_user.remember_token_expires_at }&lt;/p&gt;
&lt;p&gt;Then the Set-Cookie line appears in the body of the page, but
only contains the session cookie.&lt;/p&gt;
&lt;p&gt;Checking headers in Firebug the &quot;Cookie:&quot; header contains both
the auth_token and the session cookie.&lt;/p&gt;
&lt;p&gt;Will continue to investigate...&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-02T14:15:32+00:00</created-at>
      <creator-id type="integer">48772</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2093</number>
      <permalink>session-cookie-appearing-in-content</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3-rc1 2.3.0 rack session</tag>
      <title>Session-Cookie appearing in content</title>
      <updated-at type="datetime">2009-03-02T14:15:35+00:00</updated-at>
      <user-id type="integer">468</user-id>
      <version type="integer">4</version>
      <user-name>David Smalley</user-name>
      <creator-name>Tobsch</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2093</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Upgrade to Passenger 2.1, it should be fixed there.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Upgrade to Passenger 2.1, it should be fixed there.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-02T16:34:38+00:00</created-at>
      <creator-id type="integer">48772</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2093</number>
      <permalink>session-cookie-appearing-in-content</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3-rc1 2.3.0 rack session</tag>
      <title>Session-Cookie appearing in content</title>
      <updated-at type="datetime">2009-03-02T16:34:41+00:00</updated-at>
      <user-id type="integer">46643</user-id>
      <version type="integer">5</version>
      <user-name>thedarkone</user-name>
      <creator-name>Tobsch</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2093</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Same problem here. Anywhere I was setting a cookie in the app now puts it in the body of the response. This is with Passenger 2.0.6. It doesn't happen on mongrel.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Same problem here. Anywhere I was setting a cookie in the app
now puts it in the body of the response. This is with Passenger
2.0.6. It doesn't happen on mongrel.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-04T06:46:59+00:00</created-at>
      <creator-id type="integer">48772</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2093</number>
      <permalink>session-cookie-appearing-in-content</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3-rc1 2.3.0 rack session</tag>
      <title>Session-Cookie appearing in content</title>
      <updated-at type="datetime">2009-03-04T06:47:04+00:00</updated-at>
      <user-id type="integer">26178</user-id>
      <version type="integer">6</version>
      <user-name>Richard Poirier</user-name>
      <creator-name>Tobsch</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2093</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I have such a problem with Passenger 2.0.6 too.
However, after Passenger is upgraded to 2.1.1, the problem disappears.
This version of passenger is still in beta, so you can't get it from rubyforge. You may take a look at their blog(http://blog.phusion.nl/2009/03/01/phusion-passenger-211-beta-released-thanks-sponsors/).</body>
      <body-html>&lt;div&gt;&lt;p&gt;I have such a problem with Passenger 2.0.6 too. However, after
Passenger is upgraded to 2.1.1, the problem disappears. This
version of passenger is still in beta, so you can't get it from
rubyforge. You may take a look at their blog(&lt;a href=&quot;http://blog.phusion.nl/2009/03/01/phusion-passenger-211-beta-released-thanks-sponsors/).%3C/p&quot;&gt;http://blog.phusion.nl/2009/03/0...&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-06T11:09:44+00:00</created-at>
      <creator-id type="integer">48772</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2093</number>
      <permalink>session-cookie-appearing-in-content</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3-rc1 2.3.0 rack session</tag>
      <title>Session-Cookie appearing in content</title>
      <updated-at type="datetime">2009-03-06T11:09:50+00:00</updated-at>
      <user-id type="integer">27313</user-id>
      <version type="integer">7</version>
      <user-name>richy zhang</user-name>
      <creator-name>Tobsch</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2093</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Same problem here. Upgrading to Passenger 2.1.1(beta) solved the problem.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Same problem here. Upgrading to Passenger 2.1.1(beta) solved the
problem.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-08T04:33:44+00:00</created-at>
      <creator-id type="integer">48772</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2093</number>
      <permalink>session-cookie-appearing-in-content</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3-rc1 2.3.0 rack session</tag>
      <title>Session-Cookie appearing in content</title>
      <updated-at type="datetime">2009-03-08T04:33:49+00:00</updated-at>
      <user-id type="integer">538</user-id>
      <version type="integer">8</version>
      <user-name>James Chen</user-name>
      <creator-name>Tobsch</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2093</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Hongli confirmed upgrading to passenger 2.1.1 solves the problem.

Thanks.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Hongli confirmed upgrading to passenger 2.1.1 solves the
problem.&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-03-08T12:01:09+00:00</created-at>
      <creator-id type="integer">48772</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2093</number>
      <permalink>session-cookie-appearing-in-content</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>2.3-rc1 2.3.0 rack session</tag>
      <title>Session-Cookie appearing in content</title>
      <updated-at type="datetime">2009-03-08T12:01:15+00:00</updated-at>
      <user-id type="integer">1366</user-id>
      <version type="integer">9</version>
      <user-name>Pratik</user-name>
      <creator-name>Tobsch</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2093</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment-image type="Attachment">
      <code>9cf2ac416933672ef0a381f5097bbd8cabfa7002</code>
      <content-type>image/jpeg</content-type>
      <created-at type="datetime">2009-02-27T11:44:41+00:00</created-at>
      <filename>__WG_Angebote_und_Gesuche_-_Kostenlos_bei_WG-Spion_-_Auch_Nachmieter_und_Zwischenmieter_f_r_Deine_Wohnung_oder_WG.jpg</filename>
      <height type="integer">75</height>
      <id type="integer">93853</id>
      <size type="integer">28957</size>
      <uploader-id type="integer">48772</uploader-id>
      <width type="integer">1328</width>
      <url>http://rails.lighthouseapp.com/attachments/93853/__WG_Angebote_und_Gesuche_-_Kostenlos_bei_WG-Spion_-_Auch_Nachmieter_und_Zwischenmieter_f_r_Deine_Wohnung_oder_WG.jpg</url>
    </attachment-image>
  </attachments>
</ticket>
