<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">15316</assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">false</closed>
  <created-at type="datetime">2011-02-17T08:07:24+00:00</created-at>
  <creator-id type="integer">20854</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">71470</milestone-id>
  <number type="integer">4337</number>
  <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
  <priority type="integer">2</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>open</state>
  <tag nil="true"></tag>
  <title>Tweaks to make ActiveRecord Fiber-friendly</title>
  <updated-at type="datetime">2011-03-26T01:58:24+00:00</updated-at>
  <user-id type="integer">142823</user-id>
  <version type="integer">18</version>
  <user-name>bingbing</user-name>
  <creator-name>Mike Perham</creator-name>
  <assigned-user-name>Aaron Patterson</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
  <milestone-title>3.1</milestone-title>
  <priority-name>Medium</priority-name>
  <original-body>My work on Phat (http://www.mikeperham.com/2010/04/03/introducing-phat-an-asynchronous-rails-app/) brought to light a few issues in making Rails working in a single Thread, multiple Fiber environment.

The full set of patches required for ActiveRecord is here:

http://github.com/mperham/em_postgresql/blob/master/lib/active_record/patches.rb

Some of these changes can't be easily rolled back into Rails but the ones that can IMO are:

* The connection pool's checkout method should mark a connection as checked out before actually using it, otherwise another Fiber may try to use the same connection while the verify! operation is in progress.

In connection_pool.rb

    def checkout_and_verify(c)
      @checked_out &lt;&lt; c
      c.verify!
      c.run_callbacks :checkout
      c
    end

* The connection pool Mutex should be configurable.  Since Fibers cause a single thread to check out many connections from the pool, the Mutex causes deadlocks, even though there is only a single Thread executing.  Ideally, I should be able to supply my own Mutex and Condition classes which are Fiber-friendly.</original-body>
  <latest-body>My work on Phat (http://www.mikeperham.com/2010/04/03/introducing-phat-an-asynchronous-rails-app/) brought to light a few issues in making Rails working in a single Thread, multiple Fiber environment.

The full set of patches required for ActiveRecord is here:

http://github.com/mperham/em_postgresql/blob/master/lib/active_record/patches.rb

Some of these changes can't be easily rolled back into Rails but the ones that can IMO are:

* The connection pool's checkout method should mark a connection as checked out before actually using it, otherwise another Fiber may try to use the same connection while the verify! operation is in progress.

In connection_pool.rb

    def checkout_and_verify(c)
      @checked_out &lt;&lt; c
      c.verify!
      c.run_callbacks :checkout
      c
    end

* The connection pool Mutex should be configurable.  Since Fibers cause a single thread to check out many connections from the pool, the Mutex causes deadlocks, even though there is only a single Thread executing.  Ideally, I should be able to supply my own Mutex and Condition classes which are Fiber-friendly.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;My work on Phat (&lt;a href=
&quot;http://www.mikeperham.com/2010/04/03/introducing-phat-an-asynchronous-rails-app/&quot;&gt;http://www.mikeperham.com/2010/04/03/introducing-phat-an-asynchrono...&lt;/a&gt;)
brought to light a few issues in making Rails working in a single
Thread, multiple Fiber environment.&lt;/p&gt;
&lt;p&gt;The full set of patches required for ActiveRecord is here:&lt;/p&gt;
&lt;p&gt;&lt;a href=
&quot;http://github.com/mperham/em_postgresql/blob/master/lib/active_record/patches.rb&quot;&gt;
http://github.com/mperham/em_postgresql/blob/master/lib/active_reco...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Some of these changes can't be easily rolled back into Rails but
the ones that can IMO are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The connection pool's checkout method should mark a connection
as checked out before actually using it, otherwise another Fiber
may try to use the same connection while the verify! operation is
in progress.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In connection_pool.rb&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;def checkout_and_verify(c)
  @checked_out &amp;lt;&amp;lt; c
  c.verify!
  c.run_callbacks :checkout
  c
end&lt;/code&gt;
&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;The connection pool Mutex should be configurable. Since Fibers
cause a single thread to check out many connections from the pool,
the Mutex causes deadlocks, even though there is only a single
Thread executing. Ideally, I should be able to supply my own Mutex
and Condition classes which are Fiber-friendly.&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>My work on Phat (http://www.mikeperham.com/2010/04/03/introducing-phat-an-asynchronous-rails-app/) brought to light a few issues in making Rails working in a single Thread, multiple Fiber environment.

The full set of patches required for ActiveRecord is here:

http://github.com/mperham/em_postgresql/blob/master/lib/active_record/patches.rb

Some of these changes can't be easily rolled back into Rails but the ones that can IMO are:

* The connection pool's checkout method should mark a connection as checked out before actually using it, otherwise another Fiber may try to use the same connection while the verify! operation is in progress.

In connection_pool.rb

    def checkout_and_verify(c)
      @checked_out &lt;&lt; c
      c.verify!
      c.run_callbacks :checkout
      c
    end

* The connection pool Mutex should be configurable.  Since Fibers cause a single thread to check out many connections from the pool, the Mutex causes deadlocks, even though there is only a single Thread executing.  Ideally, I should be able to supply my own Mutex and Condition classes which are Fiber-friendly.</body>
      <body-html>&lt;div&gt;&lt;p&gt;My work on Phat (&lt;a href=
&quot;http://www.mikeperham.com/2010/04/03/introducing-phat-an-asynchronous-rails-app/&quot;&gt;http://www.mikeperham.com/2010/04/03/introducing-phat-an-asynchrono...&lt;/a&gt;)
brought to light a few issues in making Rails working in a single
Thread, multiple Fiber environment.&lt;/p&gt;
&lt;p&gt;The full set of patches required for ActiveRecord is here:&lt;/p&gt;
&lt;p&gt;&lt;a href=
&quot;http://github.com/mperham/em_postgresql/blob/master/lib/active_record/patches.rb&quot;&gt;
http://github.com/mperham/em_postgresql/blob/master/lib/active_reco...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Some of these changes can't be easily rolled back into Rails but
the ones that can IMO are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The connection pool's checkout method should mark a connection
as checked out before actually using it, otherwise another Fiber
may try to use the same connection while the verify! operation is
in progress.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In connection_pool.rb&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;def checkout_and_verify(c)
  @checked_out &amp;lt;&amp;lt; c
  c.verify!
  c.run_callbacks :checkout
  c
end&lt;/code&gt;
&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;The connection pool Mutex should be configurable. Since Fibers
cause a single thread to check out many connections from the pool,
the Mutex causes deadlocks, even though there is only a single
Thread executing. Ideally, I should be able to supply my own Mutex
and Condition classes which are Fiber-friendly.&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-07T16:28:22+01:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2010-04-07T16:28:24+01:00</updated-at>
      <user-id type="integer">20854</user-id>
      <version type="integer">1</version>
      <user-name>Mike Perham</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Cool - thanks for working on this, Mike!

Looks like the pool implementation itself could be configurable so you could pick a threaded or fibered variant.

Patches (and tests) welcome, of course :)</body>
      <body-html>&lt;div&gt;&lt;p&gt;Cool - thanks for working on this, Mike!&lt;/p&gt;
&lt;p&gt;Looks like the pool implementation itself could be configurable
so you could pick a threaded or fibered variant.&lt;/p&gt;
&lt;p&gt;Patches (and tests) welcome, of course :)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-07T18:24:38+01:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
:milestone: 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2010-04-07T18:24:43+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">2</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Any suggestions on the switching logic?  I like the idea of config.fibersafe! which works in a similar fashion to config.threadsafe!  It would be able to rejigger the Rails stack (AR, memcache-client, e.g.) to use Fiber-safe versions.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Any suggestions on the switching logic? I like the idea of
config.fibersafe! which works in a similar fashion to
config.threadsafe! It would be able to rejigger the Rails stack
(AR, memcache-client, e.g.) to use Fiber-safe versions.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-07T18:56:23+01:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2010-04-07T18:56:25+01:00</updated-at>
      <user-id type="integer">20854</user-id>
      <version type="integer">3</version>
      <user-name>Mike Perham</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Patch attached.  I'm unhappy with a few areas that perhaps you can suggest alternatives:

1. How do we cleanly get the concurrency_model value from the Rails::Application instance down to the ConnectionPool?  My defined? code is definitely a hack.
2. I had to pull in EventMachine into the Gemfile in order to test the Fibers actually executing.  The wait queue uses EM to pause while waiting for a connection and I'm not sure we want to introduce that dependency into ActiveRecord, even if it's pulled in dynamically.
3. There's no real way to implement remove_stale_cached_threads! since we can't get a list of Fibers in the system.  I hacked it in em_postgresql by registering the application's FiberPool manually.  I don't know if this is a showstopper but it's a concern.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Patch attached. I'm unhappy with a few areas that perhaps you
can suggest alternatives:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;How do we cleanly get the concurrency_model value from the
Rails::Application instance down to the ConnectionPool? My defined?
code is definitely a hack.&lt;br&gt;&lt;/li&gt;
&lt;li&gt;I had to pull in EventMachine into the Gemfile in order to test
the Fibers actually executing. The wait queue uses EM to pause
while waiting for a connection and I'm not sure we want to
introduce that dependency into ActiveRecord, even if it's pulled in
dynamically.&lt;br&gt;&lt;/li&gt;
&lt;li&gt;There's no real way to implement remove_stale_cached_threads!
since we can't get a list of Fibers in the system. I hacked it in
em_postgresql by registering the application's FiberPool manually.
I don't know if this is a showstopper but it's a concern.&lt;/li&gt;
&lt;/ol&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-07T22:32:33+01:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>patch</tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2010-04-07T22:32:39+01:00</updated-at>
      <user-id type="integer">20854</user-id>
      <version type="integer">4</version>
      <user-name>Mike Perham</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Advanced bugmashin': Can some bugmashers critique the patch and revise/comment as necessary?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Advanced bugmashin': Can some bugmashers critique the patch and
revise/comment as necessary?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-15T01:54:33+01:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: patch
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>bugmash patch</tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2010-05-15T01:54:37+01:00</updated-at>
      <user-id type="integer">22242</user-id>
      <version type="integer">5</version>
      <user-name>Dan Pickett</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/27625)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/27625&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-30T04:10:32+01:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
:milestone: 27004
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>bugmash patch</tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2010-08-30T04:10:32+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">6</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/31647)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/31647&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-10-15T23:01:51+01:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 82861
</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>bugmash patch</tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2010-10-15T23:01:51+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">7</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Automatic cleanup of spam.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Automatic cleanup of spam.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-11-08T01:55:03+00:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: bugmash patch
</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2010-11-08T01:55:05+00:00</updated-at>
      <user-id type="integer">14998</user-id>
      <version type="integer">9</version>
      <user-name>Ryan Bigg</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/34349)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/34349&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-11-15T21:04:50+00:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 88038
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2010-11-15T21:04:50+00:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">10</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">85</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>+1

Hope to see this patch get accepted.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;
&lt;p&gt;Hope to see this patch get accepted.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-11-20T05:59:41+00:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2010-11-20T05:59:50+00:00</updated-at>
      <user-id type="integer">71333</user-id>
      <version type="integer">11</version>
      <user-name>wtn</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name>Jeremy Kemper</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-11-20T10:08:27+00:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 85
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2010-11-20T10:08:33+00:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">12</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I will attempt to test / fix this.  I don't like the architecture of the patch.  I think we should have two subclasses of connection pool (one for threads and one for fibers) then switch the instantiation logic.  Having initialize extend the current instance seems not good.

We can have the [spec contain configuration info](http://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb#L284-286).  IIRC, the spec comes from the database configuration yaml file, so config could be something like:

    development:
      adapter: sqlite3
      database: db/development.sqlite3
      pool: 5
      timeout: 5000
      concurrency: fiber

(I'm not sure this is *exactly* what the config file would look like)

I'm marking this for Rails 3.1 as this seems like too much for a bugfix release.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I will attempt to test / fix this. I don't like the architecture
of the patch. I think we should have two subclasses of connection
pool (one for threads and one for fibers) then switch the
instantiation logic. Having initialize extend the current instance
seems not good.&lt;/p&gt;
&lt;p&gt;We can have the &lt;a href=
&quot;http://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb#L284-286&quot;&gt;
spec contain configuration info&lt;/a&gt;. IIRC, the spec comes from the
database configuration yaml file, so config could be something
like:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;development:
  adapter: sqlite3
  database: db/development.sqlite3
  pool: 5
  timeout: 5000
  concurrency: fiber&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;(I'm not sure this is &lt;em&gt;exactly&lt;/em&gt; what the config file
would look like)&lt;/p&gt;
&lt;p&gt;I'm marking this for Rails 3.1 as this seems like too much for a
bugfix release.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-15T23:31:28+00:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 92071
</diffable-attributes>
      <milestone-id type="integer">71470</milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2010-12-15T23:31:52+00:00</updated-at>
      <user-id type="integer">15316</user-id>
      <version type="integer">13</version>
      <user-name>Aaron Patterson</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title>3.1</milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>thank you very much......&lt;span class=&quot;Apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;http://www.tran33m.com/vb/&quot;&gt;&#1605;&#1606;&#1578;&#1583;&#1610;&#1575;&#1578;&lt;/a&gt;&lt;span class=&quot;Apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;http://www.tran33m.com/vb/f86.html&quot;&gt;&#1605;&#1603;&#1610;&#1575;&#1580;&lt;/a&gt;&lt;span class=&quot;Apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;http://www.tran33m.com/vb/f84.html&quot;&gt;&#1575;&#1586;&#1610;&#1575;&#1569;&lt;/a&gt;&lt;span class=&quot;Apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;http://www.tran33m.com/vb/f84.html&quot;&gt;&#1601;&#1587;&#1575;&#1578;&#1610;&#1606;&lt;/a&gt;&lt;span class=&quot;Apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;http://www.tran33m.com/vb/f17.html&quot;&gt;&#1585;&#1587;&#1575;&#1574;&#1604; 
- &#1605;&#1587;&#1580;&#1575;&#1578; - &#1608;&#1587;&#1575;&#1574;&#1591;&lt;/a&gt;&lt;span class=&quot;Apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;http://www.tran33m.com/vb/f18.html&quot;&gt;&#1578;&#1608;&#1576;&#1610;&#1603;&#1575;&#1578;&lt;/a&gt;&lt;span class=&quot;Apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;http://www.tran33m.com/vb/f76.html&quot;&gt;&#1608;&#1592;&#1575;&#1574;&#1601;&lt;/a&gt;&lt;span class=&quot;Apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;http://www.tran33m.com/vb/f76.html&quot;&gt;jobs&lt;/a&gt; &lt;a href=&quot;http://www.tran33m.com/vb/t31874.html&quot;&gt;&#1576;&#1585;&#1608;&#1603;&#1587;&#1610;&lt;/a&gt; &lt;a href=&quot;http://www.tran33m.com/vb/t31874.html&quot;&gt;proxy&lt;/a&gt; &lt;a href=&quot;http://forum.line-sport.tv/&quot;&gt;&#1604;&#1575;&#1610;&#1606; &#1587;&#1576;&#1608;&#1585;&#1578;&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;</body>
      <body-html>&lt;div&gt;&lt;p&gt;thank you very much......&lt;span class=
&quot;Apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=
&quot;http://www.tran33m.com/vb/&quot;&gt;&amp;#1605;&amp;#1606;&amp;#1578;&amp;#1583;&amp;#1610;&amp;#1575;&amp;#1578;&lt;/a&gt;&lt;span class=&quot;Apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;http://www.tran33m.com/vb/f86.html&quot;&gt;&amp;#1605;&amp;#1603;&amp;#1610;&amp;#1575;&amp;#1580;&lt;/a&gt;&lt;span class=&quot;Apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;http://www.tran33m.com/vb/f84.html&quot;&gt;&amp;#1575;&amp;#1586;&amp;#1610;&amp;#1575;&amp;#1569;&lt;/a&gt;&lt;span class=&quot;Apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;http://www.tran33m.com/vb/f84.html&quot;&gt;&amp;#1601;&amp;#1587;&amp;#1575;&amp;#1578;&amp;#1610;&amp;#1606;&lt;/a&gt;&lt;span class=&quot;Apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;http://www.tran33m.com/vb/f17.html&quot;&gt;&amp;#1585;&amp;#1587;&amp;#1575;&amp;#1574;&amp;#1604;&lt;br&gt;
- &amp;#1605;&amp;#1587;&amp;#1580;&amp;#1575;&amp;#1578; -
&amp;#1608;&amp;#1587;&amp;#1575;&amp;#1574;&amp;#1591;&lt;/a&gt;&lt;span class=
&quot;Apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=
&quot;http://www.tran33m.com/vb/f18.html&quot;&gt;&amp;#1578;&amp;#1608;&amp;#1576;&amp;#1610;&amp;#1603;&amp;#1575;&amp;#1578;&lt;/a&gt;&lt;span class=&quot;Apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;http://www.tran33m.com/vb/f76.html&quot;&gt;&amp;#1608;&amp;#1592;&amp;#1575;&amp;#1574;&amp;#1601;&lt;/a&gt;&lt;span class=&quot;Apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;http://www.tran33m.com/vb/f76.html&quot;&gt;jobs&lt;/a&gt;
&lt;a href=
&quot;http://www.tran33m.com/vb/t31874.html&quot;&gt;&amp;#1576;&amp;#1585;&amp;#1608;&amp;#1603;&amp;#1587;&amp;#1610;&lt;/a&gt;
&lt;a href=&quot;http://www.tran33m.com/vb/t31874.html&quot;&gt;proxy&lt;/a&gt; &lt;a href=
&quot;http://forum.line-sport.tv/&quot;&gt;&amp;#1604;&amp;#1575;&amp;#1610;&amp;#1606;
&amp;#1587;&amp;#1576;&amp;#1608;&amp;#1585;&amp;#1578;&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2011-02-08T11:29:05+00:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71470</milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2011-02-08T12:16:12+00:00</updated-at>
      <user-id type="integer">136126</user-id>
      <version type="integer">14</version>
      <user-name>alasiri1</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title>3.1</milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Good &lt;a href=http://www.sale-puma.com&gt;Puma shoes sale&lt;/a&gt; information for &lt;a href=http://www.sale-puma.com&gt;Puma shoes&lt;/a&gt; fans: Yesterday, German sportswear maker Cheap Running Shoes purchased effectively lot of money Brands. The transaction entails the Cobra brand, too as linked inventory, intellectual house and endorsement contracts. It also helps make &lt;a href=http://www.sale-puma.com&gt;puma speed cat&lt;/a&gt; Shoes . They provide you with the utmost game and support all through the feet.You can happen around several types of basketball sneakers such as high-top,low-top and mid-top.The &lt;a href=http://www.sale-puma.com&gt;Puma shoes online&lt;/a&gt; and boots give you best ankle support will support want you to obtain steadiness.
As we konw,Trail &lt;a href=http://www.sale-puma.com&gt;Puma Drift Cat&lt;/a&gt; Shoes black, Trail &lt;a href=http://www.sale-puma.com&gt;Puma future cat&lt;/a&gt; ShoesWhite Black? 50 many years backshore are actually released within a great accomplishment. Trail Running Shoes speed cat shoes?go in add-on to King Pele into planet tournament finals, bottom tennis discs matchrs within pasture inhabit an vital area in hold out in Wimbledon Dun; Its working firms have premier manufacturers and major marketplace positions in distilled spirits, residence and security, and golf products. The reply go all through the &lt;a href=http://www.sale-puma.com&gt;Cheap puma shoes&lt;/a&gt; on sale-here you are able to happen around several distcoun.&lt;a href=http://www.sale-puma.com&gt;puma shoes on sale &lt;/a&gt;.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Good &lt;a href=&quot;http:&quot;&gt;Puma shoes sale information for &lt;a href=
&quot;http:&quot;&gt;Puma shoes fans: Yesterday, German sportswear maker Cheap
Running Shoes purchased effectively lot of money Brands. The
transaction entails the Cobra brand, too as linked inventory,
intellectual house and endorsement contracts. It also helps make
&lt;a href=&quot;http:&quot;&gt;puma speed cat Shoes . They provide you with the
utmost game and support all through the feet.You can happen around
several types of basketball sneakers such as high-top,low-top and
mid-top.The &lt;a href=&quot;http:&quot;&gt;Puma shoes online and boots give you
best ankle support will support want you to obtain steadiness.&lt;br&gt;
As we konw,Trail &lt;a href=&quot;http:&quot;&gt;Puma Drift Cat Shoes black, Trail
&lt;a href=&quot;http:&quot;&gt;Puma future cat ShoesWhite Black? 50 many years
backshore are actually released within a great accomplishment.
Trail Running Shoes speed cat shoes?go in add-on to King Pele into
planet tournament finals, bottom tennis discs matchrs within
pasture inhabit an vital area in hold out in Wimbledon Dun; Its
working firms have premier manufacturers and major marketplace
positions in distilled spirits, residence and security, and golf
products. The reply go all through the &lt;a href=&quot;http:&quot;&gt;Cheap puma
shoes on sale-here you are able to happen around several
distcoun.&lt;a href=&quot;http:&quot;&gt;puma shoes on sale .&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2011-02-14T02:43:35+00:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71470</milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2011-02-14T05:41:55+00:00</updated-at>
      <user-id type="integer">136860</user-id>
      <version type="integer">15</version>
      <user-name>xixi</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title>3.1</milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>&lt;strong&gt;&lt;a href=&quot;http://www.onlinepandorajewellery.com/&quot;&gt;&lt;em&gt;Pandora&lt;/em&gt;&lt;/a&gt;&lt;/strong&gt;Right now, like appears to have been frequently  sterling silver beads which inturn instigated &lt;strong&gt;&lt;a href=&quot;http://www.onlinepandorajewellery.com/pandora-bracelets-c-3.html&quot;&gt;&lt;em&gt;Pandoras Bracelets&lt;/em&gt;&lt;/a&gt;&lt;/strong&gt;plenty of famous individuals arms plus neck. &lt;strong&gt;&lt;a href=&quot;http://www.onlinepandorajewellery.com/pandora-charms-c-9.html&quot;&gt;&lt;em&gt;Pandora&#160;Charms&lt;/em&gt;&lt;/a&gt;&lt;/strong&gt;Movie movie stars, when may be a fail And Zeta, Jennifer Aniston Donna Karan, fashion designers,&lt;strong&gt;&lt;a href=&quot;http://www.onlinepandorajewellery.com/&quot;&gt;&lt;em&gt;pandora ireland&lt;/em&gt;&lt;/a&gt;&lt;/strong&gt; Diane von Furstenberg, and so contain their discount  bead distinctive&lt;strong&gt;&lt;a href=&quot;http://www.onlinepandorajewellery.com/pandora-beads-c-4.html&quot;&gt;&lt;em&gt;pandora beads&lt;/em&gt;&lt;/a&gt;&lt;/strong&gt; .</body>
      <body-html>&lt;div&gt;&lt;p&gt;&lt;strong&gt;&lt;a href=
&quot;http://www.onlinepandorajewellery.com/&quot;&gt;&lt;em&gt;Pandora&lt;/em&gt;&lt;/a&gt;&lt;/strong&gt;Right
now, like appears to have been frequently sterling silver beads
which inturn instigated &lt;strong&gt;&lt;a href=
&quot;http://www.onlinepandorajewellery.com/pandora-bracelets-c-3.html&quot;&gt;&lt;em&gt;
Pandoras Bracelets&lt;/em&gt;&lt;/a&gt;&lt;/strong&gt;plenty of famous individuals
arms plus neck. &lt;strong&gt;&lt;a href=
&quot;http://www.onlinepandorajewellery.com/pandora-charms-c-9.html&quot;&gt;&lt;em&gt;
Pandora&amp;nbsp;Charms&lt;/em&gt;&lt;/a&gt;&lt;/strong&gt;Movie movie stars, when may be
a fail And Zeta, Jennifer Aniston Donna Karan, fashion
designers,&lt;strong&gt;&lt;a href=
&quot;http://www.onlinepandorajewellery.com/&quot;&gt;&lt;em&gt;pandora
ireland&lt;/em&gt;&lt;/a&gt;&lt;/strong&gt; Diane von Furstenberg, and so contain
their discount bead distinctive&lt;strong&gt;&lt;a href=
&quot;http://www.onlinepandorajewellery.com/pandora-beads-c-4.html&quot;&gt;&lt;em&gt;pandora
beads&lt;/em&gt;&lt;/a&gt;&lt;/strong&gt; .&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2011-02-14T05:33:17+00:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71470</milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2011-02-14T07:28:34+00:00</updated-at>
      <user-id type="integer">136876</user-id>
      <version type="integer">16</version>
      <user-name>pandora jewellry</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title>3.1</milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Today, kids as babyish as Ashcan School or nine name-conscious and trend-alert, puma ducati buying at for solid garments rather than just throwing on what&#8217;s pure. Here are just some of the brands and trends your children hungered over 2011. The 80&#8242;s Are Back. You may have noticed a trend this year for evisu jeans, supra shoes, leggings petticoats, oversized tees, and big &lt;a href=http://www.sale-puma.com&gt;puma speed cat&lt;/a&gt; shoes. This is a look that appeals to babies girls-it&#8217;s quirky and yet smart at the same time.
&lt;a href=http://www.sale-puma.com&gt;Puma future cat&lt;/a&gt; with success sets the charm for manner, lifestyle and gambols. This has been believed to serve for an ideal cross flight simulator. This has been fine-looking by most jocks and the Speed Cat is an old name for the industriousness which made &lt;a href=http://www.sale-puma.com&gt;Puma shoes&lt;/a&gt; gain millions with this business. With many people converting more wellness conscious in time, a lot wants also to commit on a good pair of cross trainers. These are very indestructible and forward-looking just like the real carrying out of a real &lt;a href=http://www.sale-puma.com&gt;Puma future cat&lt;/a&gt;. It consumes been systematically on the forefront of design and carrying out when it pertains comfort and style commingled.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Today, kids as babyish as Ashcan School or nine name-conscious
and trend-alert, puma ducati buying at for solid garments rather
than just throwing on what&amp;#8217;s pure. Here are just some of the
brands and trends your children hungered over 2011. The 80&amp;#8242;s
Are Back. You may have noticed a trend this year for evisu jeans,
supra shoes, leggings petticoats, oversized tees, and big &lt;a href=
&quot;http:&quot;&gt;puma speed cat shoes. This is a look that appeals to babies
girls-it&amp;#8217;s quirky and yet smart at the same time.&lt;br&gt;
&lt;a href=&quot;http:&quot;&gt;Puma future cat with success sets the charm for
manner, lifestyle and gambols. This has been believed to serve for
an ideal cross flight simulator. This has been fine-looking by most
jocks and the Speed Cat is an old name for the industriousness
which made &lt;a href=&quot;http:&quot;&gt;Puma shoes gain millions with this
business. With many people converting more wellness conscious in
time, a lot wants also to commit on a good pair of cross trainers.
These are very indestructible and forward-looking just like the
real carrying out of a real &lt;a href=&quot;http:&quot;&gt;Puma future cat. It
consumes been systematically on the forefront of design and
carrying out when it pertains comfort and style commingled.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2011-02-17T08:07:17+00:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71470</milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2011-02-17T08:07:24+00:00</updated-at>
      <user-id type="integer">137453</user-id>
      <version type="integer">17</version>
      <user-name>gfhg</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title>3.1</milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>&lt;b&gt;&lt;a href=&quot;http://www.watcheseshop.com/&quot;&gt;omega watch&lt;/a&gt;&lt;/b&gt;</body>
      <body-html>&lt;div&gt;&lt;p&gt;&lt;b&gt;&lt;a href=&quot;http://www.watcheseshop.com/&quot;&gt;omega
watch&lt;/a&gt;&lt;/b&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2011-03-26T01:39:33+00:00</created-at>
      <creator-id type="integer">20854</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71470</milestone-id>
      <number type="integer">4337</number>
      <permalink>tweaks-to-make-activerecord-fiber-friendly</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>Tweaks to make ActiveRecord Fiber-friendly</title>
      <updated-at type="datetime">2011-03-26T01:58:24+00:00</updated-at>
      <user-id type="integer">142823</user-id>
      <version type="integer">18</version>
      <user-name>bingbing</user-name>
      <creator-name>Mike Perham</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4337</url>
      <milestone-title>3.1</milestone-title>
      <priority-name>Medium</priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>7c73902fc774b837e4787993ffaa71687671f7e1</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-04-07T22:32:33+01:00</created-at>
      <filename>4377-fibers-1.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">474891</id>
      <size type="integer">10415</size>
      <uploader-id type="integer">20854</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/474891/4377-fibers-1.diff</url>
    </attachment>
  </attachments>
</ticket>
