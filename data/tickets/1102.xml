<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">3</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2008-09-24T14:37:43+01:00</created-at>
  <creator-id type="integer">24325</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">9903</milestone-id>
  <number type="integer">1102</number>
  <permalink>added-counter_sql-to-valid-keys-for-habtm</permalink>
  <priority type="integer">521</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>committed</state>
  <tag>2.2 activerecord bug edge patch</tag>
  <title>Added :counter_sql to valid keys for HABTM</title>
  <updated-at type="datetime">2008-11-07T08:01:32+00:00</updated-at>
  <user-id type="integer">17393</user-id>
  <version type="integer">8</version>
  <user-name>Repository</user-name>
  <creator-name>Ernie Miller</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/1102</url>
  <milestone-title>2.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>In #831, I submitted a patch to refactor AssociationCollection#count and fix problems with HABTM count in Ruby 1.8.7. I forgot to add :counter_sql to the list of valid keys for HABTM associations in associations.rb, as Tekin pointed out. This was causing the option to be rejected despite the documentation update stating it should work. This one-liner patch fixes that. Sorry!

(If someone wants to add a new fixture that is a HABTM association with a :counter_sql option and put in a test making sure it counts, it probably would be worthwhile. I just don't have the time to do that today, and wanted to get this in before the bug makes it into 2.2 beta.)</original-body>
  <latest-body>In #831, I submitted a patch to refactor AssociationCollection#count and fix problems with HABTM count in Ruby 1.8.7. I forgot to add :counter_sql to the list of valid keys for HABTM associations in associations.rb, as Tekin pointed out. This was causing the option to be rejected despite the documentation update stating it should work. This one-liner patch fixes that. Sorry!

(If someone wants to add a new fixture that is a HABTM association with a :counter_sql option and put in a test making sure it counts, it probably would be worthwhile. I just don't have the time to do that today, and wanted to get this in before the bug makes it into 2.2 beta.)</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;In &lt;a href=&quot;/projects/8994/tickets/831&quot; title=&quot;Ticket #831&quot;&gt;#831&lt;/a&gt;, I submitted a patch to refactor
AssociationCollection#count and fix problems with HABTM count in
Ruby 1.8.7. I forgot to add :counter_sql to the list of valid keys
for HABTM associations in associations.rb, as Tekin pointed out.
This was causing the option to be rejected despite the
documentation update stating it should work. This one-liner patch
fixes that. Sorry!&lt;/p&gt;
&lt;p&gt;(If someone wants to add a new fixture that is a HABTM
association with a :counter_sql option and put in a test making
sure it counts, it probably would be worthwhile. I just don't have
the time to do that today, and wanted to get this in before the bug
makes it into 2.2 beta.)&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>In #831, I submitted a patch to refactor AssociationCollection#count and fix problems with HABTM count in Ruby 1.8.7. I forgot to add :counter_sql to the list of valid keys for HABTM associations in associations.rb, as Tekin pointed out. This was causing the option to be rejected despite the documentation update stating it should work. This one-liner patch fixes that. Sorry!

(If someone wants to add a new fixture that is a HABTM association with a :counter_sql option and put in a test making sure it counts, it probably would be worthwhile. I just don't have the time to do that today, and wanted to get this in before the bug makes it into 2.2 beta.)</body>
      <body-html>&lt;div&gt;&lt;p&gt;In &lt;a href=&quot;/projects/8994/tickets/831&quot; title=&quot;Ticket #831&quot;&gt;#831&lt;/a&gt;, I submitted a patch to refactor
AssociationCollection#count and fix problems with HABTM count in
Ruby 1.8.7. I forgot to add :counter_sql to the list of valid keys
for HABTM associations in associations.rb, as Tekin pointed out.
This was causing the option to be rejected despite the
documentation update stating it should work. This one-liner patch
fixes that. Sorry!&lt;/p&gt;
&lt;p&gt;(If someone wants to add a new fixture that is a HABTM
association with a :counter_sql option and put in a test making
sure it counts, it probably would be worthwhile. I just don't have
the time to do that today, and wanted to get this in before the bug
makes it into 2.2 beta.)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-09-24T14:37:43+01:00</created-at>
      <creator-id type="integer">24325</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1102</number>
      <permalink>added-counter_sql-to-valid-keys-for-habtm</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.2 activerecord bug edge patch</tag>
      <title>Added :counter_sql to valid keys for HABTM</title>
      <updated-at type="datetime">2008-09-24T14:37:46+01:00</updated-at>
      <user-id type="integer">24325</user-id>
      <version type="integer">1</version>
      <user-name>Ernie Miller</user-name>
      <creator-name>Ernie Miller</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1102</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>This doesn't apply cleanly any more, can you rebase it and reupload it please</body>
      <body-html>&lt;div&gt;&lt;p&gt;This doesn't apply cleanly any more, can you rebase it and
reupload it please&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-11-06T19:56:21+00:00</created-at>
      <creator-id type="integer">24325</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1102</number>
      <permalink>added-counter_sql-to-valid-keys-for-habtm</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.2 activerecord bug edge patch</tag>
      <title>Added :counter_sql to valid keys for HABTM</title>
      <updated-at type="datetime">2008-11-06T19:56:22+00:00</updated-at>
      <user-id type="integer">141</user-id>
      <version type="integer">2</version>
      <user-name>Michael Koziarski</user-name>
      <creator-name>Ernie Miller</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1102</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Here you go!</body>
      <body-html>&lt;div&gt;&lt;p&gt;Here you go!&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-11-06T20:03:42+00:00</created-at>
      <creator-id type="integer">24325</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1102</number>
      <permalink>added-counter_sql-to-valid-keys-for-habtm</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.2 activerecord bug edge patch</tag>
      <title>Added :counter_sql to valid keys for HABTM</title>
      <updated-at type="datetime">2008-11-06T20:03:46+00:00</updated-at>
      <user-id type="integer">1741</user-id>
      <version type="integer">3</version>
      <user-name>Tekin</user-name>
      <creator-name>Ernie Miller</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1102</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Also, we clearly don't have any tests for this feature, can you add a few (even just a simple declaration of the association and assertion on the count).</body>
      <body-html>&lt;div&gt;&lt;p&gt;Also, we clearly don't have any tests for this feature, can you
add a few (even just a simple declaration of the association and
assertion on the count).&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-11-06T20:16:02+00:00</created-at>
      <creator-id type="integer">24325</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1102</number>
      <permalink>added-counter_sql-to-valid-keys-for-habtm</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.2 activerecord bug edge patch</tag>
      <title>Added :counter_sql to valid keys for HABTM</title>
      <updated-at type="datetime">2008-11-06T20:16:07+00:00</updated-at>
      <user-id type="integer">141</user-id>
      <version type="integer">4</version>
      <user-name>Michael Koziarski</user-name>
      <creator-name>Ernie Miller</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1102</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>OK, will try get some simply tests added to the patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;OK, will try get some simply tests added to the patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-11-06T20:25:07+00:00</created-at>
      <creator-id type="integer">24325</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1102</number>
      <permalink>added-counter_sql-to-valid-keys-for-habtm</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.2 activerecord bug edge patch</tag>
      <title>Added :counter_sql to valid keys for HABTM</title>
      <updated-at type="datetime">2008-11-06T20:25:12+00:00</updated-at>
      <user-id type="integer">1741</user-id>
      <version type="integer">5</version>
      <user-name>Tekin</user-name>
      <creator-name>Ernie Miller</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1102</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Tekin,

  Thanks for jumping on this so fast! You saved me the pain. :)</body>
      <body-html>&lt;div&gt;&lt;p&gt;Tekin,&lt;/p&gt;
&lt;p&gt;Thanks for jumping on this so fast! You saved me the pain.
:)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-11-06T20:26:56+00:00</created-at>
      <creator-id type="integer">24325</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1102</number>
      <permalink>added-counter_sql-to-valid-keys-for-habtm</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.2 activerecord bug edge patch</tag>
      <title>Added :counter_sql to valid keys for HABTM</title>
      <updated-at type="datetime">2008-11-06T20:26:59+00:00</updated-at>
      <user-id type="integer">24325</user-id>
      <version type="integer">6</version>
      <user-name>Ernie Miller</user-name>
      <creator-name>Ernie Miller</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1102</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>No worries!

Here's an updated patch with a couple of tests. Hope that does the trick.</body>
      <body-html>&lt;div&gt;&lt;p&gt;No worries!&lt;/p&gt;
&lt;p&gt;Here's an updated patch with a couple of tests. Hope that does
the trick.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-11-06T21:09:51+00:00</created-at>
      <creator-id type="integer">24325</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1102</number>
      <permalink>added-counter_sql-to-valid-keys-for-habtm</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.2 activerecord bug edge patch</tag>
      <title>Added :counter_sql to valid keys for HABTM</title>
      <updated-at type="datetime">2008-11-06T21:09:54+00:00</updated-at>
      <user-id type="integer">1741</user-id>
      <version type="integer">7</version>
      <user-name>Tekin</user-name>
      <creator-name>Ernie Miller</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1102</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>(from [32a5cfcd7f8d14407f0c00ce2cdc82b1b568438e]) Added tests for HABTM associations with counter_sql

Signed-off-by: Michael Koziarski &lt;michael@koziarski.com&gt;
[#1102 state:committed]
http://github.com/rails/rails/commit/32a5cfcd7f8d14407f0c00ce2cdc82b1b568438e</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from [32a5cfcd7f8d14407f0c00ce2cdc82b1b568438e]) Added tests
for HABTM associations with counter_sql&lt;/p&gt;
&lt;p&gt;Signed-off-by: Michael Koziarski &lt;a href=&quot;mailto:michael@koziarski.com&quot;&gt;michael@koziarski.com&lt;/a&gt; [&lt;a href=&quot;/projects/8994/tickets/1102&quot; title=&quot;Ticket #1102&quot;&gt;#1102&lt;/a&gt;
state:committed] &lt;a href=&quot;http://github.com/rails/rails/commit/32a5cfcd7f8d14407f0c00ce2cdc82b1b568438e&quot;&gt;
http://github.com/rails/rails/co...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-11-07T08:01:30+00:00</created-at>
      <creator-id type="integer">24325</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1102</number>
      <permalink>added-counter_sql-to-valid-keys-for-habtm</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>2.2 activerecord bug edge patch</tag>
      <title>Added :counter_sql to valid keys for HABTM</title>
      <updated-at type="datetime">2008-11-07T08:01:32+00:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">8</version>
      <user-name>Repository</user-name>
      <creator-name>Ernie Miller</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1102</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>97fceaa775dd080ff712153e996d2c605a3d2aab</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2008-09-24T14:37:43+01:00</created-at>
      <filename>habtm_count.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">48297</id>
      <size type="integer">1082</size>
      <uploader-id type="integer">24325</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/48297/habtm_count.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>9896e251b2b0729ab30e1e115f09b0f90cffb3ff</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2008-11-06T20:03:43+00:00</created-at>
      <filename>add_counter_sql_to_valid_keys_for_habtm_associations.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">60017</id>
      <size type="integer">1054</size>
      <uploader-id type="integer">1741</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/60017/add_counter_sql_to_valid_keys_for_habtm_associations.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>f55fd0b0ab6b0032218ef465988de426ee3f74a1</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2008-11-06T21:09:51+00:00</created-at>
      <filename>tests_for_habtm_associations_with_counter_sql.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">60046</id>
      <size type="integer">3431</size>
      <uploader-id type="integer">1741</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/60046/tests_for_habtm_associations_with_counter_sql.diff</url>
    </attachment>
  </attachments>
</ticket>
