<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">40272</assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2010-10-02T10:56:00+01:00</created-at>
  <creator-id type="integer">51033</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">82855</milestone-id>
  <number type="integer">2279</number>
  <permalink>render-layout-with-block-and-multiple-yields</permalink>
  <priority type="integer">2</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>stale</state>
  <tag>content_for layout render yield</tag>
  <title>render :layout with block and multiple yields renders twice</title>
  <updated-at type="datetime">2011-02-02T18:46:28+00:00</updated-at>
  <user-id type="integer">40272</user-id>
  <version type="integer">18</version>
  <user-name>Santiago Pastorino</user-name>
  <creator-name>Jeff Schuil</creator-name>
  <assigned-user-name>Santiago Pastorino</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
  <milestone-title>2.3.10</milestone-title>
  <priority-name>Medium</priority-name>
  <original-body>Its possible I'm misusing render :layout for sharing view markup between layouts, but this seems strange nonetheless.

@@@ ruby
&lt;!-- layouts/_common.html.erb --&gt;
common
&lt;%= yield :top %&gt;
&lt;%= yield %&gt;

&lt;!-- layouts/application.html.erb --&gt;
&lt;% render :layout =&gt; 'layouts/common' do %&gt;
  layout
  &lt;%= yield :layout %&gt;
&lt;% end %&gt;

&lt;!-- some view --&gt;
view
@@@

outputs (newlines added):
common
layout   &lt;-- Added by yield :top
view
layout   &lt;-- Added by yield
view

Notice, I haven't declared content_for :top, but it is outputting 'layout view'.

Adding any yields with an argument, like 'yield :bottom' also output the same.

Note: In application.html.erb, I tried just putting yield, not yield :layout, but I got a stack level too deep error.

I reworked my shared layouts to not pass a block to render :layout, but thought I would see if this was in fact a bug.</original-body>
  <latest-body>Its possible I'm misusing render :layout for sharing view markup between layouts, but this seems strange nonetheless.

@@@ ruby
&lt;!-- layouts/_common.html.erb --&gt;
common
&lt;%= yield :top %&gt;
&lt;%= yield %&gt;

&lt;!-- layouts/application.html.erb --&gt;
&lt;% render :layout =&gt; 'layouts/common' do %&gt;
  layout
  &lt;%= yield :layout %&gt;
&lt;% end %&gt;

&lt;!-- some view --&gt;
view
@@@

outputs (newlines added):
common
layout   &lt;-- Added by yield :top
view
layout   &lt;-- Added by yield
view

Notice, I haven't declared content_for :top, but it is outputting 'layout view'.

Adding any yields with an argument, like 'yield :bottom' also output the same.

Note: In application.html.erb, I tried just putting yield, not yield :layout, but I got a stack level too deep error.

I reworked my shared layouts to not pass a block to render :layout, but thought I would see if this was in fact a bug.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;Its possible I'm misusing render :layout for sharing view markup
between layouts, but this seems strange nonetheless.&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
&amp;lt;!-- layouts/_common.html.erb --&amp;gt;
common
&amp;lt;%= yield :top %&amp;gt;
&amp;lt;%= yield %&amp;gt;

&amp;lt;!-- layouts/application.html.erb --&amp;gt;
&amp;lt;% render :layout =&amp;gt; 'layouts/common' do %&amp;gt;
  layout
  &amp;lt;%= yield :layout %&amp;gt;
&amp;lt;% end %&amp;gt;

&amp;lt;!-- some view --&amp;gt;
view
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;outputs (newlines added): common layout &amp;lt;-- Added by yield
:top view layout &amp;lt;-- Added by yield view&lt;/p&gt;
&lt;p&gt;Notice, I haven't declared content_for :top, but it is
outputting 'layout view'.&lt;/p&gt;
&lt;p&gt;Adding any yields with an argument, like 'yield :bottom' also
output the same.&lt;/p&gt;
&lt;p&gt;Note: In application.html.erb, I tried just putting yield, not
yield :layout, but I got a stack level too deep error.&lt;/p&gt;
&lt;p&gt;I reworked my shared layouts to not pass a block to render
:layout, but thought I would see if this was in fact a bug.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Its possible I'm misusing render :layout for sharing view markup between layouts, but this seems strange nonetheless.

@@@ ruby
&lt;!-- layouts/_common.html.erb --&gt;
common
&lt;%= yield :top %&gt;
&lt;%= yield %&gt;

&lt;!-- layouts/application.html.erb --&gt;
&lt;% render :layout =&gt; 'layouts/common' do %&gt;
  layout
  &lt;%= yield :layout %&gt;
&lt;% end %&gt;

&lt;!-- some view --&gt;
view
@@@

outputs (newlines added):

    common
    layout   &lt;-- Added by yield :top
    view
    layout   &lt;-- Added by yield
    view

Notice, I haven't declared content_for :top, but it is outputting an extra 'layout view'.

Adding any yields to common with an argument, like 'yield :bottom', also output the extra 'layout view'.

Note: In application.html.erb, I tried just putting yield, not yield :layout, but I got a stack level too deep error.

I reworked my shared layouts to not pass a block to render :layout, but thought I would see if this was in fact a bug.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Its possible I'm misusing render :layout for sharing view markup
between layouts, but this seems strange nonetheless.&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
&amp;lt;!-- layouts/_common.html.erb --&amp;gt;
common
&amp;lt;%= yield :top %&amp;gt;
&amp;lt;%= yield %&amp;gt;

&amp;lt;!-- layouts/application.html.erb --&amp;gt;
&amp;lt;% render :layout =&amp;gt; 'layouts/common' do %&amp;gt;
  layout
  &amp;lt;%= yield :layout %&amp;gt;
&amp;lt;% end %&amp;gt;

&amp;lt;!-- some view --&amp;gt;
view
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;outputs (newlines added):&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;common
layout   &amp;lt;-- Added by yield :top
view
layout   &amp;lt;-- Added by yield
view
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Notice, I haven't declared content_for :top, but it is
outputting an extra 'layout view'.&lt;/p&gt;
&lt;p&gt;Adding any yields to common with an argument, like 'yield
:bottom', also output the extra 'layout view'.&lt;/p&gt;
&lt;p&gt;Note: In application.html.erb, I tried just putting yield, not
yield :layout, but I got a stack level too deep error.&lt;/p&gt;
&lt;p&gt;I reworked my shared layouts to not pass a block to render
:layout, but thought I would see if this was in fact a bug.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-17T22:12:50+00:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2009-03-17T22:21:44+00:00</updated-at>
      <user-id type="integer">51033</user-id>
      <version type="integer">1</version>
      <user-name>Jeff Schuil</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Also, in _common.html.erb, if instead of &lt;%= yield :top %&gt; I use (the deprecated) &lt;%= @content_for_top %&gt; it works as expected.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Also, in _common.html.erb, if instead of &amp;lt;%= yield :top %&amp;gt;
I use (the deprecated) &amp;lt;%= @content_for_top %&amp;gt; it works as
expected.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-17T22:35:12+00:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2009-03-17T22:35:14+00:00</updated-at>
      <user-id type="integer">51033</user-id>
      <version type="integer">2</version>
      <user-name>Jeff Schuil</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I don't see a doubled &quot;view&quot;, but I can confirm that I reproduced the &quot;stack too deep&quot; problem when rendering a complex template on 2.3.5. In my case, the template rendered a block with a layout, and inside the block, rendered a partial with a different layout, the whole thing wrapped in a normal layout. Yes, hairy. Inherited code, one of many things I'm trying to clean up.

Specifying &quot;yield :layout&quot; explicitly in every template that acts as a layout fixed the recursion that happens due to the render-block-with-layout code. The problem also goes away if I remove the render-block-with-layout (keeping the inner part), though in that case part of the page design goes away, so it's not a very good fix.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I don't see a doubled &quot;view&quot;, but I can confirm that I
reproduced the &quot;stack too deep&quot; problem when rendering a complex
template on 2.3.5. In my case, the template rendered a block with a
layout, and inside the block, rendered a partial with a different
layout, the whole thing wrapped in a normal layout. Yes, hairy.
Inherited code, one of many things I'm trying to clean up.&lt;/p&gt;
&lt;p&gt;Specifying &quot;yield :layout&quot; explicitly in every template that
acts as a layout fixed the recursion that happens due to the
render-block-with-layout code. The problem also goes away if I
remove the render-block-with-layout (keeping the inner part),
though in that case part of the page design goes away, so it's not
a very good fix.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-12-16T03:03:00+00:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: content_for layout render yield
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.5 content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2009-12-16T03:03:02+00:00</updated-at>
      <user-id type="integer">48902</user-id>
      <version type="integer">3</version>
      <user-name>Steve Madsen</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>There's also a problem with passing a layout to render a collection with partials.
The layout is applied around the whole collection (as expected), but the whole thing (layout plus collection partials) **gets rendered as many times as the items in the collection**.

Here's a quick patch that should fix both problems...</body>
      <body-html>&lt;div&gt;&lt;p&gt;There's also a problem with passing a layout to render a
collection with partials.&lt;br&gt;
The layout is applied around the whole collection (as expected),
but the whole thing (layout plus collection partials) &lt;strong&gt;gets
rendered as many times as the items in the collection&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Here's a quick patch that should fix both problems...&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-02-03T15:38:16+00:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.5 content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2010-02-03T15:38:23+00:00</updated-at>
      <user-id type="integer">29259</user-id>
      <version type="integer">4</version>
      <user-name>Leandro Pedroni</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I've run into this problem running ruby1.9.1 and rails 3 beta. I'm trying to use two &quot;render :layout do [something] end&quot; inside each other.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've run into this problem running ruby1.9.1 and rails 3 beta.
I'm trying to use two &quot;render :layout do &lt;a href=
&quot;/projects/8994/changesets/something&quot; title=
&quot;Changeset [something]&quot;&gt;[something]&lt;/a&gt; end&quot; inside each other.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-02-23T09:38:46+00:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.5 content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2010-02-23T09:38:48+00:00</updated-at>
      <user-id type="integer">55948</user-id>
      <version type="integer">5</version>
      <user-name>Rasmus R&#248;nn Nielsen</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/19097)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/19097&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-04T18:48:42+01:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 9903
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.5 content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2010-05-04T18:48:42+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">6</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Confirm that this is a problem on 2.3.8 as well. 

Leandro's patch fixes the problem of repeated output when passing collection is used problem.
Render layout with block however is not working (with or without the patch above).

Ruby -v
ruby 1.8.7 (2010-06-07 patchlevel 268)</body>
      <body-html>&lt;div&gt;&lt;p&gt;Confirm that this is a problem on 2.3.8 as well.&lt;/p&gt;
&lt;p&gt;Leandro's patch fixes the problem of repeated output when
passing collection is used problem.&lt;br&gt;
Render layout with block however is not working (with or without
the patch above).&lt;/p&gt;
&lt;p&gt;Ruby -v&lt;br&gt;
ruby 1.8.7 (2010-06-07 patchlevel 268)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-27T20:55:01+01:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">1455</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.5 content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2010-06-27T20:55:09+01:00</updated-at>
      <user-id type="integer">104798</user-id>
      <version type="integer">7</version>
      <user-name>Aditya</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Leandro can you provide a patch following http://rails.lighthouseapp.com/projects/8994/sending-patches and add a test for this cases?.
Thank you.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Leandro can you provide a patch following &lt;a href=
&quot;http://rails.lighthouseapp.com/projects/8994/sending-patches&quot;&gt;http://rails.lighthouseapp.com/projects/8994/sending-patches&lt;/a&gt;
and add a test for this cases?.&lt;br&gt;
Thank you.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-06-30T01:59:44+01:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 2.3.5 content_for layout render yield
:state: new
:priority: 1455
:milestone: 71472
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2010-06-30T01:59:50+01:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">8</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I am not able to reproduce this problem in 2-3-stable. However Aditya was able to recreate this problem just 3 days ago. Not sure what's going on.

Can someone else try?</body>
      <body-html>&lt;div&gt;&lt;p&gt;I am not able to reproduce this problem in 2-3-stable. However
Aditya was able to recreate this problem just 3 days ago. Not sure
what's going on.&lt;/p&gt;
&lt;p&gt;Can someone else try?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-01T03:44:14+01:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2010-07-01T03:44:23+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">9</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I can reproduce the output described by Jeff with Rails 2.3.8, Ruby 1.8.7 and 1.9.2.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I can reproduce the output described by Jeff with Rails 2.3.8,
Ruby 1.8.7 and 1.9.2.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-18T12:06:03+01:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2010-07-18T12:06:05+01:00</updated-at>
      <user-id type="integer">67647</user-id>
      <version type="integer">10</version>
      <user-name>masone</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Is this an issue on master too? or only 2-3-stable?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Is this an issue on master too? or only 2-3-stable?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-19T16:37:24+01:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2010-07-19T16:37:26+01:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">11</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I can't reproduce this on 3-0-stable. Changing milestone.

Can somebody please try this in 2-3-stable?</body>
      <body-html>&lt;div&gt;&lt;p&gt;I can't reproduce this on 3-0-stable. Changing milestone.&lt;/p&gt;
&lt;p&gt;Can somebody please try this in 2-3-stable?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-03T08:41:30+01:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 27004
</diffable-attributes>
      <milestone-id type="integer">73534</milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2010-08-03T08:41:32+01:00</updated-at>
      <user-id type="integer">89656</user-id>
      <version type="integer">12</version>
      <user-name>Rohit Arondekar</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title>2.3.9</milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>masone has reproduced this on 2.3.8 on July 18th, can you try it on 2-3-stable from git?.
And can someone provide a patch</body>
      <body-html>&lt;div&gt;&lt;p&gt;masone has reproduced this on 2.3.8 on July 18th, can you try it
on 2-3-stable from git?.&lt;br&gt;
And can someone provide a patch&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-03T16:42:41+01:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">73534</milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2010-08-03T16:42:45+01:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">13</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title>2.3.9</milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/27613)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/27613&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-30T02:28:48+01:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 73534
</diffable-attributes>
      <milestone-id type="integer">82855</milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2010-08-30T02:28:48+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">14</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title>2.3.10</milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I've created a sample app that may or may not be this issue but is very similar. I'm not sure that the yields are causing the failures.

http://github.com/jgeiger/double_render_bug</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've created a sample app that may or may not be this issue but
is very similar. I'm not sure that the yields are causing the
failures.&lt;/p&gt;
&lt;p&gt;&lt;a href=
&quot;http://github.com/jgeiger/double_render_bug&quot;&gt;http://github.com/jgeiger/double_render_bug&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-27T18:51:43+01:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">82855</milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2010-09-27T18:51:45+01:00</updated-at>
      <user-id type="integer">30336</user-id>
      <version type="integer">15</version>
      <user-name>jgeiger</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title>2.3.10</milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Isn't this because actionpack-3.0.0\lib\action_view\render\rendering.rb is:


    def render(options = {}, locals = {}, &amp;block)
      case options
      when Hash
        if block_given?
          _render_partial(options.merge(:partial =&gt; options[:layout]), &amp;block)

where it should be?

    def render(options = {}, locals = {}, &amp;block)
      case options
      when Hash
        if block_given?
          options.merge!(:partial =&gt; options[:layout])
          options.delete(:layout)
          _render_partial(options, &amp;block)</body>
      <body-html>&lt;div&gt;&lt;p&gt;Isn't this because
actionpack-3.0.0\lib\action_view\render\rendering.rb is:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;def render(options = {}, locals = {}, &amp;amp;block)
  case options
  when Hash
    if block_given?
      _render_partial(options.merge(:partial =&amp;gt; options[:layout]), &amp;amp;block)&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;where it should be?&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;def render(options = {}, locals = {}, &amp;amp;block)
  case options
  when Hash
    if block_given?
      options.merge!(:partial =&amp;gt; options[:layout])
      options.delete(:layout)
      _render_partial(options, &amp;amp;block)&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-10-06T11:08:46+01:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">82855</milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2010-10-06T11:08:48+01:00</updated-at>
      <user-id type="integer">118638</user-id>
      <version type="integer">16</version>
      <user-name>Shimon Young</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title>2.3.10</milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>This issue has been automatically marked as stale because it has not been commented on for at least three months.

The resources of the Rails core team are limited, and so we are asking for your help. If you can still reproduce this error on the 3-0-stable branch or on master, please reply with all of the information you have about it and add &quot;[state:open]&quot; to your comment. This will reopen the ticket for review. Likewise, if you feel that this is a very important feature for Rails to include, please reply with your explanation so we can consider it.

Thank you for all your contributions, and we hope you will understand this step to focus our efforts where they are most helpful.</body>
      <body-html>&lt;div&gt;&lt;p&gt;This issue has been automatically marked as stale because it has
not been commented on for at least three months.&lt;/p&gt;
&lt;p&gt;The resources of the Rails core team are limited, and so we are
asking for your help. If you can still reproduce this error on the
3-0-stable branch or on master, please reply with all of the
information you have about it and add &quot;[state:open]&quot; to your
comment. This will reopen the ticket for review. Likewise, if you
feel that this is a very important feature for Rails to include,
please reply with your explanation so we can consider it.&lt;/p&gt;
&lt;p&gt;Thank you for all your contributions, and we hope you will
understand this step to focus our efforts where they are most
helpful.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2011-02-02T16:58:43+00:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">82855</milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2011-02-02T18:45:52+00:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">17</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title>2.3.10</milestone-title>
      <priority-name>Medium</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body nil="true"></body>
      <body-html nil="true"></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2011-02-02T16:58:48+00:00</created-at>
      <creator-id type="integer">51033</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer">82855</milestone-id>
      <number type="integer">2279</number>
      <permalink>render-layout-with-block-and-multiple-yields</permalink>
      <priority type="integer">2</priority>
      <project-id type="integer">8994</project-id>
      <state>stale</state>
      <tag>content_for layout render yield</tag>
      <title>render :layout with block and multiple yields renders twice</title>
      <updated-at type="datetime">2011-02-02T18:46:28+00:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">18</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>Jeff Schuil</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2279</url>
      <milestone-title>2.3.10</milestone-title>
      <priority-name>Medium</priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>649197f6e0830c43644fd65ebac36733b5072c26</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-02-03T15:38:16+00:00</created-at>
      <filename>partial_layouts_patch.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">399571</id>
      <size type="integer">1097</size>
      <uploader-id type="integer">29259</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/399571/partial_layouts_patch.diff</url>
    </attachment>
  </attachments>
</ticket>
