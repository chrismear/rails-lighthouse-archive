<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">25293</assigned-user-id>
  <attachments-count type="integer">0</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2010-01-21T07:29:44+00:00</created-at>
  <creator-id type="integer">7644</creator-id>
  <milestone-due-on type="datetime">2010-01-15T00:00:00+00:00</milestone-due-on>
  <milestone-id type="integer">50064</milestone-id>
  <number type="integer">3201</number>
  <permalink>number_to_human_size-only-working-properly-when-precision-and-separator-given</permalink>
  <priority type="integer">3</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>invalid</state>
  <tag>actionview i18n locale</tag>
  <title>number_to_human_size only working properly when :precision and :separator given</title>
  <updated-at type="datetime">2010-01-25T13:01:24+00:00</updated-at>
  <user-id type="integer">25293</user-id>
  <version type="integer">9</version>
  <user-name>Prem Sichanugrist (sikachu)</user-name>
  <creator-name>Smeevil</creator-name>
  <assigned-user-name>Prem Sichanugrist (sikachu)</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/3201</url>
  <milestone-title>2.3.6</milestone-title>
  <priority-name>Low</priority-name>
  <original-body>number_to_human_size(10000000000)
returns : 9.31322574615479 

whereas number_to_human_size(10000000000,:precision =&gt; 2, :separator =&gt; '.')
returns : 9.31 GB 

leaving out either precision or seperator returns the first result again.

using in the yml : 

nl:
  number:
    human:
      storage_units:
        format: &quot;%n %u&quot;
        units:
          byte:
            one: &quot;byte&quot;
            other: &quot;bytes&quot;
          kb: &quot;KB&quot;
          mb: &quot;MB&quot;
          gb: &quot;GB&quot;</original-body>
  <latest-body>number_to_human_size(10000000000)
returns : 9.31322574615479 

whereas number_to_human_size(10000000000,:precision =&gt; 2, :separator =&gt; '.')
returns : 9.31 GB 

leaving out either precision or seperator returns the first result again.

using in the yml : 

nl:
  number:
    human:
      storage_units:
        format: &quot;%n %u&quot;
        units:
          byte:
            one: &quot;byte&quot;
            other: &quot;bytes&quot;
          kb: &quot;KB&quot;
          mb: &quot;MB&quot;
          gb: &quot;GB&quot;</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;number_to_human_size(10000000000)&lt;br&gt;
returns : 9.31322574615479&lt;/p&gt;
&lt;p&gt;whereas number_to_human_size(10000000000,:precision =&amp;gt; 2,
:separator =&amp;gt; '.')&lt;br&gt;
returns : 9.31 GB&lt;/p&gt;
&lt;p&gt;leaving out either precision or seperator returns the first
result again.&lt;/p&gt;
&lt;p&gt;using in the yml :&lt;/p&gt;
&lt;p&gt;nl:&lt;br&gt;
number:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;human:
  storage_units:
    format: &quot;%n %u&quot;
    units:
      byte:
        one: &quot;byte&quot;
        other: &quot;bytes&quot;
      kb: &quot;KB&quot;
      mb: &quot;MB&quot;
      gb: &quot;GB&quot;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>number_to_human_size(10000000000)
returns : 9.31322574615479 

whereas number_to_human_size(10000000000,:precision =&gt; 2, :separator =&gt; '.')
returns : 9.31 GB 

leaving out either precision or seperator returns the first result again.

using in the yml : 

nl:
  number:
    human:
      storage_units:
        format: &quot;%n %u&quot;
        units:
          byte:
            one: &quot;byte&quot;
            other: &quot;bytes&quot;
          kb: &quot;KB&quot;
          mb: &quot;MB&quot;
          gb: &quot;GB&quot;</body>
      <body-html>&lt;div&gt;&lt;p&gt;number_to_human_size(10000000000)&lt;br&gt;
returns : 9.31322574615479&lt;/p&gt;
&lt;p&gt;whereas number_to_human_size(10000000000,:precision =&amp;gt; 2,
:separator =&amp;gt; '.')&lt;br&gt;
returns : 9.31 GB&lt;/p&gt;
&lt;p&gt;leaving out either precision or seperator returns the first
result again.&lt;/p&gt;
&lt;p&gt;using in the yml :&lt;/p&gt;
&lt;p&gt;nl:&lt;br&gt;
number:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;human:
  storage_units:
    format: &quot;%n %u&quot;
    units:
      byte:
        one: &quot;byte&quot;
        other: &quot;bytes&quot;
      kb: &quot;KB&quot;
      mb: &quot;MB&quot;
      gb: &quot;GB&quot;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-14T21:27:12+01:00</created-at>
      <creator-id type="integer">7644</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3201</number>
      <permalink>number_to_human_size-only-working-properly-when-precision-and-separator-given</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>number_to_human_size only working properly when :precision and :separator given</title>
      <updated-at type="datetime">2009-09-14T21:27:17+01:00</updated-at>
      <user-id type="integer">7644</user-id>
      <version type="integer">1</version>
      <user-name>Smeevil</user-name>
      <creator-name>Smeevil</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3201</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body nil="true"></body>
      <body-html nil="true"></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-25T12:12:31+01:00</created-at>
      <creator-id type="integer">7644</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3201</number>
      <permalink>number_to_human_size-only-working-properly-when-precision-and-separator-given</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash</tag>
      <title>number_to_human_size only working properly when :precision and :separator given</title>
      <updated-at type="datetime">2009-09-25T12:48:31+01:00</updated-at>
      <user-id type="integer">7211</user-id>
      <version type="integer">2</version>
      <user-name>CancelProfileIsBroken</user-name>
      <creator-name>Smeevil</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3201</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>+1 verified

The issue reproduce if user set his own locale and not define number[:human][:format] or number[:format] details.
Not sure that this is a bug...</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 verified&lt;/p&gt;
&lt;p&gt;The issue reproduce if user set his own locale and not define
number[:human][:format] or number[:format] details.&lt;br&gt;
Not sure that this is a bug...&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-26T17:57:33+01:00</created-at>
      <creator-id type="integer">7644</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3201</number>
      <permalink>number_to_human_size-only-working-properly-when-precision-and-separator-given</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash</tag>
      <title>number_to_human_size only working properly when :precision and :separator given</title>
      <updated-at type="datetime">2009-09-26T17:57:37+01:00</updated-at>
      <user-id type="integer">37919</user-id>
      <version type="integer">3</version>
      <user-name>Dmitry Maksimov</user-name>
      <creator-name>Smeevil</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3201</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>-1 for Ruby 1.8.6 with Rails 2.0.5

number_to_human_size(10000000000)
NoMethodError: undefined method `number_to_human_size' for #&lt;Object:0x2af485abb338&gt;
	from (irb):1
&gt;&gt; include ActionView::Helpers::NumberHelper
=&gt; Object
&gt;&gt; number_to_human_size(10000000000)
=&gt; &quot;9.3 GB&quot;</body>
      <body-html>&lt;div&gt;&lt;p&gt;-1 for Ruby 1.8.6 with Rails 2.0.5&lt;/p&gt;
&lt;p&gt;number_to_human_size(10000000000)&lt;br&gt;
NoMethodError: undefined method &lt;code&gt;number_to_human_size' for
#&amp;lt;Object:0x2af485abb338&amp;gt;&amp;lt;br/&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;from (irb):1&lt;/code&gt;
&lt;/pre&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;include ActionView::Helpers::NumberHelper =&amp;gt; Object
number_to_human_size(10000000000) =&amp;gt; &quot;9.3 GB&quot;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-26T22:09:40+01:00</created-at>
      <creator-id type="integer">7644</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3201</number>
      <permalink>number_to_human_size-only-working-properly-when-precision-and-separator-given</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash</tag>
      <title>number_to_human_size only working properly when :precision and :separator given</title>
      <updated-at type="datetime">2009-09-26T22:09:46+01:00</updated-at>
      <user-id type="integer">71143</user-id>
      <version type="integer">4</version>
      <user-name>Blue Box Chris</user-name>
      <creator-name>Smeevil</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3201</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>verified in 2-3-stable

steps to reproduce:

1. create a custom locale file (e.g. es.yml) on config/locales
2. make sure you are not defining any number[:human][:format] nor number[:format] settings as kolo mentioned
3. call number_to_human_size specifying the locale you have just configured. E.g. helper.number_to_human_size(100000000, :locale =&gt; :es)

The wrong behavior gets fixed either by setting the number/human/format details in the locale file or by including :precision and :separator options in the call to number_to_human_size helper.</body>
      <body-html>&lt;div&gt;&lt;p&gt;verified in 2-3-stable&lt;/p&gt;
&lt;p&gt;steps to reproduce:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;create a custom locale file (e.g. es.yml) on
config/locales&lt;br&gt;&lt;/li&gt;
&lt;li&gt;make sure you are not defining any number[:human][:format] nor
number[:format] settings as kolo mentioned&lt;br&gt;&lt;/li&gt;
&lt;li&gt;call number_to_human_size specifying the locale you have just
configured. E.g. helper.number_to_human_size(100000000, :locale
=&amp;gt; :es)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The wrong behavior gets fixed either by setting the
number/human/format details in the locale file or by including
:precision and :separator options in the call to
number_to_human_size helper.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-27T03:39:14+01:00</created-at>
      <creator-id type="integer">7644</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3201</number>
      <permalink>number_to_human_size-only-working-properly-when-precision-and-separator-given</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash</tag>
      <title>number_to_human_size only working properly when :precision and :separator given</title>
      <updated-at type="datetime">2009-09-27T03:39:16+01:00</updated-at>
      <user-id type="integer">56830</user-id>
      <version type="integer">5</version>
      <user-name>Mat&#237;as Flores</user-name>
      <creator-name>Smeevil</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3201</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-01-21T07:31:06+00:00</created-at>
      <creator-id type="integer">7644</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: bugmash
:state: new
:milestone: 
</diffable-attributes>
      <milestone-id type="integer">50064</milestone-id>
      <number type="integer">3201</number>
      <permalink>number_to_human_size-only-working-properly-when-precision-and-separator-given</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>actionview i18n locale</tag>
      <title>number_to_human_size only working properly when :precision and :separator given</title>
      <updated-at type="datetime">2010-01-21T07:31:07+00:00</updated-at>
      <user-id type="integer">65556</user-id>
      <version type="integer">6</version>
      <user-name>Rizwan Reza</user-name>
      <creator-name>Smeevil</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3201</url>
      <milestone-title>2.3.6</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">25293</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-01-24T09:45:05+00:00</created-at>
      <creator-id type="integer">7644</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">50064</milestone-id>
      <number type="integer">3201</number>
      <permalink>number_to_human_size-only-working-properly-when-precision-and-separator-given</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>actionview i18n locale</tag>
      <title>number_to_human_size only working properly when :precision and :separator given</title>
      <updated-at type="datetime">2010-01-24T09:45:06+00:00</updated-at>
      <user-id type="integer">25293</user-id>
      <version type="integer">7</version>
      <user-name>Prem Sichanugrist (sikachu)</user-name>
      <creator-name>Smeevil</creator-name>
      <assigned-user-name>Prem Sichanugrist (sikachu)</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3201</url>
      <milestone-title>2.3.6</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">25293</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>TBH, i don't think this is a bug, so -1

It's an incomplete locale file. So far we don't do local fallbacks in Rails. 

So, to fix this one could

- either complete the locale file
- or enable locale fallbacks in the I18n backend (e.g. include I18n::Backend::Fallbacks to I18n::Backend::Simple)</body>
      <body-html>&lt;div&gt;&lt;p&gt;TBH, i don't think this is a bug, so -1&lt;/p&gt;
&lt;p&gt;It's an incomplete locale file. So far we don't do local
fallbacks in Rails.&lt;/p&gt;
&lt;p&gt;So, to fix this one could&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;either complete the locale file&lt;/li&gt;
&lt;li&gt;or enable locale fallbacks in the I18n backend (e.g. include
I18n::Backend::Fallbacks to I18n::Backend::Simple)&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-01-25T12:52:57+00:00</created-at>
      <creator-id type="integer">7644</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">50064</milestone-id>
      <number type="integer">3201</number>
      <permalink>number_to_human_size-only-working-properly-when-precision-and-separator-given</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>actionview i18n locale</tag>
      <title>number_to_human_size only working properly when :precision and :separator given</title>
      <updated-at type="datetime">2010-01-25T12:53:03+00:00</updated-at>
      <user-id type="integer">7400</user-id>
      <version type="integer">8</version>
      <user-name>Sven Fuchs</user-name>
      <creator-name>Smeevil</creator-name>
      <assigned-user-name>Prem Sichanugrist (sikachu)</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3201</url>
      <milestone-title>2.3.6</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">25293</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>As said by Sevn Fuchs, I think you should complete it or use fallback backend.</body>
      <body-html>&lt;div&gt;&lt;p&gt;As said by Sevn Fuchs, I think you should complete it or use
fallback backend.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-01-25T13:01:22+00:00</created-at>
      <creator-id type="integer">7644</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer">50064</milestone-id>
      <number type="integer">3201</number>
      <permalink>number_to_human_size-only-working-properly-when-precision-and-separator-given</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>actionview i18n locale</tag>
      <title>number_to_human_size only working properly when :precision and :separator given</title>
      <updated-at type="datetime">2010-01-25T13:01:24+00:00</updated-at>
      <user-id type="integer">25293</user-id>
      <version type="integer">9</version>
      <user-name>Prem Sichanugrist (sikachu)</user-name>
      <creator-name>Smeevil</creator-name>
      <assigned-user-name>Prem Sichanugrist (sikachu)</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3201</url>
      <milestone-title>2.3.6</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
</ticket>
