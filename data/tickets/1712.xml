<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">424</assigned-user-id>
  <attachments-count type="integer">3</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-01-08T13:11:36+00:00</created-at>
  <creator-id type="integer">32111</creator-id>
  <milestone-due-on type="datetime">2009-01-31T00:00:00+00:00</milestone-due-on>
  <milestone-id type="integer" nil="true"></milestone-id>
  <number type="integer">1712</number>
  <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
  <priority type="integer">33</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>2.3 actionview production view</tag>
  <title>&quot;Template is missing&quot; error for engine in production environment</title>
  <updated-at type="datetime">2009-02-22T16:43:27+00:00</updated-at>
  <user-id type="integer">424</user-id>
  <version type="integer">17</version>
  <user-name>Joshua Peek</user-name>
  <creator-name>Ngoc Dao</creator-name>
  <assigned-user-name>Joshua Peek</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
  <priority-name nil="true"></priority-name>
  <original-body>[Edge Rails]

1. Create &quot;my_app&quot; engine (plugin with &quot;app&quot; directory) with proper routes.rb, controller, and view
2. Start server in production environment (ruby script/server -e production) and goto http://localhost:3000/my_app, the error message below appears

----------
Template is missing
Missing template my_app/index.erb in view path app/views
----------</original-body>
  <latest-body>[Edge Rails]

1. Create &quot;my_app&quot; engine (plugin with &quot;app&quot; directory) with proper routes.rb, controller, and view
2. Start server in production environment (ruby script/server -e production) and goto http://localhost:3000/my_app, the error message below appears

----------
Template is missing
Missing template my_app/index.erb in view path app/views
----------</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;[Edge Rails]&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Create &quot;my_app&quot; engine (plugin with &quot;app&quot; directory) with
proper routes.rb, controller, and view&lt;/li&gt;
&lt;li&gt;Start server in production environment (ruby script/server -e
production) and goto &lt;a href=&quot;http://localhost:3000/my_app&quot;&gt;http://localhost:3000/my_app&lt;/a&gt;,
the error message below appears&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;p&gt;Template is missing&lt;/p&gt;
&lt;h2&gt;Missing template my_app/index.erb in view path app/views&lt;/h2&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>[Edge Rails]

1. Create &quot;my_app&quot; engine (plugin with &quot;app&quot; directory) with proper routes.rb, controller, and view
2. Start server in production environment (ruby script/server -e production) and goto http://localhost:3000/my_app, the error message below appears

----------
Template is missing
Missing template my_app/index.erb in view path app/views
----------</body>
      <body-html>&lt;div&gt;&lt;p&gt;[Edge Rails]&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Create &quot;my_app&quot; engine (plugin with &quot;app&quot; directory) with
proper routes.rb, controller, and view&lt;/li&gt;
&lt;li&gt;Start server in production environment (ruby script/server -e
production) and goto &lt;a href=&quot;http://localhost:3000/my_app&quot;&gt;http://localhost:3000/my_app&lt;/a&gt;,
the error message below appears&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;p&gt;Template is missing&lt;/p&gt;
&lt;h2&gt;Missing template my_app/index.erb in view path app/views&lt;/h2&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-01-08T13:11:36+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionview edge production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-01-08T13:11:41+00:00</updated-at>
      <user-id type="integer">32111</user-id>
      <version type="integer">1</version>
      <user-name>Ngoc Dao</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title>2.x</milestone-title>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>The correct view path should be:
vendor/plugins/my_app/app/views</body>
      <body-html>&lt;div&gt;&lt;p&gt;The correct view path should be:
vendor/plugins/my_app/app/views&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-01-08T13:23:21+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionview edge production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-01-08T13:23:23+00:00</updated-at>
      <user-id type="integer">32111</user-id>
      <version type="integer">2</version>
      <user-name>Ngoc Dao</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title>2.x</milestone-title>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Same problem here. In development environment the engine works fine. In production it fails with the same error described above</body>
      <body-html>&lt;div&gt;&lt;p&gt;Same problem here. In development environment the engine works
fine. In production it fails with the same error described
above&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-01-09T16:53:16+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionview edge production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-01-09T16:53:17+00:00</updated-at>
      <user-id type="integer">17102</user-id>
      <version type="integer">3</version>
      <user-name>Stephan Kaag</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title>2.x</milestone-title>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Calling @@ActionController::Base.view_paths@@ in Rails::Plugin::Loader's _add_engine_view_paths_ seems to fix this as a workaround.

A real solution is needed because this functionality is really broken at the moment.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Calling @@ActionController::Base.view_paths@@ in
Rails::Plugin::Loader's &lt;em&gt;add_engine_view_paths&lt;/em&gt; seems to fix
this as a workaround.&lt;/p&gt;
&lt;p&gt;A real solution is needed because this functionality is really
broken at the moment.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-01-11T13:36:19+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionview edge production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-01-11T18:20:00+00:00</updated-at>
      <user-id type="integer">17102</user-id>
      <version type="integer">4</version>
      <user-name>Stephan Kaag</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title>2.x</milestone-title>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Problem found.

The cause is this commit: http://github.com/rails/rails/commit/558ab327b733717f4a8de3ed62b8dcd62e9ff9c3

In production environment the view-path is 'resetted' in the function 'load_view_paths'. The engines view-paths are left out.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Problem found.&lt;/p&gt;
&lt;p&gt;The cause is this commit: &lt;a href=&quot;http://github.com/rails/rails/commit/558ab327b733717f4a8de3ed62b8dcd62e9ff9c3&quot;&gt;
http://github.com/rails/rails/co...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In production environment the view-path is 'resetted' in the
function 'load_view_paths'. The engines view-paths are left
out.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-01-11T14:08:39+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionview edge production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-01-11T18:20:14+00:00</updated-at>
      <user-id type="integer">17102</user-id>
      <version type="integer">5</version>
      <user-name>Stephan Kaag</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title>2.x</milestone-title>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>This problem also occurs in the RC for 2.3</body>
      <body-html>&lt;div&gt;&lt;p&gt;This problem also occurs in the RC for 2.3&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-02T09:36:38+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: actionview edge production view
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 actionview production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-02-02T09:36:43+00:00</updated-at>
      <user-id type="integer">17102</user-id>
      <version type="integer">6</version>
      <user-name>Stephan Kaag</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title>2.x</milestone-title>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I get this error also on development environment.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I get this error also on development environment.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-03T13:57:04+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 actionview production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-02-03T13:57:07+00:00</updated-at>
      <user-id type="integer">40268</user-id>
      <version type="integer">7</version>
      <user-name>marcbey</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title>2.x</milestone-title>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">12714</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-06T13:42:08+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 9903
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 actionview production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-02-06T13:42:10+00:00</updated-at>
      <user-id type="integer">83</user-id>
      <version type="integer">8</version>
      <user-name>DHH</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name>Yehuda Katz (wycats)</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title nil="true"></milestone-title>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">12714</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Here's a simple fix, just changes the existing ActionController::Base.view_paths to EagerPaths.


ActionController::Base.view_paths is already set earlier (in initialize_framework_views, then added to in load_plugins if there are any engine plugins), so configuration.view_path is already in the view_paths -- no need to reference it again.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Here's a simple fix, just changes the existing
ActionController::Base.view_paths to EagerPaths.&lt;/p&gt;
&lt;p&gt;ActionController::Base.view_paths is already set earlier (in
initialize_framework_views, then added to in load_plugins if there
are any engine plugins), so configuration.view_path is already in
the view_paths -- no need to reference it again.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-07T19:51:58+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 actionview production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-02-07T19:52:03+00:00</updated-at>
      <user-id type="integer">22427</user-id>
      <version type="integer">9</version>
      <user-name>David Reese</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name>Yehuda Katz (wycats)</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title nil="true"></milestone-title>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">12714</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Or another simple fix where you don't have to mess with the core code, is to just append the engine paths by hand into ApplicationController.view_paths at the end of your application_controller.rb file.  This is just a hack until the core is fixed, of course, but it does the job.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Or another simple fix where you don't have to mess with the core
code, is to just append the engine paths by hand into
ApplicationController.view_paths at the end of your
application_controller.rb file. This is just a hack until the core
is fixed, of course, but it does the job.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-07T20:51:44+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 actionview production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-02-07T20:51:45+00:00</updated-at>
      <user-id type="integer">27185</user-id>
      <version type="integer">10</version>
      <user-name>Glenn Powell</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name>Yehuda Katz (wycats)</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title nil="true"></milestone-title>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">12714</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Thank you, Glenn, not messing with core code would have been a better idea!

My last patch is wrong. There was of course more refactoring to be done.

Paths are already added correctly as EagerPaths/Paths, depending on cache_classes config, through the setter method on AC::Base.view_paths... but only if they're added as strings, not as ActionView::Template::Path. So initialize_framework_views needed cleanup.

Now, i'm not sure why #load_view_paths needs to exist at all. If there are any view paths, they've already been added correctly (eagerly), afaict.

[there's of course another ticket somewhere RE: the view path confusion in ActionMailer (template_root vs view_paths).]

now wycats, you probably know all this already and this would have taken you 5 minutes...</body>
      <body-html>&lt;div&gt;&lt;p&gt;Thank you, Glenn, not messing with core code would have been a
better idea!&lt;/p&gt;
&lt;p&gt;My last patch is wrong. There was of course more refactoring to
be done.&lt;/p&gt;
&lt;p&gt;Paths are already added correctly as EagerPaths/Paths, depending
on cache_classes config, through the setter method on
AC::Base.view_paths... but only if they're added as strings, not as
ActionView::Template::Path. So initialize_framework_views needed
cleanup.&lt;/p&gt;
&lt;p&gt;Now, i'm not sure why #load_view_paths needs to exist at all. If
there are any view paths, they've already been added correctly
(eagerly), afaict.&lt;/p&gt;
&lt;p&gt;[there's of course another ticket somewhere RE: the view path
confusion in ActionMailer (template_root vs view_paths).]&lt;/p&gt;
&lt;p&gt;now wycats, you probably know all this already and this would
have taken you 5 minutes...&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-07T21:36:43+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 actionview production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-02-07T21:36:46+00:00</updated-at>
      <user-id type="integer">22427</user-id>
      <version type="integer">11</version>
      <user-name>David Reese</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name>Yehuda Katz (wycats)</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title nil="true"></milestone-title>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">12714</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I've just added ticket #1909 which should fix this problem along with some extra benefits. I'd be grateful if you could check it out and see if it fixes things for you.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've just added ticket &lt;a href=&quot;/projects/8994/tickets/1909&quot; title=&quot;Ticket #1909&quot;&gt;#1909&lt;/a&gt; which should fix this problem along
with some extra benefits. I'd be grateful if you could check it out
and see if it fixes things for you.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-08T10:38:16+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 actionview production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-02-08T10:38:22+00:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">12</version>
      <user-name>Andrew White</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name>Yehuda Katz (wycats)</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title nil="true"></milestone-title>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">12714</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Trying to migrate a heavily engines-based app to 2.3 I've applied David's latest patch and it seems to work for me for ActionView view_paths. ActionMailer does not pick up templates from plugins though but instead breaks with a MethodMissing #find_template for class String (or something like that).

I've come up with the attached patch which certainly is not the right way to solve it (i guess), but maybe it's helpful to point out what's breaking.

(Ah, I should mention that the attached patch is based on David's latest one.)</body>
      <body-html>&lt;div&gt;&lt;p&gt;Trying to migrate a heavily engines-based app to 2.3 I've
applied David's latest patch and it seems to work for me for
ActionView view_paths. ActionMailer does not pick up templates from
plugins though but instead breaks with a MethodMissing
#find_template for class String (or something like that).&lt;/p&gt;
&lt;p&gt;I've come up with the attached patch which certainly is not the
right way to solve it (i guess), but maybe it's helpful to point
out what's breaking.&lt;/p&gt;
&lt;p&gt;(Ah, I should mention that the attached patch is based on
David's latest one.)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-09T09:02:11+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 actionview production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-02-09T09:02:44+00:00</updated-at>
      <user-id type="integer">7400</user-id>
      <version type="integer">13</version>
      <user-name>Sven Fuchs</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name>Yehuda Katz (wycats)</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title nil="true"></milestone-title>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">12714</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>thanks sven... I realized ActionMailer wasn't getting the paths right but I went ahead and tried Andrew White's patch (on #1909) and it both fixed the original problem (this ticket) and vastly sped up my dev environment.

From what I can tell, ActionMailer is still not actually using all the view paths you send it -- in the initialize it gets templates from template root, which is:

@@@ ruby
      def template_root
        self.view_paths &amp;&amp; self.view_paths.first
      end
@@@

(Meanwhile I encountered an unsolvable bug in 2.3 where my cookies weren't being written correctly. Not even sure where to file that bug (rails? rack? passenger?) So i'm back to 2.2 and called it a day.)</body>
      <body-html>&lt;div&gt;&lt;p&gt;thanks sven... I realized ActionMailer wasn't getting the paths
right but I went ahead and tried Andrew White's patch (on &lt;a href=&quot;/projects/8994/tickets/1909&quot; title=&quot;Ticket #1909&quot;&gt;#1909&lt;/a&gt;) and
it both fixed the original problem (this ticket) and vastly sped up
my dev environment.&lt;/p&gt;
&lt;p&gt;From what I can tell, ActionMailer is still not actually using
all the view paths you send it -- in the initialize it gets
templates from template root, which is:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
      def template_root
        self.view_paths &amp;amp;&amp;amp; self.view_paths.first
      end
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;(Meanwhile I encountered an unsolvable bug in 2.3 where my
cookies weren't being written correctly. Not even sure where to
file that bug (rails? rack? passenger?) So i'm back to 2.2 and
called it a day.)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-09T15:37:45+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 actionview production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-02-09T15:37:49+00:00</updated-at>
      <user-id type="integer">22427</user-id>
      <version type="integer">14</version>
      <user-name>David Reese</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name>Yehuda Katz (wycats)</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title nil="true"></milestone-title>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">12714</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>David, maybe this ticket has something to do with your cookies problem?

http://rails.lighthouseapp.com:80/projects/8994/tickets/1957-sessions-break-in-23-with-mongrel#ticket-1957-7</body>
      <body-html>&lt;div&gt;&lt;p&gt;David, maybe this ticket has something to do with your cookies
problem?&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://rails.lighthouseapp.com:80/projects/8994/tickets/1957-sessions-break-in-23-with-mongrel#ticket-1957-7&quot;&gt;
http://rails.lighthouseapp.com:8...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-14T10:07:50+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 actionview production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-02-14T10:07:55+00:00</updated-at>
      <user-id type="integer">11904</user-id>
      <version type="integer">15</version>
      <user-name>Thijs</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name>Yehuda Katz (wycats)</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title nil="true"></milestone-title>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">12714</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Josh, I'm pretty sure you can close this ticket as being fixed by the changes in #1909. I can reproduce this error using 2.3.0 but I can't with edge.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Josh, I'm pretty sure you can close this ticket as being fixed
by the changes in &lt;a href=&quot;/projects/8994/tickets/1909&quot; title=&quot;Ticket #1909&quot;&gt;#1909&lt;/a&gt;. I can reproduce this error using 2.3.0
but I can't with edge.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-22T06:42:21+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 actionview production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-02-22T06:42:25+00:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">16</version>
      <user-name>Andrew White</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name>Yehuda Katz (wycats)</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title nil="true"></milestone-title>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-02-22T16:43:25+00:00</created-at>
      <creator-id type="integer">32111</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
:assigned_user: 12714
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1712</number>
      <permalink>template-is-missing-error-for-engine-in-production-environment</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>2.3 actionview production view</tag>
      <title>&quot;Template is missing&quot; error for engine in production environment</title>
      <updated-at type="datetime">2009-02-22T16:43:27+00:00</updated-at>
      <user-id type="integer">424</user-id>
      <version type="integer">17</version>
      <user-name>Joshua Peek</user-name>
      <creator-name>Ngoc Dao</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1712</url>
      <priority-name nil="true"></priority-name>
      <milestone-title nil="true"></milestone-title>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>084c2b19be04353241f276cce9deb4cac5540adb</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-02-07T19:51:58+00:00</created-at>
      <filename>do-not-override-plugins.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">86352</id>
      <size type="integer">1232</size>
      <uploader-id type="integer">22427</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/86352/do-not-override-plugins.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>fda05d447c2f6ad5923dd102c5fae3efcdd75e13</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-02-07T21:36:43+00:00</created-at>
      <filename>do-not-override-plugin-view-path.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">86359</id>
      <size type="integer">3572</size>
      <uploader-id type="integer">22427</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/86359/do-not-override-plugin-view-path.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>309d7a042a41d574a0e3e05878f5065a196dec68</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-02-09T09:02:11+00:00</created-at>
      <filename>0001-make-actionmailer-view_paths-work-.-somehow.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">86559</id>
      <size type="integer">3218</size>
      <uploader-id type="integer">7400</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/86559/0001-make-actionmailer-view_paths-work-.-somehow.patch</url>
    </attachment>
  </attachments>
</ticket>
