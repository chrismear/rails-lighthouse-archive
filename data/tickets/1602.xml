<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2008-12-19T07:18:30+00:00</created-at>
  <creator-id type="integer">24025</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">9903</milestone-id>
  <number type="integer">1602</number>
  <permalink>failsafe_response-200-ok</permalink>
  <priority type="integer">947</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>wontfix</state>
  <tag nil="true"></tag>
  <title>failsafe_response 200 OK</title>
  <updated-at type="datetime">2009-03-03T20:37:32+00:00</updated-at>
  <user-id type="integer">34876</user-id>
  <version type="integer">3</version>
  <user-name>Bill Kirtley</user-name>
  <creator-name>Joran Greef</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/1602</url>
  <milestone-title>2.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>I've been invoking internal server errors to test Rails status code handling by sending in some malformed JSON.

For an internal server error, however, failsafe_response returns Status: 200 OK with the following in the response body:

@@@
Status: 500 Internal Server Error

Content-Type: text/html

&lt;html&gt;&lt;body&gt;&lt;h1&gt;500 Internal Server Error&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;
@@@

As an aside, I think Rail's error handling schizophrenia between production and development needs to be simplified. Just send the right status header and put just the status text in the response body (to help clients who can't get at the Status header). The developer can get his exception report in the server logs.</original-body>
  <latest-body>I've been invoking internal server errors to test Rails status code handling by sending in some malformed JSON.

For an internal server error, however, failsafe_response returns Status: 200 OK with the following in the response body:

@@@
Status: 500 Internal Server Error

Content-Type: text/html

&lt;html&gt;&lt;body&gt;&lt;h1&gt;500 Internal Server Error&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;
@@@

As an aside, I think Rail's error handling schizophrenia between production and development needs to be simplified. Just send the right status header and put just the status text in the response body (to help clients who can't get at the Status header). The developer can get his exception report in the server logs.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;I've been invoking internal server errors to test Rails status
code handling by sending in some malformed JSON.&lt;/p&gt;
&lt;p&gt;For an internal server error, however, failsafe_response returns
Status: 200 OK with the following in the response body:&lt;/p&gt;


&lt;pre&gt;&lt;code&gt;
Status: 500 Internal Server Error

Content-Type: text/html

&amp;lt;html&amp;gt;&amp;lt;body&amp;gt;&amp;lt;h1&amp;gt;500 Internal Server Error&amp;lt;/h1&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As an aside, I think Rail's error handling schizophrenia between
production and development needs to be simplified. Just send the
right status header and put just the status text in the response
body (to help clients who can't get at the Status header). The
developer can get his exception report in the server logs.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I've been invoking internal server errors to test Rails status code handling by sending in some malformed JSON.

For an internal server error, however, failsafe_response returns Status: 200 OK with the following in the response body:

@@@
Status: 500 Internal Server Error

Content-Type: text/html

&lt;html&gt;&lt;body&gt;&lt;h1&gt;500 Internal Server Error&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;
@@@

As an aside, I think Rail's error handling schizophrenia between production and development needs to be simplified. Just send the right status header and put just the status text in the response body (to help clients who can't get at the Status header). The developer can get his exception report in the server logs.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've been invoking internal server errors to test Rails status
code handling by sending in some malformed JSON.&lt;/p&gt;
&lt;p&gt;For an internal server error, however, failsafe_response returns
Status: 200 OK with the following in the response body:&lt;/p&gt;


&lt;pre&gt;&lt;code&gt;
Status: 500 Internal Server Error

Content-Type: text/html

&amp;lt;html&amp;gt;&amp;lt;body&amp;gt;&amp;lt;h1&amp;gt;500 Internal Server Error&amp;lt;/h1&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As an aside, I think Rail's error handling schizophrenia between
production and development needs to be simplified. Just send the
right status header and put just the status text in the response
body (to help clients who can't get at the Status header). The
developer can get his exception report in the server logs.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-12-19T07:18:31+00:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1602</number>
      <permalink>failsafe_response-200-ok</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>failsafe_response 200 OK</title>
      <updated-at type="datetime">2008-12-19T07:18:35+00:00</updated-at>
      <user-id type="integer">24025</user-id>
      <version type="integer">1</version>
      <user-name>Joran Greef</user-name>
      <creator-name>Joran Greef</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1602</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>@@@ ruby
      def failsafe_response(exception)
        log_failsafe_exception(exception)
        [500, {'Content-Type' =&gt; 'text/html'}, failsafe_response_body]
      rescue Exception =&gt; failsafe_error # Logger or IO errors
        $stderr.puts &quot;Error during failsafe response: #{failsafe_error}&quot;
      end
@@@

Looks like a 500 status code to me. Are you on edge?</body>
      <body-html>&lt;div&gt;&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
      def failsafe_response(exception)
        log_failsafe_exception(exception)
        [500, {'Content-Type' =&amp;gt; 'text/html'}, failsafe_response_body]
      rescue Exception =&amp;gt; failsafe_error # Logger or IO errors
        $stderr.puts &amp;quot;Error during failsafe response: #{failsafe_error}&amp;quot;
      end
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Looks like a 500 status code to me. Are you on edge?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-12-20T16:36:04+00:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1602</number>
      <permalink>failsafe_response-200-ok</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>wontfix</state>
      <tag nil="true"></tag>
      <title>failsafe_response 200 OK</title>
      <updated-at type="datetime">2008-12-20T16:36:05+00:00</updated-at>
      <user-id type="integer">424</user-id>
      <version type="integer">2</version>
      <user-name>Joshua Peek</user-name>
      <creator-name>Joran Greef</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1602</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>This bug exists in versions of Rails up to 2.2.2, but not in the 2.3 code.  

Will there be a 2.2.3?  Is there somewhere to submit a patch?

http://billkirtley.wordpress.com/2009/03/03/failsafe-handling-with-rails/</body>
      <body-html>&lt;div&gt;&lt;p&gt;This bug exists in versions of Rails up to 2.2.2, but not in the
2.3 code.&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Will there be a 2.2.3? Is there somewhere to submit a patch?&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://billkirtley.wordpress.com/2009/03/03/failsafe-handling-with-rails/&quot;&gt;
http://billkirtley.wordpress.com...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-03-03T20:36:48+00:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1602</number>
      <permalink>failsafe_response-200-ok</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>wontfix</state>
      <tag nil="true"></tag>
      <title>failsafe_response 200 OK</title>
      <updated-at type="datetime">2009-03-03T20:37:32+00:00</updated-at>
      <user-id type="integer">34876</user-id>
      <version type="integer">3</version>
      <user-name>Bill Kirtley</user-name>
      <creator-name>Joran Greef</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1602</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>a82601d25045337f3f909c5b5c52d639adca7097</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-03-03T20:36:48+00:00</created-at>
      <filename>failsafe_patch.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">95481</id>
      <size type="integer">1832</size>
      <uploader-id type="integer">34876</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/95481/failsafe_patch.diff</url>
    </attachment>
  </attachments>
</ticket>
