<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">424</assigned-user-id>
  <attachments-count type="integer">4</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-09-26T12:25:33+01:00</created-at>
  <creator-id type="integer">8406</creator-id>
  <milestone-due-on type="datetime">2010-11-15T00:00:00+00:00</milestone-due-on>
  <milestone-id type="integer">88038</milestone-id>
  <number type="integer">3260</number>
  <permalink>actionviewtestcase-needs-to-be-ported-to-master</permalink>
  <priority type="integer">5</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>3.0 actionview bugmash testcase</tag>
  <title>ActionView::TestCase needs to be ported to master.</title>
  <updated-at type="datetime">2010-10-15T23:01:36+01:00</updated-at>
  <user-id type="integer">85</user-id>
  <version type="integer">15</version>
  <user-name>Jeremy Kemper</user-name>
  <creator-name>Eloy Duran</creator-name>
  <assigned-user-name>Joshua Peek</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/3260</url>
  <milestone-title>3.0.2</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>I was gonna do this myself in the near future, and still will if there's no interest, but I realized some people might want to work on this as part of the bugmash.

This new implementation of ActionView::TestCase should be ported to master. Should be a good way to get familiar with some of the view internals as well.

http://github.com/rails/rails/commit/cddd4746f9a2fba8215d53a0f9ac5241f128d07b</original-body>
  <latest-body>I was gonna do this myself in the near future, and still will if there's no interest, but I realized some people might want to work on this as part of the bugmash.

This new implementation of ActionView::TestCase should be ported to master. Should be a good way to get familiar with some of the view internals as well.

http://github.com/rails/rails/commit/cddd4746f9a2fba8215d53a0f9ac5241f128d07b</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;I was gonna do this myself in the near future, and still will if
there's no interest, but I realized some people might want to work
on this as part of the bugmash.&lt;/p&gt;
&lt;p&gt;This new implementation of ActionView::TestCase should be ported
to master. Should be a good way to get familiar with some of the
view internals as well.&lt;/p&gt;
&lt;p&gt;&lt;a href=
&quot;http://github.com/rails/rails/commit/cddd4746f9a2fba8215d53a0f9ac5241f128d07b&quot;&gt;
http://github.com/rails/rails/commit/cddd4746f9a2fba8215d53a0f9ac52...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer">8406</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I was gonna do this myself in the near future, and still will if there's no interest, but I realized some people might want to work on this as part of the bugmash.

This new implementation of ActionView::TestCase should be ported to master. Should be a good way to get familiar with some of the view internals as well.

http://github.com/rails/rails/commit/cddd4746f9a2fba8215d53a0f9ac5241f128d07b</body>
      <body-html>&lt;div&gt;&lt;p&gt;I was gonna do this myself in the near future, and still will if
there's no interest, but I realized some people might want to work
on this as part of the bugmash.&lt;/p&gt;
&lt;p&gt;This new implementation of ActionView::TestCase should be ported
to master. Should be a good way to get familiar with some of the
view internals as well.&lt;/p&gt;
&lt;p&gt;&lt;a href=
&quot;http://github.com/rails/rails/commit/cddd4746f9a2fba8215d53a0f9ac5241f128d07b&quot;&gt;
http://github.com/rails/rails/commit/cddd4746f9a2fba8215d53a0f9ac52...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-26T12:25:33+01:00</created-at>
      <creator-id type="integer">8406</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3260</number>
      <permalink>actionviewtestcase-needs-to-be-ported-to-master</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>3.0 actionview bugmash testcase</tag>
      <title>ActionView::TestCase needs to be ported to master.</title>
      <updated-at type="datetime">2009-09-26T12:25:34+01:00</updated-at>
      <user-id type="integer">8406</user-id>
      <version type="integer">1</version>
      <user-name>Eloy Duran</user-name>
      <creator-name>Eloy Duran</creator-name>
      <assigned-user-name>Eloy Duran</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3260</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">8406</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I've attached a patch that ports ActiveView:TestCase to master</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've attached a patch that ports ActiveView:TestCase to
master&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-26T19:25:07+01:00</created-at>
      <creator-id type="integer">8406</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3260</number>
      <permalink>actionviewtestcase-needs-to-be-ported-to-master</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>3.0 actionview bugmash testcase</tag>
      <title>ActionView::TestCase needs to be ported to master.</title>
      <updated-at type="datetime">2009-09-26T19:25:12+01:00</updated-at>
      <user-id type="integer">36381</user-id>
      <version type="integer">2</version>
      <user-name>Elad Meidar</user-name>
      <creator-name>Eloy Duran</creator-name>
      <assigned-user-name>Eloy Duran</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3260</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">8406</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Patch doesn't apply cleanly to master. There are a couple of simple class renames in the way, and then a more complex refactoring. Several of the tests open ActionController::Helpers#master_helper_module to add helper methods. But that class has moved to AbstractController:Helpers, the method has changed to _helpers, and now it feels like there's an encapsulation boundary there, and opening it up is the wrong way to go about it.

Working on a revised patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Patch doesn't apply cleanly to master. There are a couple of
simple class renames in the way, and then a more complex
refactoring. Several of the tests open
ActionController::Helpers#master_helper_module to add helper
methods. But that class has moved to AbstractController:Helpers,
the method has changed to _helpers, and now it feels like there's
an encapsulation boundary there, and opening it up is the wrong way
to go about it.&lt;/p&gt;
&lt;p&gt;Working on a revised patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-26T21:12:14+01:00</created-at>
      <creator-id type="integer">8406</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3260</number>
      <permalink>actionviewtestcase-needs-to-be-ported-to-master</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>3.0 actionview bugmash testcase</tag>
      <title>ActionView::TestCase needs to be ported to master.</title>
      <updated-at type="datetime">2009-09-26T21:23:47+01:00</updated-at>
      <user-id type="integer">23560</user-id>
      <version type="integer">3</version>
      <user-name>Erik Ostrom</user-name>
      <creator-name>Eloy Duran</creator-name>
      <assigned-user-name>Eloy Duran</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3260</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">8406</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Never mind - it's over my head. Attached is a revision of Elad's patch that got me past the &quot;tests don't run at all&quot; phase and into the &quot;dozens of test failures&quot; phase. This might or might not be better than starting from Elad's patch, or from the original commit.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Never mind - it's over my head. Attached is a revision of Elad's
patch that got me past the &quot;tests don't run at all&quot; phase and into
the &quot;dozens of test failures&quot; phase. This might or might not be
better than starting from Elad's patch, or from the original
commit.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-27T02:26:36+01:00</created-at>
      <creator-id type="integer">8406</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3260</number>
      <permalink>actionviewtestcase-needs-to-be-ported-to-master</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>3.0 actionview bugmash testcase</tag>
      <title>ActionView::TestCase needs to be ported to master.</title>
      <updated-at type="datetime">2009-09-27T02:26:42+01:00</updated-at>
      <user-id type="integer">23560</user-id>
      <version type="integer">4</version>
      <user-name>Erik Ostrom</user-name>
      <creator-name>Eloy Duran</creator-name>
      <assigned-user-name>Eloy Duran</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3260</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">8406</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>-1, confirming Erik's assessment that Elad's patch doesn't seem to work against master.  And after several hours of basically trying to duplicate what Erik was doing, I think this is also beyond me.</body>
      <body-html>&lt;div&gt;&lt;p&gt;-1, confirming Erik's assessment that Elad's patch doesn't seem
to work against master. And after several hours of basically trying
to duplicate what Erik was doing, I think this is also beyond
me.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-27T07:11:52+01:00</created-at>
      <creator-id type="integer">8406</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3260</number>
      <permalink>actionviewtestcase-needs-to-be-ported-to-master</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>3.0 actionview bugmash testcase</tag>
      <title>ActionView::TestCase needs to be ported to master.</title>
      <updated-at type="datetime">2009-09-27T07:11:56+01:00</updated-at>
      <user-id type="integer">71145</user-id>
      <version type="integer">5</version>
      <user-name>Blue Box Stephen</user-name>
      <creator-name>Eloy Duran</creator-name>
      <assigned-user-name>Eloy Duran</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3260</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">8406</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Thanks a lot for trying though guys! I'll do this myself then when I find the time.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Thanks a lot for trying though guys! I'll do this myself then
when I find the time.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-27T12:49:10+01:00</created-at>
      <creator-id type="integer">8406</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3260</number>
      <permalink>actionviewtestcase-needs-to-be-ported-to-master</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>3.0 actionview bugmash testcase</tag>
      <title>ActionView::TestCase needs to be ported to master.</title>
      <updated-at type="datetime">2009-09-27T12:49:13+01:00</updated-at>
      <user-id type="integer">8406</user-id>
      <version type="integer">6</version>
      <user-name>Eloy Duran</user-name>
      <creator-name>Eloy Duran</creator-name>
      <assigned-user-name>Eloy Duran</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3260</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">8406</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Much closer. I expect to have a working patch later today.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Much closer. I expect to have a working patch later today.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-27T23:14:17+01:00</created-at>
      <creator-id type="integer">8406</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3260</number>
      <permalink>actionviewtestcase-needs-to-be-ported-to-master</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>3.0 actionview bugmash testcase</tag>
      <title>ActionView::TestCase needs to be ported to master.</title>
      <updated-at type="datetime">2009-09-27T23:14:22+01:00</updated-at>
      <user-id type="integer">23560</user-id>
      <version type="integer">7</version>
      <user-name>Erik Ostrom</user-name>
      <creator-name>Eloy Duran</creator-name>
      <assigned-user-name>Eloy Duran</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3260</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">8406</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I've attached a patch that makes all the tests pass. I haven't actually verified that you can use it in a real app. But I'm optimistic!

I am somewhat skeptical about the code around test helpers. It breaks the abstraction boundary around AbstractController::Helpers. It would be better if it could use the Helpers API (or if the Helpers API could be extended for that purpose).</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've attached a patch that makes all the tests pass. I haven't
actually verified that you can use it in a real app. But I'm
optimistic!&lt;/p&gt;
&lt;p&gt;I am somewhat skeptical about the code around test helpers. It
breaks the abstraction boundary around AbstractController::Helpers.
It would be better if it could use the Helpers API (or if the
Helpers API could be extended for that purpose).&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-28T07:54:42+01:00</created-at>
      <creator-id type="integer">8406</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3260</number>
      <permalink>actionviewtestcase-needs-to-be-ported-to-master</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>3.0 actionview bugmash testcase</tag>
      <title>ActionView::TestCase needs to be ported to master.</title>
      <updated-at type="datetime">2009-09-28T07:54:47+01:00</updated-at>
      <user-id type="integer">23560</user-id>
      <version type="integer">8</version>
      <user-name>Erik Ostrom</user-name>
      <creator-name>Eloy Duran</creator-name>
      <assigned-user-name>Eloy Duran</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3260</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">8406</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>It looks good, I'll try it out tonight.

&gt; I am somewhat skeptical about the code around test helpers. It breaks the abstraction boundary around AbstractController::Helpers. It would be better if it could use the Helpers API (or if the Helpers API could be extended for that purpose).

&gt; This code breaks the abstraction boundary around AbstractController::Helpers, and in fact includes tests to verify that breaking the abstraction boundary is effective.

Could you elaborate on this? For instance, in the which tests is &#8220;breakage&#8221; tested?

And I assume you're talking about the ActionController::Helpers/AbstractController::Helpers API? That could certainly be refactored yes, for instance, the helpers shouldn't use &#8220;controller&#8221; imo to call helper methods on. Otherwise, like in this example, it has to be monkeypatched. So one way would be if Helpers.helper_method, accepts both the method to make available, plus the receiver, instead of assuming &#8220;controller&#8221; as the receiver. The controller class can then simply override it and super with self as the receiver.</body>
      <body-html>&lt;div&gt;&lt;p&gt;It looks good, I'll try it out tonight.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I am somewhat skeptical about the code around test helpers. It
breaks the abstraction boundary around AbstractController::Helpers.
It would be better if it could use the Helpers API (or if the
Helpers API could be extended for that purpose).&lt;/p&gt;
&lt;p&gt;This code breaks the abstraction boundary around
AbstractController::Helpers, and in fact includes tests to verify
that breaking the abstraction boundary is effective.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Could you elaborate on this? For instance, in the which tests is
&amp;#8220;breakage&amp;#8221; tested?&lt;/p&gt;
&lt;p&gt;And I assume you're talking about the
ActionController::Helpers/AbstractController::Helpers API? That
could certainly be refactored yes, for instance, the helpers
shouldn't use &amp;#8220;controller&amp;#8221; imo to call helper methods
on. Otherwise, like in this example, it has to be monkeypatched. So
one way would be if Helpers.helper_method, accepts both the method
to make available, plus the receiver, instead of assuming
&amp;#8220;controller&amp;#8221; as the receiver. The controller class can
then simply override it and super with self as the receiver.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-28T09:54:39+01:00</created-at>
      <creator-id type="integer">8406</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3260</number>
      <permalink>actionviewtestcase-needs-to-be-ported-to-master</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>3.0 actionview bugmash testcase</tag>
      <title>ActionView::TestCase needs to be ported to master.</title>
      <updated-at type="datetime">2009-09-28T09:54:41+01:00</updated-at>
      <user-id type="integer">8406</user-id>
      <version type="integer">9</version>
      <user-name>Eloy Duran</user-name>
      <creator-name>Eloy Duran</creator-name>
      <assigned-user-name>Eloy Duran</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3260</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">8406</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Yeah, that extension of helper_method is just what I had in mind.

I was confused when I wrote about &quot;tests to verify&quot;. I was referring to &quot;is able to make methods available to the view&quot; and &quot;named routes can be used from helper included in view&quot;, which both open _helpers (formerly master_helper_module). But they do it as a way to set up the test - not as the behavior to be tested. Sorry I got that wrong.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Yeah, that extension of helper_method is just what I had in
mind.&lt;/p&gt;
&lt;p&gt;I was confused when I wrote about &quot;tests to verify&quot;. I was
referring to &quot;is able to make methods available to the view&quot; and
&quot;named routes can be used from helper included in view&quot;, which both
open _helpers (formerly master_helper_module). But they do it as a
way to set up the test - not as the behavior to be tested. Sorry I
got that wrong.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-28T18:11:22+01:00</created-at>
      <creator-id type="integer">8406</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3260</number>
      <permalink>actionviewtestcase-needs-to-be-ported-to-master</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>3.0 actionview bugmash testcase</tag>
      <title>ActionView::TestCase needs to be ported to master.</title>
      <updated-at type="datetime">2009-09-28T18:11:25+01:00</updated-at>
      <user-id type="integer">23560</user-id>
      <version type="integer">10</version>
      <user-name>Erik Ostrom</user-name>
      <creator-name>Eloy Duran</creator-name>
      <assigned-user-name>Eloy Duran</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3260</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>I created an application with a helper, and some simple tests, routes, rendering with ivars and lvars etc. It all worked fine, thanks! So +1 and assigning to Josh. :)

I just had to add one extra require statement to the test case file. This problem was only encountered when running from an app instead of running the actionpack test suite.

I created a new patch with the extra require and adjusted the commit message. All ok with you?</body>
      <body-html>&lt;div&gt;&lt;p&gt;I created an application with a helper, and some simple tests,
routes, rendering with ivars and lvars etc. It all worked fine,
thanks! So +1 and assigning to Josh. :)&lt;/p&gt;
&lt;p&gt;I just had to add one extra require statement to the test case
file. This problem was only encountered when running from an app
instead of running the actionpack test suite.&lt;/p&gt;
&lt;p&gt;I created a new patch with the extra require and adjusted the
commit message. All ok with you?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-28T19:08:38+01:00</created-at>
      <creator-id type="integer">8406</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
:assigned_user: 8406
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3260</number>
      <permalink>actionviewtestcase-needs-to-be-ported-to-master</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>verified</state>
      <tag>3.0 actionview bugmash testcase</tag>
      <title>ActionView::TestCase needs to be ported to master.</title>
      <updated-at type="datetime">2009-09-28T19:08:42+01:00</updated-at>
      <user-id type="integer">8406</user-id>
      <version type="integer">11</version>
      <user-name>Eloy Duran</user-name>
      <creator-name>Eloy Duran</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3260</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>On the topic of the Helpers API etc. Today I thought it would be better to forward almost all method calls to the TestController instance, this would make params, session, request etc work a expected. So these current &quot;hacks&quot; are then probably no longer needed, the only hack that would be needed is to override render so it sets the ivars on the controller and then forwards the call to controller.render which will set the ivars on the view instance.

Still, if you feel like cleaning what we discussed earlier up right now, feel free of course :)</body>
      <body-html>&lt;div&gt;&lt;p&gt;On the topic of the Helpers API etc. Today I thought it would be
better to forward almost all method calls to the TestController
instance, this would make params, session, request etc work a
expected. So these current &quot;hacks&quot; are then probably no longer
needed, the only hack that would be needed is to override render so
it sets the ivars on the controller and then forwards the call to
controller.render which will set the ivars on the view
instance.&lt;/p&gt;
&lt;p&gt;Still, if you feel like cleaning what we discussed earlier up
right now, feel free of course :)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-28T19:11:00+01:00</created-at>
      <creator-id type="integer">8406</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3260</number>
      <permalink>actionviewtestcase-needs-to-be-ported-to-master</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>verified</state>
      <tag>3.0 actionview bugmash testcase</tag>
      <title>ActionView::TestCase needs to be ported to master.</title>
      <updated-at type="datetime">2009-09-28T19:11:02+01:00</updated-at>
      <user-id type="integer">8406</user-id>
      <version type="integer">12</version>
      <user-name>Eloy Duran</user-name>
      <creator-name>Eloy Duran</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3260</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Arg, and the patch&#8230;</body>
      <body-html>&lt;div&gt;&lt;p&gt;Arg, and the patch&amp;#8230;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-28T19:11:37+01:00</created-at>
      <creator-id type="integer">8406</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3260</number>
      <permalink>actionviewtestcase-needs-to-be-ported-to-master</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>verified</state>
      <tag>3.0 actionview bugmash testcase</tag>
      <title>ActionView::TestCase needs to be ported to master.</title>
      <updated-at type="datetime">2009-09-28T19:11:44+01:00</updated-at>
      <user-id type="integer">8406</user-id>
      <version type="integer">13</version>
      <user-name>Eloy Duran</user-name>
      <creator-name>Eloy Duran</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3260</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>(from [8ffc2e3b8de38c485fa24820208b40920dad7ae3]) Ported the new ActionView::TestCase from 2-3-stable to master [#3260
state:resolved]

The test case now mimicks the template environment more closely, so it's
possible to use render, load helper dependencies.

This also fixes assert_select, and similar assertions. Because view tests
and helpers generally don't render full templates assert_select looks
first in rendered and then in output_buffer to find the rendered output.

Additional `master'-only changes: Made the Action Pack Rakefile run the
ActionView::TestCase tests, and made ActionView::Rendering#_render_text
always return a string.

Signed-off-by: Joshua Peek &lt;josh@joshpeek.com&gt;
http://github.com/rails/rails/commit/8ffc2e3b8de38c485fa24820208b40920dad7ae3</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/8ffc2e3b8de38c485fa24820208b40920dad7ae3&quot;
title=
&quot;Changeset [8ffc2e3b8de38c485fa24820208b40920dad7ae3]&quot;&gt;[8ffc2e3b8de38c485fa24820208b40920dad7ae3]&lt;/a&gt;)
Ported the new ActionView::TestCase from 2-3-stable to master
[&lt;a href=&quot;/projects/8994/tickets/3260&quot; title=
&quot;Ticket #3260&quot;&gt;#3260&lt;/a&gt; state:resolved]&lt;/p&gt;
&lt;p&gt;The test case now mimicks the template environment more closely,
so it's&lt;br&gt;
possible to use render, load helper dependencies.&lt;/p&gt;
&lt;p&gt;This also fixes assert_select, and similar assertions. Because
view tests&lt;br&gt;
and helpers generally don't render full templates assert_select
looks&lt;br&gt;
first in rendered and then in output_buffer to find the rendered
output.&lt;/p&gt;
&lt;p&gt;Additional &lt;code&gt;master'-only changes: Made the Action Pack
Rakefile run the&amp;lt;br/&amp;gt; ActionView::TestCase tests, and made
ActionView::Rendering#_render_text&amp;lt;br/&amp;gt; always return a
string.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Signed-off-by: Joshua Peek &lt;a&gt;josh@joshpeek.com&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/8ffc2e3b8de38c485fa24820208b40920dad7ae3&quot;&gt;
http://github.com/rails/rails/commit/8ffc2e3b8de38c485fa24820208b40...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-09-28T19:31:43+01:00</created-at>
      <creator-id type="integer">8406</creator-id>
      <diffable-attributes type="yaml">--- 
:state: verified
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3260</number>
      <permalink>actionviewtestcase-needs-to-be-ported-to-master</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>3.0 actionview bugmash testcase</tag>
      <title>ActionView::TestCase needs to be ported to master.</title>
      <updated-at type="datetime">2009-09-28T19:31:48+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">14</version>
      <user-name>Repository</user-name>
      <creator-name>Eloy Duran</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3260</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/31647)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/31647&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-10-15T23:01:36+01:00</created-at>
      <creator-id type="integer">8406</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
:milestone: 27004
</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">3260</number>
      <permalink>actionviewtestcase-needs-to-be-ported-to-master</permalink>
      <priority type="integer">5</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>3.0 actionview bugmash testcase</tag>
      <title>ActionView::TestCase needs to be ported to master.</title>
      <updated-at type="datetime">2010-10-15T23:01:36+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">15</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Eloy Duran</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3260</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>75bdd38a5494f28def483aff5b09146c5415c914</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-09-26T19:25:07+01:00</created-at>
      <filename>LH3260-ActionView_TestCase_ported_to_master.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">279415</id>
      <size type="integer">14805</size>
      <uploader-id type="integer">36381</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/279415/LH3260-ActionView_TestCase_ported_to_master.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>de3b6dc8e269a291ecfe2834238c73bc92c506eb</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-09-27T02:26:36+01:00</created-at>
      <filename>0001-lh3260-ActionView-Testcase-ported-to-master.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">279561</id>
      <size type="integer">14849</size>
      <uploader-id type="integer">23560</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/279561/0001-lh3260-ActionView-Testcase-ported-to-master.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>feab9826e853c064fe2e30b39356d69634b5ed14</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-09-28T07:54:42+01:00</created-at>
      <filename>0001-Ported-Eloy-Duran-s-ActionView-TestCase-rewrite-to.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">279851</id>
      <size type="integer">15915</size>
      <uploader-id type="integer">23560</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/279851/0001-Ported-Eloy-Duran-s-ActionView-TestCase-rewrite-to.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>49f90752d240c00c46386f14cb5df1869aafbc6d</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-09-28T19:11:37+01:00</created-at>
      <filename>ported_actionview_testcase_to_master.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">280352</id>
      <size type="integer">15869</size>
      <uploader-id type="integer">8406</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/280352/ported_actionview_testcase_to_master.patch</url>
    </attachment>
  </attachments>
</ticket>
