<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">0</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-02-17T15:32:41+00:00</created-at>
  <creator-id type="integer">22596</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">9903</milestone-id>
  <number type="integer">1998</number>
  <permalink>23-session-storing-an-activerecord-object-crashes-with-nilinclude-and-undefined-classmodule</permalink>
  <priority type="integer">1245</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>duplicate</state>
  <tag>2.3.0</tag>
  <title>2.3 Session Storing an ActiveRecord object crashes with nil.include? and undefined class/module</title>
  <updated-at type="datetime">2009-02-17T15:57:29+00:00</updated-at>
  <user-id type="integer">424</user-id>
  <version type="integer">2</version>
  <user-name>Joshua Peek</user-name>
  <creator-name>George Chatzigeorgiou</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/1998</url>
  <milestone-title>2.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>I have a line of code in a controller that stores an active record object in the session

session[:cart] = @order

With 2.2.2 this works perfectly ok, but with 2.3 I get an &quot;nil.include?&quot; error that has to do with skip_time_zone_conversion_attributes. I patched that and then I got the &quot;undefined class/Module Order&quot; error. 

It makes no difference which session type I'm using, both CookieStore and ActiveRecord store crash.

Below is the stack trace for the first error:

  Order Columns (2.8ms)   SHOW FIELDS FROM `orders`
/!\ FAILSAFE /!\  Tue Feb 17 15:41:17 +0200 2009
  Status: 500 Internal Server Error
  You have a nil object when you didn't expect it!
You might have expected an instance of Array.
The error occurred while evaluating nil.include?
    /home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:142:in `create_time_zone_conversion_attribute?'
    /home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:75:in `define_attribute_methods'
    /home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:71:in `each'
    /home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:71:in `define_attribute_methods'
    /home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:350:in `respond_to?'
    /home/bandito/.gem/ruby/1.8/gems/activesupport-2.3.0/lib/active_support/message_verifier.rb:36:in `dump'
    /home/bandito/.gem/ruby/1.8/gems/activesupport-2.3.0/lib/active_support/message_verifier.rb:36:in `generate'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/session/cookie_store.rb:154:in `marshal'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/session/cookie_store.rb:100:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/failsafe.rb:11:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `synchronize'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:83:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/cgi_process.rb:44:in `dispatch_cgi'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:79:in `dispatch_cgi'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:29:in `dispatch'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:76:in `process'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `synchronize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `process'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:159:in `process_client'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `each'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `process_client'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `initialize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `new'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `initialize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `new'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:282:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `each'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:128:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/command.rb:212:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:281
    /usr/bin/mongrel_rails:19:in `load'
    /usr/bin/mongrel_rails:19

and after patching create_time_zone_conversion_attribute?

@@@
def create_time_zone_conversion_attribute?(name, column)
          time_zone_aware_attributes &amp;&amp; (!skip_time_zone_conversion_for_attributes || skip_time_zone_conversion_for_attributes.include?(name.to_sym)) &amp;&amp; [:datetime, :timestamp].include?(column.type)
end
@@@

Status: 500 Internal Server Error
  undefined class/module Order
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:67:in `dump'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:67:in `marshal'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:123:in `marshal_data!'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:178:in `send'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:178:in `evaluate_method'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:166:in `call'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:93:in `run'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:92:in `each'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:92:in `send'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:92:in `run'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:276:in `run_callbacks'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/callbacks.rb:316:in `callback'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/callbacks.rb:221:in `create_or_update'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/base.rb:2532:in `save_without_validation'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/validations.rb:1009:in `save_without_dirty'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/dirty.rb:79:in `save_without_autosave_associations'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/autosave_association.rb:147:in `save_without_transactions'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:229:in `send'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:229:in `with_transaction_returning_status'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:182:in `transaction'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:228:in `with_transaction_returning_status'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:196:in `save'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:208:in `rollback_active_record_state!'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:196:in `save'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:301:in `set_session'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/base.rb:1454:in `silence'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:298:in `set_session'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/session/abstract_store.rb:116:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/failsafe.rb:11:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `synchronize'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:83:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/cgi_process.rb:44:in `dispatch_cgi'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:79:in `dispatch_cgi'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:29:in `dispatch'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:76:in `process'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `synchronize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `process'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:159:in `process_client'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `each'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `process_client'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `initialize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `new'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `initialize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `new'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:282:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `each'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:128:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/command.rb:212:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:281
    /usr/bin/mongrel_rails:19:in `load'
    /usr/bin/mongrel_rails:19</original-body>
  <latest-body>I have a line of code in a controller that stores an active record object in the session

session[:cart] = @order

With 2.2.2 this works perfectly ok, but with 2.3 I get an &quot;nil.include?&quot; error that has to do with skip_time_zone_conversion_attributes. I patched that and then I got the &quot;undefined class/Module Order&quot; error. 

It makes no difference which session type I'm using, both CookieStore and ActiveRecord store crash.

Below is the stack trace for the first error:

  Order Columns (2.8ms)   SHOW FIELDS FROM `orders`
/!\ FAILSAFE /!\  Tue Feb 17 15:41:17 +0200 2009
  Status: 500 Internal Server Error
  You have a nil object when you didn't expect it!
You might have expected an instance of Array.
The error occurred while evaluating nil.include?
    /home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:142:in `create_time_zone_conversion_attribute?'
    /home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:75:in `define_attribute_methods'
    /home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:71:in `each'
    /home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:71:in `define_attribute_methods'
    /home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:350:in `respond_to?'
    /home/bandito/.gem/ruby/1.8/gems/activesupport-2.3.0/lib/active_support/message_verifier.rb:36:in `dump'
    /home/bandito/.gem/ruby/1.8/gems/activesupport-2.3.0/lib/active_support/message_verifier.rb:36:in `generate'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/session/cookie_store.rb:154:in `marshal'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/session/cookie_store.rb:100:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/failsafe.rb:11:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `synchronize'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:83:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/cgi_process.rb:44:in `dispatch_cgi'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:79:in `dispatch_cgi'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:29:in `dispatch'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:76:in `process'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `synchronize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `process'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:159:in `process_client'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `each'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `process_client'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `initialize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `new'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `initialize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `new'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:282:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `each'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:128:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/command.rb:212:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:281
    /usr/bin/mongrel_rails:19:in `load'
    /usr/bin/mongrel_rails:19

and after patching create_time_zone_conversion_attribute?

@@@
def create_time_zone_conversion_attribute?(name, column)
          time_zone_aware_attributes &amp;&amp; (!skip_time_zone_conversion_for_attributes || skip_time_zone_conversion_for_attributes.include?(name.to_sym)) &amp;&amp; [:datetime, :timestamp].include?(column.type)
end
@@@

Status: 500 Internal Server Error
  undefined class/module Order
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:67:in `dump'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:67:in `marshal'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:123:in `marshal_data!'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:178:in `send'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:178:in `evaluate_method'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:166:in `call'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:93:in `run'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:92:in `each'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:92:in `send'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:92:in `run'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:276:in `run_callbacks'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/callbacks.rb:316:in `callback'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/callbacks.rb:221:in `create_or_update'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/base.rb:2532:in `save_without_validation'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/validations.rb:1009:in `save_without_dirty'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/dirty.rb:79:in `save_without_autosave_associations'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/autosave_association.rb:147:in `save_without_transactions'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:229:in `send'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:229:in `with_transaction_returning_status'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:182:in `transaction'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:228:in `with_transaction_returning_status'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:196:in `save'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:208:in `rollback_active_record_state!'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:196:in `save'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:301:in `set_session'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/base.rb:1454:in `silence'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:298:in `set_session'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/session/abstract_store.rb:116:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/failsafe.rb:11:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `synchronize'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:83:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/cgi_process.rb:44:in `dispatch_cgi'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:79:in `dispatch_cgi'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:29:in `dispatch'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:76:in `process'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `synchronize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `process'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:159:in `process_client'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `each'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `process_client'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `initialize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `new'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `initialize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `new'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:282:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `each'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:128:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/command.rb:212:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:281
    /usr/bin/mongrel_rails:19:in `load'
    /usr/bin/mongrel_rails:19</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;I have a line of code in a controller that stores an active
record object in the session&lt;/p&gt;
&lt;p&gt;session[:cart] = @order&lt;/p&gt;
&lt;p&gt;With 2.2.2 this works perfectly ok, but with 2.3 I get an
&quot;nil.include?&quot; error that has to do with
skip_time_zone_conversion_attributes. I patched that and then I got
the &quot;undefined class/Module Order&quot; error.&lt;/p&gt;
&lt;p&gt;It makes no difference which session type I'm using, both
CookieStore and ActiveRecord store crash.&lt;/p&gt;
&lt;p&gt;Below is the stack trace for the first error:&lt;/p&gt;
&lt;p&gt;Order Columns (2.8ms) SHOW FIELDS FROM &lt;code&gt;orders&lt;/code&gt; /!\
FAILSAFE /!\ Tue Feb 17 15:41:17 +0200 2009 Status: 500 Internal
Server Error You have a nil object when you didn't expect it! You
might have expected an instance of Array. The error occurred while
evaluating nil.include?&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;/home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:142:in `create_time_zone_conversion_attribute?'
/home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:75:in `define_attribute_methods'
/home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:71:in `each'
/home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:71:in `define_attribute_methods'
/home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:350:in `respond_to?'
/home/bandito/.gem/ruby/1.8/gems/activesupport-2.3.0/lib/active_support/message_verifier.rb:36:in `dump'
/home/bandito/.gem/ruby/1.8/gems/activesupport-2.3.0/lib/active_support/message_verifier.rb:36:in `generate'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/session/cookie_store.rb:154:in `marshal'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/session/cookie_store.rb:100:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/failsafe.rb:11:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `synchronize'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:83:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/cgi_process.rb:44:in `dispatch_cgi'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:79:in `dispatch_cgi'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:29:in `dispatch'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:76:in `process'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `synchronize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `process'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:159:in `process_client'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `each'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `process_client'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:282:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `each'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:128:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/command.rb:212:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:281
/usr/bin/mongrel_rails:19:in `load'
/usr/bin/mongrel_rails:19
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;and after patching create_time_zone_conversion_attribute?&lt;/p&gt;


&lt;pre&gt;&lt;code&gt;
def create_time_zone_conversion_attribute?(name, column)
          time_zone_aware_attributes &amp;amp;&amp;amp; (!skip_time_zone_conversion_for_attributes || skip_time_zone_conversion_for_attributes.include?(name.to_sym)) &amp;amp;&amp;amp; [:datetime, :timestamp].include?(column.type)
end
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Status: 500 Internal Server Error undefined class/module
Order&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:67:in `dump'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:67:in `marshal'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:123:in `marshal_data!'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:178:in `send'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:178:in `evaluate_method'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:166:in `call'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:93:in `run'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:92:in `each'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:92:in `send'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:92:in `run'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:276:in `run_callbacks'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/callbacks.rb:316:in `callback'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/callbacks.rb:221:in `create_or_update'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/base.rb:2532:in `save_without_validation'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/validations.rb:1009:in `save_without_dirty'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/dirty.rb:79:in `save_without_autosave_associations'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/autosave_association.rb:147:in `save_without_transactions'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:229:in `send'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:229:in `with_transaction_returning_status'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:182:in `transaction'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:228:in `with_transaction_returning_status'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:196:in `save'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:208:in `rollback_active_record_state!'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:196:in `save'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:301:in `set_session'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/base.rb:1454:in `silence'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:298:in `set_session'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/session/abstract_store.rb:116:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/failsafe.rb:11:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `synchronize'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:83:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/cgi_process.rb:44:in `dispatch_cgi'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:79:in `dispatch_cgi'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:29:in `dispatch'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:76:in `process'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `synchronize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `process'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:159:in `process_client'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `each'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `process_client'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:282:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `each'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:128:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/command.rb:212:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:281
/usr/bin/mongrel_rails:19:in `load'
/usr/bin/mongrel_rails:19
&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I have a line of code in a controller that stores an active record object in the session

session[:cart] = @order

With 2.2.2 this works perfectly ok, but with 2.3 I get an &quot;nil.include?&quot; error that has to do with skip_time_zone_conversion_attributes. I patched that and then I got the &quot;undefined class/Module Order&quot; error. 

It makes no difference which session type I'm using, both CookieStore and ActiveRecord store crash.

Below is the stack trace for the first error:

  Order Columns (2.8ms)   SHOW FIELDS FROM `orders`
/!\ FAILSAFE /!\  Tue Feb 17 15:41:17 +0200 2009
  Status: 500 Internal Server Error
  You have a nil object when you didn't expect it!
You might have expected an instance of Array.
The error occurred while evaluating nil.include?
    /home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:142:in `create_time_zone_conversion_attribute?'
    /home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:75:in `define_attribute_methods'
    /home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:71:in `each'
    /home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:71:in `define_attribute_methods'
    /home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:350:in `respond_to?'
    /home/bandito/.gem/ruby/1.8/gems/activesupport-2.3.0/lib/active_support/message_verifier.rb:36:in `dump'
    /home/bandito/.gem/ruby/1.8/gems/activesupport-2.3.0/lib/active_support/message_verifier.rb:36:in `generate'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/session/cookie_store.rb:154:in `marshal'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/session/cookie_store.rb:100:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/failsafe.rb:11:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `synchronize'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:83:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/cgi_process.rb:44:in `dispatch_cgi'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:79:in `dispatch_cgi'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:29:in `dispatch'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:76:in `process'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `synchronize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `process'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:159:in `process_client'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `each'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `process_client'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `initialize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `new'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `initialize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `new'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:282:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `each'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:128:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/command.rb:212:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:281
    /usr/bin/mongrel_rails:19:in `load'
    /usr/bin/mongrel_rails:19

and after patching create_time_zone_conversion_attribute?

@@@
def create_time_zone_conversion_attribute?(name, column)
          time_zone_aware_attributes &amp;&amp; (!skip_time_zone_conversion_for_attributes || skip_time_zone_conversion_for_attributes.include?(name.to_sym)) &amp;&amp; [:datetime, :timestamp].include?(column.type)
end
@@@

Status: 500 Internal Server Error
  undefined class/module Order
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:67:in `dump'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:67:in `marshal'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:123:in `marshal_data!'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:178:in `send'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:178:in `evaluate_method'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:166:in `call'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:93:in `run'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:92:in `each'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:92:in `send'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:92:in `run'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:276:in `run_callbacks'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/callbacks.rb:316:in `callback'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/callbacks.rb:221:in `create_or_update'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/base.rb:2532:in `save_without_validation'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/validations.rb:1009:in `save_without_dirty'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/dirty.rb:79:in `save_without_autosave_associations'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/autosave_association.rb:147:in `save_without_transactions'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:229:in `send'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:229:in `with_transaction_returning_status'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:182:in `transaction'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:228:in `with_transaction_returning_status'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:196:in `save'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:208:in `rollback_active_record_state!'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:196:in `save'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:301:in `set_session'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/base.rb:1454:in `silence'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:298:in `set_session'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/session/abstract_store.rb:116:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/failsafe.rb:11:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `synchronize'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:83:in `call'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/cgi_process.rb:44:in `dispatch_cgi'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:79:in `dispatch_cgi'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:29:in `dispatch'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:76:in `process'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `synchronize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `process'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:159:in `process_client'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `each'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `process_client'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `initialize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `new'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `initialize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `new'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:282:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `each'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:128:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/command.rb:212:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:281
    /usr/bin/mongrel_rails:19:in `load'
    /usr/bin/mongrel_rails:19</body>
      <body-html>&lt;div&gt;&lt;p&gt;I have a line of code in a controller that stores an active
record object in the session&lt;/p&gt;
&lt;p&gt;session[:cart] = @order&lt;/p&gt;
&lt;p&gt;With 2.2.2 this works perfectly ok, but with 2.3 I get an
&quot;nil.include?&quot; error that has to do with
skip_time_zone_conversion_attributes. I patched that and then I got
the &quot;undefined class/Module Order&quot; error.&lt;/p&gt;
&lt;p&gt;It makes no difference which session type I'm using, both
CookieStore and ActiveRecord store crash.&lt;/p&gt;
&lt;p&gt;Below is the stack trace for the first error:&lt;/p&gt;
&lt;p&gt;Order Columns (2.8ms) SHOW FIELDS FROM &lt;code&gt;orders&lt;/code&gt; /!\
FAILSAFE /!\ Tue Feb 17 15:41:17 +0200 2009 Status: 500 Internal
Server Error You have a nil object when you didn't expect it! You
might have expected an instance of Array. The error occurred while
evaluating nil.include?&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;/home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:142:in `create_time_zone_conversion_attribute?'
/home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:75:in `define_attribute_methods'
/home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:71:in `each'
/home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:71:in `define_attribute_methods'
/home/bandito/.gem/ruby/1.8/gems/activerecord-2.3.0/lib/active_record/attribute_methods.rb:350:in `respond_to?'
/home/bandito/.gem/ruby/1.8/gems/activesupport-2.3.0/lib/active_support/message_verifier.rb:36:in `dump'
/home/bandito/.gem/ruby/1.8/gems/activesupport-2.3.0/lib/active_support/message_verifier.rb:36:in `generate'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/session/cookie_store.rb:154:in `marshal'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/session/cookie_store.rb:100:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/failsafe.rb:11:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `synchronize'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:83:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/cgi_process.rb:44:in `dispatch_cgi'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:79:in `dispatch_cgi'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:29:in `dispatch'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:76:in `process'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `synchronize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `process'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:159:in `process_client'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `each'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `process_client'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:282:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `each'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:128:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/command.rb:212:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:281
/usr/bin/mongrel_rails:19:in `load'
/usr/bin/mongrel_rails:19
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;and after patching create_time_zone_conversion_attribute?&lt;/p&gt;


&lt;pre&gt;&lt;code&gt;
def create_time_zone_conversion_attribute?(name, column)
          time_zone_aware_attributes &amp;amp;&amp;amp; (!skip_time_zone_conversion_for_attributes || skip_time_zone_conversion_for_attributes.include?(name.to_sym)) &amp;amp;&amp;amp; [:datetime, :timestamp].include?(column.type)
end
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Status: 500 Internal Server Error undefined class/module
Order&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:67:in `dump'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:67:in `marshal'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:123:in `marshal_data!'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:178:in `send'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:178:in `evaluate_method'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:166:in `call'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:93:in `run'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:92:in `each'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:92:in `send'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:92:in `run'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.3.0/lib/active_support/callbacks.rb:276:in `run_callbacks'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/callbacks.rb:316:in `callback'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/callbacks.rb:221:in `create_or_update'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/base.rb:2532:in `save_without_validation'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/validations.rb:1009:in `save_without_dirty'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/dirty.rb:79:in `save_without_autosave_associations'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/autosave_association.rb:147:in `save_without_transactions'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:229:in `send'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:229:in `with_transaction_returning_status'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:182:in `transaction'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:228:in `with_transaction_returning_status'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:196:in `save'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:208:in `rollback_active_record_state!'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/transactions.rb:196:in `save'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:301:in `set_session'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/base.rb:1454:in `silence'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.0/lib/active_record/session_store.rb:298:in `set_session'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/session/abstract_store.rb:116:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/failsafe.rb:11:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `synchronize'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/rack_ext/lock.rb:15:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:83:in `call'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/cgi_process.rb:44:in `dispatch_cgi'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:79:in `dispatch_cgi'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.3.0/lib/action_controller/dispatcher.rb:29:in `dispatch'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:76:in `process'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `synchronize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `process'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:159:in `process_client'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `each'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `process_client'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:282:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `each'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:128:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/command.rb:212:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:281
/usr/bin/mongrel_rails:19:in `load'
/usr/bin/mongrel_rails:19
&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-17T15:32:46+00:00</created-at>
      <creator-id type="integer">22596</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1998</number>
      <permalink>23-session-storing-an-activerecord-object-crashes-with-nilinclude-and-undefined-classmodule</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.0</tag>
      <title>2.3 Session Storing an ActiveRecord object crashes with nil.include? and undefined class/module</title>
      <updated-at type="datetime">2009-02-17T15:37:01+00:00</updated-at>
      <user-id type="integer">22596</user-id>
      <version type="integer">1</version>
      <user-name>George Chatzigeorgiou</user-name>
      <creator-name>George Chatzigeorgiou</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1998</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>#1864</body>
      <body-html>&lt;div&gt;&lt;p&gt;&lt;a href=&quot;/projects/8994/tickets/1864&quot; title=&quot;Ticket #1864&quot;&gt;#1864&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-02-17T15:57:21+00:00</created-at>
      <creator-id type="integer">22596</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1998</number>
      <permalink>23-session-storing-an-activerecord-object-crashes-with-nilinclude-and-undefined-classmodule</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>duplicate</state>
      <tag>2.3.0</tag>
      <title>2.3 Session Storing an ActiveRecord object crashes with nil.include? and undefined class/module</title>
      <updated-at type="datetime">2009-02-17T15:57:29+00:00</updated-at>
      <user-id type="integer">424</user-id>
      <version type="integer">2</version>
      <user-name>Joshua Peek</user-name>
      <creator-name>George Chatzigeorgiou</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1998</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
</ticket>
