<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">15316</assigned-user-id>
  <attachments-count type="integer">6</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2010-12-02T08:43:08+00:00</created-at>
  <creator-id type="integer">45224</creator-id>
  <milestone-due-on type="datetime">2011-02-27T00:00:00+00:00</milestone-due-on>
  <milestone-id type="integer">101623</milestone-id>
  <number type="integer">2189</number>
  <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
  <priority type="integer">3</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag nil="true"></tag>
  <title>count breaks has_many through association collection with named scope</title>
  <updated-at type="datetime">2011-02-12T21:58:20+00:00</updated-at>
  <user-id type="integer">40272</user-id>
  <version type="integer">78</version>
  <user-name>Santiago Pastorino</user-name>
  <creator-name>nkryptic</creator-name>
  <assigned-user-name>Aaron Patterson</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
  <milestone-title>3.0.5</milestone-title>
  <priority-name>Low</priority-name>
  <original-body>It appears that commit [6543426c73](http://github.com/rails/rails/commit/6543426c73fa9ccf3649d7cbacbbb0fda9b6a099 &quot;6543426c73&quot;) causes a count query to break when it is called on a has_many through association collection with a named scope:

@@@ ruby
class Member
  # has publisher boolean attribute
  named_scope :publishers, :conditions =&gt; { :publisher =&gt; true }
  has_many :memberships
  has_many :groups, :through =&gt; :memberships
end

class Membership
  belongs_to :member
  belongs_to :group
end

class Group
  has_many :memberships
  has_many :members, :through =&gt; :memberships
end

group = Group.new
group.members.publishers.count =&gt;
# SQLite3::SQLException: near &quot;*&quot;: syntax error: SELECT count(&quot;members&quot;.*) AS count_members_all FROM &quot;members&quot;...
@@@

It would seem that the commit changed the case statement for **construct_count_options_from_args** in activerecord/lib/active_record/calculations.rb to use the *select* from any :find scope:

@@@ ruby
column_name = scope(:find)[:select] if scope(:find)
@@@

This results in the column name of &quot;tablename&quot;.*, which sqlite doesn't like in a count statement.  This behavior only occurs on the has_many through relationship, could not get it to occur with any others - named_scope or not.</original-body>
  <latest-body>It appears that commit [6543426c73](http://github.com/rails/rails/commit/6543426c73fa9ccf3649d7cbacbbb0fda9b6a099 &quot;6543426c73&quot;) causes a count query to break when it is called on a has_many through association collection with a named scope:

@@@ ruby
class Member
  # has publisher boolean attribute
  named_scope :publishers, :conditions =&gt; { :publisher =&gt; true }
  has_many :memberships
  has_many :groups, :through =&gt; :memberships
end

class Membership
  belongs_to :member
  belongs_to :group
end

class Group
  has_many :memberships
  has_many :members, :through =&gt; :memberships
end

group = Group.new
group.members.publishers.count =&gt;
# SQLite3::SQLException: near &quot;*&quot;: syntax error: SELECT count(&quot;members&quot;.*) AS count_members_all FROM &quot;members&quot;...
@@@

It would seem that the commit changed the case statement for **construct_count_options_from_args** in activerecord/lib/active_record/calculations.rb to use the *select* from any :find scope:

@@@ ruby
column_name = scope(:find)[:select] if scope(:find)
@@@

This results in the column name of &quot;tablename&quot;.*, which sqlite doesn't like in a count statement.  This behavior only occurs on the has_many through relationship, could not get it to occur with any others - named_scope or not.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;It appears that commit &lt;a href=&quot;http://github.com/rails/rails/commit/6543426c73fa9ccf3649d7cbacbbb0fda9b6a099&quot; title=&quot;6543426c73&quot;&gt;6543426c73&lt;/a&gt; causes a count query to break
when it is called on a has_many through association collection with
a named scope:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
class Member
  # has publisher boolean attribute
  named_scope :publishers, :conditions =&amp;gt; { :publisher =&amp;gt; true }
  has_many :memberships
  has_many :groups, :through =&amp;gt; :memberships
end

class Membership
  belongs_to :member
  belongs_to :group
end

class Group
  has_many :memberships
  has_many :members, :through =&amp;gt; :memberships
end

group = Group.new
group.members.publishers.count =&amp;gt;
# SQLite3::SQLException: near &amp;quot;*&amp;quot;: syntax error: SELECT count(&amp;quot;members&amp;quot;.*) AS count_members_all FROM &amp;quot;members&amp;quot;...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It would seem that the commit changed the case statement for
&lt;strong&gt;construct_count_options_from_args&lt;/strong&gt; in
activerecord/lib/active_record/calculations.rb to use the
&lt;em&gt;select&lt;/em&gt; from any :find scope:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
column_name = scope(:find)[:select] if scope(:find)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This results in the column name of &quot;tablename&quot;.*, which sqlite
doesn't like in a count statement. This behavior only occurs on the
has_many through relationship, could not get it to occur with any
others - named_scope or not.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>It appears that commit [6543426c73](http://github.com/rails/rails/commit/6543426c73fa9ccf3649d7cbacbbb0fda9b6a099 &quot;6543426c73&quot;) causes a count query to break when it is called on a has_many through association collection with a named scope:

@@@ ruby
class Member
  # has publisher boolean attribute
  named_scope :publishers, :conditions =&gt; { :publisher =&gt; true }
  has_many :memberships
  has_many :groups, :through =&gt; :memberships
end

class Membership
  belongs_to :member
  belongs_to :group
end

class Group
  has_many :memberships
  has_many :members, :through =&gt; :memberships
end

group = Group.new
group.members.publishers.count =&gt;
# SQLite3::SQLException: near &quot;*&quot;: syntax error: SELECT count(&quot;members&quot;.*) AS count_members_all FROM &quot;members&quot;...
@@@

It would seem that the commit changed the case statement for **construct_count_options_from_args** in activerecord/lib/active_record/calculations.rb to use the *select* from any :find scope:

@@@ ruby
column_name = scope(:find)[:select] if scope(:find)
@@@

This results in the column name of &quot;tablename&quot;.*, which sqlite doesn't like in a count statement.  This behavior only occurs on the has_many through relationship, could not get it to occur with any others - named_scope or not.</body>
      <body-html>&lt;div&gt;&lt;p&gt;It appears that commit &lt;a href=&quot;http://github.com/rails/rails/commit/6543426c73fa9ccf3649d7cbacbbb0fda9b6a099&quot; title=&quot;6543426c73&quot;&gt;6543426c73&lt;/a&gt; causes a count query to break
when it is called on a has_many through association collection with
a named scope:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
class Member
  # has publisher boolean attribute
  named_scope :publishers, :conditions =&amp;gt; { :publisher =&amp;gt; true }
  has_many :memberships
  has_many :groups, :through =&amp;gt; :memberships
end

class Membership
  belongs_to :member
  belongs_to :group
end

class Group
  has_many :memberships
  has_many :members, :through =&amp;gt; :memberships
end

group = Group.new
group.members.publishers.count =&amp;gt;
# SQLite3::SQLException: near &amp;quot;*&amp;quot;: syntax error: SELECT count(&amp;quot;members&amp;quot;.*) AS count_members_all FROM &amp;quot;members&amp;quot;...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It would seem that the commit changed the case statement for
&lt;strong&gt;construct_count_options_from_args&lt;/strong&gt; in
activerecord/lib/active_record/calculations.rb to use the
&lt;em&gt;select&lt;/em&gt; from any :find scope:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
column_name = scope(:find)[:select] if scope(:find)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This results in the column name of &quot;tablename&quot;.*, which sqlite
doesn't like in a count statement. This behavior only occurs on the
has_many through relationship, could not get it to occur with any
others - named_scope or not.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-10T00:12:03+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>count breaks sqlite has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-10T00:12:06+00:00</updated-at>
      <user-id type="integer">45224</user-id>
      <version type="integer">1</version>
      <user-name>nkryptic</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>BTW, I've worked-around the issue by passing :select =&gt; &quot;*&quot; to the count method for now:

@@@ ruby
group.members.publishers.count(:select =&gt; &quot;*&quot;)
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;BTW, I've worked-around the issue by passing :select =&amp;gt; &quot;*&quot;
to the count method for now:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
group.members.publishers.count(:select =&amp;gt; &amp;quot;*&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-10T00:14:17+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>count breaks sqlite has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-10T00:14:22+00:00</updated-at>
      <user-id type="integer">45224</user-id>
      <version type="integer">2</version>
      <user-name>nkryptic</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>This also doesn't work on MySQL 5.1.</body>
      <body-html>&lt;div&gt;&lt;p&gt;This also doesn't work on MySQL 5.1.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-10T11:05:55+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>count breaks sqlite has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-10T11:06:00+00:00</updated-at>
      <user-id type="integer">8407</user-id>
      <version type="integer">3</version>
      <user-name>Manfred Stienstra</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Attached is a quick fix for the problem, I'm not quite sure how to solve this in a more general way because you never know where the :select is coming from.

Specifying :select =&gt; '*' is not a real solution because you don't want to do that for empty? and such.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Attached is a quick fix for the problem, I'm not quite sure how
to solve this in a more general way because you never know where
the :select is coming from.&lt;/p&gt;
&lt;p&gt;Specifying :select =&amp;gt; '*' is not a real solution because you
don't want to do that for empty? and such.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-10T14:35:59+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>count breaks sqlite has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-10T14:40:26+00:00</updated-at>
      <user-id type="integer">8407</user-id>
      <version type="integer">4</version>
      <user-name>Manfred Stienstra</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>This affects mysql 5.0 also, and is definitely a regression.</body>
      <body-html>&lt;div&gt;&lt;p&gt;This affects mysql 5.0 also, and is definitely a regression.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-11T10:42:23+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>count breaks sqlite has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-11T10:53:16+00:00</updated-at>
      <user-id type="integer">10460</user-id>
      <version type="integer">5</version>
      <user-name>Will Bryant</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Associations are one source of `:select` options, but more generally:

@@@
class Account &lt; ActiveRecord::Base
  named_scope :account_fields_only, :select =&gt; 'accounts.*'
end
@@@

@@@
&gt;&gt; Account.account_fields_only.count
ActiveRecord::StatementInvalid: Mysql::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '*) AS count_accounts_all FROM `accounts`' at line 1: SELECT count(accounts.*) AS count_accounts_all FROM `accounts` 
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;Associations are one source of &lt;code&gt;:select&lt;/code&gt; options, but
more generally:&lt;/p&gt;


&lt;pre&gt;&lt;code&gt;
class Account &amp;lt; ActiveRecord::Base
  named_scope :account_fields_only, :select =&amp;gt; 'accounts.*'
end
&lt;/code&gt;&lt;/pre&gt;


&lt;pre&gt;&lt;code&gt;
&amp;gt;&amp;gt; Account.account_fields_only.count
ActiveRecord::StatementInvalid: Mysql::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '*) AS count_accounts_all FROM `accounts`' at line 1: SELECT count(accounts.*) AS count_accounts_all FROM `accounts` 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-16T15:39:33+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>count breaks sqlite has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-16T15:39:36+00:00</updated-at>
      <user-id type="integer">813</user-id>
      <version type="integer">6</version>
      <user-name>Tom Stuart</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Note that this also seems to break paginating results using will_paginate.

For example, this code now breaks.  Note that:

User has_many :posts, :through=&gt; :contributions

@@@
class Post &lt; ActiveRecord::Base
  named_scope :published, :conditions =&gt; &quot;posts`.state='ok'&quot;
end

@posts = @user.posts.published.paginate :page =&gt; page, :per_page =&gt; &quot;10&quot;
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;Note that this also seems to break paginating results using
will_paginate.&lt;/p&gt;
&lt;p&gt;For example, this code now breaks. Note that:&lt;/p&gt;
&lt;p&gt;User has_many :posts, :through=&amp;gt; :contributions&lt;/p&gt;


&lt;pre&gt;&lt;code&gt;
class Post &amp;lt; ActiveRecord::Base
  named_scope :published, :conditions =&amp;gt; &amp;quot;posts`.state='ok'&amp;quot;
end

@posts = @user.posts.published.paginate :page =&amp;gt; page, :per_page =&amp;gt; &amp;quot;10&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-16T17:49:28+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>count breaks sqlite has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-16T17:49:32+00:00</updated-at>
      <user-id type="integer">50855</user-id>
      <version type="integer">7</version>
      <user-name>jlpeters</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I've been examining this as it breaks one of my apps as well. I think Manfred's solution is the best so far. I don't really see any issues with it as I can't imagine any counting scenarios where it wouldn't be appropriate to turn &quot;table.*&quot; into &quot;*&quot;. As long as no one can think of anything I think we should do that. Essentially we're just sanitizing the select field to make it appropriate for count.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've been examining this as it breaks one of my apps as well. I
think Manfred's solution is the best so far. I don't really see any
issues with it as I can't imagine any counting scenarios where it
wouldn't be appropriate to turn &quot;table.&lt;em&gt;&quot; into &quot;&lt;/em&gt;&quot;. As long
as no one can think of anything I think we should do that.
Essentially we're just sanitizing the select field to make it
appropriate for count.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-16T19:37:54+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 
:title: count breaks sqlite has_many through association collection with named scope
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord calculations patch scope tested</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-16T19:37:57+00:00</updated-at>
      <user-id type="integer">19875</user-id>
      <version type="integer">8</version>
      <user-name>Peter Wagenet</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>My patch wasn't meant as a maintainable solution, but because a complete rewrite of scopes is going to take a while it might be best to apply it for now as it seems to bite quite a few people ):</body>
      <body-html>&lt;div&gt;&lt;p&gt;My patch wasn't meant as a maintainable solution, but because a
complete rewrite of scopes is going to take a while it might be
best to apply it for now as it seems to bite quite a few people
):&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-16T19:47:56+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: activerecord calculations patch scope tested
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-16T19:48:01+00:00</updated-at>
      <user-id type="integer">8407</user-id>
      <version type="integer">9</version>
      <user-name>Manfred Stienstra</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Putting the attached file in your initializers should provide a temporary fix as well.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Putting the attached file in your initializers should provide a
temporary fix as well.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-16T20:01:59+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-16T20:02:04+00:00</updated-at>
      <user-id type="integer">19875</user-id>
      <version type="integer">10</version>
      <user-name>Peter Wagenet</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Others may disagree, but I'm not sure that this would merit a complete rewrite of scopes. As far as I know, the only alternative to COUNT(table.*) is just COUNT(*). You've provide a sanitizer method to make sure that any requests with &quot;table.*&quot; become &quot;*&quot; and that seems appropriate enough.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Others may disagree, but I'm not sure that this would merit a
complete rewrite of scopes. As far as I know, the only alternative
to COUNT(table.&lt;em&gt;) is just COUNT(&lt;/em&gt;). You've provide a
sanitizer method to make sure that any requests with &quot;table.&lt;em&gt;&quot;
become &quot;&lt;/em&gt;&quot; and that seems appropriate enough.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-16T20:05:24+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-16T20:05:29+00:00</updated-at>
      <user-id type="integer">19875</user-id>
      <version type="integer">11</version>
      <user-name>Peter Wagenet</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I think there's a typo in the regex in count_fix.rb - I had a few specs that ran counts on uniq'd has_manys that were failing: 

@@@
SQLite3::SQLException: near &quot;*&quot;: syntax error: SELECT count(DISTINCT *) AS count_all FROM &quot;assets&quot; INNER JOIN &quot;shipment_order_items&quot; ON &quot;assets&quot;.id = &quot;shipment_order_items&quot;.asset_id WHERE ((&quot;shipment_order_items&quot;.shipment_order_id = 1))
@@@

I changed line 14 of count_fix.rb to:

@@@ ruby
column_name = '*' if column_name =~ /\.\*$/ # was /\.*$/, was looking for any number of periods instead of specifically .*
@@@

I've uploaded a count_fix.rb that should fix that, and hopefully not break anything else (at the least, my counts on scoped has_many :throughs appear to be working.)</body>
      <body-html>&lt;div&gt;&lt;p&gt;I think there's a typo in the regex in count_fix.rb - I had a
few specs that ran counts on uniq'd has_manys that were
failing:&lt;/p&gt;


&lt;pre&gt;&lt;code&gt;
SQLite3::SQLException: near &amp;quot;*&amp;quot;: syntax error: SELECT count(DISTINCT *) AS count_all FROM &amp;quot;assets&amp;quot; INNER JOIN &amp;quot;shipment_order_items&amp;quot; ON &amp;quot;assets&amp;quot;.id = &amp;quot;shipment_order_items&amp;quot;.asset_id WHERE ((&amp;quot;shipment_order_items&amp;quot;.shipment_order_id = 1))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I changed line 14 of count_fix.rb to:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
column_name = '*' if column_name =~ /\.\*$/ # was /\.*$/, was looking for any number of periods instead of specifically .*
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I've uploaded a count_fix.rb that should fix that, and hopefully
not break anything else (at the least, my counts on scoped has_many
:throughs appear to be working.)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-16T21:07:49+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-16T21:07:55+00:00</updated-at>
      <user-id type="integer">27548</user-id>
      <version type="integer">12</version>
      <user-name>Rufo Sanchez</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Whoops, thanks for catching that.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Whoops, thanks for catching that.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-16T22:32:08+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-16T22:32:15+00:00</updated-at>
      <user-id type="integer">19875</user-id>
      <version type="integer">13</version>
      <user-name>Peter Wagenet</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Thanks for the workaround. What do you think about changing line 14 into:
@@@ ruby
column_name.sub!('*', primary_key) if column_name =~ /\.\*$/
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;Thanks for the workaround. What do you think about changing line
14 into:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
column_name.sub!('*', primary_key) if column_name =~ /\.\*$/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-18T17:31:30+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 2.3.2 activerecord bug calculations patch scope tested verified
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-18T17:31:33+00:00</updated-at>
      <user-id type="integer">20052</user-id>
      <version type="integer">14</version>
      <user-name>Miha Filej</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I could do that too. Does anyone have thoughts on what's more appropriate?</body>
      <body-html>&lt;div&gt;&lt;p&gt;I could do that too. Does anyone have thoughts on what's more
appropriate?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-18T17:39:31+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-18T17:39:37+00:00</updated-at>
      <user-id type="integer">19875</user-id>
      <version type="integer">15</version>
      <user-name>Peter Wagenet</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I would prefer substituting the primary key, personally, as I feel it makes it more clear what we're doing and makes me less nervous about counts with joins (which aren't really well handled yet elsewhere, but we might as well start...)</body>
      <body-html>&lt;div&gt;&lt;p&gt;I would prefer substituting the primary key, personally, as I
feel it makes it more clear what we're doing and makes me less
nervous about counts with joins (which aren't really well handled
yet elsewhere, but we might as well start...)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-19T03:46:15+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-19T03:46:22+00:00</updated-at>
      <user-id type="integer">10460</user-id>
      <version type="integer">16</version>
      <user-name>Will Bryant</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>The problem also occurs if you use a :select option in named_scope, eg:
 ...
  named_scope :grouped, :group =&gt; 'search_query',
    :select =&gt; &quot;MAX(id) AS id, MAX(created_at) AS created_at, search_query&quot;
 ...

ARModel.grouped.empty? then fails with an SQL error similar to the one mentioned.</body>
      <body-html>&lt;div&gt;&lt;p&gt;The problem also occurs if you use a :select option in
named_scope, eg: ... named_scope :grouped, :group =&amp;gt;
'search_query',&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;:select =&amp;gt; &quot;MAX(id) AS id, MAX(created_at) AS created_at, search_query&quot;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;...&lt;/p&gt;
&lt;p&gt;ARModel.grouped.empty? then fails with an SQL error similar to
the one mentioned.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-19T13:18:13+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-19T13:18:20+00:00</updated-at>
      <user-id type="integer">19167</user-id>
      <version type="integer">17</version>
      <user-name>Thomas Steinhausen</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Hmm, yeah the real difficulty here is the fact that what's normally acceptable for a SELECT statement is not acceptable for a count statement. The question then becomes how one can reasonably translate that statement into a legitimate count statement. Unfortunately, I can't think of a simple straight-forward way to do that.

We could use a two step process like:
1) Translate table.* to table.primary_key
2) Anything still not valid we do a find and then do a size on the returned array. 

Or we could try something a little less pretty, though more reliable: Allow users to specify a :count_select in addition to their normal :select statement.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Hmm, yeah the real difficulty here is the fact that what's
normally acceptable for a SELECT statement is not acceptable for a
count statement. The question then becomes how one can reasonably
translate that statement into a legitimate count statement.
Unfortunately, I can't think of a simple straight-forward way to do
that.&lt;/p&gt;
&lt;p&gt;We could use a two step process like: 1) Translate table.* to
table.primary_key 2) Anything still not valid we do a find and then
do a size on the returned array.&lt;/p&gt;
&lt;p&gt;Or we could try something a little less pretty, though more
reliable: Allow users to specify a :count_select in addition to
their normal :select statement.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-19T13:29:08+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-19T13:29:12+00:00</updated-at>
      <user-id type="integer">19875</user-id>
      <version type="integer">18</version>
      <user-name>Peter Wagenet</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Peter, care to write a patch?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Peter, care to write a patch?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-19T13:32:07+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-19T13:32:12+00:00</updated-at>
      <user-id type="integer">8407</user-id>
      <version type="integer">19</version>
      <user-name>Manfred Stienstra</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>For which solution?</body>
      <body-html>&lt;div&gt;&lt;p&gt;For which solution?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-19T14:18:53+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-19T14:19:00+00:00</updated-at>
      <user-id type="integer">19875</user-id>
      <version type="integer">20</version>
      <user-name>Peter Wagenet</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-23T16:35:27+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-23T16:35:29+00:00</updated-at>
      <user-id type="integer">9721</user-id>
      <version type="integer">21</version>
      <user-name>Max Lapshin</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Regarding the above comments of using the primary_key in the count

Please keep in mind that in many databases (certainly the ones I've worked on) there's a big difference between COUNT(*) and COUNT(field)

COUNT(*) is what we're all familiar with.  The number of rows the select would have returned

COUNT(field) however only returns the number of NON-NULL entries in that field.

Example:
select count(*) from users;  =&gt; 100

select count(last_logged_in) from users;   =&gt;   50</body>
      <body-html>&lt;div&gt;&lt;p&gt;Regarding the above comments of using the primary_key in the
count&lt;/p&gt;
&lt;p&gt;Please keep in mind that in many databases (certainly the ones
I've worked on) there's a big difference between COUNT(*) and
COUNT(field)&lt;/p&gt;
&lt;p&gt;COUNT(*) is what we're all familiar with. The number of rows the
select would have returned&lt;/p&gt;
&lt;p&gt;COUNT(field) however only returns the number of NON-NULL entries
in that field.&lt;/p&gt;
&lt;p&gt;Example: select count(*) from users; =&amp;gt; 100&lt;/p&gt;
&lt;p&gt;select count(last_logged_in) from users; =&amp;gt; 50&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-27T13:45:54+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-27T13:46:00+00:00</updated-at>
      <user-id type="integer">6310</user-id>
      <version type="integer">22</version>
      <user-name>Mina Naguib</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I hit a very similar issue, which I reported in ticket #2329. As well as having .* in :select, I also had a calculated column, hence there was a comma in there. I came up with a one-line fix to change column_name to :all if :select contains a comma but I guess this wouldn't fix the case where you just have .*.

@@@
--- a/activerecord/lib/active_record/calculations.rb
+++ b/activerecord/lib/active_record/calculations.rb
@@ -164,6 +164,7 @@ module ActiveRecord
             raise ArgumentError, &quot;Unexpected parameters passed to count(): #{args.inspect}&quot;
           end
 
+          column_name = :all if column_name.to_s.index(',')
           [column_name || :all, options]
         end
 
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;I hit a very similar issue, which I reported in ticket &lt;a href=&quot;/projects/8994/tickets/2329&quot; title=&quot;Ticket #2329&quot;&gt;#2329&lt;/a&gt;. As
well as having . &lt;em&gt;in :select, I also had a calculated column,
hence there was a comma in there. I came up with a one-line fix to
change column_name to :all if :select contains a comma but I guess
this wouldn't fix the case where you just have .&lt;/em&gt;.&lt;/p&gt;


&lt;pre&gt;&lt;code&gt;
--- a/activerecord/lib/active_record/calculations.rb
+++ b/activerecord/lib/active_record/calculations.rb
@@ -164,6 +164,7 @@ module ActiveRecord
             raise ArgumentError, &amp;quot;Unexpected parameters passed to count(): #{args.inspect}&amp;quot;
           end
 
+          column_name = :all if column_name.to_s.index(',')
           [column_name || :all, options]
         end
 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-27T14:11:11+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-27T14:11:17+00:00</updated-at>
      <user-id type="integer">10014</user-id>
      <version type="integer">23</version>
      <user-name>James Le Cuirot</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Sorry. Stupid Markdown...

I hit a very similar issue, which I reported in ticket #2329. As well as having .\* in :select, I also had a calculated column, hence there was a comma in there. I came up with a one-line fix to change column_name to :all if :select contains a comma but I guess this wouldn't fix the case where you just have .\*.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Sorry. Stupid Markdown...&lt;/p&gt;
&lt;p&gt;I hit a very similar issue, which I reported in ticket &lt;a href=&quot;/projects/8994/tickets/2329&quot; title=&quot;Ticket #2329&quot;&gt;#2329&lt;/a&gt;. As
well as having .* in :select, I also had a calculated column, hence
there was a comma in there. I came up with a one-line fix to change
column_name to :all if :select contains a comma but I guess this
wouldn't fix the case where you just have .*.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-27T14:12:51+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-27T14:12:58+00:00</updated-at>
      <user-id type="integer">10014</user-id>
      <version type="integer">24</version>
      <user-name>James Le Cuirot</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>@Mina: primary keys can't be NULL.

My vote is for:

@@@
COUNT(`[table]`.[primary_key])
@@@

It just feels more right. It will also produce correct counts if users get wild with all sorts of manual JOINs.</body>
      <body-html>&lt;div&gt;&lt;p&gt;@Mina: primary keys can't be NULL.&lt;/p&gt;
&lt;p&gt;My vote is for:&lt;/p&gt;


&lt;pre&gt;&lt;code&gt;
COUNT(`[table]`.[primary_key])
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It just feels more right. It will also produce correct counts if
users get wild with all sorts of manual JOINs.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-27T16:40:04+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-27T16:40:08+00:00</updated-at>
      <user-id type="integer">192</user-id>
      <version type="integer">25</version>
      <user-name>Mislav</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>My vote is also for table.primary_key</body>
      <body-html>&lt;div&gt;&lt;p&gt;My vote is also for table.primary_key&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-27T18:40:40+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-27T18:40:47+00:00</updated-at>
      <user-id type="integer">9721</user-id>
      <version type="integer">26</version>
      <user-name>Max Lapshin</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Seeing as the primary key should always be populated, counting it should get you the same result as COUNT(*).</body>
      <body-html>&lt;div&gt;&lt;p&gt;Seeing as the primary key should always be populated, counting
it should get you the same result as COUNT(*).&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-27T21:54:05+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-27T21:54:13+00:00</updated-at>
      <user-id type="integer">19875</user-id>
      <version type="integer">27</version>
      <user-name>Peter Wagenet</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>+1 count(*)

fix the regression now, worry about more obscure edge cases later when we have real use cases rather than theoretical ones (or time to think through theoretical ones).</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 count(*)&lt;/p&gt;
&lt;p&gt;fix the regression now, worry about more obscure edge cases
later when we have real use cases rather than theoretical ones (or
time to think through theoretical ones).&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-29T22:40:45+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-29T22:40:50+01:00</updated-at>
      <user-id type="integer">17200</user-id>
      <version type="integer">28</version>
      <user-name>Xavier Shay</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>+1 count(*)</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 count(*)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-30T14:07:03+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-30T14:07:08+01:00</updated-at>
      <user-id type="integer">26942</user-id>
      <version type="integer">29</version>
      <user-name>Wiktor Schmidt</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>What's holding this up?</body>
      <body-html>&lt;div&gt;&lt;p&gt;What's holding this up?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-30T22:49:48+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-30T22:49:55+01:00</updated-at>
      <user-id type="integer">6470</user-id>
      <version type="integer">30</version>
      <user-name>Nate</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-30T22:52:08+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 1366
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-03-30T22:52:13+01:00</updated-at>
      <user-id type="integer">1366</user-id>
      <version type="integer">31</version>
      <user-name>Pratik</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>This bug is pain. +1 vote fix asap, don't care how.</body>
      <body-html>&lt;div&gt;&lt;p&gt;This bug is pain. +1 vote fix asap, don't care how.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-01T21:56:03+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-01T21:56:08+01:00</updated-at>
      <user-id type="integer">42756</user-id>
      <version type="integer">32</version>
      <user-name>Marc Bowes</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>+1 count(*)</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 count(*)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-02T15:25:48+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-02T15:25:55+01:00</updated-at>
      <user-id type="integer">794</user-id>
      <version type="integer">33</version>
      <user-name>Christos Zisopoulos</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Hey guys, please don't just comment with just +1, it doesn't really help, it only annoys active developers who get assigned to the patch and they stop watching the tickets

Voting is meant for an actual patch after you've reviewed it, not for some abstract solution that isn't actually implemented.

From the [contributers guide](https://rails.lighthouseapp.com/projects/8994/sending-patches):

&gt; If your comment simply says +1, then odds are other reviewers aren't going to take it too seriously. Show that you took the time to review the patch. Once three people have approved it, add the verified tag. This will bring it to the attention of a committer who'll then review the changes looking for the same kinds of things.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Hey guys, please don't just comment with just +1, it doesn't
really help, it only annoys active developers who get assigned to
the patch and they stop watching the tickets&lt;/p&gt;
&lt;p&gt;Voting is meant for an actual patch after you've reviewed it,
not for some abstract solution that isn't actually implemented.&lt;/p&gt;
&lt;p&gt;From the &lt;a href=&quot;https://rails.lighthouseapp.com/projects/8994/sending-patches&quot;&gt;contributers
guide&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If your comment simply says +1, then odds are other reviewers
aren't going to take it too seriously. Show that you took the time
to review the patch. Once three people have approved it, add the
verified tag. This will bring it to the attention of a committer
who'll then review the changes looking for the same kinds of
things.&lt;/p&gt;
&lt;/blockquote&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-02T15:34:10+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-02T15:34:14+01:00</updated-at>
      <user-id type="integer">8407</user-id>
      <version type="integer">34</version>
      <user-name>Manfred Stienstra</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Okay, I applied this patch in my app, (Rails 2.3.2) as such:

@@@ ruby
module CountFix
  def self.included(base)
    base.class_eval do
      extend ClassMethods
      class &lt;&lt; self; alias_method_chain :construct_count_options_from_args, :fix; end
    end
  end
  
  module ClassMethods
    protected
      def construct_count_options_from_args_with_fix(*args)
        column_name, options = construct_count_options_from_args_without_fix(*args)
        column_name = '*' if column_name =~ /\.\*$/
        [column_name, options]
      end
  end
end
ActiveRecord::Base.send :include, CountFix
@@@

It's a rather large app.  Here's the last line of rake stats:

Code LOC: 14241     Test LOC: 18787     Code to Test Ratio: 1:1.3

So far no issues, all specs pass.  +1 :)</body>
      <body-html>&lt;div&gt;&lt;p&gt;Okay, I applied this patch in my app, (Rails 2.3.2) as such:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
module CountFix
  def self.included(base)
    base.class_eval do
      extend ClassMethods
      class &amp;lt;&amp;lt; self; alias_method_chain :construct_count_options_from_args, :fix; end
    end
  end
  
  module ClassMethods
    protected
      def construct_count_options_from_args_with_fix(*args)
        column_name, options = construct_count_options_from_args_without_fix(*args)
        column_name = '*' if column_name =~ /\.\*$/
        [column_name, options]
      end
  end
end
ActiveRecord::Base.send :include, CountFix
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It's a rather large app. Here's the last line of rake stats:&lt;/p&gt;
&lt;p&gt;Code LOC: 14241 Test LOC: 18787 Code to Test Ratio: 1:1.3&lt;/p&gt;
&lt;p&gt;So far no issues, all specs pass. +1 :)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-02T15:49:08+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-02T15:49:15+01:00</updated-at>
      <user-id type="integer">17345</user-id>
      <version type="integer">35</version>
      <user-name>Steven Soroka</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I think there is a problem in rails.

Proxies and name_scopes must be merge in orde to not have these kind of problems.

Here is two tests.

The first, count over an association proxy. When you call count AssociationCollection#count it call the reflexion with Calculations#count(:all,{})

@@@ ruby
  Tag.first.tagged_posts.count
@@@

But the second use a name_scope.

@@@ ruby
  Tag.first.tagged_posts.containing_the_letter_a.count
@@@

The last one bypass the association proxy, so you call Calculations#count() with any args. In these case it will suppose that there is no association proxy, so it extract column_name from scope(:find)[:select]. As it comes from a proxy, the select is &quot;`table_name`.*&quot; that obviously is not and SQL valid COUNT.

Maybe it must be a module for proxies and named_scope.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I think there is a problem in rails.&lt;/p&gt;
&lt;p&gt;Proxies and name_scopes must be merge in orde to not have these
kind of problems.&lt;/p&gt;
&lt;p&gt;Here is two tests.&lt;/p&gt;
&lt;p&gt;The first, count over an association proxy. When you call count
AssociationCollection#count it call the reflexion with
Calculations#count(:all,{})&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
  Tag.first.tagged_posts.count
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;But the second use a name_scope.&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
  Tag.first.tagged_posts.containing_the_letter_a.count
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The last one bypass the association proxy, so you call
Calculations#count() with any args. In these case it will suppose
that there is no association proxy, so it extract column_name from
scope(:find)[:select]. As it comes from a proxy, the select is
&quot;&lt;code&gt;table_name&lt;/code&gt;.*&quot; that obviously is not and SQL valid
COUNT.&lt;/p&gt;
&lt;p&gt;Maybe it must be a module for proxies and named_scope.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-02T16:30:52+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-02T16:30:56+01:00</updated-at>
      <user-id type="integer">20574</user-id>
      <version type="integer">36</version>
      <user-name>Guillermo &#193;lvarez</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-04-02T16:33:52+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-02T16:33:59+01:00</updated-at>
      <user-id type="integer">8407</user-id>
      <version type="integer">37</version>
      <user-name>Manfred Stienstra</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>The best thing you can do with these problem is just add (:all) to count. So instend of apply a patch, just be explicit:

@@@ ruby 
  Tag.first.tagged_posts.containing_the_letter_a.count
@@@

*Must be:*

@@@ ruby 
  Tag.first.tagged_posts.containing_the_letter_a.count(:all)
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;The best thing you can do with these problem is just add (:all)
to count. So instend of apply a patch, just be explicit:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
  Tag.first.tagged_posts.containing_the_letter_a.count
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;Must be:&lt;/em&gt;&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
  Tag.first.tagged_posts.containing_the_letter_a.count(:all)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-04-02T17:58:32+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-02T17:58:36+01:00</updated-at>
      <user-id type="integer">20574</user-id>
      <version type="integer">38</version>
      <user-name>Guillermo &#193;lvarez</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>This bug also gets triggered when using the empty? method, so it's not always possible to add (:all) to count.</body>
      <body-html>&lt;div&gt;&lt;p&gt;This bug also gets triggered when using the empty? method, so
it's not always possible to add (:all) to count.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-04-04T12:38:21+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-04T12:38:25+01:00</updated-at>
      <user-id type="integer">7381</user-id>
      <version type="integer">39</version>
      <user-name>John Topley</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>@John Topley

There is another thing you can do. Is so simple, but it isn't the best solution.

Instead of use .empty? Just put .all.empty?

These isn't clean, doesn't have good performance, but can bypass these kind of rails bugs.

At least is what i have to do to upgrade some rails apps. 

I prefer have these kind of solutions before start monkey patching.</body>
      <body-html>&lt;div&gt;&lt;p&gt;@John Topley&lt;/p&gt;
&lt;p&gt;There is another thing you can do. Is so simple, but it isn't
the best solution.&lt;/p&gt;
&lt;p&gt;Instead of use .empty? Just put .all.empty?&lt;/p&gt;
&lt;p&gt;These isn't clean, doesn't have good performance, but can bypass
these kind of rails bugs.&lt;/p&gt;
&lt;p&gt;At least is what i have to do to upgrade some rails apps.&lt;/p&gt;
&lt;p&gt;I prefer have these kind of solutions before start monkey
patching.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-04-06T15:29:36+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-06T15:29:42+01:00</updated-at>
      <user-id type="integer">20574</user-id>
      <version type="integer">40</version>
      <user-name>Guillermo &#193;lvarez</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>@Guillermo: that's a horrible &quot;solution&quot;, and a waste of resources (fetches all records and instantiates all rows as AR objects, just to check if there's any).  Even after it's fixed in Rails you'll have to remember to hunt through your code and figure out where all your work-arounds are.

You're better off getting comfortable patching Rails.

The CountFix above looks pretty safe (I've used it without problems) and you can always wrap it in Rails version check so you don't have to remember to remove it:

@@@ ruby
  if Rails.version == '2.3.2'
    ...
  end
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;@Guillermo: that's a horrible &quot;solution&quot;, and a waste of
resources (fetches all records and instantiates all rows as AR
objects, just to check if there's any). Even after it's fixed in
Rails you'll have to remember to hunt through your code and figure
out where all your work-arounds are.&lt;/p&gt;
&lt;p&gt;You're better off getting comfortable patching Rails.&lt;/p&gt;
&lt;p&gt;The CountFix above looks pretty safe (I've used it without
problems) and you can always wrap it in Rails version check so you
don't have to remember to remove it:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
  if Rails.version == '2.3.2'
    ...
  end
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-04-06T15:55:41+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-06T15:55:48+01:00</updated-at>
      <user-id type="integer">17345</user-id>
      <version type="integer">41</version>
      <user-name>Steven Soroka</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Here's a patch. Same as CountFix. It's slightly hackish but it will work until Manfred gets scopes redone.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Here's a patch. Same as CountFix. It's slightly hackish but it
will work until Manfred gets scopes redone.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-04-07T04:07:14+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope tested verified</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-07T04:07:18+01:00</updated-at>
      <user-id type="integer">19875</user-id>
      <version type="integer">42</version>
      <user-name>Peter Wagenet</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Peter, did you check if there are other methods like count that might have the same problem with the :select query parameter?

For other people watching this ticket, this is the time to try to apply the patch on your Rails fork and tell us if it applies and if it solves your problems (:</body>
      <body-html>&lt;div&gt;&lt;p&gt;Peter, did you check if there are other methods like count that
might have the same problem with the :select query parameter?&lt;/p&gt;
&lt;p&gt;For other people watching this ticket, this is the time to try
to apply the patch on your Rails fork and tell us if it applies and
if it solves your problems (:&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-07T12:54:22+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 2.3.2 activerecord bug calculations patch regression scope tested verified
:state: incomplete
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-07T12:54:31+01:00</updated-at>
      <user-id type="integer">8407</user-id>
      <version type="integer">43</version>
      <user-name>Manfred Stienstra</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>I have not checked any non-count methods. If anyone is aware of any that I should take a look at, please let me know.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I have not checked any non-count methods. If anyone is aware of
any that I should take a look at, please let me know.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-07T14:27:08+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-07T14:27:15+01:00</updated-at>
      <user-id type="integer">19875</user-id>
      <version type="integer">44</version>
      <user-name>Peter Wagenet</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>That patch is still failing for me, giving me the following SQL error:

Mysql::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '*) AS count_all FROM `articles` INNER JOIN `article_listings` ON `articles`.id =' at line 1: SELECT count(DISTINCT *) AS count_all FROM `articles` INNER JOIN `article_listings` ON `articles`.id = `article_listings`.article_id WHERE (((`articles`.`headline` IN ('Daily Debriefing','Political Debriefing')) AND ((`article_listings`.issue_id = 2613))) AND ((`article_listings`.issue_id = 2613))) 

It's from calling #empty? on one named scope called on one has_many :through association.</body>
      <body-html>&lt;div&gt;&lt;p&gt;That patch is still failing for me, giving me the following SQL
error:&lt;/p&gt;
&lt;p&gt;Mysql::Error: You have an error in your SQL syntax; check the
manual that corresponds to your MySQL server version for the right
syntax to use near '&lt;em&gt;) AS count_all FROM &lt;code&gt;articles&lt;/code&gt;
INNER JOIN &lt;code&gt;article_listings&lt;/code&gt; ON
&lt;code&gt;articles&lt;/code&gt;.id =' at line 1: SELECT count(DISTINCT&lt;/em&gt; )
AS count_all FROM &lt;code&gt;articles&lt;/code&gt; INNER JOIN
&lt;code&gt;article_listings&lt;/code&gt; ON &lt;code&gt;articles&lt;/code&gt;.id =
&lt;code&gt;article_listings&lt;/code&gt;.article_id WHERE
(((&lt;code&gt;articles&lt;/code&gt;.&lt;code&gt;headline&lt;/code&gt; IN ('Daily
Debriefing','Political Debriefing')) AND
((&lt;code&gt;article_listings&lt;/code&gt;.issue_id = 2613))) AND
((&lt;code&gt;article_listings&lt;/code&gt;.issue_id = 2613)))&lt;/p&gt;
&lt;p&gt;It's from calling #empty? on one named scope called on one
has_many :through association.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-10T03:17:18+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-10T03:17:25+01:00</updated-at>
      <user-id type="integer">51923</user-id>
      <version type="integer">45</version>
      <user-name>Andrew Bloomgarden</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Since this bug has broken pretty significant core functionality and the functionality added by the patch while arguably useful is certainly an edge case, isn't the simplest solution to revert that patch?

The patch in question didn't appear to get even a single +1, and while it would be nice not to lose that functionality, I would much rather have applications be able to perform the basic functionality without breaking.

Can we simply call this a poorly vetted patch that should be resubmitted when it deals with these issues and be done with it?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Since this bug has broken pretty significant core functionality
and the functionality added by the patch while arguably useful is
certainly an edge case, isn't the simplest solution to revert that
patch?&lt;/p&gt;
&lt;p&gt;The patch in question didn't appear to get even a single +1, and
while it would be nice not to lose that functionality, I would much
rather have applications be able to perform the basic functionality
without breaking.&lt;/p&gt;
&lt;p&gt;Can we simply call this a poorly vetted patch that should be
resubmitted when it deals with these issues and be done with
it?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-17T23:31:08+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-17T23:31:13+01:00</updated-at>
      <user-id type="integer">24863</user-id>
      <version type="integer">46</version>
      <user-name>Dan Weinand</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>would be great if this could be fixed, i want to upgrade :(</body>
      <body-html>&lt;div&gt;&lt;p&gt;would be great if this could be fixed, i want to upgrade :(&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-18T10:08:21+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-18T10:08:27+01:00</updated-at>
      <user-id type="integer">42010</user-id>
      <version type="integer">47</version>
      <user-name>grosser</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Mike Gunderloy suggested me that #2482 is similar problem like this.
Would anyone be kind to care about that ticket, too?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Mike Gunderloy suggested me that &lt;a href=&quot;/projects/8994/tickets/2482&quot; title=&quot;Ticket #2482&quot;&gt;#2482&lt;/a&gt; is
similar problem like this. Would anyone be kind to care about that
ticket, too?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-23T02:58:59+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-23T02:59:06+01:00</updated-at>
      <user-id type="integer">30467</user-id>
      <version type="integer">48</version>
      <user-name>Nobuhiro IMAI</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>ok, silly question #547 here: I found the thread, found the final proposed patch. What do I need to do to patch my 2.2.2 rails which is exhibiting this break on a submission of a count() to a mysql db?

I have the patch, and it appears to be a separate file, so how do I hook it in or where do I place it? Its not a diff file that I run against any particular source file?

Thanks in advance.
s</body>
      <body-html>&lt;div&gt;&lt;p&gt;ok, silly question &lt;a href=&quot;/projects/8994/tickets/547&quot; title=&quot;Ticket #547&quot;&gt;#547&lt;/a&gt; here: I found the thread, found the final
proposed patch. What do I need to do to patch my 2.2.2 rails which
is exhibiting this break on a submission of a count() to a mysql
db?&lt;/p&gt;
&lt;p&gt;I have the patch, and it appears to be a separate file, so how
do I hook it in or where do I place it? Its not a diff file that I
run against any particular source file?&lt;/p&gt;
&lt;p&gt;Thanks in advance. s&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-04-27T07:00:27+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-04-27T07:00:32+01:00</updated-at>
      <user-id type="integer">55289</user-id>
      <version type="integer">49</version>
      <user-name>seanskye</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>I put together a monkey patch to workaround the issue until it's fixed.

http://gist.github.com/107168</body>
      <body-html>&lt;div&gt;&lt;p&gt;I put together a monkey patch to workaround the issue until it's
fixed.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://gist.github.com/107168&quot;&gt;http://gist.github.com/107168&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-06T17:42:00+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-05-06T17:42:08+01:00</updated-at>
      <user-id type="integer">11372</user-id>
      <version type="integer">50</version>
      <user-name>Josh Susser</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>seanskye: I think you most likely have a different issue.  This regression first appeared in Rails 2.3 RC2; on 2.2.2 it shouldn't be a problem (we use this functionality no problem in a 2.2.2 app).</body>
      <body-html>&lt;div&gt;&lt;p&gt;seanskye: I think you most likely have a different issue. This
regression first appeared in Rails 2.3 RC2; on 2.2.2 it shouldn't
be a problem (we use this functionality no problem in a 2.2.2
app).&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-11T02:39:13+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.3.2 activerecord bug calculations patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-05-11T02:39:19+01:00</updated-at>
      <user-id type="integer">10460</user-id>
      <version type="integer">51</version>
      <user-name>Will Bryant</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>But there is really a problem with .count on MySQL in 2.2.2. And it's not related to named scopes. I've stumbled on it too. In a database where the models are the following, executing item.orders.count will fail on mysql 5.0.67 (which I use) but runs ok on sqlite.
@@@ ruby
class Order &lt; ActiveRecord::Base
  has_many :lines, :dependent =&gt; :destroy
  has_many :items, :through =&gt; :lines 
end

class Item &lt; ActiveRecord::Base
  has_many :lines, :dependent =&gt; :destroy
  has_many :orders, :through =&gt; :lines
end

class Line &lt; ActiveRecord::Base
  belongs_to :order
  belongs_to :item
end
@@@
In the log the following error appears:

ActionView::TemplateError (Mysql::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'lines ON orders.id = lines.order_id    WHERE ((`lines`.item_id = 2))' at line 1:
 SELECT count(*) AS count_all FROM `orders`  INNER JOIN lines ON orders.id = lines.order_id    WHERE ((`lines`.item_id = 2)) ) on line #6 of app/views/admin/index.html.erb:</body>
      <body-html>&lt;div&gt;&lt;p&gt;But there is really a problem with .count on MySQL in 2.2.2. And
it's not related to named scopes. I've stumbled on it too. In a
database where the models are the following, executing
item.orders.count will fail on mysql 5.0.67 (which I use) but runs
ok on sqlite.&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
class Order &amp;lt; ActiveRecord::Base
  has_many :lines, :dependent =&amp;gt; :destroy
  has_many :items, :through =&amp;gt; :lines 
end

class Item &amp;lt; ActiveRecord::Base
  has_many :lines, :dependent =&amp;gt; :destroy
  has_many :orders, :through =&amp;gt; :lines
end

class Line &amp;lt; ActiveRecord::Base
  belongs_to :order
  belongs_to :item
end
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In the log the following error appears:&lt;/p&gt;
&lt;p&gt;ActionView::TemplateError (Mysql::Error: You have an error in
your SQL syntax; check the manual that corresponds to your MySQL
server version for the right syntax to use near 'lines ON orders.id
= lines.order_id WHERE ((&lt;code&gt;lines&lt;/code&gt;.item_id = 2))' at line
1: SELECT count(*) AS count_all FROM &lt;code&gt;orders&lt;/code&gt; INNER JOIN
lines ON orders.id = lines.order_id WHERE
((&lt;code&gt;lines&lt;/code&gt;.item_id = 2)) ) on line &lt;a href=&quot;/projects/8994/tickets/6&quot; title=&quot;Ticket #6&quot;&gt;#6&lt;/a&gt; of
app/views/admin/index.html.erb:&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-12T22:08:04+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 2.3.2 activerecord bug calculations patch regression scope
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-05-12T22:08:14+01:00</updated-at>
      <user-id type="integer">30637</user-id>
      <version type="integer">52</version>
      <user-name>Jacob Gorban</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Jacob: &quot;lines&quot; is a reserved word in MySQL. The bug here is that ActiveRecord didn't properly escape table names on JOIN.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Jacob: &quot;lines&quot; is a reserved word in MySQL. The bug here is that
ActiveRecord didn't properly escape table names on JOIN.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-13T11:06:31+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-05-13T11:06:41+01:00</updated-at>
      <user-id type="integer">192</user-id>
      <version type="integer">53</version>
      <user-name>Mislav</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Josh - That monkey patch is working wonderfully.  Thanks!</body>
      <body-html>&lt;div&gt;&lt;p&gt;Josh - That monkey patch is working wonderfully. Thanks!&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-22T21:42:31+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-05-22T21:42:40+01:00</updated-at>
      <user-id type="integer">1514</user-id>
      <version type="integer">54</version>
      <user-name>Duff OMelia</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>I have a lot of named scopes that are ordered by a join:

@@@ ruby
  named_scope :most_achieved,
    :select =&gt; 'tips.*, COUNT(*) AS raw_achievement_count',
    :joins =&gt; :achievements,
    :group =&gt; 'tips.id',
    :order =&gt; 'raw_achievement_count DESC'
@@@

Here's how I changed Josh's monkey patch to support counting these:

@@@ ruby
  class ActiveRecord::Base
    protected
      def self.construct_count_options_from_args(*args)
        name_and_options = super
        if name_and_options[0].is_a?(String)
          if name_and_options[0].include?(',')
            name_and_options[0] = &quot;DISTINCT #{quoted_table_name}.#{primary_key}&quot;
          elsif name_and_options[0] =~ /\.\*$/
            name_and_options[0] = '*'
          end
        end
        name_and_options
      end
  end
@@@

This way, I get what I expect from

  Tip.most_achieved.count

because it calls

  SELECT COUNT(DISTINCT `tips`.id)

rather than

  SELECT COUNT(*)</body>
      <body-html>&lt;div&gt;&lt;p&gt;I have a lot of named scopes that are ordered by a join:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;  named_scope :most_achieved,
    :select =&amp;gt; 'tips.*, COUNT(*) AS raw_achievement_count',
    :joins =&amp;gt; :achievements,
    :group =&amp;gt; 'tips.id',
    :order =&amp;gt; 'raw_achievement_count DESC'&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Here's how I changed Josh's monkey patch to support counting
these:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;  class ActiveRecord::Base
    protected
      def self.construct_count_options_from_args(*args)
        name_and_options = super
        if name_and_options[0].is_a?(String)
          if name_and_options[0].include?(',')
            name_and_options[0] = &quot;DISTINCT #{quoted_table_name}.#{primary_key}&quot;
          elsif name_and_options[0] =~ /\.\*$/
            name_and_options[0] = '*'
          end
        end
        name_and_options
      end
  end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;This way, I get what I expect from&lt;/p&gt;
&lt;p&gt;Tip.most_achieved.count&lt;/p&gt;
&lt;p&gt;because it calls&lt;/p&gt;
&lt;p&gt;SELECT COUNT(DISTINCT &lt;code&gt;tips&lt;/code&gt;.id)&lt;/p&gt;
&lt;p&gt;rather than&lt;/p&gt;
&lt;p&gt;SELECT COUNT(*)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-27T19:11:12+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-05-27T19:11:22+01:00</updated-at>
      <user-id type="integer">33412</user-id>
      <version type="integer">55</version>
      <user-name>seamusabshere</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>As per discussions on rails-core, the original commit introducing the problem has been reverted for 2-3-stable (reverted in 34c3162), so the forthcoming patch release will effectively fix this bug for 2.3.  A good solution is required for master (Rails 3), so all the above option are on the table.

This is a good opportunity to fix up how counts behave with joins etc. too.</body>
      <body-html>&lt;div&gt;&lt;p&gt;As per discussions on rails-core, the original commit
introducing the problem has been reverted for 2-3-stable (reverted
in 34c3162), so the forthcoming patch release will effectively fix
this bug for 2.3. A good solution is required for master (Rails 3),
so all the above option are on the table.&lt;/p&gt;
&lt;p&gt;This is a good opportunity to fix up how counts behave with
joins etc. too.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-06-01T03:37:00+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-06-01T03:37:08+01:00</updated-at>
      <user-id type="integer">10460</user-id>
      <version type="integer">56</version>
      <user-name>Will Bryant</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>I think this should default to count just the &quot;memberships&quot;
table without going into the whole merge thing!

makes sense?

( &quot;memberships&quot; from the first example presented in this page )</body>
      <body-html>&lt;div&gt;&lt;p&gt;I think this should default to count just the &quot;memberships&quot;&lt;br&gt;
table without going into the whole merge thing!&lt;/p&gt;
&lt;p&gt;makes sense?&lt;/p&gt;
&lt;p&gt;( &quot;memberships&quot; from the first example presented in this page
)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-06-04T06:58:52+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-06-04T06:58:59+01:00</updated-at>
      <user-id type="integer">39886</user-id>
      <version type="integer">57</version>
      <user-name>kazuyoshi tlacaelel</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>I don't know the following is releated, but when researching this bug I found that the where-clause created by ActiveRecord changed at some point between 2.1.2 and 2.3.2.

What in Rails 2.1.2 used to look like this:
@@@ SQL
SELECT count(*) AS count_all FROM `products` INNER JOIN product_relations ON products.id = product_relations.child_id WHERE ((`products`.`published` = 1) AND ((`product_relations`.parent_id = 55587668) AND ((`product_relations`.`tp_product_relation_id` = 544572937))))
@@@

Will in 3.2-stable currently look like:
@@@ SQL
SELECT count(*) AS count_all FROM `products` INNER JOIN `product_relations` ON `products`.id = `product_relations`.child_id WHERE (((`products`.`published` = 1) AND ((`product_relations`.parent_id = 55587668) AND ((`product_relations`.`tp_product_relation_id` = 544572937)))) AND ((`product_relations`.parent_id = 55587668) AND ((`product_relations`.`tp_product_relation_id` = 544572937))))
@@@

As you can see the count-bug is now gone since I've moved from 3.2.3 to 3.2-stable, but for some reason the where-clause is repeated (which it also where on 3.2.3).

This is an excerpt of the code that gives this issue:
@@@ Ruby
class ProductRelationType &lt; ActiveRecord::Base
  ...
end

class ProductRelation &lt; ActiveRecord::Base
  belongs_to :typ, :foreign_key =&gt; 'tp_product_relation_id', :class_name =&gt; 'ProductRelationType'
  belongs_to :child, :foreign_key =&gt; 'child_id', :class_name =&gt; 'Product'
  belongs_to :parent, :foreign_key =&gt; 'parent_id', :class_name =&gt; 'Product'
  ...
end

class Product &lt; ActiveRecord::Base
  has_many :child_products, :foreign_key =&gt; 'parent_id', :class_name =&gt; 'ProductRelation'
  has_many :variants, :through =&gt; :child_products, :source =&gt; :child, :conditions =&gt; { &quot;product_relations.tp_product_relation_id&quot; =&gt; ProductRelationType.find_by_label('variant') }
  named_scope :published, :conditions =&gt; { :published =&gt; true }
  ...
end

@product.variants.published.empty?
@@@

Is this related to this bug?</body>
      <body-html>&lt;div&gt;&lt;p&gt;I don't know the following is releated, but when researching
this bug I found that the where-clause created by ActiveRecord
changed at some point between 2.1.2 and 2.3.2.&lt;/p&gt;
&lt;p&gt;What in Rails 2.1.2 used to look like this:&lt;br&gt;
@@@ SQL SELECT count(&lt;em&gt;) AS count_all FROM &lt;code&gt;products&lt;/code&gt;
INNER JOIN product_relations ON products.id =
product_relations.child_id WHERE
((&lt;code&gt;products&lt;/code&gt;.&lt;code&gt;published&lt;/code&gt; = 1) AND
((&lt;code&gt;product_relations&lt;/code&gt;.parent_id = 55587668) AND
((&lt;code&gt;product_relations&lt;/code&gt;.&lt;code&gt;tp_product_relation_id&lt;/code&gt;
= 544572937))))&lt;br&gt;&lt;/em&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;em&gt;&lt;code&gt;
Will in 3.2-stable currently look like:
@@@ SQL
SELECT count(&lt;/code&gt;) AS count_all FROM &lt;code&gt;products&lt;/code&gt; INNER JOIN &lt;code&gt;product_relations&lt;/code&gt; ON &lt;code&gt;products&lt;/code&gt;.id = &lt;code&gt;product_relations&lt;/code&gt;.child_id WHERE (((&lt;code&gt;products&lt;/code&gt;.&lt;code&gt;published&lt;/code&gt; = 1) AND ((&lt;code&gt;product_relations&lt;/code&gt;.parent_id = 55587668) AND ((&lt;code&gt;product_relations&lt;/code&gt;.&lt;code&gt;tp_product_relation_id&lt;/code&gt; = 544572937)))) AND ((&lt;code&gt;product_relations&lt;/code&gt;.parent_id = 55587668) AND ((&lt;code&gt;product_relations&lt;/code&gt;.&lt;code&gt;tp_product_relation_id&lt;/code&gt; = 544572937))))&lt;/em&gt;
&lt;/pre&gt;
&lt;p&gt;As you can see the count-bug is now gone since I've moved from
3.2.3 to 3.2-stable, but for some reason the where-clause is
repeated (which it also where on 3.2.3).&lt;/p&gt;
&lt;p&gt;This is an excerpt of the code that gives this issue:&lt;br&gt;
@@@ Ruby class ProductRelationType &amp;lt; ActiveRecord::Base&lt;br&gt;
... end&lt;/p&gt;
&lt;p&gt;class ProductRelation &amp;lt; ActiveRecord::Base&lt;br&gt;
belongs_to :typ, :foreign_key =&amp;gt; 'tp_product_relation_id',
:class_name =&amp;gt; 'ProductRelationType' belongs_to :child,
:foreign_key =&amp;gt; 'child_id', :class_name =&amp;gt; 'Product'
belongs_to :parent, :foreign_key =&amp;gt; 'parent_id', :class_name
=&amp;gt; 'Product' ... end&lt;/p&gt;
&lt;p&gt;class Product &amp;lt; ActiveRecord::Base&lt;br&gt;
has_many :child_products, :foreign_key =&amp;gt; 'parent_id',
:class_name =&amp;gt; 'ProductRelation' has_many :variants, :through
=&amp;gt; :child_products, :source =&amp;gt; :child, :conditions =&amp;gt; {
&quot;product_relations.tp_product_relation_id&quot; =&amp;gt;
ProductRelationType.find_by_label('variant') } named_scope
:published, :conditions =&amp;gt; { :published =&amp;gt; true } ... end&lt;/p&gt;
&lt;p&gt;@product.variants.published.empty?&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;
Is this related to this bug?&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-06-15T19:47:39+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-06-15T19:47:39+01:00</updated-at>
      <user-id type="integer">20564</user-id>
      <version type="integer">58</version>
      <user-name>Thomas Watson</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Sorry for the formatting :( Why doesn't Lighthouse have a preview-before-post feature??
Here goes nothing - sorry if I'm spamming you once again...

What in Rails 2.1.2 used to look like this:

@@@
SELECT count(*) AS count_all FROM `products` INNER JOIN product_relations ON products.id = product_relations.child_id WHERE ((`products`.`published` = 1) AND ((`product_relations`.parent_id = 55587668) AND ((`product_relations`.`tp_product_relation_id` = 544572937))))
@@@

Will in 3.2-stable currently look like:

@@@
SELECT count(*) AS count_all FROM `products` INNER JOIN `product_relations` ON `products`.id = `product_relations`.child_id WHERE (((`products`.`published` = 1) AND ((`product_relations`.parent_id = 55587668) AND ((`product_relations`.`tp_product_relation_id` = 544572937)))) AND ((`product_relations`.parent_id = 55587668) AND ((`product_relations`.`tp_product_relation_id` = 544572937))))
@@@

As you can see the count-bug is now gone since I've moved from 3.2.3 to 3.2-stable, but for some reason the where-clause is repeated (which it also where on 3.2.3).

This is an excerpt of the code that gives this issue:

@@@
class ProductRelationType &lt; ActiveRecord::Base
  ...
end

class ProductRelation &lt; ActiveRecord::Base
  belongs_to :typ, :foreign_key =&gt; 'tp_product_relation_id', :class_name =&gt; 'ProductRelationType'
  belongs_to :child, :foreign_key =&gt; 'child_id', :class_name =&gt; 'Product'
  belongs_to :parent, :foreign_key =&gt; 'parent_id', :class_name =&gt; 'Product'
  ...
end

class Product &lt; ActiveRecord::Base
  has_many :child_products, :foreign_key =&gt; 'parent_id', :class_name =&gt; 'ProductRelation'
  has_many :variants, :through =&gt; :child_products, :source =&gt; :child, :conditions =&gt; { &quot;product_relations.tp_product_relation_id&quot; =&gt; ProductRelationType.find_by_label('variant') }
  named_scope :published, :conditions =&gt; { :published =&gt; true }
  ...
end

@product.variants.published.empty?
@@@

Is this related to this bug?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Sorry for the formatting :( Why doesn't Lighthouse have a
preview-before-post feature??&lt;br&gt;
Here goes nothing - sorry if I'm spamming you once again...&lt;/p&gt;
&lt;p&gt;What in Rails 2.1.2 used to look like this:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;SELECT count(*) AS count_all FROM `products` INNER JOIN product_relations ON products.id = product_relations.child_id WHERE ((`products`.`published` = 1) AND ((`product_relations`.parent_id = 55587668) AND ((`product_relations`.`tp_product_relation_id` = 544572937))))&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Will in 3.2-stable currently look like:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;SELECT count(*) AS count_all FROM `products` INNER JOIN `product_relations` ON `products`.id = `product_relations`.child_id WHERE (((`products`.`published` = 1) AND ((`product_relations`.parent_id = 55587668) AND ((`product_relations`.`tp_product_relation_id` = 544572937)))) AND ((`product_relations`.parent_id = 55587668) AND ((`product_relations`.`tp_product_relation_id` = 544572937))))&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;As you can see the count-bug is now gone since I've moved from
3.2.3 to 3.2-stable, but for some reason the where-clause is
repeated (which it also where on 3.2.3).&lt;/p&gt;
&lt;p&gt;This is an excerpt of the code that gives this issue:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;class ProductRelationType &amp;lt; ActiveRecord::Base
  ...
end

class ProductRelation &amp;lt; ActiveRecord::Base
  belongs_to :typ, :foreign_key =&amp;gt; 'tp_product_relation_id', :class_name =&amp;gt; 'ProductRelationType'
  belongs_to :child, :foreign_key =&amp;gt; 'child_id', :class_name =&amp;gt; 'Product'
  belongs_to :parent, :foreign_key =&amp;gt; 'parent_id', :class_name =&amp;gt; 'Product'
  ...
end

class Product &amp;lt; ActiveRecord::Base
  has_many :child_products, :foreign_key =&amp;gt; 'parent_id', :class_name =&amp;gt; 'ProductRelation'
  has_many :variants, :through =&amp;gt; :child_products, :source =&amp;gt; :child, :conditions =&amp;gt; { &quot;product_relations.tp_product_relation_id&quot; =&amp;gt; ProductRelationType.find_by_label('variant') }
  named_scope :published, :conditions =&amp;gt; { :published =&amp;gt; true }
  ...
end

@product.variants.published.empty?&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Is this related to this bug?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-06-15T19:53:07+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-06-15T19:53:07+01:00</updated-at>
      <user-id type="integer">20564</user-id>
      <version type="integer">59</version>
      <user-name>Thomas Watson</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>I was relying on this feature so I was a little disappointed that it got reverted. Guess you can't please everybody. I have a bunch of customisations/fixes that I occasionally rebase against the stable branch. This time, I had to revert the reversion!</body>
      <body-html>&lt;div&gt;&lt;p&gt;I was relying on this feature so I was a little disappointed
that it got reverted. Guess you can't please everybody. I have a
bunch of customisations/fixes that I occasionally rebase against
the stable branch. This time, I had to revert the reversion!&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-07-27T16:45:55+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2009-07-27T16:46:06+01:00</updated-at>
      <user-id type="integer">10014</user-id>
      <version type="integer">60</version>
      <user-name>James Le Cuirot</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/19097)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/19097&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-04T18:48:41+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 9903
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2010-05-04T18:48:41+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">61</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>So obviously there's been an essentially complete rewrite of this stuff now we're implemented using arel.  I manually applied Guillermo's test on master, and it passes as expected.  Is there still an issue here, or can we close now?</body>
      <body-html>&lt;div&gt;&lt;p&gt;So obviously there's been an essentially complete rewrite of
this stuff now we're implemented using arel. I manually applied
Guillermo's test on master, and it passes as expected. Is there
still an issue here, or can we close now?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-26T05:49:15+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2010-05-26T05:50:15+01:00</updated-at>
      <user-id type="integer">10460</user-id>
      <version type="integer">62</version>
      <user-name>Will Bryant</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>I would only close if there was a passing test committed to both 2-3-stable and master.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I would only close if there was a passing test committed to both
2-3-stable and master.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-26T11:01:52+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2010-05-26T11:02:56+01:00</updated-at>
      <user-id type="integer">192</user-id>
      <version type="integer">63</version>
      <user-name>Mislav</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>OK.  I don't think this will ever get fixed for 2.3.</body>
      <body-html>&lt;div&gt;&lt;p&gt;OK. I don't think this will ever get fixed for 2.3.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-26T11:22:39+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2010-05-26T11:23:41+01:00</updated-at>
      <user-id type="integer">10460</user-id>
      <version type="integer">64</version>
      <user-name>Will Bryant</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Any updates here?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Any updates here?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-10-07T05:54:36+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2010-10-07T05:54:46+01:00</updated-at>
      <user-id type="integer">89656</user-id>
      <version type="integer">65</version>
      <user-name>Rohit Arondekar</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>I haven't met this behavior. It's nice to share your experience. Thanks! &lt;a href=&quot;http://www.jabberjawmobile.com&quot;&gt;prepaid cell phones&lt;/a&gt;</body>
      <body-html>&lt;div&gt;&lt;p&gt;I haven't met this behavior. It's nice to share your experience.
Thanks! &lt;a href=&quot;http://www.jabberjawmobile.com&quot;&gt;prepaid cell
phones&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-10-30T06:59:59+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2010-10-31T05:55:00+00:00</updated-at>
      <user-id type="integer">122541</user-id>
      <version type="integer">66</version>
      <user-name>Susanlin</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Are you looking for Designer Replica Handbags? My-Handbag.com is happy to offer you the best replicas handbags and watches made with high quality materials at lowest price you'll find anywhere.
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;bags replica&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;handbags fake&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;bags fake&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;Fake bags&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;replica handbags Wholesale&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;wholesale designer bags&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;wholesale designer handbags&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;wholesale replica designer handbags&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;replica handbags offers&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;replica bags suppliers&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;replica bags manufacturers&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_15.html&quot;&gt;Chanel handbags Replica&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_19.html&quot;&gt;Gucci handbags Replica&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_12.html&quot;&gt;Louis Vuitton handbags Replica&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;replica hermes handbags&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;replica hermes bags&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes handbags replica&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes bags replica&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;designer hermes handbags&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes handbags designer&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;designer hermes bags&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes bags designer&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;discounted hermes handbags&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes handbags cheap&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes bags cheap&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes bags discounted&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes handbags on sale&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes bags on sale&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes handbags wholesale&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes handbags&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;replica watches&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;watches replica&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;cheap watches&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;designer watches&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;Swiss watches&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;mens watches&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;ladies watches&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;fake watches&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;discounted watches&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;sport watches&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;wholesale replica watches&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;replica swiss watches&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;knockoff watches&lt;/a&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;replica watches on sale&lt;/a&gt;
replicasincn.com is dedicated to bring buyers the top grade replica handbags and watches at wholesale price. Here you can find a genuine pool of replica bags and watches with a wide range varieties.
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;handbags fake&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;bags replica&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;handbags cheap&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;bags cheap&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;handbags discounted&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;bags discounted&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_19.html&quot;&gt;replica gucci handbags&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_15.html&quot;&gt;replica chanel handbags&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_12.html&quot;&gt;replica Louis Vuitton handbags&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;Cheap handbags&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;Wholesale replica handbags&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;Wholesale fake handbags&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;Wholesale cheap handbags&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;Wholesale designer handbags&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_32.html&quot;&gt;designer Hermes handbags&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_32.html&quot;&gt;Replica Hermes handbags&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_32.html&quot;&gt;Hermes handbags replica&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_32.html&quot;&gt;Hermes handbags&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_32.html&quot;&gt;Hermes bags&lt;/a&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_32.html&quot;&gt;hermes birkin&lt;/a&gt;</body>
      <body-html>&lt;div&gt;&lt;p&gt;Are you looking for Designer Replica Handbags? My-Handbag.com is
happy to offer you the best replicas handbags and watches made with
high quality materials at lowest price you'll find anywhere.&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;bags replica&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;handbags fake&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;bags fake&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;Fake bags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;replica handbags
Wholesale&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;wholesale designer
bags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;wholesale designer
handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;wholesale replica designer
handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;replica handbags
offers&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;replica bags suppliers&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/&quot;&gt;replica bags
manufacturers&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_15.html&quot;&gt;Chanel handbags
Replica&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_19.html&quot;&gt;Gucci handbags
Replica&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_12.html&quot;&gt;Louis Vuitton
handbags Replica&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;replica hermes
handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;replica hermes
bags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes handbags
replica&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes bags
replica&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;designer hermes
handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes handbags
designer&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;designer hermes
bags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes bags
designer&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;discounted
hermes handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes handbags
cheap&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes bags
cheap&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes bags
discounted&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes handbags
on sale&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes bags on
sale&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes handbags
wholesale&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_32.html&quot;&gt;hermes
handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;replica
watches&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;watches
replica&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;cheap
watches&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;designer
watches&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;Swiss
watches&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;mens
watches&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;ladies
watches&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;fake
watches&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;discounted
watches&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;sport
watches&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;wholesale
replica watches&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;replica swiss
watches&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;knockoff
watches&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.my-handbag.com/catalog_111.html&quot;&gt;replica
watches on sale&lt;/a&gt;&lt;br&gt;
replicasincn.com is dedicated to bring buyers the top grade replica
handbags and watches at wholesale price. Here you can find a
genuine pool of replica bags and watches with a wide range
varieties.&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;handbags fake&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;bags replica&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;handbags cheap&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;bags cheap&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;handbags discounted&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;bags discounted&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_19.html&quot;&gt;replica gucci
handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_15.html&quot;&gt;replica
chanel handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_12.html&quot;&gt;replica Louis
Vuitton handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;Cheap handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;Wholesale replica
handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;Wholesale fake
handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;Wholesale cheap
handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/&quot;&gt;Wholesale designer
handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_32.html&quot;&gt;designer
Hermes handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_32.html&quot;&gt;Replica
Hermes handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_32.html&quot;&gt;Hermes
handbags replica&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_32.html&quot;&gt;Hermes
handbags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_32.html&quot;&gt;Hermes
bags&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.replicasincn.com/catalog_32.html&quot;&gt;hermes
birkin&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-10-30T07:17:01+01:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope</tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2010-10-31T06:02:32+00:00</updated-at>
      <user-id type="integer">122552</user-id>
      <version type="integer">67</version>
      <user-name>fstory</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Automatic cleanup of spam.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Automatic cleanup of spam.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-11-01T17:02:02+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 2.2.2 2.3.2 activerecord bug calculations mysql patch regression scope
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2010-11-01T17:02:13+00:00</updated-at>
      <user-id type="integer">94458</user-id>
      <version type="integer">69</version>
      <user-name>Jeff Kreeftmeijer</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>&lt;p&gt;When Coach began as Manhattan Leather Bags in 1941, they were inspired by   baseball glove design and they created discount handbags with similar qualities.&lt;strong&gt;&lt;a href=&quot;http://www.uk-supra.com&quot;&gt;supra shoes&lt;/a&gt;&lt;/strong&gt; didn't come along until years later. The original handbag collection   had twelve designs, and they were made from supple, tan, top-quality leathers,   and showed the same excellent craftsmanship and stitching that we still expect   today.&lt;/p&gt;
&lt;p&gt;Coach hired a woman named Bonnie Cashin in 1962, and she brought new looks to   Coach bags. She used many new fabrics and organic materials like jersey and   wool. She created the brass hardware that is symbolic of &lt;strong&gt;&lt;a href=&quot;http://www.menstimberlandshoes.com&quot;&gt;timberland boots&lt;/a&gt;&lt;/strong&gt;. When   Lew Frankfort came aboard in 1979, he brought Coach to the next level, and they   became a name known the world over. Affordable luxury was not a concept that   many people knew, but now they would. Soon after Frankfort joined Coach, they   came out with a catalog, and opened their flagship store in New York City.&lt;/p&gt;
&lt;p&gt;In the 1980's, Coach expanded and made innovations that brought its brand   relevance and strength. They designed watches starting in 1988, and also   expanded their company to Tokyo. Japan still counts among the leading purchasers   of &lt;strong&gt;&lt;a href=&quot;http://www.allofcoach.com&quot;&gt;coach purses&lt;/a&gt;&lt;/strong&gt; and Coach heels. The manufacture of Coach shoes began in the mid   90's, and Reed Krakoff, the lead designer, loaned his talents to help put Coach   heels and &lt;a href=&quot;http://www.louisvuittonbagoutlet.com&quot;&gt;&lt;strong&gt;louis vuitton bags outlet&lt;/strong&gt;&lt;/a&gt; on the map. Their shoes aren't as popular as their   handbags, but they are well worth the money invested in their purchase.&lt;/p&gt;
&lt;p&gt;Women love heels, but at times you may want to wear shoes that don't have   this height. &lt;strong&gt;&lt;a href=&quot;http://www.truereligionjeans-outlet.com&quot;&gt;true religion jeans outlet&lt;/a&gt;&lt;/strong&gt; are as dedicated to comfort as they are to style and   pizzazz. Coach platforms come in many styles, from gold loafers to slingbacks   with open toes. You may be able to find Coach shoes at discount prices online,   but be sure that you are buying genuine Coach products.&lt;/p&gt;
&lt;p&gt;If you're looking for &lt;a href=&quot;http://www.womenmonclerjackets.com&quot;&gt;&lt;strong&gt;moncler jackets&lt;/strong&gt;&lt;/a&gt; that will make you feel and look glamorous, Coach   shoes and &lt;a href=&quot;http://www.chanelpursesbags.com&quot;&gt;&lt;strong&gt;chanel purses&lt;/strong&gt;&lt;/a&gt; can do that well. Coach sneakers and heels will make you   feel sporty, too. When selecting pumps or sandals to wear, you'll be happy to   count on the long-standing quality and service of the Coach company. They have   many styles to choose from, including chic and glamorous Coach boots and Coach   heels. Whether you are looking for sports shoes like Coach sneakers or sexy   shoes like Coach boots, the Coach name will never let you down.&lt;/p&gt;</body>
      <body-html>&lt;div&gt;&lt;p&gt;When Coach began as Manhattan Leather Bags in 1941, they were
inspired by baseball glove design and they created discount
handbags with similar qualities.&lt;strong&gt;&lt;a href=
&quot;http://www.uk-supra.com&quot;&gt;supra shoes&lt;/a&gt;&lt;/strong&gt; didn't come
along until years later. The original handbag collection had twelve
designs, and they were made from supple, tan, top-quality leathers,
and showed the same excellent craftsmanship and stitching that we
still expect today.&lt;/p&gt;
&lt;p&gt;Coach hired a woman named Bonnie Cashin in 1962, and she brought
new looks to Coach bags. She used many new fabrics and organic
materials like jersey and wool. She created the brass hardware that
is symbolic of &lt;strong&gt;&lt;a href=
&quot;http://www.menstimberlandshoes.com&quot;&gt;timberland boots&lt;/a&gt;&lt;/strong&gt;.
When Lew Frankfort came aboard in 1979, he brought Coach to the
next level, and they became a name known the world over. Affordable
luxury was not a concept that many people knew, but now they would.
Soon after Frankfort joined Coach, they came out with a catalog,
and opened their flagship store in New York City.&lt;/p&gt;
&lt;p&gt;In the 1980's, Coach expanded and made innovations that brought
its brand relevance and strength. They designed watches starting in
1988, and also expanded their company to Tokyo. Japan still counts
among the leading purchasers of &lt;strong&gt;&lt;a href=
&quot;http://www.allofcoach.com&quot;&gt;coach purses&lt;/a&gt;&lt;/strong&gt; and Coach
heels. The manufacture of Coach shoes began in the mid 90's, and
Reed Krakoff, the lead designer, loaned his talents to help put
Coach heels and &lt;a href=
&quot;http://www.louisvuittonbagoutlet.com&quot;&gt;&lt;strong&gt;louis vuitton bags
outlet&lt;/strong&gt;&lt;/a&gt; on the map. Their shoes aren't as popular as
their handbags, but they are well worth the money invested in their
purchase.&lt;/p&gt;
&lt;p&gt;Women love heels, but at times you may want to wear shoes that
don't have this height. &lt;strong&gt;&lt;a href=
&quot;http://www.truereligionjeans-outlet.com&quot;&gt;true religion jeans
outlet&lt;/a&gt;&lt;/strong&gt; are as dedicated to comfort as they are to
style and pizzazz. Coach platforms come in many styles, from gold
loafers to slingbacks with open toes. You may be able to find Coach
shoes at discount prices online, but be sure that you are buying
genuine Coach products.&lt;/p&gt;
&lt;p&gt;If you're looking for &lt;a href=
&quot;http://www.womenmonclerjackets.com&quot;&gt;&lt;strong&gt;moncler
jackets&lt;/strong&gt;&lt;/a&gt; that will make you feel and look glamorous,
Coach shoes and &lt;a href=
&quot;http://www.chanelpursesbags.com&quot;&gt;&lt;strong&gt;chanel
purses&lt;/strong&gt;&lt;/a&gt; can do that well. Coach sneakers and heels will
make you feel sporty, too. When selecting pumps or sandals to wear,
you'll be happy to count on the long-standing quality and service
of the Coach company. They have many styles to choose from,
including chic and glamorous Coach boots and Coach heels. Whether
you are looking for sports shoes like Coach sneakers or sexy shoes
like Coach boots, the Coach name will never let you down.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-11-08T01:06:02+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2010-11-08T23:12:00+00:00</updated-at>
      <user-id type="integer">123546</user-id>
      <version type="integer">70</version>
      <user-name>jim123456</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>&lt;a href=&quot;http://www.boots4us.com/&quot;&gt;Uggs&lt;/a&gt; are available in many different colors  and styles and it is this enormous selection which makes the boots so versatile  and desirable. The styles run the gamut from the casual look of the standard  three quarter &lt;a href=&quot;http://www.boots4us.com/&quot;&gt;ugg&lt;/a&gt; boots in a natural  shade to the flamboyant and funky long haired pink boot. What&#8217;s more, people  are wearing these popular &lt;a href=&quot;http://www.bootfeed.com&quot;&gt;ugg australia&lt;/a&gt; to the office, on the dance floor, out to dinner, and while on vacation to the  slopes or to the shores. Whatever look you are trying to achieve, you can  achieve it in &lt;a href=&quot;http://www.bootfeed.com&quot;&gt;uggs outlet&lt;/a&gt;. For one more  things, these boots are not geared towards any one segment of society. Men,  women, children and infants can all find a pair of &lt;a href=&quot;http://www.bootfeed.com&quot;&gt;ugg boots on sale&lt;/a&gt; to match their size and  their style. In addition, &lt;a href=&quot;http://www.bootcarrier.com&quot;&gt;ugg boots sale&lt;/a&gt; is a store that providing genuine sheep skin &lt;a href=&quot;http://www.bootcarrier.com&quot;&gt;cheap ugg boots&lt;/a&gt; can be worn in all types  of weather. When one thinks of boots, one tends to relate boots to cold  weather.  These boots are comfortable,  too. So break out of your fashion rule mentality and let your imagination go wild. Get yourself a pair of boots at &lt;a href=&quot;http://www.bootcarrier.com&quot;&gt;ugg  boots uk&lt;/a&gt; online and wear them with you jeans, wear them to work on casual  Friday, or pair them up with your Sunday best. By the way, Christmas day is coming  so near, why not buying a pair of boots as a gift at &lt;a href=&quot;http://www.overgift.com&quot;&gt;christmas tree shop&lt;/a&gt;. Don&#8217;t be hesitating now, just surfing online and click the links above to get it.</body>
      <body-html>&lt;div&gt;&lt;p&gt;&lt;a href=&quot;http://www.boots4us.com/&quot;&gt;Uggs&lt;/a&gt; are available in
many different colors and styles and it is this enormous selection
which makes the boots so versatile and desirable. The styles run
the gamut from the casual look of the standard three quarter
&lt;a href=&quot;http://www.boots4us.com/&quot;&gt;ugg&lt;/a&gt; boots in a natural shade
to the flamboyant and funky long haired pink boot. What&amp;#8217;s
more, people are wearing these popular &lt;a href=
&quot;http://www.bootfeed.com&quot;&gt;ugg australia&lt;/a&gt; to the office, on the
dance floor, out to dinner, and while on vacation to the slopes or
to the shores. Whatever look you are trying to achieve, you can
achieve it in &lt;a href=&quot;http://www.bootfeed.com&quot;&gt;uggs outlet&lt;/a&gt;.
For one more things, these boots are not geared towards any one
segment of society. Men, women, children and infants can all find a
pair of &lt;a href=&quot;http://www.bootfeed.com&quot;&gt;ugg boots on sale&lt;/a&gt; to
match their size and their style. In addition, &lt;a href=
&quot;http://www.bootcarrier.com&quot;&gt;ugg boots sale&lt;/a&gt; is a store that
providing genuine sheep skin &lt;a href=
&quot;http://www.bootcarrier.com&quot;&gt;cheap ugg boots&lt;/a&gt; can be worn in all
types of weather. When one thinks of boots, one tends to relate
boots to cold weather. These boots are comfortable, too. So break
out of your fashion rule mentality and let your imagination go
wild. Get yourself a pair of boots at &lt;a href=
&quot;http://www.bootcarrier.com&quot;&gt;ugg boots uk&lt;/a&gt; online and wear them
with you jeans, wear them to work on casual Friday, or pair them up
with your Sunday best. By the way, Christmas day is coming so near,
why not buying a pair of boots as a gift at &lt;a href=
&quot;http://www.overgift.com&quot;&gt;christmas tree shop&lt;/a&gt;. Don&amp;#8217;t be
hesitating now, just surfing online and click the links above to
get it.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-11-16T09:51:26+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2010-12-02T08:43:08+00:00</updated-at>
      <user-id type="integer">125253</user-id>
      <version type="integer">71</version>
      <user-name>itiaoshui</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>00zoe
&lt;a href=&quot;http://www.mbtshoes4sale.co.uk&quot;&gt;&lt;strong&gt;MBT shoes&lt;/strong&gt;&lt;/a&gt;, Galin ang Na. 
&lt;a href=&quot;http://www.timberlandboots4sale.co.uk&quot;&gt;&lt;strong&gt;Timberland Boots Sale&lt;/strong&gt;&lt;/a&gt;, insulated boot and set. 
&lt;a href=&quot;http://www.thenorthfaceoutlet.co.uk&quot;&gt;&lt;strong&gt;north face jacket&lt;/strong&gt;&lt;/a&gt;, have been the. 
&lt;a href=&quot;http://www.timberlandbootsale.co.uk&quot;&gt;&lt;strong&gt;Timberland boots&lt;/strong&gt;&lt;/a&gt;, &#32463;&#20856;1956. 
&lt;a href=&quot;http://www.cheapuggbootssale.co.uk&quot;&gt;&lt;strong&gt;ugg boots sale&lt;/strong&gt;&lt;/a&gt;, qkl000. 
&lt;a href=&quot;http://www.timberlandboots2sale.co.uk&quot;&gt;&lt;strong&gt;Timberland&lt;/strong&gt;&lt;/a&gt;, &#35199;&#38376;&#21561;&#38634;. 
&lt;a href=&quot;http://www.mbtclearance.org/&quot;&gt;&lt;strong&gt;MBT shoes clearance&lt;/strong&gt;&lt;/a&gt;, styles, sizes. 
&lt;a href=&quot;http://www.mbtshoes4sale.co.uk&quot;&gt;&lt;strong&gt;MBT shoes&lt;/strong&gt;&lt;/a&gt;, Galin ang Na. 
&lt;a href=&quot;http://www.mbtshoes4sale.co.uk&quot;&gt;&lt;strong&gt;MBT trainers&lt;/strong&gt;&lt;/a&gt;, boots sale online. 
&lt;a href=&quot;http://www.cheapuggbootssale.co.uk&quot;&gt;&lt;strong&gt;cheap ugg boots uk&lt;/strong&gt;&lt;/a&gt;, making cutprice. 
&lt;a href=&quot;http://www.cheapuggbootssale.co.uk/cheap-ugg-handbags-uk-c-23.html&quot;&gt;&lt;strong&gt;ugg handbags uk&lt;/strong&gt;&lt;/a&gt;, have not looked back.. 
&lt;a href=&quot;http://www.cheapuggbootssale.co.uk/cheap-ugg-handbags-uk-c-23.html&quot;&gt;&lt;strong&gt;cheap ugg handbags&lt;/strong&gt;&lt;/a&gt;, The result was the. 
&lt;a href=&quot;http://www.mbtshoes4sale.co.uk&quot;&gt;&lt;strong&gt;MBT lami shoes&lt;/strong&gt;&lt;/a&gt;, We have a long term. 
&lt;a href=&quot;http://www.mbtshoes4sale.co.uk&quot;&gt;&lt;strong&gt;MBT tunisha&lt;/strong&gt;&lt;/a&gt;, cooperative manufacturer. 
&lt;a href=&quot;http://www.timberlandbootsale.co.uk&quot;&gt;&lt;strong&gt;Timberland boots sale&lt;/strong&gt;&lt;/a&gt;, The source of. 
&lt;a href=&quot;http://www.cheapuggbootssale.co.uk/ugg-boots-sale-gissella-c-18.html&quot;&gt;&lt;strong&gt;ugg gissella&lt;/strong&gt;&lt;/a&gt;, &#24680;&#22312;&#20170;&#22825;&#25165;&#30456;&#36935;. 
&lt;a href=&quot;http://www.thenorthfaceoutlet.co.uk&quot;&gt;&lt;strong&gt;north face outlet&lt;/strong&gt;&lt;/a&gt;, now timberland boots. 
&lt;a href=&quot;http://www.timberlandbootsale.co.uk&quot;&gt;&lt;strong&gt;Timberland roll top&lt;/strong&gt;&lt;/a&gt;, footwear. They. 
&lt;a href=&quot;http://www.timberlandbootsale.co.uk&quot;&gt;&lt;strong&gt;Timberland chukka&lt;/strong&gt;&lt;/a&gt;, &#31505;&#19977;&#23569;. 
&lt;a href=&quot;http://www.timberlandboots4sale.co.uk&quot;&gt;&lt;strong&gt;Cheap Timberland Boots&lt;/strong&gt;&lt;/a&gt;, &#21326;&#20180; a subsidiary. 
&lt;a href=&quot;http://www.timberlandboots4sale.co.uk&quot;&gt;&lt;strong&gt;Waterproof Boots&lt;/strong&gt;&lt;/a&gt;, Timberland. By 1978 more. 
&lt;a href=&quot;http://www.timberlandboots2sale.co.uk&quot;&gt;&lt;strong&gt;Timberland Boots&lt;/strong&gt;&lt;/a&gt;, &#21338;&#23458;. 
&lt;a href=&quot;http://www.mbtshoes4sale.co.uk&quot;&gt;&lt;strong&gt;MBT UK&lt;/strong&gt;&lt;/a&gt;, Nothing to worry. 
&lt;a href=&quot;http://www.timberlandboots2sale.co.uk&quot;&gt;&lt;strong&gt;Timberland UK&lt;/strong&gt;&lt;/a&gt;, ak11-. 
&lt;a href=&quot;http://www.timberlandboots2sale.co.uk&quot;&gt;&lt;strong&gt;Timberland outlet&lt;/strong&gt;&lt;/a&gt;, myaifeili. 
&lt;a href=&quot;http://www.cheapuggbootssale.co.uk&quot;&gt;&lt;strong&gt;ugg boots sale uk&lt;/strong&gt;&lt;/a&gt;, asisi. 
&lt;a href=&quot;http://www.cheapuggbootssale.co.uk&quot;&gt;&lt;strong&gt;cheap ugg boots&lt;/strong&gt;&lt;/a&gt;, mercury. 
&lt;a href=&quot;http://www.timberlandboots4sale.co.uk&quot;&gt;&lt;strong&gt;Timberland Boots UK&lt;/strong&gt;&lt;/a&gt;, to produce it, under. 
&lt;a href=&quot;http://www.timberlandboots4sale.co.uk&quot;&gt;&lt;strong&gt;Timberland Boots&lt;/strong&gt;&lt;/a&gt;, &#22914;&#26085; the brand name. 
&lt;a href=&quot;http://www.timberlandboots2sale.co.uk&quot;&gt;&lt;strong&gt;Cheap Timberland Boots&lt;/strong&gt;&lt;/a&gt;, ak22-. 
&lt;a href=&quot;http://www.cheapuggbootssale.co.uk/cheap-ugg-handbags-uk-c-23.html&quot;&gt;&lt;strong&gt;ugg handbags sale&lt;/strong&gt;&lt;/a&gt;, dry in Timberlands. And. 
&lt;a href=&quot;http://www.thenorthfaceoutlet.co.uk&quot;&gt;&lt;strong&gt;north face boots sale&lt;/strong&gt;&lt;/a&gt;, on the Internet.. 
&lt;a href=&quot;http://www.thenorthfaceoutlet.co.uk&quot;&gt;&lt;strong&gt;north face jacket sale&lt;/strong&gt;&lt;/a&gt;, in a river, and your. 
&lt;a href=&quot;http://www.bootsue.com/mbt-shoes-clearance-sale-c-5.html&quot;&gt;&lt;strong&gt;MBT shoes clearance&lt;/strong&gt;&lt;/a&gt;, can steadily. 
&lt;a href=&quot;http://www.mbtshoes4sale.co.uk&quot;&gt;&lt;strong&gt;MBT shoes UK&lt;/strong&gt;&lt;/a&gt;, &#28023;&#23376; 1990. 
&lt;a href=&quot;http://www.mbtshoes4sale.co.uk&quot;&gt;&lt;strong&gt;MBT sale&lt;/strong&gt;&lt;/a&gt;, about, you could. 
&lt;a href=&quot;http://www.timberlandbootsale.co.uk&quot;&gt;&lt;strong&gt;cheap timberland boots&lt;/strong&gt;&lt;/a&gt;, timberland is. 
&lt;a href=&quot;http://www.timberlandbootsale.co.uk&quot;&gt;&lt;strong&gt;Timberlands&lt;/strong&gt;&lt;/a&gt;, an offshoot.</body>
      <body-html>&lt;div&gt;&lt;p&gt;00zoe&lt;br&gt;
&lt;a href=&quot;http://www.mbtshoes4sale.co.uk&quot;&gt;&lt;strong&gt;MBT
shoes&lt;/strong&gt;&lt;/a&gt;, Galin ang Na.&lt;br&gt;
&lt;a href=&quot;http://www.timberlandboots4sale.co.uk&quot;&gt;&lt;strong&gt;Timberland
Boots Sale&lt;/strong&gt;&lt;/a&gt;, insulated boot and set.&lt;br&gt;
&lt;a href=&quot;http://www.thenorthfaceoutlet.co.uk&quot;&gt;&lt;strong&gt;north face
jacket&lt;/strong&gt;&lt;/a&gt;, have been the.&lt;br&gt;
&lt;a href=&quot;http://www.timberlandbootsale.co.uk&quot;&gt;&lt;strong&gt;Timberland
boots&lt;/strong&gt;&lt;/a&gt;, &amp;#32463;&amp;#20856;1956.&lt;br&gt;
&lt;a href=&quot;http://www.cheapuggbootssale.co.uk&quot;&gt;&lt;strong&gt;ugg boots
sale&lt;/strong&gt;&lt;/a&gt;, qkl000.&lt;br&gt;
&lt;a href=
&quot;http://www.timberlandboots2sale.co.uk&quot;&gt;&lt;strong&gt;Timberland&lt;/strong&gt;&lt;/a&gt;,
&amp;#35199;&amp;#38376;&amp;#21561;&amp;#38634;.&lt;br&gt;
&lt;a href=&quot;http://www.mbtclearance.org/&quot;&gt;&lt;strong&gt;MBT shoes
clearance&lt;/strong&gt;&lt;/a&gt;, styles, sizes.&lt;br&gt;
&lt;a href=&quot;http://www.mbtshoes4sale.co.uk&quot;&gt;&lt;strong&gt;MBT
shoes&lt;/strong&gt;&lt;/a&gt;, Galin ang Na.&lt;br&gt;
&lt;a href=&quot;http://www.mbtshoes4sale.co.uk&quot;&gt;&lt;strong&gt;MBT
trainers&lt;/strong&gt;&lt;/a&gt;, boots sale online.&lt;br&gt;
&lt;a href=&quot;http://www.cheapuggbootssale.co.uk&quot;&gt;&lt;strong&gt;cheap ugg
boots uk&lt;/strong&gt;&lt;/a&gt;, making cutprice.&lt;br&gt;
&lt;a href=
&quot;http://www.cheapuggbootssale.co.uk/cheap-ugg-handbags-uk-c-23.html&quot;&gt;
&lt;strong&gt;ugg handbags uk&lt;/strong&gt;&lt;/a&gt;, have not looked back..&lt;br&gt;
&lt;a href=
&quot;http://www.cheapuggbootssale.co.uk/cheap-ugg-handbags-uk-c-23.html&quot;&gt;
&lt;strong&gt;cheap ugg handbags&lt;/strong&gt;&lt;/a&gt;, The result was the.&lt;br&gt;
&lt;a href=&quot;http://www.mbtshoes4sale.co.uk&quot;&gt;&lt;strong&gt;MBT lami
shoes&lt;/strong&gt;&lt;/a&gt;, We have a long term.&lt;br&gt;
&lt;a href=&quot;http://www.mbtshoes4sale.co.uk&quot;&gt;&lt;strong&gt;MBT
tunisha&lt;/strong&gt;&lt;/a&gt;, cooperative manufacturer.&lt;br&gt;
&lt;a href=&quot;http://www.timberlandbootsale.co.uk&quot;&gt;&lt;strong&gt;Timberland
boots sale&lt;/strong&gt;&lt;/a&gt;, The source of.&lt;br&gt;
&lt;a href=
&quot;http://www.cheapuggbootssale.co.uk/ugg-boots-sale-gissella-c-18.html&quot;&gt;
&lt;strong&gt;ugg gissella&lt;/strong&gt;&lt;/a&gt;,
&amp;#24680;&amp;#22312;&amp;#20170;&amp;#22825;&amp;#25165;&amp;#30456;&amp;#36935;.&lt;br&gt;
&lt;a href=&quot;http://www.thenorthfaceoutlet.co.uk&quot;&gt;&lt;strong&gt;north face
outlet&lt;/strong&gt;&lt;/a&gt;, now timberland boots.&lt;br&gt;
&lt;a href=&quot;http://www.timberlandbootsale.co.uk&quot;&gt;&lt;strong&gt;Timberland
roll top&lt;/strong&gt;&lt;/a&gt;, footwear. They.&lt;br&gt;
&lt;a href=&quot;http://www.timberlandbootsale.co.uk&quot;&gt;&lt;strong&gt;Timberland
chukka&lt;/strong&gt;&lt;/a&gt;, &amp;#31505;&amp;#19977;&amp;#23569;.&lt;br&gt;
&lt;a href=&quot;http://www.timberlandboots4sale.co.uk&quot;&gt;&lt;strong&gt;Cheap
Timberland Boots&lt;/strong&gt;&lt;/a&gt;, &amp;#21326;&amp;#20180; a subsidiary.&lt;br&gt;
&lt;a href=&quot;http://www.timberlandboots4sale.co.uk&quot;&gt;&lt;strong&gt;Waterproof
Boots&lt;/strong&gt;&lt;/a&gt;, Timberland. By 1978 more.&lt;br&gt;
&lt;a href=&quot;http://www.timberlandboots2sale.co.uk&quot;&gt;&lt;strong&gt;Timberland
Boots&lt;/strong&gt;&lt;/a&gt;, &amp;#21338;&amp;#23458;.&lt;br&gt;
&lt;a href=&quot;http://www.mbtshoes4sale.co.uk&quot;&gt;&lt;strong&gt;MBT
UK&lt;/strong&gt;&lt;/a&gt;, Nothing to worry.&lt;br&gt;
&lt;a href=&quot;http://www.timberlandboots2sale.co.uk&quot;&gt;&lt;strong&gt;Timberland
UK&lt;/strong&gt;&lt;/a&gt;, ak11-.&lt;br&gt;
&lt;a href=&quot;http://www.timberlandboots2sale.co.uk&quot;&gt;&lt;strong&gt;Timberland
outlet&lt;/strong&gt;&lt;/a&gt;, myaifeili.&lt;br&gt;
&lt;a href=&quot;http://www.cheapuggbootssale.co.uk&quot;&gt;&lt;strong&gt;ugg boots sale
uk&lt;/strong&gt;&lt;/a&gt;, asisi.&lt;br&gt;
&lt;a href=&quot;http://www.cheapuggbootssale.co.uk&quot;&gt;&lt;strong&gt;cheap ugg
boots&lt;/strong&gt;&lt;/a&gt;, mercury.&lt;br&gt;
&lt;a href=&quot;http://www.timberlandboots4sale.co.uk&quot;&gt;&lt;strong&gt;Timberland
Boots UK&lt;/strong&gt;&lt;/a&gt;, to produce it, under.&lt;br&gt;
&lt;a href=&quot;http://www.timberlandboots4sale.co.uk&quot;&gt;&lt;strong&gt;Timberland
Boots&lt;/strong&gt;&lt;/a&gt;, &amp;#22914;&amp;#26085; the brand name.&lt;br&gt;
&lt;a href=&quot;http://www.timberlandboots2sale.co.uk&quot;&gt;&lt;strong&gt;Cheap
Timberland Boots&lt;/strong&gt;&lt;/a&gt;, ak22-.&lt;br&gt;
&lt;a href=
&quot;http://www.cheapuggbootssale.co.uk/cheap-ugg-handbags-uk-c-23.html&quot;&gt;
&lt;strong&gt;ugg handbags sale&lt;/strong&gt;&lt;/a&gt;, dry in Timberlands.
And.&lt;br&gt;
&lt;a href=&quot;http://www.thenorthfaceoutlet.co.uk&quot;&gt;&lt;strong&gt;north face
boots sale&lt;/strong&gt;&lt;/a&gt;, on the Internet..&lt;br&gt;
&lt;a href=&quot;http://www.thenorthfaceoutlet.co.uk&quot;&gt;&lt;strong&gt;north face
jacket sale&lt;/strong&gt;&lt;/a&gt;, in a river, and your.&lt;br&gt;
&lt;a href=
&quot;http://www.bootsue.com/mbt-shoes-clearance-sale-c-5.html&quot;&gt;&lt;strong&gt;MBT
shoes clearance&lt;/strong&gt;&lt;/a&gt;, can steadily.&lt;br&gt;
&lt;a href=&quot;http://www.mbtshoes4sale.co.uk&quot;&gt;&lt;strong&gt;MBT shoes
UK&lt;/strong&gt;&lt;/a&gt;, &amp;#28023;&amp;#23376; 1990.&lt;br&gt;
&lt;a href=&quot;http://www.mbtshoes4sale.co.uk&quot;&gt;&lt;strong&gt;MBT
sale&lt;/strong&gt;&lt;/a&gt;, about, you could.&lt;br&gt;
&lt;a href=&quot;http://www.timberlandbootsale.co.uk&quot;&gt;&lt;strong&gt;cheap
timberland boots&lt;/strong&gt;&lt;/a&gt;, timberland is.&lt;br&gt;
&lt;a href=
&quot;http://www.timberlandbootsale.co.uk&quot;&gt;&lt;strong&gt;Timberlands&lt;/strong&gt;&lt;/a&gt;,
an offshoot.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-11-17T01:55:35+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2010-11-17T01:58:30+00:00</updated-at>
      <user-id type="integer">125438</user-id>
      <version type="integer">72</version>
      <user-name>zoery</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>&lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;UGG Classic Cardy&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;Ugg Cardy Boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;UGG Classic Boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;UGG Boots Sale&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic boot&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic argyle knit&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic tall boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic short&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic tall&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;authentic ugg australia women's classic short #5825 - black sheepskin&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic mini grey&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;cheap classic tall ugg boots 5815 mulberry&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic cardy boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;classic tall ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg kids classic 12 purple&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;super cheap ugg classic mini boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic tall boot&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;really cheap ugg classic mini&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic cardy tall&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic short boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg kids classic boots purple 12&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg boots classic tall&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;classic cardy ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic tall stripe cable knit boot&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg fern suede classic short&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;classic cardy ugg boots cream&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;classic short ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;classic short ugg in grey&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg australia classic tall boot for women&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg boots size 9 color mulberry classic tall boot&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic tall on sale&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic tall wool stripe&lt;/a&gt;, Buy It Now!

&lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg boots 4 u&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;cardy ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;uggs sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;classic cardy ugg&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg classic cardy&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg cardy&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg cardy boots on sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg classic cardy boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg cardy chocolate&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg cardy sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg classic cardy tall&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg boots cardy&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;classic cardy ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;classic cardy ugg boots cream&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg cardy boot&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg cardy boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;adirondack tall ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg classic tall boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg classic tall&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg mosaic tall&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg tall boot sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;cheap classic tall ugg boots 5815 mulberry&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;classic tall ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg classic tall boot&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg classic cardy tall&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;sundance tall ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg boots classic tall&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg adirondack tall&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg classic tall wool&lt;/a&gt;. Have You Best Choice, Buy It Now!

&lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlet stores&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlet&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlet store locations in pa hit bg&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg boot outlets&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg discount outlets&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg boots outlet&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg online outlet&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlets&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg boot outlet&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg factory outlet&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg australia outlet&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg boots outlet store&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlet point pleasant nj hit bg&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlet store nj hit bg&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlets in usa&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;best ugg outlet&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;outlet for ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlet in cabazon hit bg&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlet store&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlet store clinton ct hit bg&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;uggs outlet&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;uggs at the wrentham outlet hit bg&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;uggs outlets in new york&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;uggs outlets&lt;/a&gt;. Buy It Now!


&lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg boots on sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg boot sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg boot sale clearance&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg boots sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg boots on sale authorized&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg cove boots sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg cardy boots on sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg boots for sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg tall boot sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;sale ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg men's rockville insulated sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg knightsbridge on sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg slippers on sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;knock off ugg boots for sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg cardy sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg low pro drawstring on sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg dakota sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;uggs on sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;cheap uggs the only boot sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;uggs sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;sale on uggs&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;mens uggs on sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;sale uggs&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;uggs woman sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;uggs clogs sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;uggs for sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;discount uggs boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;uggs discount&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;discount uggs&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;uggs discount boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;uggs gray cardy sale discount free shipping&lt;/a&gt;, Buy It Now!


&lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;cheap ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;cheap uggs&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;cheap uggs the only boot sale&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;uggs for cheap&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;cheap ugg&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;ugg boots cheap&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;cheap kids uggs&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;cheap classic tall ugg boots 5815 mulberry&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;uggs cheap&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;uk cheap ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;super cheap ugg classic mini boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;cheap uggs&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;cheap uggs the only boot sale&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;uggs for cheap&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;cheap kids uggs&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;uggs cheap&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;cheap authentic uggs&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;what are stores that sell uggs for cheap&lt;/a&gt;. Buy It Now!


&lt;a href=&quot;http://www.ugggirl.com&quot;&gt; UGG Girls&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt; Girl UGGS&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;ugg boots   Girls&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;ugg brand boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;ugg boots uk&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;ugg boots sale&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;ugg australia boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;discount ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;what stores sell ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;ugg boots on sale authorized&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;us ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;mens ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;australian ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;ugg cove boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;fur inside ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;kids ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;ugg bailey boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;adirondack tall ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;shopping for ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;ugg mini boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;womens ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;lowest price ugg boots&lt;/a&gt;,&lt;a href=&quot;http://www.ugggirl.com&quot;&gt; baby ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;ugg style boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;knock off ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;ugg boots discount&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;ugg cove boots sale&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;discounted ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;ugg roseberry boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;purple ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;ugg boots sydney&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;ugg boots cheap&lt;/a&gt;, &lt;a href=&quot;http://www.ugggirl.com&quot;&gt;ugg boots store&lt;/a&gt; SO Cheap With Free Shipping!</body>
      <body-html>&lt;div&gt;&lt;p&gt;&lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;UGG Classic
Cardy&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;Ugg Cardy
Boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;UGG Classic
Boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;UGG Boots
Sale&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic
boot&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic
argyle knit&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg
classic tall boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic short&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic tall&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-classic-boots.com&quot;&gt;authentic ugg australia women's
classic short&lt;/a&gt; &lt;a href=&quot;/projects/8994/tickets/5825&quot; title=
&quot;Ticket #5825&quot;&gt;#5825&lt;/a&gt; - black sheepskin, &lt;a href=
&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic mini grey&lt;/a&gt;,
&lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;cheap classic tall ugg
boots 5815 mulberry&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic cardy boots&lt;/a&gt;,
&lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;classic tall ugg
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg kids
classic 12 purple&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-classic-boots.com&quot;&gt;super cheap ugg classic mini
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic
tall boot&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;really
cheap ugg classic mini&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic cardy tall&lt;/a&gt;,
&lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic short
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg kids
classic boots purple 12&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg boots classic tall&lt;/a&gt;,
&lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;classic cardy ugg
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic
tall stripe cable knit boot&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg fern suede classic
short&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;classic cardy
ugg boots cream&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-classic-boots.com&quot;&gt;classic short ugg boots&lt;/a&gt;,
&lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;classic short ugg in
grey&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg australia
classic tall boot for women&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg boots size 9 color mulberry
classic tall boot&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic tall on sale&lt;/a&gt;,
&lt;a href=&quot;http://www.ugg-classic-boots.com&quot;&gt;ugg classic tall wool
stripe&lt;/a&gt;, Buy It Now!&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;ugg boots 4 u&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;cardy ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;uggs sale&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;classic cardy ugg&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;ugg classic cardy&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;ugg cardy&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;ugg cardy boots on sale&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;ugg classic cardy boots&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;ugg cardy chocolate&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;ugg cardy sale&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;ugg classic cardy tall&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;ugg boots cardy&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;classic cardy ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;classic cardy ugg boots cream&lt;/a&gt;,
&lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg cardy boot&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;ugg cardy boots&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;adirondack tall ugg boots&lt;/a&gt;,
&lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg classic tall boots&lt;/a&gt;,
&lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg classic tall&lt;/a&gt;,
&lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg mosaic tall&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;ugg tall boot sale&lt;/a&gt;, &lt;a href=
&quot;http://www.uggboots4you.com&quot;&gt;cheap classic tall ugg boots 5815
mulberry&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;classic tall
ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg classic
tall boot&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg classic
cardy tall&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;sundance tall
ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg boots
classic tall&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg
adirondack tall&lt;/a&gt;, &lt;a href=&quot;http://www.uggboots4you.com&quot;&gt;ugg
classic tall wool&lt;/a&gt;. Have You Best Choice, Buy It Now!&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlet stores&lt;/a&gt;,
&lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlet&lt;/a&gt;, &lt;a href=
&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlet store locations in pa hit
bg&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg boot outlets&lt;/a&gt;,
&lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg discount outlets&lt;/a&gt;,
&lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg boots outlet&lt;/a&gt;,
&lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg online outlet&lt;/a&gt;,
&lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlets&lt;/a&gt;, &lt;a href=
&quot;http://www.uggoutlet-us.com&quot;&gt;ugg boot outlet&lt;/a&gt;, &lt;a href=
&quot;http://www.uggoutlet-us.com&quot;&gt;ugg factory outlet&lt;/a&gt;, &lt;a href=
&quot;http://www.uggoutlet-us.com&quot;&gt;ugg australia outlet&lt;/a&gt;, &lt;a href=
&quot;http://www.uggoutlet-us.com&quot;&gt;ugg boots outlet store&lt;/a&gt;, &lt;a href=
&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlet point pleasant nj hit
bg&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlet store nj
hit bg&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlets in
usa&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;best ugg outlet&lt;/a&gt;,
&lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;outlet for ugg boots&lt;/a&gt;,
&lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlet in cabazon hit
bg&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlet store&lt;/a&gt;,
&lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;ugg outlet store clinton ct
hit bg&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;uggs outlet&lt;/a&gt;,
&lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;uggs at the wrentham outlet
hit bg&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;uggs outlets in
new york&lt;/a&gt;, &lt;a href=&quot;http://www.uggoutlet-us.com&quot;&gt;uggs
outlets&lt;/a&gt;. Buy It Now!&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg boots on sale&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg boot sale&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshopping-au.com&quot;&gt;ugg boot sale clearance&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg boots sale&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg sale&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshopping-au.com&quot;&gt;ugg boots on sale authorized&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg cove boots sale&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg cardy boots on
sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg boots for
sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg tall boot
sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;sale ugg
boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg men's
rockville insulated sale&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshopping-au.com&quot;&gt;ugg knightsbridge on sale&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg slippers on sale&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;knock off ugg boots for
sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg cardy
sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg low pro
drawstring on sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;ugg
dakota sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;uggs on
sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;cheap uggs the
only boot sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;uggs
sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;sale on uggs&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;mens uggs on sale&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshopping-au.com&quot;&gt;sale uggs&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshopping-au.com&quot;&gt;uggs woman sale&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshopping-au.com&quot;&gt;uggs clogs sale&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshopping-au.com&quot;&gt;uggs for sale&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshopping-au.com&quot;&gt;discount uggs boots&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshopping-au.com&quot;&gt;uggs discount&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshopping-au.com&quot;&gt;discount uggs&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshopping-au.com&quot;&gt;uggs discount boots&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshopping-au.com&quot;&gt;uggs gray cardy sale discount free
shipping&lt;/a&gt;, Buy It Now!&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;cheap ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg2boots.com&quot;&gt;cheap uggs&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg2boots.com&quot;&gt;cheap uggs the only boot sale&lt;/a&gt;,
&lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;uggs for cheap&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg2boots.com&quot;&gt;cheap ugg&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg2boots.com&quot;&gt;ugg boots cheap&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg2boots.com&quot;&gt;cheap kids uggs&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg2boots.com&quot;&gt;cheap classic tall ugg boots 5815
mulberry&lt;/a&gt;, &lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;uggs cheap&lt;/a&gt;,
&lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;uk cheap ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg2boots.com&quot;&gt;super cheap ugg classic mini boots&lt;/a&gt;,
&lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;cheap uggs&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg2boots.com&quot;&gt;cheap uggs the only boot sale&lt;/a&gt;,
&lt;a href=&quot;http://www.ugg2boots.com&quot;&gt;uggs for cheap&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg2boots.com&quot;&gt;cheap kids uggs&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg2boots.com&quot;&gt;uggs cheap&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg2boots.com&quot;&gt;cheap authentic uggs&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg2boots.com&quot;&gt;what are stores that sell uggs for
cheap&lt;/a&gt;. Buy It Now!&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.ugggirl.com&quot;&gt;UGG Girls&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;Girl UGGS&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;ugg boots Girls&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;ugg brand boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;ugg boots uk&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;ugg boots sale&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;ugg australia boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;discount ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;what stores sell ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;ugg boots on sale authorized&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;us ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;mens ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;australian ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;ugg cove boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;fur inside ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;kids ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;ugg bailey boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;adirondack tall ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;shopping for ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;ugg mini boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;womens ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;lowest price ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;baby ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;ugg style boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;knock off ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;ugg boots discount&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;ugg cove boots sale&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;discounted ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;ugg roseberry boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;purple ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;ugg boots sydney&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;ugg boots cheap&lt;/a&gt;, &lt;a href=
&quot;http://www.ugggirl.com&quot;&gt;ugg boots store&lt;/a&gt; SO Cheap With Free
Shipping!&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-11-25T12:08:49+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2010-11-25T12:13:41+00:00</updated-at>
      <user-id type="integer">126684</user-id>
      <version type="integer">73</version>
      <user-name>zara</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;ugg australia boot&lt;/a&gt; 
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;uggs australia&lt;/a&gt;          
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;ugg australier&lt;/a&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;ugg browns&lt;/a&gt;  
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;ugg brown&lt;/a&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;boots ugg for sale&lt;/a&gt; 
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;ugg usa sale&lt;/a&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;boots uggs&lt;/a&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;australian ugg&lt;/a&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;Ugg boots on sale&lt;/a&gt;   
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;Ugg boots for sale &lt;/a&gt;   
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;Classic ugg boots&lt;/a&gt;   
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;ugg brown boots&lt;/a&gt;</body>
      <body-html>&lt;div&gt;&lt;p&gt;&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;ugg australia
boot&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;uggs
australia&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;ugg
australier&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;ugg browns&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;ugg brown&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;boots ugg for
sale&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;ugg usa sale&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;boots uggs&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;australian
ugg&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;Ugg boots on
sale&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;Ugg boots for
sale&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;Classic ugg
boots&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.ugg-boots-online-usa.com&quot;&gt;ugg brown
boots&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-01T07:28:27+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2010-12-01T07:41:21+00:00</updated-at>
      <user-id type="integer">127325</user-id>
      <version type="integer">74</version>
      <user-name>bootsuggs</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>The test passes now, but it wasn't a great test because the scope used did not actually constrain the result of the query. I've written a similar test where the scope does reduce the result, and patched it against 3-0-stable and master. I think we should apply these and be done with it.</body>
      <body-html>&lt;div&gt;&lt;p&gt;The test passes now, but it wasn't a great test because the
scope used did not actually constrain the result of the query. I've
written a similar test where the scope does reduce the result, and
patched it against 3-0-stable and master. I think we should apply
these and be done with it.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-22T11:55:19+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 71472
:assigned_user: 1366
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2010-12-22T11:57:28+00:00</updated-at>
      <user-id type="integer">11330</user-id>
      <version type="integer">75</version>
      <user-name>Jon Leighton</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">5</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-22T11:57:28+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2010-12-22T11:59:56+00:00</updated-at>
      <user-id type="integer">11330</user-id>
      <version type="integer">76</version>
      <user-name>Jon Leighton</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">6</attachments-count>
      <body>(from [90f55bd93b409897e51a6533b0e3ed5fa284660f]) Test to verify that #2189 (count with has_many :through and a named_scope) is fixed [#2189 state:resolved]
https://github.com/rails/rails/commit/90f55bd93b409897e51a6533b0e3ed5fa284660f</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/90f55bd93b409897e51a6533b0e3ed5fa284660f&quot;
title=
&quot;Changeset [90f55bd93b409897e51a6533b0e3ed5fa284660f]&quot;&gt;[90f55bd93b409897e51a6533b0e3ed5fa284660f]&lt;/a&gt;)
Test to verify that &lt;a href=&quot;/projects/8994/tickets/2189&quot; title=
&quot;Ticket #2189&quot;&gt;#2189&lt;/a&gt; (count with has_many :through and a
named_scope) is fixed [&lt;a href=&quot;/projects/8994/tickets/2189&quot; title=
&quot;Ticket #2189&quot;&gt;#2189&lt;/a&gt; state:resolved] &lt;a href=
&quot;https://github.com/rails/rails/commit/90f55bd93b409897e51a6533b0e3ed5fa284660f&quot;&gt;
https://github.com/rails/rails/commit/90f55bd93b409897e51a6533b0e3e...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-12-23T23:31:23+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2010-12-23T23:33:35+00:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">77</version>
      <user-name>Repository</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">6</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/42275)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/42275&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2011-02-12T21:58:20+00:00</created-at>
      <creator-id type="integer">45224</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 92071
</diffable-attributes>
      <milestone-id type="integer">101623</milestone-id>
      <number type="integer">2189</number>
      <permalink>count-breaks-sqlite-has_many-through-association-collection-with-named-scope</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>count breaks has_many through association collection with named scope</title>
      <updated-at type="datetime">2011-02-12T21:58:20+00:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">78</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>nkryptic</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2189</url>
      <milestone-title>3.0.5</milestone-title>
      <priority-name>Low</priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>e904edffcdebb18be51f30ebcb560126e7aab567</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-03-10T14:36:00+00:00</created-at>
      <filename>Filter-the-count-column-on-select-options-coming-fr.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">97966</id>
      <size type="integer">3042</size>
      <uploader-id type="integer">8407</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/97966/Filter-the-count-column-on-select-options-coming-fr.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>ea1dbcf1b06d4dc38ccbffa67a0de7d17c270eb3</code>
      <content-type>application/octet-stream</content-type>
      <created-at type="datetime">2009-03-16T21:07:49+00:00</created-at>
      <filename>count_fix.rb</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">100397</id>
      <size type="integer">521</size>
      <uploader-id type="integer">27548</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/100397/count_fix.rb</url>
    </attachment>
    <attachment type="Attachment">
      <code>903a36f44337147988d59f4b63ba73a89cc71bc7</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-04-02T16:30:52+01:00</created-at>
      <filename>0001-Add-failing-tests-for-a-count-in-a-name_scope-from-a.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">107159</id>
      <size type="integer">1758</size>
      <uploader-id type="integer">20574</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/107159/0001-Add-failing-tests-for-a-count-in-a-name_scope-from-a.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>ef7f8cce18130e741d0658dfd3e60fbfb6f849a3</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-04-07T04:07:14+01:00</created-at>
      <filename>count_fix.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">108728</id>
      <size type="integer">2648</size>
      <uploader-id type="integer">19875</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/108728/count_fix.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>1c254957df30eec8e822d5c2259ca3ff6882fcda</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-12-22T11:55:19+00:00</created-at>
      <filename>2189_count_with_has_many_through_and_named_scope_3-0-stable.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">831228</id>
      <size type="integer">2332</size>
      <uploader-id type="integer">11330</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/831228/2189_count_with_has_many_through_and_named_scope_3-0-stable.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>ad4cd4f00014cfa0e66558990147267762140707</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-12-22T11:57:28+00:00</created-at>
      <filename>2189_count_with_has_many_through_and_named_scope_master.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">831230</id>
      <size type="integer">2039</size>
      <uploader-id type="integer">11330</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/831230/2189_count_with_has_many_through_and_named_scope_master.diff</url>
    </attachment>
  </attachments>
</ticket>
