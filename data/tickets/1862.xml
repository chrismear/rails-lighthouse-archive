<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">4</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-02-03T23:01:25+00:00</created-at>
  <creator-id type="integer">42690</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">71472</milestone-id>
  <number type="integer">1862</number>
  <permalink>running-autolink-on-text-containing-a-mailto-link-breaks</permalink>
  <priority type="integer">1138</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>actionview auto_link patch</tag>
  <title>Running autolink on text containing a mailto: link breaks</title>
  <updated-at type="datetime">2010-05-29T03:06:52+01:00</updated-at>
  <user-id type="integer">17393</user-id>
  <version type="integer">12</version>
  <user-name>Repository</user-name>
  <creator-name>marek</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/1862</url>
  <milestone-title>3.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>ActionView::Helpers::TextHelper#autolink does not handle certain mailto: links properly.

Assume the following html:
@@@
&lt;a href=&quot;mailto:david@loudthinking.com&quot;&gt;Mail me&lt;/a&gt;
@@@

When running this html through autolink, it should not alter the html. However it is transformed to:
@@@
&lt;a href=&quot;mailto:&lt;a href=&quot;david@loudthinking.com&quot;&gt;david@loudthinking.com&lt;/a&gt;&quot;&gt;Mail me&lt;/a&gt;
@@@

I wrote a test to reproduce this bug and added a fix as well. See:
http://github.com/mdh/rails/commit/a4b672c5348e7782da877fd6cbf2a012caba6087</original-body>
  <latest-body>ActionView::Helpers::TextHelper#autolink does not handle certain mailto: links properly.

Assume the following html:
@@@
&lt;a href=&quot;mailto:david@loudthinking.com&quot;&gt;Mail me&lt;/a&gt;
@@@

When running this html through autolink, it should not alter the html. However it is transformed to:
@@@
&lt;a href=&quot;mailto:&lt;a href=&quot;david@loudthinking.com&quot;&gt;david@loudthinking.com&lt;/a&gt;&quot;&gt;Mail me&lt;/a&gt;
@@@

I wrote a test to reproduce this bug and added a fix as well. See:
http://github.com/mdh/rails/commit/a4b672c5348e7782da877fd6cbf2a012caba6087</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;ActionView::Helpers::TextHelper#autolink does not handle certain
mailto: links properly.&lt;/p&gt;
&lt;p&gt;Assume the following html:&lt;/p&gt;


&lt;pre&gt;&lt;code&gt;
&amp;lt;a href=&amp;quot;mailto:david@loudthinking.com&amp;quot;&amp;gt;Mail me&amp;lt;/a&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;When running this html through autolink, it should not alter the
html. However it is transformed to:&lt;/p&gt;


&lt;pre&gt;&lt;code&gt;
&amp;lt;a href=&amp;quot;mailto:&amp;lt;a href=&amp;quot;david@loudthinking.com&amp;quot;&amp;gt;david@loudthinking.com&amp;lt;/a&amp;gt;&amp;quot;&amp;gt;Mail me&amp;lt;/a&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I wrote a test to reproduce this bug and added a fix as well.
See: &lt;a href=&quot;http://github.com/mdh/rails/commit/a4b672c5348e7782da877fd6cbf2a012caba6087&quot;&gt;
http://github.com/mdh/rails/comm...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>ActionView::Helpers::TextHelper#autolink does not handle certain mailto: links properly.

Assume the following html:
@@@
&lt;a href=&quot;mailto:david@loudthinking.com&quot;&gt;Mail me&lt;/a&gt;
@@@

When running this html through autolink, it should not alter the html. However it is transformed to:
@@@
&lt;a href=&quot;mailto:&lt;a href=&quot;david@loudthinking.com&quot;&gt;david@loudthinking.com&lt;/a&gt;&quot;&gt;Mail me&lt;/a&gt;
@@@

I wrote a test to reproduce this bug and added a fix as well. See:
http://github.com/mdh/rails/commit/a4b672c5348e7782da877fd6cbf2a012caba6087</body>
      <body-html>&lt;div&gt;&lt;p&gt;ActionView::Helpers::TextHelper#autolink does not handle certain
mailto: links properly.&lt;/p&gt;
&lt;p&gt;Assume the following html:&lt;/p&gt;


&lt;pre&gt;&lt;code&gt;
&amp;lt;a href=&amp;quot;mailto:david@loudthinking.com&amp;quot;&amp;gt;Mail me&amp;lt;/a&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;When running this html through autolink, it should not alter the
html. However it is transformed to:&lt;/p&gt;


&lt;pre&gt;&lt;code&gt;
&amp;lt;a href=&amp;quot;mailto:&amp;lt;a href=&amp;quot;david@loudthinking.com&amp;quot;&amp;gt;david@loudthinking.com&amp;lt;/a&amp;gt;&amp;quot;&amp;gt;Mail me&amp;lt;/a&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I wrote a test to reproduce this bug and added a fix as well.
See: &lt;a href=&quot;http://github.com/mdh/rails/commit/a4b672c5348e7782da877fd6cbf2a012caba6087&quot;&gt;
http://github.com/mdh/rails/comm...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-03T23:01:25+00:00</created-at>
      <creator-id type="integer">42690</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1862</number>
      <permalink>running-autolink-on-text-containing-a-mailto-link-breaks</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionview auto_link bug edge &quot;ruby 1.8.7&quot; text_helper</tag>
      <title>Running autolink on text containing a mailto: link breaks</title>
      <updated-at type="datetime">2009-02-03T23:01:28+00:00</updated-at>
      <user-id type="integer">42690</user-id>
      <version type="integer">1</version>
      <user-name>marek</user-name>
      <creator-name>marek</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1862</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>+1</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-04T03:12:39+00:00</created-at>
      <creator-id type="integer">42690</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: actionview auto_link bug edge &quot;ruby 1.8.7&quot; text_helper
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1862</number>
      <permalink>running-autolink-on-text-containing-a-mailto-link-breaks</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionview auto_link bug edge patch &quot;ruby 1.8.7&quot; text_helper</tag>
      <title>Running autolink on text containing a mailto: link breaks</title>
      <updated-at type="datetime">2009-02-04T03:12:41+00:00</updated-at>
      <user-id type="integer">21653</user-id>
      <version type="integer">2</version>
      <user-name>Amos King</user-name>
      <creator-name>marek</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1862</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>That patch isn't a patch ;)

But more fundamentally,  does the other auto_link functionality support already linked text?  I didn't see it looking at the tests but perhaps I'm missing it.

If it does, then let's pull that kind of test into a new test case for both emails and urls.</body>
      <body-html>&lt;div&gt;&lt;p&gt;That patch isn't a patch ;)&lt;/p&gt;
&lt;p&gt;But more fundamentally, does the other auto_link functionality
support already linked text? I didn't see it looking at the tests
but perhaps I'm missing it.&lt;/p&gt;
&lt;p&gt;If it does, then let's pull that kind of test into a new test
case for both emails and urls.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-06T00:59:31+00:00</created-at>
      <creator-id type="integer">42690</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1862</number>
      <permalink>running-autolink-on-text-containing-a-mailto-link-breaks</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionview auto_link bug edge patch &quot;ruby 1.8.7&quot; text_helper</tag>
      <title>Running autolink on text containing a mailto: link breaks</title>
      <updated-at type="datetime">2009-02-06T00:59:33+00:00</updated-at>
      <user-id type="integer">141</user-id>
      <version type="integer">3</version>
      <user-name>Michael Koziarski</user-name>
      <creator-name>marek</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1862</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Oops,

Please excuse me for screwing up.
I added a proper diff file this time.

I guess this feature is not often used.

But yes, there is such a test in text_helper_test.rb.
It's called test_auto_link_already_linked. 
I've expanded that test so it covers this issue too, please see patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Oops,&lt;/p&gt;
&lt;p&gt;Please excuse me for screwing up. I added a proper diff file
this time.&lt;/p&gt;
&lt;p&gt;I guess this feature is not often used.&lt;/p&gt;
&lt;p&gt;But yes, there is such a test in text_helper_test.rb. It's
called test_auto_link_already_linked. I've expanded that test so it
covers this issue too, please see patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-06T09:06:38+00:00</created-at>
      <creator-id type="integer">42690</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1862</number>
      <permalink>running-autolink-on-text-containing-a-mailto-link-breaks</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionview auto_link bug edge patch &quot;ruby 1.8.7&quot; text_helper</tag>
      <title>Running autolink on text containing a mailto: link breaks</title>
      <updated-at type="datetime">2009-02-06T09:06:39+00:00</updated-at>
      <user-id type="integer">42690</user-id>
      <version type="integer">4</version>
      <user-name>marek</user-name>
      <creator-name>marek</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1862</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Very much related to this issue:

If the html contains an img tag it gets screwed up too. I fixed that as well. See second patch file.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Very much related to this issue:&lt;/p&gt;
&lt;p&gt;If the html contains an img tag it gets screwed up too. I fixed
that as well. See second patch file.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-18T09:17:21+00:00</created-at>
      <creator-id type="integer">42690</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1862</number>
      <permalink>running-autolink-on-text-containing-a-mailto-link-breaks</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionview auto_link bug edge patch &quot;ruby 1.8.7&quot; text_helper</tag>
      <title>Running autolink on text containing a mailto: link breaks</title>
      <updated-at type="datetime">2009-02-18T09:17:23+00:00</updated-at>
      <user-id type="integer">42690</user-id>
      <version type="integer">5</version>
      <user-name>marek</user-name>
      <creator-name>marek</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1862</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>The second issue (IMG tag) was resolved in #1523.

I'm attaching a patch that takes the same approach as that ticket for the first issue you reported. It's very similar to your patch, only it handles all cases of email strings found inside HTML attributes.</body>
      <body-html>&lt;div&gt;&lt;p&gt;The second issue (IMG tag) was resolved in &lt;a href=&quot;/projects/8994/tickets/1523&quot; title=&quot;Ticket #1523&quot;&gt;#1523&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I'm attaching a patch that takes the same approach as that
ticket for the first issue you reported. It's very similar to your
patch, only it handles all cases of email strings found inside HTML
attributes.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-11T10:46:55+00:00</created-at>
      <creator-id type="integer">42690</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1862</number>
      <permalink>running-autolink-on-text-containing-a-mailto-link-breaks</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionview auto_link bug edge patch &quot;ruby 1.8.7&quot; text_helper</tag>
      <title>Running autolink on text containing a mailto: link breaks</title>
      <updated-at type="datetime">2009-03-11T10:58:30+00:00</updated-at>
      <user-id type="integer">192</user-id>
      <version type="integer">6</version>
      <user-name>Mislav</user-name>
      <creator-name>marek</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1862</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Thanks for taking the time to look at my patch.
I was not aware of #1523.
Using the same approach makes sense.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Thanks for taking the time to look at my patch. I was not aware
of &lt;a href=&quot;/projects/8994/tickets/1523&quot; title=&quot;Ticket #1523&quot;&gt;#1523&lt;/a&gt;. Using the same approach makes sense.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-03-11T11:09:34+00:00</created-at>
      <creator-id type="integer">42690</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1862</number>
      <permalink>running-autolink-on-text-containing-a-mailto-link-breaks</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionview auto_link bug edge patch &quot;ruby 1.8.7&quot; text_helper</tag>
      <title>Running autolink on text containing a mailto: link breaks</title>
      <updated-at type="datetime">2009-03-11T11:23:43+00:00</updated-at>
      <user-id type="integer">42690</user-id>
      <version type="integer">7</version>
      <user-name>marek</user-name>
      <creator-name>marek</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1862</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>I've pushes two patches which resolve all auto_link issues in this tracker. [Changes are in the &quot;auto_link&quot; branch](http://github.com/mislav/rails/compare/auto_link) of my fork</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've pushes two patches which resolve all auto_link issues in
this tracker. &lt;a href=
&quot;http://github.com/mislav/rails/compare/auto_link&quot;&gt;Changes are in
the &quot;auto_link&quot; branch&lt;/a&gt; of my fork&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-17T05:37:13+01:00</created-at>
      <creator-id type="integer">42690</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: actionview auto_link bug edge patch &quot;ruby 1.8.7&quot; text_helper
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1862</number>
      <permalink>running-autolink-on-text-containing-a-mailto-link-breaks</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionview auto_link patch</tag>
      <title>Running autolink on text containing a mailto: link breaks</title>
      <updated-at type="datetime">2010-04-17T05:37:16+01:00</updated-at>
      <user-id type="integer">192</user-id>
      <version type="integer">8</version>
      <user-name>Mislav</user-name>
      <creator-name>marek</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1862</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>I've just pushed 2-3-stable compatible version. The branch name is **&quot;auto_link_2-3-stable&quot;**</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've just pushed 2-3-stable compatible version. The branch name
is &lt;strong&gt;&quot;auto_link_2-3-stable&quot;&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-17T05:53:44+01:00</created-at>
      <creator-id type="integer">42690</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1862</number>
      <permalink>running-autolink-on-text-containing-a-mailto-link-breaks</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionview auto_link patch</tag>
      <title>Running autolink on text containing a mailto: link breaks</title>
      <updated-at type="datetime">2010-04-17T05:53:48+01:00</updated-at>
      <user-id type="integer">192</user-id>
      <version type="integer">9</version>
      <user-name>Mislav</user-name>
      <creator-name>marek</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1862</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/19097)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/19097&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-04T18:48:39+01:00</created-at>
      <creator-id type="integer">42690</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 9903
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">1862</number>
      <permalink>running-autolink-on-text-containing-a-mailto-link-breaks</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionview auto_link patch</tag>
      <title>Running autolink on text containing a mailto: link breaks</title>
      <updated-at type="datetime">2010-05-04T18:48:39+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">10</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>marek</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1862</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>(from [17b4fd25e4de8f05d40ccaa776e51636745aa8e8]) avoid auto_linking already linked emails; more robust detection of linked URLs

References #1523  [#1862 state:resolved]  [#3591 state:resolved]

Add test that shows how link text can contain HTML if needed:
the trick is using block form in combination with `raw`.
Let link text be automatically HTML-escaped

[#2017 state:resolved]
http://github.com/rails/rails/commit/17b4fd25e4de8f05d40ccaa776e51636745aa8e8</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/17b4fd25e4de8f05d40ccaa776e51636745aa8e8&quot;
title=
&quot;Changeset [17b4fd25e4de8f05d40ccaa776e51636745aa8e8]&quot;&gt;[17b4fd25e4de8f05d40ccaa776e51636745aa8e8]&lt;/a&gt;)
avoid auto_linking already linked emails; more robust detection of
linked URLs&lt;/p&gt;
&lt;p&gt;References &lt;a href=&quot;/projects/8994/tickets/1523&quot; title=
&quot;Ticket #1523&quot;&gt;#1523&lt;/a&gt; [&lt;a href=&quot;/projects/8994/tickets/1862&quot;
title=&quot;Ticket #1862&quot;&gt;#1862&lt;/a&gt; state:resolved] [&lt;a href=
&quot;/projects/8994/tickets/3591&quot; title=&quot;Ticket #3591&quot;&gt;#3591&lt;/a&gt;
state:resolved]&lt;/p&gt;
&lt;p&gt;Add test that shows how link text can contain HTML if
needed:&lt;br&gt;
the trick is using block form in combination with
&lt;code&gt;raw&lt;/code&gt;.&lt;br&gt;
Let link text be automatically HTML-escaped&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;/projects/8994/tickets/2017&quot; title=
&quot;Ticket #2017&quot;&gt;#2017&lt;/a&gt; state:resolved] &lt;a href=
&quot;http://github.com/rails/rails/commit/17b4fd25e4de8f05d40ccaa776e51636745aa8e8&quot;&gt;
http://github.com/rails/rails/commit/17b4fd25e4de8f05d40ccaa776e516...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-05-29T03:06:24+01:00</created-at>
      <creator-id type="integer">42690</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">1862</number>
      <permalink>running-autolink-on-text-containing-a-mailto-link-breaks</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>actionview auto_link patch</tag>
      <title>Running autolink on text containing a mailto: link breaks</title>
      <updated-at type="datetime">2010-05-29T03:06:32+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">11</version>
      <user-name>Repository</user-name>
      <creator-name>marek</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1862</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>(from [8f0b2138ee979799092e0489f7298289c90901b9]) avoid auto_linking already linked emails; more robust detection of linked URLs

References #1523  [#1862 state:resolved]  [#3591 state:resolved]

Add test that shows how link text can contain HTML if needed:
the trick is using block form in combination with `raw`.
Let link text be automatically HTML-escaped

[#2017 state:resolved]
http://github.com/rails/rails/commit/8f0b2138ee979799092e0489f7298289c90901b9</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/8f0b2138ee979799092e0489f7298289c90901b9&quot;
title=
&quot;Changeset [8f0b2138ee979799092e0489f7298289c90901b9]&quot;&gt;[8f0b2138ee979799092e0489f7298289c90901b9]&lt;/a&gt;)
avoid auto_linking already linked emails; more robust detection of
linked URLs&lt;/p&gt;
&lt;p&gt;References &lt;a href=&quot;/projects/8994/tickets/1523&quot; title=
&quot;Ticket #1523&quot;&gt;#1523&lt;/a&gt; [&lt;a href=&quot;/projects/8994/tickets/1862&quot;
title=&quot;Ticket #1862&quot;&gt;#1862&lt;/a&gt; state:resolved] [&lt;a href=
&quot;/projects/8994/tickets/3591&quot; title=&quot;Ticket #3591&quot;&gt;#3591&lt;/a&gt;
state:resolved]&lt;/p&gt;
&lt;p&gt;Add test that shows how link text can contain HTML if
needed:&lt;br&gt;
the trick is using block form in combination with
&lt;code&gt;raw&lt;/code&gt;.&lt;br&gt;
Let link text be automatically HTML-escaped&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;/projects/8994/tickets/2017&quot; title=
&quot;Ticket #2017&quot;&gt;#2017&lt;/a&gt; state:resolved] &lt;a href=
&quot;http://github.com/rails/rails/commit/8f0b2138ee979799092e0489f7298289c90901b9&quot;&gt;
http://github.com/rails/rails/commit/8f0b2138ee979799092e0489f72982...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-05-29T03:06:49+01:00</created-at>
      <creator-id type="integer">42690</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">1862</number>
      <permalink>running-autolink-on-text-containing-a-mailto-link-breaks</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>actionview auto_link patch</tag>
      <title>Running autolink on text containing a mailto: link breaks</title>
      <updated-at type="datetime">2010-05-29T03:06:52+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">12</version>
      <user-name>Repository</user-name>
      <creator-name>marek</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1862</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>1fbd626271e41aedc066e8a6e231565a93e71b8b</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-02-03T23:07:26+00:00</created-at>
      <filename>patch-file.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">84707</id>
      <size type="integer">48</size>
      <uploader-id type="integer">42690</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/84707/patch-file.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>befac0a9b3e9ab20f6d23742d2a15568eea9e0e5</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-02-06T09:06:38+00:00</created-at>
      <filename>patch_file.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">85871</id>
      <size type="integer">1515</size>
      <uploader-id type="integer">42690</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/85871/patch_file.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>c1473ced5d4075dbcac0139bf91f9913fc1a0414</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-02-18T09:17:21+00:00</created-at>
      <filename>img_tag_patch.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">90024</id>
      <size type="integer">1209</size>
      <uploader-id type="integer">42690</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/90024/img_tag_patch.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>fbf9c3f5d81135952b9d675a581136540381c5c6</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-03-11T10:46:55+00:00</created-at>
      <filename>auto-link-email.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">98441</id>
      <size type="integer">2101</size>
      <uploader-id type="integer">192</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/98441/auto-link-email.patch</url>
    </attachment>
  </attachments>
</ticket>
