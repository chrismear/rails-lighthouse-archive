<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">19965</assigned-user-id>
  <attachments-count type="integer">2</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2010-07-28T16:48:40+01:00</created-at>
  <creator-id type="integer">33887</creator-id>
  <milestone-due-on type="datetime">2010-11-15T00:00:00+00:00</milestone-due-on>
  <milestone-id type="integer">88038</milestone-id>
  <number type="integer">5231</number>
  <permalink>print-stack-traces-with-deprecation-warnings</permalink>
  <priority type="integer">1</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>backtrace deprecation warnings</tag>
  <title>print stack traces with deprecation warnings</title>
  <updated-at type="datetime">2010-10-15T23:01:59+01:00</updated-at>
  <user-id type="integer">85</user-id>
  <version type="integer">23</version>
  <user-name>Jeremy Kemper</user-name>
  <creator-name>Jakub Suder</creator-name>
  <assigned-user-name>Jos&#233; Valim</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
  <milestone-title>3.0.2</milestone-title>
  <priority-name>High</priority-name>
  <original-body>Right now, the deprecation warnings from ActiveSupport look like this:

DEPRECATION WARNING: Calling a method in Rails::Application is deprecated, please call it directly in your application constant Foo::Application. (called from method_missing at .../railties-3.0.0.rc/lib/rails/application.rb:77)

This tells me nothing about where exactly is the code that causes the warning, if it's in one of the gems, in Rails, or somewhere in my code... Some kind of partial stack trace would be helpful here.</original-body>
  <latest-body>Right now, the deprecation warnings from ActiveSupport look like this:

DEPRECATION WARNING: Calling a method in Rails::Application is deprecated, please call it directly in your application constant Foo::Application. (called from method_missing at .../railties-3.0.0.rc/lib/rails/application.rb:77)

This tells me nothing about where exactly is the code that causes the warning, if it's in one of the gems, in Rails, or somewhere in my code... Some kind of partial stack trace would be helpful here.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;Right now, the deprecation warnings from ActiveSupport look like
this:&lt;/p&gt;
&lt;p&gt;DEPRECATION WARNING: Calling a method in Rails::Application is
deprecated, please call it directly in your application constant
Foo::Application. (called from method_missing at
.../railties-3.0.0.rc/lib/rails/application.rb:77)&lt;/p&gt;
&lt;p&gt;This tells me nothing about where exactly is the code that
causes the warning, if it's in one of the gems, in Rails, or
somewhere in my code... Some kind of partial stack trace would be
helpful here.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Right now, the deprecation warnings from ActiveSupport look like this:

DEPRECATION WARNING: Calling a method in Rails::Application is deprecated, please call it directly in your application constant Foo::Application. (called from method_missing at .../railties-3.0.0.rc/lib/rails/application.rb:77)

This tells me nothing about where exactly is the code that causes the warning, if it's in one of the gems, in Rails, or somewhere in my code... Some kind of partial stack trace would be helpful here.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Right now, the deprecation warnings from ActiveSupport look like
this:&lt;/p&gt;
&lt;p&gt;DEPRECATION WARNING: Calling a method in Rails::Application is
deprecated, please call it directly in your application constant
Foo::Application. (called from method_missing at
.../railties-3.0.0.rc/lib/rails/application.rb:77)&lt;/p&gt;
&lt;p&gt;This tells me nothing about where exactly is the code that
causes the warning, if it's in one of the gems, in Rails, or
somewhere in my code... Some kind of partial stack trace would be
helpful here.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-28T16:48:40+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-07-28T16:48:43+01:00</updated-at>
      <user-id type="integer">33887</user-id>
      <version type="integer">1</version>
      <user-name>Jakub Suder</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>+1

I think caller should be invoked and the output of that should be printed. Let's see what Santiago has to say.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;
&lt;p&gt;I think caller should be invoked and the output of that should
be printed. Let's see what Santiago has to say.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-28T18:21:15+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
:state: new
:milestone: 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-07-28T18:21:17+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">2</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>my bad. In this case it is saying that it was called from method_missing. 

So what's the issue?</body>
      <body-html>&lt;div&gt;&lt;p&gt;my bad. In this case it is saying that it was called from
method_missing.&lt;/p&gt;
&lt;p&gt;So what's the issue?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-28T18:22:15+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-07-28T18:22:18+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">3</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>The issue is that I'm not interested in Rails internal code that actually outputs the deprecation warning (which is the last few lines of the backtrace), I'm interested in the code that caused the warning in the first place. In this case, the culprit was a line in my Rakefile (Rails::Application.load_tasks instead of Foo::Application.load_tasks), but the warning didn't tell me that, I had to manually add some temporary code to ActiveSupport that printed the whole backtrace (the line in Rakefile was about 10 lines deeper into the backtrace).</body>
      <body-html>&lt;div&gt;&lt;p&gt;The issue is that I'm not interested in Rails internal code that
actually outputs the deprecation warning (which is the last few
lines of the backtrace), I'm interested in the code that caused the
warning in the first place. In this case, the culprit was a line in
my Rakefile (Rails::Application.load_tasks instead of
Foo::Application.load_tasks), but the warning didn't tell me that,
I had to manually add some temporary code to ActiveSupport that
printed the whole backtrace (the line in Rakefile was about 10
lines deeper into the backtrace).&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-28T18:32:58+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-07-28T18:33:02+01:00</updated-at>
      <user-id type="integer">33887</user-id>
      <version type="integer">4</version>
      <user-name>Jakub Suder</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Point taken. However having the full backtrace all the time might be annoying.

Personally I would like to have an option like 

@@@ ruby
config.print_full_stacktrace_from_deprecation_warnings = true
@@@

In this way when I am in the mood to resolve all the warnings, I would turn that option ON and will get full stacktrace. Otherwise one line deprecation warning will be printed.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Point taken. However having the full backtrace all the time
might be annoying.&lt;/p&gt;
&lt;p&gt;Personally I would like to have an option like&lt;/p&gt;
&lt;pre&gt;
&lt;code class=
&quot;ruby&quot;&gt;config.print_full_stacktrace_from_deprecation_warnings = true&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;In this way when I am in the mood to resolve all the warnings, I
would turn that option ON and will get full stacktrace. Otherwise
one line deprecation warning will be printed.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-28T18:41:40+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-07-28T18:41:41+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">5</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Sounds good. You're right that if you're not trying to solve the problem at this specific moment, it would get annoying very fast.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Sounds good. You're right that if you're not trying to solve the
problem at this specific moment, it would get annoying very
fast.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-28T18:42:56+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-07-28T18:42:58+01:00</updated-at>
      <user-id type="integer">33887</user-id>
      <version type="integer">6</version>
      <user-name>Jakub Suder</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I'm uploading a patch that fixes this issue. Instead of adding an option to show full stack traces, I've changed the code to always show the first line in the stack that's outside Rails gem directory (which should almost always be the culprit that caused the warning).

Examples - lines returned in the warning message:

1) If I use an old form of Rails::Application.routes.draw with |map|:

Before the patch:

    initialize at /Users/psionides/Downloads/rails/actionpack/lib/action_dispatch/routing/deprecated_mapper.rb:34

Which just tells me I'm using a deprecated method related to routing, but doesn't tell me which one and where. After the patch:

    &lt;top (required)&gt; at /Users/psionides/Downloads/railstest/railstest/config/routes.rb:1

Which tells me exactly where the error is.

2) If I call Rails::Application.load_tasks in the Rakefile:

Before the patch:

    method_missing at /Users/psionides/Downloads/rails/railties/lib/rails/application.rb:77

After the patch:

    &lt;top (required)&gt; at /Users/psionides/Downloads/railstest/railstest/Rakefile:7

Please review and apply the patch when you find some time.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I'm uploading a patch that fixes this issue. Instead of adding
an option to show full stack traces, I've changed the code to
always show the first line in the stack that's outside Rails gem
directory (which should almost always be the culprit that caused
the warning).&lt;/p&gt;
&lt;p&gt;Examples - lines returned in the warning message:&lt;/p&gt;
&lt;p&gt;1) If I use an old form of Rails::Application.routes.draw with
|map|:&lt;/p&gt;
&lt;p&gt;Before the patch:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;initialize at /Users/psionides/Downloads/rails/actionpack/lib/action_dispatch/routing/deprecated_mapper.rb:34&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Which just tells me I'm using a deprecated method related to
routing, but doesn't tell me which one and where. After the
patch:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;&amp;lt;top (required)&amp;gt; at /Users/psionides/Downloads/railstest/railstest/config/routes.rb:1&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Which tells me exactly where the error is.&lt;/p&gt;
&lt;p&gt;2) If I call Rails::Application.load_tasks in the Rakefile:&lt;/p&gt;
&lt;p&gt;Before the patch:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;method_missing at /Users/psionides/Downloads/rails/railties/lib/rails/application.rb:77&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;After the patch:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;&amp;lt;top (required)&amp;gt; at /Users/psionides/Downloads/railstest/railstest/Rakefile:7&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Please review and apply the patch when you find some time.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-20T19:25:26+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-08-20T19:25:29+01:00</updated-at>
      <user-id type="integer">33887</user-id>
      <version type="integer">7</version>
      <user-name>Jakub Suder</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Nice work. And indeed very useful.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Nice work. And indeed very useful.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-20T19:52:07+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-08-20T19:52:08+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">8</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Is there any chance someone can apply this patch before 3.0 final? I guess it's going to be most useful once 3.0 is released, because there's going to be lots of deprecations from 2.x, and the number of things deprecated in 3.1/3.2 will probably be smaller...</body>
      <body-html>&lt;div&gt;&lt;p&gt;Is there any chance someone can apply this patch before 3.0
final? I guess it's going to be most useful once 3.0 is released,
because there's going to be lots of deprecations from 2.x, and the
number of things deprecated in 3.1/3.2 will probably be
smaller...&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-23T11:10:30+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-08-23T11:10:33+01:00</updated-at>
      <user-id type="integer">33887</user-id>
      <version type="integer">9</version>
      <user-name>Jakub Suder</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Mate, I would love to pull it in! Just one thing, couldn't you try to use Rails.backtrace_cleaner instead?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Mate, I would love to pull it in! Just one thing, couldn't you
try to use Rails.backtrace_cleaner instead?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-24T21:11:23+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 3
:milestone: 71472
:assigned_user: 40272
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-08-24T21:11:26+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">10</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Hmm... it looks like I could just replace:

    rails_gem_root = File.expand_path(&quot;../../../../..&quot;, __FILE__) + &quot;/&quot;
    first_external = callstack.find { |line| !line.start_with?(rails_gem_root) }

with:

    first_external = Rails.backtrace_cleaner.clean(callstack).first

However, I'm not sure if I can assume that Rails and Rails.backtrace_cleaner are available - after all, you can use ActiveSupport without using Rails, right?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Hmm... it looks like I could just replace:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;rails_gem_root = File.expand_path(&quot;../../../../..&quot;, __FILE__) + &quot;/&quot;
first_external = callstack.find { |line| !line.start_with?(rails_gem_root) }&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;with:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;first_external = Rails.backtrace_cleaner.clean(callstack).first&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;However, I'm not sure if I can assume that Rails and
Rails.backtrace_cleaner are available - after all, you can use
ActiveSupport without using Rails, right?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-24T21:36:14+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-08-24T21:36:17+01:00</updated-at>
      <user-id type="integer">33887</user-id>
      <version type="integer">11</version>
      <user-name>Jakub Suder</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Right! Here is an example of using backtrace cleaner, checking properly if it is defined or not:

http://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/show_exceptions.rb#L148</body>
      <body-html>&lt;div&gt;&lt;p&gt;Right! Here is an example of using backtrace cleaner, checking
properly if it is defined or not:&lt;/p&gt;
&lt;p&gt;&lt;a href=
&quot;http://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/show_exceptions.rb#L148&quot;&gt;
http://github.com/rails/rails/blob/master/actionpack/lib/action_dis...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-24T21:40:41+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-08-24T21:40:47+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">12</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Honestly, I don't think this makes much sense in this case... The code in ActionDispatch uses the cleaner (if available) to remove some useless lines from the trace to make it more readable, and if it's not available, leaves it as it is, so it makes a difference for the user. Here we only want that one specific line, so adding the cleaner would just mean less code, but adding a cleaner with an if/else would actually mean more code and no advantages (other than removing Rails.root from the string, but it's just one line anyway).

Besides, if the cause of the deprecation is inside a gem that you're using (this happened to me at least once), the cleaner would return a wrong line, because (by default) it treats everything outside your app as noise.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Honestly, I don't think this makes much sense in this case...
The code in ActionDispatch uses the cleaner (if available) to
remove some useless lines from the trace to make it more readable,
and if it's not available, leaves it as it is, so it makes a
difference for the user. Here we only want that one specific line,
so adding the cleaner would just mean less code, but adding a
cleaner with an if/else would actually mean more code and no
advantages (other than removing Rails.root from the string, but
it's just one line anyway).&lt;/p&gt;
&lt;p&gt;Besides, if the cause of the deprecation is inside a gem that
you're using (this happened to me at least once), the cleaner would
return a wrong line, because (by default) it treats everything
outside your app as noise.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-24T22:01:12+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-08-24T22:01:13+01:00</updated-at>
      <user-id type="integer">33887</user-id>
      <version type="integer">13</version>
      <user-name>Jakub Suder</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>At this point of time I am seeing a lot of deprecation messages from third party gems. If the offending line is not there then the deprecation message might be confusing. 

Personally I would like to have an option like this

@@@ ruby
config.print_full_stacktrace_from_deprecation_warnings = true
@@@

If the option is on then dump the full trace otherwise just one line is enough. 


When a project is being migrated from 2.x to 3.x at that time I want deprecation messages to be one line because I am ignoring them. After a week when my project is passing all tests I would like to have full dump so that I could remove deprecation message.  

In some cases it might not be possible to get rid of all deprecation messages. I get some message from shoulda and I need to wait until shoulda guys fix the gem.</body>
      <body-html>&lt;div&gt;&lt;p&gt;At this point of time I am seeing a lot of deprecation messages
from third party gems. If the offending line is not there then the
deprecation message might be confusing.&lt;/p&gt;
&lt;p&gt;Personally I would like to have an option like this&lt;/p&gt;
&lt;pre&gt;
&lt;code class=
&quot;ruby&quot;&gt;config.print_full_stacktrace_from_deprecation_warnings = true&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;If the option is on then dump the full trace otherwise just one
line is enough.&lt;/p&gt;
&lt;p&gt;When a project is being migrated from 2.x to 3.x at that time I
want deprecation messages to be one line because I am ignoring
them. After a week when my project is passing all tests I would
like to have full dump so that I could remove deprecation
message.&lt;br&gt;&lt;/p&gt;
&lt;p&gt;In some cases it might not be possible to get rid of all
deprecation messages. I get some message from shoulda and I need to
wait until shoulda guys fix the gem.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-24T22:06:58+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-08-24T22:07:03+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">14</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>&gt; At this point of time I am seeing a lot of deprecation messages from third party gems. If the offending line is not there then the deprecation message might be confusing.


Yeah, that's what the patch is intended to fix (the original version, without Rails cleaner). Example from my current app:

Before the patch:

    DEPRECATION WARNING: Calling a method in Rails::Application is deprecated, please call it directly in your application constant Qwerly::Application. (called from method_missing at /Users/psionides/.rvm/gems/ruby-1.9.2-preview3@foo/gems/railties-3.0.0.rc/lib/rails/application.rb:77)
    DEPRECATION WARNING: You are using the old router DSL which will be removed in Rails 3.1. Please check how to update your routes file at: http://www.engineyard.com/blog/2010/the-lowdown-on-routes-in-rails-3/. (called from initialize at /Users/psionides/.rvm/gems/ruby-1.9.2-preview3@foo/gems/actionpack-3.0.0.rc/lib/action_dispatch/routing/deprecated_mapper.rb:33)

(No clue what's going on.)

After the patch:

    DEPRECATION WARNING: Calling a method in Rails::Application is deprecated, please call it directly in your application constant Qwerly::Application. (called from &lt;top (required)&gt; at /Users/psionides/.rvm/gems/ruby-1.9.2-preview3@foo/gems/jammit-0.5.1/rails/routes.rb:3)
    DEPRECATION WARNING: You are using the old router DSL which will be removed in Rails 3.1. Please check how to update your routes file at: http://www.engineyard.com/blog/2010/the-lowdown-on-routes-in-rails-3/. (called from &lt;top (required)&gt; at /Users/psionides/.rvm/gems/ruby-1.9.2-preview3@foo/gems/jammit-0.5.1/rails/routes.rb:3)

(Aha, it's Jammit! I should probably tell them.)</body>
      <body-html>&lt;div&gt;&lt;blockquote&gt;
&lt;p&gt;At this point of time I am seeing a lot of deprecation messages
from third party gems. If the offending line is not there then the
deprecation message might be confusing.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Yeah, that's what the patch is intended to fix (the original
version, without Rails cleaner). Example from my current app:&lt;/p&gt;
&lt;p&gt;Before the patch:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;DEPRECATION WARNING: Calling a method in Rails::Application is deprecated, please call it directly in your application constant Qwerly::Application. (called from method_missing at /Users/psionides/.rvm/gems/ruby-1.9.2-preview3@foo/gems/railties-3.0.0.rc/lib/rails/application.rb:77)
DEPRECATION WARNING: You are using the old router DSL which will be removed in Rails 3.1. Please check how to update your routes file at: http://www.engineyard.com/blog/2010/the-lowdown-on-routes-in-rails-3/. (called from initialize at /Users/psionides/.rvm/gems/ruby-1.9.2-preview3@foo/gems/actionpack-3.0.0.rc/lib/action_dispatch/routing/deprecated_mapper.rb:33)&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;(No clue what's going on.)&lt;/p&gt;
&lt;p&gt;After the patch:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;DEPRECATION WARNING: Calling a method in Rails::Application is deprecated, please call it directly in your application constant Qwerly::Application. (called from &amp;lt;top (required)&amp;gt; at /Users/psionides/.rvm/gems/ruby-1.9.2-preview3@foo/gems/jammit-0.5.1/rails/routes.rb:3)
DEPRECATION WARNING: You are using the old router DSL which will be removed in Rails 3.1. Please check how to update your routes file at: http://www.engineyard.com/blog/2010/the-lowdown-on-routes-in-rails-3/. (called from &amp;lt;top (required)&amp;gt; at /Users/psionides/.rvm/gems/ruby-1.9.2-preview3@foo/gems/jammit-0.5.1/rails/routes.rb:3)&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;(Aha, it's Jammit! I should probably tell them.)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-24T22:22:31+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-08-24T22:22:33+01:00</updated-at>
      <user-id type="integer">33887</user-id>
      <version type="integer">15</version>
      <user-name>Jakub Suder</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I think an option is not necessary here, you don't really need the whole stack trace, as I thought initially - all it would tell you in the example above is how Jammit is loaded in the app - probably somehow with Bundler, but that's irrelevant; what's relevant is who calls one of the Rails methods incorrectly, and unless it's Rails itself, it will always be the first non-Rails line in the stack trace, in this case some method in Jammit. That's all I need to either fix the error myself or tell someone (gem owner) to fix it.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I think an option is not necessary here, you don't really need
the whole stack trace, as I thought initially - all it would tell
you in the example above is how Jammit is loaded in the app -
probably somehow with Bundler, but that's irrelevant; what's
relevant is who calls one of the Rails methods incorrectly, and
unless it's Rails itself, it will always be the first non-Rails
line in the stack trace, in this case some method in Jammit. That's
all I need to either fix the error myself or tell someone (gem
owner) to fix it.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-24T22:25:49+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-08-24T22:25:54+01:00</updated-at>
      <user-id type="integer">33887</user-id>
      <version type="integer">16</version>
      <user-name>Jakub Suder</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I see. For some reason I thought you were removing everything no belonging to my code including gems. My bad.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I see. For some reason I thought you were removing everything no
belonging to my code including gems. My bad.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-24T22:25:59+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-08-24T22:26:02+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">17</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>That's what the Rails cleaner would do, because it's configured by default to filter out everything that doesn't match APP_DIRS_PATTERN = /^\/?(app|config|lib|test)/.</body>
      <body-html>&lt;div&gt;&lt;p&gt;That's what the Rails cleaner would do, because it's configured
by default to filter out everything that doesn't match
APP_DIRS_PATTERN = /^\/?(app|config|lib|test)/.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-24T22:37:56+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-08-24T22:37:57+01:00</updated-at>
      <user-id type="integer">33887</user-id>
      <version type="integer">18</version>
      <user-name>Jakub Suder</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Yes, you are right Jakub. Just one last change then: your patch should return callstack.first if no external is found (useful when we deprecate something but we are still calling inside rails tests, for example)</body>
      <body-html>&lt;div&gt;&lt;p&gt;Yes, you are right Jakub. Just one last change then: your patch
should return callstack.first if no external is found (useful when
we deprecate something but we are still calling inside rails tests,
for example)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-25T01:12:46+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-08-25T01:12:47+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">19</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Good point, I've updated the patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Good point, I've updated the patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-25T08:20:36+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-08-25T08:20:40+01:00</updated-at>
      <user-id type="integer">33887</user-id>
      <version type="integer">20</version>
      <user-name>Jakub Suder</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>(from [4f945e97e55b861ab014d71efa983ab183441031]) better callstack reporting in deprecation messages

now the reported line is the first line in the stack
that's outside Rails, which is the one that actually
caused the problem in the first place

[#5231 state:resolved]

Signed-off-by: Jos&#233; Valim &lt;jose.valim@gmail.com&gt;
http://github.com/rails/rails/commit/4f945e97e55b861ab014d71efa983ab183441031</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/4f945e97e55b861ab014d71efa983ab183441031&quot;
title=
&quot;Changeset [4f945e97e55b861ab014d71efa983ab183441031]&quot;&gt;[4f945e97e55b861ab014d71efa983ab183441031]&lt;/a&gt;)
better callstack reporting in deprecation messages&lt;/p&gt;
&lt;p&gt;now the reported line is the first line in the stack&lt;br&gt;
that's outside Rails, which is the one that actually&lt;br&gt;
caused the problem in the first place&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;/projects/8994/tickets/5231&quot; title=
&quot;Ticket #5231&quot;&gt;#5231&lt;/a&gt; state:resolved]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jos&amp;eacute; Valim &lt;a&gt;jose.valim@gmail.com&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/4f945e97e55b861ab014d71efa983ab183441031&quot;&gt;
http://github.com/rails/rails/commit/4f945e97e55b861ab014d71efa983a...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-08-25T11:24:39+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-08-25T11:24:41+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">21</version>
      <user-name>Repository</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>(from [aec084955df4761dfc60920048209314ee466463]) better callstack reporting in deprecation messages

now the reported line is the first line in the stack
that's outside Rails, which is the one that actually
caused the problem in the first place

[#5231 state:resolved]

Signed-off-by: Jos&#233; Valim &lt;jose.valim@gmail.com&gt;
http://github.com/rails/rails/commit/aec084955df4761dfc60920048209314ee466463</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/aec084955df4761dfc60920048209314ee466463&quot;
title=
&quot;Changeset [aec084955df4761dfc60920048209314ee466463]&quot;&gt;[aec084955df4761dfc60920048209314ee466463]&lt;/a&gt;)
better callstack reporting in deprecation messages&lt;/p&gt;
&lt;p&gt;now the reported line is the first line in the stack&lt;br&gt;
that's outside Rails, which is the one that actually&lt;br&gt;
caused the problem in the first place&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;/projects/8994/tickets/5231&quot; title=
&quot;Ticket #5231&quot;&gt;#5231&lt;/a&gt; state:resolved]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jos&amp;eacute; Valim &lt;a&gt;jose.valim@gmail.com&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/aec084955df4761dfc60920048209314ee466463&quot;&gt;
http://github.com/rails/rails/commit/aec084955df4761dfc609200482093...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-08-25T11:25:39+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-08-25T11:25:40+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">22</version>
      <user-name>Repository</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name>High</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/31647)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/31647&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-10-15T23:01:59+01:00</created-at>
      <creator-id type="integer">33887</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 27004
</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">5231</number>
      <permalink>print-stack-traces-with-deprecation-warnings</permalink>
      <priority type="integer">1</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>backtrace deprecation warnings</tag>
      <title>print stack traces with deprecation warnings</title>
      <updated-at type="datetime">2010-10-15T23:01:59+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">23</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Jakub Suder</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5231</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name>High</priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>f4e4a2cd71b717c759f827d189772a3c29ea5061</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-08-20T19:25:26+01:00</created-at>
      <filename>0001-better-callstack-reporting-in-deprecation-messages.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">638749</id>
      <size type="integer">1433</size>
      <uploader-id type="integer">33887</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/638749/0001-better-callstack-reporting-in-deprecation-messages.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>9878726972ada6b8a73175057ae236f1c709a6c2</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-08-25T08:20:36+01:00</created-at>
      <filename>0001-better-callstack-reporting-in-deprecation-messages.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">644028</id>
      <size type="integer">1452</size>
      <uploader-id type="integer">33887</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/644028/0001-better-callstack-reporting-in-deprecation-messages.patch</url>
    </attachment>
  </attachments>
</ticket>
