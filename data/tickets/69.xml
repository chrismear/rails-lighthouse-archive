<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">2</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2008-04-30T19:25:48+01:00</created-at>
  <creator-id type="integer">18806</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer" nil="true"></milestone-id>
  <number type="integer">69</number>
  <permalink>urlencodedpairparser-creates-wrong-params-hash-with-nested-attributes-in-arrays</permalink>
  <priority type="integer">10472</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>stale</state>
  <tag nil="true"></tag>
  <title>UrlEncodedPairParser creates wrong params hash with nested attributes in arrays</title>
  <updated-at type="datetime">2011-02-02T17:59:32+00:00</updated-at>
  <user-id type="integer">40272</user-id>
  <version type="integer">16</version>
  <user-name>Santiago Pastorino</user-name>
  <creator-name>Matthew Moore</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/69</url>
  <priority-name nil="true"></priority-name>
  <original-body>In edge rails, sending in request attributes with the following:

&amp;email[to_new_contacts][][contact_attributes][first_name]=first
&amp;email[to_new_contacts][][contact_attributes][middle_name]=middle
&amp;email[to_new_contacts][relationship]=friend
&amp;email[to_new_contacts][][contact_attributes][first_name]=first2
&amp;email[to_new_contacts][][contact_attributes][middle_name]=middle2
&amp;email[to_new_contacts][relationship]=friend2

Creates a very unexpected params value.  The attached test compares what the desired output is, versus what is actually output by UrlEncodedPairParser.

Shouldn't the params hash look similar to the following?  It looks much different, as you'll see in the test.

:email =&gt; :to_new_contacts =&gt; [ 
   {:relationship =&gt; '..', : contact_attributes =&gt; { :first_name =&gt; '..' } },
   {:relationship =&gt; '..', : contact_attributes =&gt; { :first_name =&gt; '..' } }
 ]</original-body>
  <latest-body>In edge rails, sending in request attributes with the following:

&amp;email[to_new_contacts][][contact_attributes][first_name]=first
&amp;email[to_new_contacts][][contact_attributes][middle_name]=middle
&amp;email[to_new_contacts][relationship]=friend
&amp;email[to_new_contacts][][contact_attributes][first_name]=first2
&amp;email[to_new_contacts][][contact_attributes][middle_name]=middle2
&amp;email[to_new_contacts][relationship]=friend2

Creates a very unexpected params value.  The attached test compares what the desired output is, versus what is actually output by UrlEncodedPairParser.

Shouldn't the params hash look similar to the following?  It looks much different, as you'll see in the test.

:email =&gt; :to_new_contacts =&gt; [ 
   {:relationship =&gt; '..', : contact_attributes =&gt; { :first_name =&gt; '..' } },
   {:relationship =&gt; '..', : contact_attributes =&gt; { :first_name =&gt; '..' } }
 ]</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;
In edge rails, sending in request attributes with the following:
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][][contact_attributes][first_name]=first
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][][contact_attributes][middle_name]=middle
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][relationship]=friend
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][][contact_attributes][first_name]=first2
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][][contact_attributes][middle_name]=middle2
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][relationship]=friend2
&lt;/p&gt;&lt;p&gt;
Creates a very unexpected params value.  The attached test compares what the desired output is, versus what is actually output by UrlEncodedPairParser.
&lt;/p&gt;&lt;p&gt;
Shouldn't the params hash look similar to the following?  It looks much different, as you'll see in the test.
&lt;/p&gt;&lt;p&gt;
:email =&gt; :to_new_contacts =&gt; [
&lt;/p&gt;&lt;p&gt;
{:relationship =&gt; '..', : contact_attributes =&gt; { :first_name =&gt; '..' } },
&lt;/p&gt;&lt;p&gt;
{:relationship =&gt; '..', : contact_attributes =&gt; { :first_name =&gt; '..' } }
&lt;/p&gt;&lt;p&gt;
]
&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>In edge rails, sending in request attributes with the following:

&amp;email[to_new_contacts][][contact_attributes][first_name]=first
&amp;email[to_new_contacts][][contact_attributes][middle_name]=middle
&amp;email[to_new_contacts][relationship]=friend
&amp;email[to_new_contacts][][contact_attributes][first_name]=first2
&amp;email[to_new_contacts][][contact_attributes][middle_name]=middle2
&amp;email[to_new_contacts][relationship]=friend2

Creates a very unexpected params value.  The attached test compares what the desired output is, versus what is actually output by UrlEncodedPairParser.

Shouldn't the params hash look similar to the following?  It looks much different, as you'll see in the test.

:email =&gt; :to_new_contacts =&gt; [ 
   {:relationship =&gt; '..', : contact_attributes =&gt; { :first_name =&gt; '..' } },
   {:relationship =&gt; '..', : contact_attributes =&gt; { :first_name =&gt; '..' } }
 ]</body>
      <body-html>&lt;div&gt;&lt;p&gt;
In edge rails, sending in request attributes with the following:
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][][contact_attributes][first_name]=first
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][][contact_attributes][middle_name]=middle
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][relationship]=friend
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][][contact_attributes][first_name]=first2
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][][contact_attributes][middle_name]=middle2
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][relationship]=friend2
&lt;/p&gt;&lt;p&gt;
Creates a very unexpected params value.  The attached test compares what the desired output is, versus what is actually output by UrlEncodedPairParser.
&lt;/p&gt;&lt;p&gt;
Shouldn't the params hash look similar to the following?  It looks much different, as you'll see in the test.
&lt;/p&gt;&lt;p&gt;
:email =&gt; :to_new_contacts =&gt; [
&lt;/p&gt;&lt;p&gt;
{:relationship =&gt; '..', : contact_attributes =&gt; { :first_name =&gt; '..' } },
&lt;/p&gt;&lt;p&gt;
{:relationship =&gt; '..', : contact_attributes =&gt; { :first_name =&gt; '..' } }
&lt;/p&gt;&lt;p&gt;
]
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-04-30T19:25:48+01:00</created-at>
      <creator-id type="integer">18806</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">69</number>
      <permalink>urlencodedpairparser-creates-wrong-params-hash-with-nested-attributes-in-arrays</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>UrlEncodedPairParser creates wrong params hash with nested attributes in arrays</title>
      <updated-at type="datetime">2008-04-30T19:25:48+01:00</updated-at>
      <user-id type="integer">18806</user-id>
      <version type="integer">1</version>
      <user-name>Matthew Moore</user-name>
      <creator-name>Matthew Moore</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/69</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>In the following arguments, you are treating email[to_new_contacts] like an array with []

&amp;email[to_new_contacts][][contact_attributes][first_name]=first
&amp;email[to_new_contacts][][contact_attributes][middle_name]=middle
&amp;email[to_new_contacts][][contact_attributes][first_name]=first2
&amp;email[to_new_contacts][][contact_attributes][middle_name]=middle2


However, in these arguments, you are treating email[to_new_contacts] like a hash by indexing it with &quot;relationship&quot;

&amp;email[to_new_contacts][relationship]=friend
&amp;email[to_new_contacts][relationship]=friend2


You probably just want to use a hash like this:

&amp;email[to_new_contacts][friend][contact_attributes][first_name]=first
&amp;email[to_new_contacts][friend][contact_attributes][middle_name]=middle
&amp;email[to_new_contacts][friend2][contact_attributes][first_name]=first2
&amp;email[to_new_contacts][friend2][contact_attributes][middle_name]=middle2
&amp;email[to_new_contacts][relationship]=friend
&amp;email[to_new_contacts][relationship]=friend2


Which will create these params:
@@@ ruby
{&quot;email&quot;=&gt;
  {&quot;to_new_contacts&quot;=&gt;
    {&quot;friend2&quot;=&gt;
      {&quot;contact_attributes&quot;=&gt;
        {&quot;first_name&quot;=&gt;&quot;first2&quot;, &quot;middle_name&quot;=&gt;&quot;middle2&quot;}},
     &quot;relationship&quot;=&gt;&quot;friend&quot;,
     &quot;friend&quot;=&gt;
      {&quot;contact_attributes&quot;=&gt;
        {&quot;first_name&quot;=&gt;&quot;first&quot;, &quot;middle_name&quot;=&gt;&quot;middle&quot;}}}}}
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;
In the following arguments, you are treating email[to_new_contacts] like an array with []
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][][contact_attributes][first_name]=first
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][][contact_attributes][middle_name]=middle
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][][contact_attributes][first_name]=first2
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][][contact_attributes][middle_name]=middle2
&lt;/p&gt;&lt;p&gt;
However, in these arguments, you are treating email[to_new_contacts] like a hash by indexing it with &quot;relationship&quot;
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][relationship]=friend
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][relationship]=friend2
&lt;/p&gt;&lt;p&gt;
You probably just want to use a hash like this:
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][friend][contact_attributes][first_name]=first
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][friend][contact_attributes][middle_name]=middle
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][friend2][contact_attributes][first_name]=first2
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][friend2][contact_attributes][middle_name]=middle2
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][relationship]=friend
&lt;/p&gt;&lt;p&gt;
&amp;email[to_new_contacts][relationship]=friend2
&lt;/p&gt;&lt;p&gt;
Which will create these params:
&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;{&amp;quot;email&amp;quot;=&amp;gt;
  {&amp;quot;to_new_contacts&amp;quot;=&amp;gt;
    {&amp;quot;friend2&amp;quot;=&amp;gt;
      {&amp;quot;contact_attributes&amp;quot;=&amp;gt;
        {&amp;quot;first_name&amp;quot;=&amp;gt;&amp;quot;first2&amp;quot;, &amp;quot;middle_name&amp;quot;=&amp;gt;&amp;quot;middle2&amp;quot;}},
     &amp;quot;relationship&amp;quot;=&amp;gt;&amp;quot;friend&amp;quot;,
     &amp;quot;friend&amp;quot;=&amp;gt;
      {&amp;quot;contact_attributes&amp;quot;=&amp;gt;
        {&amp;quot;first_name&amp;quot;=&amp;gt;&amp;quot;first&amp;quot;, &amp;quot;middle_name&amp;quot;=&amp;gt;&amp;quot;middle&amp;quot;}}}}}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-05-28T03:56:59+01:00</created-at>
      <creator-id type="integer">18806</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">69</number>
      <permalink>urlencodedpairparser-creates-wrong-params-hash-with-nested-attributes-in-arrays</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>UrlEncodedPairParser creates wrong params hash with nested attributes in arrays</title>
      <updated-at type="datetime">2008-05-28T03:56:59+01:00</updated-at>
      <user-id type="integer">10280</user-id>
      <version type="integer">2</version>
      <user-name>Carl Porth</user-name>
      <creator-name>Matthew Moore</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/69</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>We are having the same problem. Except it seems to only be a problem when we are submitting via Ajax and using Form#serialize


When submitted via Form#serialize looking in firebug, it shows that the this is how the attributes are being sent:

@@@ ruby
user[phone_numbers_attributes][][extension]
user[phone_numbers_attributes][][extension]
user[phone_numbers_attributes][][phone_number] = 1234567899
user[phone_numbers_attributes][][phone_number] = 1234567890
user[phone_numbers_attributes][][phone_type] = cell
user[phone_numbers_attributes][][phone_type] = Home
user[phone_numbers_attributes][][primary]
user[phone_numbers_attributes][][primary]
@@@

This is what it looks like in the params object:

@@@ ruby
{&quot;user&quot;=&gt;
  {&quot;phone_numbers_attributes&quot;=&gt;
    [
      {&quot;primary&quot;=&gt;&quot;&quot;}, 
      {&quot;primary&quot;=&gt;&quot;&quot;, &quot;phone_number&quot;=&gt;&quot;1234567890&quot;}, 
      {&quot;extension&quot;=&gt;&quot;&quot;, &quot;phone_number&quot;=&gt;&quot;1234567899&quot;}, 
      {&quot;phone_type&quot;=&gt;&quot;Home&quot;, &quot;extension&quot;=&gt;&quot;&quot;}, 
      {&quot;phone_type&quot;=&gt;&quot;Cell&quot;}
    ]
  }
}
@@@

When submitted via normal form posting we get this in the params object:

@@@ ruby
{&quot;user&quot;=&gt;
  {&quot;phone_numbers_attributes&quot;=&gt;
    [
      {&quot;phone_type&quot;=&gt;&quot;Home&quot;, &quot;primary&quot;=&gt;&quot;&quot;, &quot;extension&quot;=&gt;&quot;&quot;, &quot;phone_number&quot;=&gt;&quot;1234567899&quot;}, 
      {&quot;phone_type&quot;=&gt;&quot;Cell&quot;, &quot;primary&quot;=&gt;&quot;&quot;, &quot;extension&quot;=&gt;&quot;&quot;, &quot;phone_number&quot;=&gt;&quot;1234567890&quot;}
    ]
  }
}
@@@

Also, Why does submitting via the Ajax and Form#serialize do empty fields show up as a blank string, but normal form submitting does not?</body>
      <body-html>&lt;div&gt;&lt;p&gt;
We are having the same problem. Except it seems to only be a problem when we are submitting via Ajax and using Form#serialize
&lt;/p&gt;&lt;p&gt;
When submitted via Form#serialize looking in firebug, it shows that the this is how the attributes are being sent:
&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;user[phone_numbers_attributes][][extension]
user[phone_numbers_attributes][][extension]
user[phone_numbers_attributes][][phone_number] = 1234567899
user[phone_numbers_attributes][][phone_number] = 1234567890
user[phone_numbers_attributes][][phone_type] = cell
user[phone_numbers_attributes][][phone_type] = Home
user[phone_numbers_attributes][][primary]
user[phone_numbers_attributes][][primary]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;
This is what it looks like in the params object:
&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;{&amp;quot;user&amp;quot;=&amp;gt;
  {&amp;quot;phone_numbers_attributes&amp;quot;=&amp;gt;
    [
      {&amp;quot;primary&amp;quot;=&amp;gt;&amp;quot;&amp;quot;}, 
      {&amp;quot;primary&amp;quot;=&amp;gt;&amp;quot;&amp;quot;, &amp;quot;phone_number&amp;quot;=&amp;gt;&amp;quot;1234567890&amp;quot;}, 
      {&amp;quot;extension&amp;quot;=&amp;gt;&amp;quot;&amp;quot;, &amp;quot;phone_number&amp;quot;=&amp;gt;&amp;quot;1234567899&amp;quot;}, 
      {&amp;quot;phone_type&amp;quot;=&amp;gt;&amp;quot;Home&amp;quot;, &amp;quot;extension&amp;quot;=&amp;gt;&amp;quot;&amp;quot;}, 
      {&amp;quot;phone_type&amp;quot;=&amp;gt;&amp;quot;Cell&amp;quot;}
    ]
  }
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;
When submitted via normal form posting we get this in the params object:
&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;{&amp;quot;user&amp;quot;=&amp;gt;
  {&amp;quot;phone_numbers_attributes&amp;quot;=&amp;gt;
    [
      {&amp;quot;phone_type&amp;quot;=&amp;gt;&amp;quot;Home&amp;quot;, &amp;quot;primary&amp;quot;=&amp;gt;&amp;quot;&amp;quot;, &amp;quot;extension&amp;quot;=&amp;gt;&amp;quot;&amp;quot;, &amp;quot;phone_number&amp;quot;=&amp;gt;&amp;quot;1234567899&amp;quot;}, 
      {&amp;quot;phone_type&amp;quot;=&amp;gt;&amp;quot;Cell&amp;quot;, &amp;quot;primary&amp;quot;=&amp;gt;&amp;quot;&amp;quot;, &amp;quot;extension&amp;quot;=&amp;gt;&amp;quot;&amp;quot;, &amp;quot;phone_number&amp;quot;=&amp;gt;&amp;quot;1234567890&amp;quot;}
    ]
  }
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;
Also, Why does submitting via the Ajax and Form#serialize do empty fields show up as a blank string, but normal form submitting does not?
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-07-12T21:57:22+01:00</created-at>
      <creator-id type="integer">18806</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">69</number>
      <permalink>urlencodedpairparser-creates-wrong-params-hash-with-nested-attributes-in-arrays</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionpack bug closed request urlencodedpairparser</tag>
      <title>UrlEncodedPairParser creates wrong params hash with nested attributes in arrays</title>
      <updated-at type="datetime">2008-07-12T21:57:22+01:00</updated-at>
      <user-id type="integer">13453</user-id>
      <version type="integer">3</version>
      <user-name>Stephen Heuer</user-name>
      <creator-name>Matthew Moore</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/69</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Here is a link to the problem in the old rails trac: 
&quot;http://dev.rubyonrails.org/ticket/8775&quot;:http://dev.rubyonrails.org/ticket/8775</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Here is a link to the problem in the old rails trac:
&lt;/p&gt;&lt;p&gt;
&lt;a href=&quot;http://dev.rubyonrails.org/ticket/8775&quot;&gt;http://dev.rubyonrails.org/ticket/8775&lt;/a&gt;
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-07-12T22:03:03+01:00</created-at>
      <creator-id type="integer">18806</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: actionpack bug closed request urlencodedpairparser
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">69</number>
      <permalink>urlencodedpairparser-creates-wrong-params-hash-with-nested-attributes-in-arrays</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionpack bug request urlencodedpairparser</tag>
      <title>UrlEncodedPairParser creates wrong params hash with nested attributes in arrays</title>
      <updated-at type="datetime">2008-07-12T22:03:03+01:00</updated-at>
      <user-id type="integer">13453</user-id>
      <version type="integer">4</version>
      <user-name>Stephen Heuer</user-name>
      <creator-name>Matthew Moore</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/69</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>This old ticket is related as well, http://dev.rubyonrails.org/ticket/10101. 
I'm still having this problem, I was hoping it would have been fixed in 2.1.

Comron</body>
      <body-html>&lt;div&gt;&lt;p&gt;This old ticket is related as well, &lt;a href=&quot;http://dev.rubyonrails.org/ticket/10101&quot;&gt;http://dev.rubyonrails.org/ticke...&lt;/a&gt;.
I'm still having this problem, I was hoping it would have been
fixed in 2.1.&lt;/p&gt;
&lt;p&gt;Comron&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-09-17T21:40:01+01:00</created-at>
      <creator-id type="integer">18806</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: actionpack bug request urlencodedpairparser
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">69</number>
      <permalink>urlencodedpairparser-creates-wrong-params-hash-with-nested-attributes-in-arrays</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionpack bug request urlencodedpairparser</tag>
      <title>UrlEncodedPairParser creates wrong params hash with nested attributes in arrays</title>
      <updated-at type="datetime">2008-09-17T21:40:02+01:00</updated-at>
      <user-id type="integer">17264</user-id>
      <version type="integer">5</version>
      <user-name>Comron Sattari</user-name>
      <creator-name>Matthew Moore</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/69</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>A patch which (mostly) fixes this problem is available here http://www.vector-seven.com/2008/07/20/taking-the-pain-out-of-complex-forms-in-rails/

I'm using it in production with minor tweaks to the form helpers and I have had very few issues.

Also an idea to compact! the arrays which are returned as they often contain nils.</body>
      <body-html>&lt;div&gt;&lt;p&gt;A patch which (mostly) fixes this problem is available here
&lt;a href=&quot;http://www.vector-seven.com/2008/07/20/taking-the-pain-out-of-complex-forms-in-rails/&quot;&gt;
http://www.vector-seven.com/2008...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I'm using it in production with minor tweaks to the form helpers
and I have had very few issues.&lt;/p&gt;
&lt;p&gt;Also an idea to compact! the arrays which are returned as they
often contain nils.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-09-18T00:11:26+01:00</created-at>
      <creator-id type="integer">18806</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">69</number>
      <permalink>urlencodedpairparser-creates-wrong-params-hash-with-nested-attributes-in-arrays</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>actionpack bug request urlencodedpairparser</tag>
      <title>UrlEncodedPairParser creates wrong params hash with nested attributes in arrays</title>
      <updated-at type="datetime">2008-09-18T00:11:31+01:00</updated-at>
      <user-id type="integer">23252</user-id>
      <version type="integer">6</version>
      <user-name>Ivan Vanderbyl</user-name>
      <creator-name>Matthew Moore</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/69</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>We need a patch or even a failing test case. Will reopen after that.

Thanks.</body>
      <body-html>&lt;div&gt;&lt;p&gt;We need a patch or even a failing test case. Will reopen after
that.&lt;/p&gt;
&lt;p&gt;Thanks.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-12-19T15:58:28+00:00</created-at>
      <creator-id type="integer">18806</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">69</number>
      <permalink>urlencodedpairparser-creates-wrong-params-hash-with-nested-attributes-in-arrays</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>actionpack bug request urlencodedpairparser</tag>
      <title>UrlEncodedPairParser creates wrong params hash with nested attributes in arrays</title>
      <updated-at type="datetime">2008-12-19T15:58:34+00:00</updated-at>
      <user-id type="integer">1366</user-id>
      <version type="integer">7</version>
      <user-name>Pratik</user-name>
      <creator-name>Matthew Moore</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/69</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-04T17:15:30+01:00</created-at>
      <creator-id type="integer">18806</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: actionpack bug request urlencodedpairparser
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">69</number>
      <permalink>urlencodedpairparser-creates-wrong-params-hash-with-nested-attributes-in-arrays</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>actionpack bug bugmash request urlencodedpairparser</tag>
      <title>UrlEncodedPairParser creates wrong params hash with nested attributes in arrays</title>
      <updated-at type="datetime">2009-08-04T17:15:34+01:00</updated-at>
      <user-id type="integer">7211</user-id>
      <version type="integer">8</version>
      <user-name>CancelProfileIsBroken</user-name>
      <creator-name>Matthew Moore</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/69</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-01-20T10:52:34+00:00</created-at>
      <creator-id type="integer">18806</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: actionpack bug bugmash request urlencodedpairparser
:state: incomplete
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">69</number>
      <permalink>urlencodedpairparser-creates-wrong-params-hash-with-nested-attributes-in-arrays</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>stale</state>
      <tag>actionpack bug request urlencodedpairparser</tag>
      <title>UrlEncodedPairParser creates wrong params hash with nested attributes in arrays</title>
      <updated-at type="datetime">2010-01-20T10:52:36+00:00</updated-at>
      <user-id type="integer">65556</user-id>
      <version type="integer">9</version>
      <user-name>Rizwan Reza</user-name>
      <creator-name>Matthew Moore</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/69</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>It would be nice to get this fixed. It has been three years now...</body>
      <body-html>&lt;div&gt;&lt;p&gt;It would be nice to get this fixed. It has been three years
now...&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-10-13T04:21:11+01:00</created-at>
      <creator-id type="integer">18806</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">69</number>
      <permalink>urlencodedpairparser-creates-wrong-params-hash-with-nested-attributes-in-arrays</permalink>
      <priority type="integer">10472</priority>
      <project-id type="integer">8994</project-id>
      <state>stale</state>
      <tag>actionpack bug request urlencodedpairparser</tag>
      <title>UrlEncodedPairParser creates wrong params hash with nested attributes in arrays</title>
      <updated-at type="datetime">2010-10-13T04:21:14+01:00</updated-at>
      <user-id type="integer">119715</user-id>
      <version type="integer">10</version>
      <user-name>Thomas Pedersen</user-name>
      <creator-name>Matthew Moore</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/69</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Thomas can you provide a patch with a test case or at least a test case only?.
Thanks.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Thomas can you provide a patch with a test case or at least a
test case only?.&lt;br&gt;
Thanks.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-10-13T14:11:09+01:00</created-at>
      <creator-id type="integer">18806</creator-id>
      <diffable-attributes type="yaml">--- 
:state: stale
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">69</number>
      <permalink>urlencodedpairparser-creates-wrong-params-hash-with-nested-attributes-in-arrays</permalink>
      <priority type="integer">10472</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>actionpack bug request urlencodedpairparser</tag>
      <title>UrlEncodedPairParser creates wrong params hash with nested attributes in arrays</title>
      <updated-at type="datetime">2010-10-13T14:11:11+01:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">11</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>Matthew Moore</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/69</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I have attached a view template that demonstrates the problem. You have to set up a simple controller and an action in routes.rb for it work, but that takes two minutes.

The form conctains the following fields:

  &lt;input type=&quot;text&quot; name=&quot;rule[condition_list][][text]&quot;  value=&quot;text1&quot; /&gt;&lt;br /&gt;
  &lt;input type=&quot;text&quot; name=&quot;rule[condition_list][][value]&quot; value=&quot;value1&quot; /&gt;&lt;br /&gt;
  &lt;input type=&quot;text&quot; name=&quot;rule[condition_list][][text]&quot;  value=&quot;text2&quot; /&gt;&lt;br /&gt;
  &lt;input type=&quot;text&quot; name=&quot;rule[condition_list][][value]&quot; value=&quot;value2&quot; /&gt;&lt;br /&gt;
  &lt;input type=&quot;text&quot; name=&quot;rule[condition_list][][text]&quot;  value=&quot;text3&quot; /&gt;&lt;br /&gt;
  &lt;input type=&quot;text&quot; name=&quot;rule[condition_list][][value]&quot; value=&quot;value3&quot; /&gt;&lt;br /&gt;

When you submit the form normally, Rails groups the values proper in params[] like this:

Parameters: {&quot;commit&quot;=&gt;&quot;Subtmit&quot;, &quot;rule&quot;=&gt;{&quot;condition_list&quot;=&gt;[{&quot;text&quot;=&gt;&quot;text1&quot;, &quot;value&quot;=&gt;&quot;value1&quot;}, {&quot;text&quot;=&gt;&quot;text2&quot;, &quot;value&quot;=&gt;&quot;value2&quot;}, {&quot;text&quot;=&gt;&quot;text3&quot;, &quot;value&quot;=&gt;&quot;value3&quot;}]}}

But when you use button_to_remove to submit via Ajax, the values are no longer properly grouped:

Parameters: {&quot;commit&quot;=&gt;&quot;Submit&quot;, &quot;authenticity_token&quot;=&gt;&quot;ZW+GHWqfHCpp4rDp67xYHn2a7iOJlbgLg1YYYVZJb9o=&quot;, &quot;id&quot;=&gt;&quot;1&quot;, &quot;rule&quot;=&gt;{&quot;condition_list&quot;=&gt;[{&quot;text&quot;=&gt;&quot;text1&quot;}, {&quot;text&quot;=&gt;&quot;text2&quot;}, {&quot;text&quot;=&gt;&quot;text3&quot;, &quot;value&quot;=&gt;&quot;value1&quot;}, {&quot;value&quot;=&gt;&quot;value2&quot;}, {&quot;value&quot;=&gt;&quot;value3&quot;}]}}</body>
      <body-html>&lt;div&gt;&lt;p&gt;I have attached a view template that demonstrates the problem.
You have to set up a simple controller and an action in routes.rb
for it work, but that takes two minutes.&lt;/p&gt;
&lt;p&gt;The form conctains the following fields:&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;&lt;/p&gt;
&lt;p&gt;When you submit the form normally, Rails groups the values
proper in params[] like this:&lt;/p&gt;
&lt;p&gt;Parameters: {&quot;commit&quot;=&amp;gt;&quot;Subtmit&quot;,
&quot;rule&quot;=&amp;gt;{&quot;condition_list&quot;=&amp;gt;[{&quot;text&quot;=&amp;gt;&quot;text1&quot;,
&quot;value&quot;=&amp;gt;&quot;value1&quot;}, {&quot;text&quot;=&amp;gt;&quot;text2&quot;, &quot;value&quot;=&amp;gt;&quot;value2&quot;},
{&quot;text&quot;=&amp;gt;&quot;text3&quot;, &quot;value&quot;=&amp;gt;&quot;value3&quot;}]}}&lt;/p&gt;
&lt;p&gt;But when you use button_to_remove to submit via Ajax, the values
are no longer properly grouped:&lt;/p&gt;
&lt;p&gt;Parameters: {&quot;commit&quot;=&amp;gt;&quot;Submit&quot;,
&quot;authenticity_token&quot;=&amp;gt;&quot;ZW+GHWqfHCpp4rDp67xYHn2a7iOJlbgLg1YYYVZJb9o=&quot;,
&quot;id&quot;=&amp;gt;&quot;1&quot;,
&quot;rule&quot;=&amp;gt;{&quot;condition_list&quot;=&amp;gt;[{&quot;text&quot;=&amp;gt;&quot;text1&quot;},
{&quot;text&quot;=&amp;gt;&quot;text2&quot;}, {&quot;text&quot;=&amp;gt;&quot;text3&quot;, &quot;value&quot;=&amp;gt;&quot;value1&quot;},
{&quot;value&quot;=&amp;gt;&quot;value2&quot;}, {&quot;value&quot;=&amp;gt;&quot;value3&quot;}]}}&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-10-13T17:19:47+01:00</created-at>
      <creator-id type="integer">18806</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">69</number>
      <permalink>urlencodedpairparser-creates-wrong-params-hash-with-nested-attributes-in-arrays</permalink>
      <priority type="integer">10472</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>actionpack bug request urlencodedpairparser</tag>
      <title>UrlEncodedPairParser creates wrong params hash with nested attributes in arrays</title>
      <updated-at type="datetime">2010-10-13T17:19:49+01:00</updated-at>
      <user-id type="integer">119715</user-id>
      <version type="integer">12</version>
      <user-name>Thomas Pedersen</user-name>
      <creator-name>Matthew Moore</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/69</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Automatic cleanup of spam.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Automatic cleanup of spam.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-10-19T08:27:32+01:00</created-at>
      <creator-id type="integer">18806</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: actionpack bug request urlencodedpairparser
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">69</number>
      <permalink>urlencodedpairparser-creates-wrong-params-hash-with-nested-attributes-in-arrays</permalink>
      <priority type="integer">10472</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>UrlEncodedPairParser creates wrong params hash with nested attributes in arrays</title>
      <updated-at type="datetime">2010-10-19T08:27:36+01:00</updated-at>
      <user-id type="integer">14998</user-id>
      <version type="integer">14</version>
      <user-name>Ryan Bigg</user-name>
      <creator-name>Matthew Moore</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/69</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>This issue has been automatically marked as stale because it has not been commented on for at least three months.

The resources of the Rails core team are limited, and so we are asking for your help. If you can still reproduce this error on the 3-0-stable branch or on master, please reply with all of the information you have about it and add &quot;[state:open]&quot; to your comment. This will reopen the ticket for review. Likewise, if you feel that this is a very important feature for Rails to include, please reply with your explanation so we can consider it.

Thank you for all your contributions, and we hope you will understand this step to focus our efforts where they are most helpful.</body>
      <body-html>&lt;div&gt;&lt;p&gt;This issue has been automatically marked as stale because it has
not been commented on for at least three months.&lt;/p&gt;
&lt;p&gt;The resources of the Rails core team are limited, and so we are
asking for your help. If you can still reproduce this error on the
3-0-stable branch or on master, please reply with all of the
information you have about it and add &quot;[state:open]&quot; to your
comment. This will reopen the ticket for review. Likewise, if you
feel that this is a very important feature for Rails to include,
please reply with your explanation so we can consider it.&lt;/p&gt;
&lt;p&gt;Thank you for all your contributions, and we hope you will
understand this step to focus our efforts where they are most
helpful.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2011-02-02T16:48:01+00:00</created-at>
      <creator-id type="integer">18806</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">69</number>
      <permalink>urlencodedpairparser-creates-wrong-params-hash-with-nested-attributes-in-arrays</permalink>
      <priority type="integer">10472</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag nil="true"></tag>
      <title>UrlEncodedPairParser creates wrong params hash with nested attributes in arrays</title>
      <updated-at type="datetime">2011-02-02T17:59:32+00:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">15</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>Matthew Moore</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/69</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body nil="true"></body>
      <body-html nil="true"></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2011-02-02T16:48:02+00:00</created-at>
      <creator-id type="integer">18806</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">69</number>
      <permalink>urlencodedpairparser-creates-wrong-params-hash-with-nested-attributes-in-arrays</permalink>
      <priority type="integer">10472</priority>
      <project-id type="integer">8994</project-id>
      <state>stale</state>
      <tag nil="true"></tag>
      <title>UrlEncodedPairParser creates wrong params hash with nested attributes in arrays</title>
      <updated-at type="datetime">2011-02-02T17:59:13+00:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">16</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>Matthew Moore</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/69</url>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>d96e4c234df88adf9515d5a555676f887f23ddb5</code>
      <content-type>text/x-ruby-script</content-type>
      <created-at type="datetime">2008-04-30T19:25:48+01:00</created-at>
      <filename>request_parameter_parsing_test.rb</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">20903</id>
      <size type="integer">7412</size>
      <uploader-id type="integer">18806</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/20903/request_parameter_parsing_test.rb</url>
    </attachment>
    <attachment type="Attachment">
      <code>cb6047313a97b820e48e0925f81209c387c7f38e</code>
      <content-type>application/octet-stream</content-type>
      <created-at type="datetime">2010-10-13T17:19:47+01:00</created-at>
      <filename>testhtml.erb</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">718265</id>
      <size type="integer">1068</size>
      <uploader-id type="integer">119715</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/718265/testhtml.erb</url>
    </attachment>
  </attachments>
</ticket>
