<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">15783</assigned-user-id>
  <attachments-count type="integer">6</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2008-10-23T01:38:16+01:00</created-at>
  <creator-id type="integer">17760</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">9903</milestone-id>
  <number type="integer">1255</number>
  <permalink>timeend_of_day-not-entirely-accurate</permalink>
  <priority type="integer">660</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>activesupport time usec</tag>
  <title>time.end_of_day not entirely accurate</title>
  <updated-at type="datetime">2009-08-09T16:04:01+01:00</updated-at>
  <user-id type="integer">17393</user-id>
  <version type="integer">23</version>
  <user-name>Repository</user-name>
  <creator-name>Ivan Vega</creator-name>
  <assigned-user-name>Geoff Buesing</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
  <milestone-title>2.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>Time.new.end_of_day.usec returns 0, and it should return 999999 instead, IMHO.

The relevant change is on line 210, simply from:

@@@ ruby
def end_of_day
  change(:hour =&gt; 23, :min =&gt; 59, :sec =&gt; 59)
end
@@@

to:

@@@ ruby
def end_of_day
  change(:hour =&gt; 23, :min =&gt; 59, :sec =&gt; 59, :usec =&gt; 999999)
end
@@@

I didn't create a patch because I thought the change is so minimal, but I will if you require it.

This is relevant on an application I'm experimenting with because I'm sorting records by a timestamp, and that sorting could be messed up as the order of two records with the same hour/min/sec would be unpredictable.</original-body>
  <latest-body>Time.new.end_of_day.usec returns 0, and it should return 999999 instead, IMHO.

The relevant change is on line 210, simply from:

@@@ ruby
def end_of_day
  change(:hour =&gt; 23, :min =&gt; 59, :sec =&gt; 59)
end
@@@

to:

@@@ ruby
def end_of_day
  change(:hour =&gt; 23, :min =&gt; 59, :sec =&gt; 59, :usec =&gt; 999999)
end
@@@

I didn't create a patch because I thought the change is so minimal, but I will if you require it.

This is relevant on an application I'm experimenting with because I'm sorting records by a timestamp, and that sorting could be messed up as the order of two records with the same hour/min/sec would be unpredictable.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;Time.new.end_of_day.usec returns 0, and it should return 999999
instead, IMHO.&lt;/p&gt;
&lt;p&gt;The relevant change is on line 210, simply from:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
def end_of_day
  change(:hour =&amp;gt; 23, :min =&amp;gt; 59, :sec =&amp;gt; 59)
end
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;to:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
def end_of_day
  change(:hour =&amp;gt; 23, :min =&amp;gt; 59, :sec =&amp;gt; 59, :usec =&amp;gt; 999999)
end
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I didn't create a patch because I thought the change is so
minimal, but I will if you require it.&lt;/p&gt;
&lt;p&gt;This is relevant on an application I'm experimenting with
because I'm sorting records by a timestamp, and that sorting could
be messed up as the order of two records with the same hour/min/sec
would be unpredictable.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Time.new.end_of_day.usec returns 0, and it should return 999999 instead, IMHO.

The relevant change is on line 210 of activesupport/lib/active_support/core_ext/time/calculations.rb, simply from:
@@@ ruby
def end_of_day
  change(:hour =&gt; 23, :min =&gt; 59, :sec =&gt; 59)
end
@@@

to:
@@@ ruby
def end_of_day
  change(:hour =&gt; 23, :min =&gt; 59, :sec =&gt; 59, :usec =&gt; 999999)
end
@@@

I didn't create a patch because I thought the change is so minimal, but I will if you require it.

This is relevant on an application I'm experimenting with because I'm sorting records by a timestamp, and that sorting could be messed up as the order of two records with the same hour/min/sec would be unpredictable.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Time.new.end_of_day.usec returns 0, and it should return 999999
instead, IMHO.&lt;/p&gt;
&lt;p&gt;The relevant change is on line 210 of
activesupport/lib/active_support/core_ext/time/calculations.rb,
simply from:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
def end_of_day
  change(:hour =&amp;gt; 23, :min =&amp;gt; 59, :sec =&amp;gt; 59)
end
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;to:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
def end_of_day
  change(:hour =&amp;gt; 23, :min =&amp;gt; 59, :sec =&amp;gt; 59, :usec =&amp;gt; 999999)
end
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I didn't create a patch because I thought the change is so
minimal, but I will if you require it.&lt;/p&gt;
&lt;p&gt;This is relevant on an application I'm experimenting with
because I'm sorting records by a timestamp, and that sorting could
be messed up as the order of two records with the same hour/min/sec
would be unpredictable.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-10-23T01:38:16+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activesupport time timestamps</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2008-10-23T02:40:29+01:00</updated-at>
      <user-id type="integer">17760</user-id>
      <version type="integer">1</version>
      <user-name>Ivan Vega</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-01-19T02:11:44+00:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activesupport time timestamps</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-01-19T02:11:46+00:00</updated-at>
      <user-id type="integer">1366</user-id>
      <version type="integer">2</version>
      <user-name>Pratik</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I can see how this would result unexpected behavior when you're sorting or comparing based on a timestamp -- you'd assume, for example, that any record that was created after the #end_of_day was created on the next day, but this would not necessarily be the case.

If we're going to go ahead and change #end_of_day, we should also change the other end_of_ methods: #end_of_week, #end_of_month, #end_of_quarter, #end_of_year.

Existing tests for these methods would break when we added :usec =&gt; 999999 to their implementations, so we'd need a patch that changed implementations and tests for these methods.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I can see how this would result unexpected behavior when you're
sorting or comparing based on a timestamp -- you'd assume, for
example, that any record that was created after the #end_of_day was
created on the next day, but this would not necessarily be the
case.&lt;/p&gt;
&lt;p&gt;If we're going to go ahead and change #end_of_day, we should
also change the other end_of_ methods: #end_of_week, #end_of_month,
#end_of_quarter, #end_of_year.&lt;/p&gt;
&lt;p&gt;Existing tests for these methods would break when we added :usec
=&amp;gt; 999999 to their implementations, so we'd need a patch that
changed implementations and tests for these methods.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-01-19T15:05:37+00:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: activesupport time timestamps
:state: new
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>activesupport time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-01-19T15:05:39+00:00</updated-at>
      <user-id type="integer">15783</user-id>
      <version type="integer">3</version>
      <user-name>Geoff Buesing</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Please reopen if you have a patch for this</body>
      <body-html>&lt;div&gt;&lt;p&gt;Please reopen if you have a patch for this&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-02-08T19:15:33+00:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>activesupport time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-02-08T19:15:35+00:00</updated-at>
      <user-id type="integer">15783</user-id>
      <version type="integer">4</version>
      <user-name>Geoff Buesing</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-05T13:34:41+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: activesupport time usec
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>activesupport bugmash time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-05T13:34:46+01:00</updated-at>
      <user-id type="integer">7211</user-id>
      <version type="integer">5</version>
      <user-name>CancelProfileIsBroken</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Attached patch to fix all of the end_of methods: #end_of_day, #end_of_week, #end_of_month, #end_of_quarter, and #end_of_year.  I've also updated the tests for these methods to check for the correct usec value.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Attached patch to fix all of the end_of methods: #end_of_day,
#end_of_week, #end_of_month, #end_of_quarter, and #end_of_year.
I've also updated the tests for these methods to check for the
correct usec value.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-07T02:26:53+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>activesupport bugmash time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-07T02:26:59+01:00</updated-at>
      <user-id type="integer">45230</user-id>
      <version type="integer">6</version>
      <user-name>Matt Duncan</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>@Matt - thanks for this patch.

One issue: your updated docs for Date#end_of_ methods say that &quot;DateTime objects will have time set to 23:59:59.999999&quot;, but this isn't true -- the existing tests confirm this (you're passing a :usec value into DateTime change, but that doesn't do anything.)

We *could* go forward without worrying about DateTime. DateTime has a weird sec_fraction value that's a Rational; I don't know how that would translate into usec, or something similar.</body>
      <body-html>&lt;div&gt;&lt;p&gt;@Matt - thanks for this patch.&lt;/p&gt;
&lt;p&gt;One issue: your updated docs for Date#end_of_ methods say that
&quot;DateTime objects will have time set to 23:59:59.999999&quot;, but this
isn't true -- the existing tests confirm this (you're passing a
:usec value into DateTime change, but that doesn't do
anything.)&lt;/p&gt;
&lt;p&gt;We &lt;em&gt;could&lt;/em&gt; go forward without worrying about DateTime.
DateTime has a weird sec_fraction value that's a Rational; I don't
know how that would translate into usec, or something similar.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-07T03:41:17+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>activesupport bugmash time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-07T03:41:19+01:00</updated-at>
      <user-id type="integer">15783</user-id>
      <version type="integer">7</version>
      <user-name>Geoff Buesing</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>@Geoff - Here is the fixed patch, it includes only changes to the Time#end_of_ methods.</body>
      <body-html>&lt;div&gt;&lt;p&gt;@Geoff - Here is the fixed patch, it includes only changes to
the Time#end_of_ methods.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-08T00:04:36+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>activesupport bugmash time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-08T00:04:42+01:00</updated-at>
      <user-id type="integer">45230</user-id>
      <version type="integer">8</version>
      <user-name>Matt Duncan</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>The patch applies successfully and all tests pass.

The tests look good, and the new functionality makes sense to me.

+1</body>
      <body-html>&lt;div&gt;&lt;p&gt;The patch applies successfully and all tests pass.&lt;/p&gt;
&lt;p&gt;The tests look good, and the new functionality makes sense to
me.&lt;/p&gt;
&lt;p&gt;+1&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-08T01:46:53+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>activesupport bugmash time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-08T01:46:57+01:00</updated-at>
      <user-id type="integer">20273</user-id>
      <version type="integer">9</version>
      <user-name>Josh Sharpe</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>+1 for the idea, but the patch doesn't apply to 2-3-stable.
I've attached a patch that works. It was probably due to all the recent commits or something.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 for the idea, but the patch doesn't apply to 2-3-stable. I've
attached a patch that works. It was probably due to all the recent
commits or something.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-09T04:27:12+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>activesupport bugmash time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-09T04:27:16+01:00</updated-at>
      <user-id type="integer">30376</user-id>
      <version type="integer">10</version>
      <user-name>Hugo Peixoto</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>verified

+1 The patch by Hugo works on 2-3-stable.</body>
      <body-html>&lt;div&gt;&lt;p&gt;verified&lt;/p&gt;
&lt;p&gt;+1 The patch by Hugo works on 2-3-stable.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-09T04:33:39+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>activesupport bugmash time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-09T04:33:44+01:00</updated-at>
      <user-id type="integer">65556</user-id>
      <version type="integer">11</version>
      <user-name>Rizwan Reza</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Hugo, I see the following two stylistic items got changed in your patch (vs my original):

@@@ ruby
# Extra space before closing paren:
last_day = ::Time.days_in_month( self.month, self.year )

# Missing space after first comma:
# (and while it's being fixed, the spacing around the second comma could probably be fixed also)
change(:month =&gt; 12,:day =&gt; 31,:hour =&gt; 23, :min =&gt; 59, :sec =&gt; 59)
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;Hugo, I see the following two stylistic items got changed in
your patch (vs my original):&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;# Extra space before closing paren:
last_day = ::Time.days_in_month( self.month, self.year )

# Missing space after first comma:
# (and while it's being fixed, the spacing around the second comma could probably be fixed also)
change(:month =&amp;gt; 12,:day =&amp;gt; 31,:hour =&amp;gt; 23, :min =&amp;gt; 59, :sec =&amp;gt; 59)&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-09T05:54:22+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>activesupport bugmash time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-09T05:54:26+01:00</updated-at>
      <user-id type="integer">45230</user-id>
      <version type="integer">12</version>
      <user-name>Matt Duncan</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>+1 for Hugo's patch for 2-3. Uploading one compatible with master branch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 for Hugo's patch for 2-3. Uploading one compatible with
master branch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-09T06:42:14+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>activesupport bugmash time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-09T06:42:19+01:00</updated-at>
      <user-id type="integer">26790</user-id>
      <version type="integer">13</version>
      <user-name>Kieran P</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-09T07:08:44+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- 
:title: time.end_of_day not entirely accurate
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>activesupport bugmash time usec</tag>
      <title>[PATCH] time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-09T07:08:46+01:00</updated-at>
      <user-id type="integer">26790</user-id>
      <version type="integer">14</version>
      <user-name>Kieran P</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>One downside is that this complicates compatibility with Ruby 1.9.2. It has Time#nsec - nanosecond resolution.</body>
      <body-html>&lt;div&gt;&lt;p&gt;One downside is that this complicates compatibility with Ruby
1.9.2. It has Time#nsec - nanosecond resolution.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-09T09:40:03+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- 
:state: incomplete
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>activesupport bugmash time usec</tag>
      <title>[PATCH] time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-09T09:40:06+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">15</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-09T09:40:18+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- 
:title: &quot;[PATCH] time.end_of_day not entirely accurate&quot;
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>activesupport bugmash time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-09T09:40:23+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">16</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>I've attached a patch for master that supposedly on master, with both ruby1.8 and 1.9. Please test it, as my 1.9 setup is kind of broken.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've attached a patch for master that supposedly on master, with
both ruby1.8 and 1.9. Please test it, as my 1.9 setup is kind of
broken.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-09T13:05:55+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>activesupport bugmash time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-09T13:06:00+01:00</updated-at>
      <user-id type="integer">30376</user-id>
      <version type="integer">17</version>
      <user-name>Hugo Peixoto</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">5</attachments-count>
      <body>+1 Hugo's patch applied cleanly on master, with ruby 1.8</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 Hugo's patch applied cleanly on master, with ruby 1.8&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-09T13:28:14+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>activesupport bugmash time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-09T13:28:18+01:00</updated-at>
      <user-id type="integer">54601</user-id>
      <version type="integer">18</version>
      <user-name>railsbob</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">5</attachments-count>
      <body>+1 Hugo's patch applied on master with ruby 1.9.2.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 Hugo's patch applied on master with ruby 1.9.2.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-09T13:33:03+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>activesupport bugmash time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-09T13:33:07+01:00</updated-at>
      <user-id type="integer">64156</user-id>
      <version type="integer">19</version>
      <user-name>Nikolay Petrachkov </user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">5</attachments-count>
      <body>Here's the 2-3-stable patch. Please test it in ruby 1.9.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Here's the 2-3-stable patch. Please test it in ruby 1.9.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-09T14:10:09+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>activesupport bugmash time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-09T14:10:15+01:00</updated-at>
      <user-id type="integer">30376</user-id>
      <version type="integer">20</version>
      <user-name>Hugo Peixoto</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">6</attachments-count>
      <body>Both patches (master and 2-3) pass on both 1.8.7 and 1.9.1.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Both patches (master and 2-3) pass on both 1.8.7 and 1.9.1.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-08-09T14:26:09+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>activesupport bugmash time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-09T14:26:12+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">21</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">6</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-09T16:01:59+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: activesupport bugmash time usec
:state: open
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>activesupport time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-09T16:02:05+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">22</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15783</assigned-user-id>
      <attachments-count type="integer">6</attachments-count>
      <body>(from [3545d6b0b227cc9ee4a645097bdbd43b33b42a87]) Setting usec (and nsec for Ruby 1.9) on Time#end_of_* methods [#1255 status:resolved]

Signed-off-by: Jos&#233; Valim &lt;jose.valim@gmail.com&gt;
http://github.com/rails/rails/commit/3545d6b0b227cc9ee4a645097bdbd43b33b42a87</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/3545d6b0b227cc9ee4a645097bdbd43b33b42a87&quot;
title=
&quot;Changeset [3545d6b0b227cc9ee4a645097bdbd43b33b42a87]&quot;&gt;[3545d6b0b227cc9ee4a645097bdbd43b33b42a87]&lt;/a&gt;)
Setting usec (and nsec for Ruby 1.9) on Time#end_of_* methods
[&lt;a href=&quot;/projects/8994/tickets/1255&quot; title=
&quot;Ticket #1255&quot;&gt;#1255&lt;/a&gt; status:resolved]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jos&amp;eacute; Valim &lt;a href=
&quot;mailto:jose.valim@gmail.com&quot;&gt;jose.valim@gmail.com&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/3545d6b0b227cc9ee4a645097bdbd43b33b42a87&quot;&gt;
http://github.com/rails/rails/commit/3545d6b0b227cc9ee4a645097bdbd4...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-08-09T16:03:59+01:00</created-at>
      <creator-id type="integer">17760</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1255</number>
      <permalink>timeend_of_day-not-entirely-accurate</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>activesupport time usec</tag>
      <title>time.end_of_day not entirely accurate</title>
      <updated-at type="datetime">2009-08-09T16:04:01+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">23</version>
      <user-name>Repository</user-name>
      <creator-name>Ivan Vega</creator-name>
      <assigned-user-name>Geoff Buesing</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1255</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>2b1e8a4ef1b1f1ebfaba2254917454788d317ea4</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-08-07T02:26:53+01:00</created-at>
      <filename>1255.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">238163</id>
      <size type="integer">12316</size>
      <uploader-id type="integer">45230</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/238163/1255.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>8bbc7481280dbd7acd8183782595a1d07e1529a1</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-08-08T00:04:36+01:00</created-at>
      <filename>1255.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">238876</id>
      <size type="integer">8184</size>
      <uploader-id type="integer">45230</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/238876/1255.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>2d0573c415c5e6d616585e423f7f06e92a8f238e</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-08-09T04:27:12+01:00</created-at>
      <filename>1255-setting-usec-on-time-end_of_-methods.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">239248</id>
      <size type="integer">8432</size>
      <uploader-id type="integer">30376</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/239248/1255-setting-usec-on-time-end_of_-methods.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>b46fa93772f132039e151ebc7f178c3812d7d41f</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-08-09T06:42:14+01:00</created-at>
      <filename>1125-Setting-usec-on-Time-end_of_-methods-ported-to-maste.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">239282</id>
      <size type="integer">8688</size>
      <uploader-id type="integer">26790</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/239282/1125-Setting-usec-on-Time-end_of_-methods-ported-to-maste.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>5ea30f90d8114a40510051c612fc161ffe218b0a</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-08-09T13:05:55+01:00</created-at>
      <filename>1255-setting-usec-or-nsec-on-time-end_of_-methods-master.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">239336</id>
      <size type="integer">17586</size>
      <uploader-id type="integer">30376</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/239336/1255-setting-usec-or-nsec-on-time-end_of_-methods-master.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>aeb101547cfb601870f7d24ab317cf9200fe89e7</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-08-09T14:10:10+01:00</created-at>
      <filename>1255-setting-usec-or-nsec-on-time-end_of_-methods-2-3-stable.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">239347</id>
      <size type="integer">9103</size>
      <uploader-id type="integer">30376</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/239347/1255-setting-usec-or-nsec-on-time-end_of_-methods-2-3-stable.diff</url>
    </attachment>
  </attachments>
</ticket>
