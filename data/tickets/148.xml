<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2008-05-08T20:34:38+01:00</created-at>
  <creator-id type="integer">19338</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer" nil="true"></milestone-id>
  <number type="integer">148</number>
  <permalink>actionmailer-url-generation-uses-host-port-from-request</permalink>
  <priority type="integer">11883</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>invalid</state>
  <tag>mailer patch tested url</tag>
  <title>ActionMailer URL generation uses host/port from request</title>
  <updated-at type="datetime">2008-05-20T18:55:59+01:00</updated-at>
  <user-id type="integer">1366</user-id>
  <version type="integer">2</version>
  <user-name>Pratik</user-name>
  <creator-name>Nathan Wilmes</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/148</url>
  <priority-name nil="true"></priority-name>
  <original-body>ActionMailer relies on the UrlWriter module to generate all of the URLs needed for links.  Because UrlWriter doesn't know anything about the current request, it becomes extremely hard to make the link aware of domain information (host/port/protocol).  The Rails doc examples refer to using setting default_url_options in your mailer definitions, which means that they cannot be environment aware.  Another solution I've seen used is to set domain-related model variables to be used by the mailer templates.

The following patch is a (simplified) version of Nick Kallen's Retardase Inhibitor, with his blessings.  Check this link out for more details:

http://pivots.pivotallabs.com/users/nick/blog/articles/281-how-i-learned-to-stop-hating-and-love-action-mailer</original-body>
  <latest-body>ActionMailer relies on the UrlWriter module to generate all of the URLs needed for links.  Because UrlWriter doesn't know anything about the current request, it becomes extremely hard to make the link aware of domain information (host/port/protocol).  The Rails doc examples refer to using setting default_url_options in your mailer definitions, which means that they cannot be environment aware.  Another solution I've seen used is to set domain-related model variables to be used by the mailer templates.

The following patch is a (simplified) version of Nick Kallen's Retardase Inhibitor, with his blessings.  Check this link out for more details:

http://pivots.pivotallabs.com/users/nick/blog/articles/281-how-i-learned-to-stop-hating-and-love-action-mailer</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;
ActionMailer relies on the UrlWriter module to generate all of the URLs needed for links.  Because UrlWriter doesn't know anything about the current request, it becomes extremely hard to make the link aware of domain information (host/port/protocol).  The Rails doc examples refer to using setting default_url_options in your mailer definitions, which means that they cannot be environment aware.  Another solution I've seen used is to set domain-related model variables to be used by the mailer templates.
&lt;/p&gt;&lt;p&gt;
The following patch is a (simplified) version of Nick Kallen's Retardase Inhibitor, with his blessings.  Check this link out for more details:
&lt;/p&gt;&lt;p&gt;
&lt;a href=&quot;http://pivots.pivotallabs.com/users/nick/blog/articles/281-how-i-learned-to-stop-hating-and-love-action-mailer&quot;&gt;http://pivots.pivotallabs.com/us...&lt;/a&gt;
&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>ActionMailer relies on the UrlWriter module to generate all of the URLs needed for links.  Because UrlWriter doesn't know anything about the current request, it becomes extremely hard to make the link aware of domain information (host/port/protocol).  The Rails doc examples refer to using setting default_url_options in your mailer definitions, which means that they cannot be environment aware.  Another solution I've seen used is to set domain-related model variables to be used by the mailer templates.

The following patch is a (simplified) version of Nick Kallen's Retardase Inhibitor, with his blessings.  Check this link out for more details:

http://pivots.pivotallabs.com/users/nick/blog/articles/281-how-i-learned-to-stop-hating-and-love-action-mailer</body>
      <body-html>&lt;div&gt;&lt;p&gt;
ActionMailer relies on the UrlWriter module to generate all of the URLs needed for links.  Because UrlWriter doesn't know anything about the current request, it becomes extremely hard to make the link aware of domain information (host/port/protocol).  The Rails doc examples refer to using setting default_url_options in your mailer definitions, which means that they cannot be environment aware.  Another solution I've seen used is to set domain-related model variables to be used by the mailer templates.
&lt;/p&gt;&lt;p&gt;
The following patch is a (simplified) version of Nick Kallen's Retardase Inhibitor, with his blessings.  Check this link out for more details:
&lt;/p&gt;&lt;p&gt;
&lt;a href=&quot;http://pivots.pivotallabs.com/users/nick/blog/articles/281-how-i-learned-to-stop-hating-and-love-action-mailer&quot;&gt;http://pivots.pivotallabs.com/us...&lt;/a&gt;
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-05-08T20:34:39+01:00</created-at>
      <creator-id type="integer">19338</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">148</number>
      <permalink>actionmailer-url-generation-uses-host-port-from-request</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>ActionMailer URL generation uses host/port from request</title>
      <updated-at type="datetime">2008-05-08T20:34:39+01:00</updated-at>
      <user-id type="integer">19338</user-id>
      <version type="integer">1</version>
      <user-name>Nathan Wilmes</user-name>
      <creator-name>Nathan Wilmes</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/148</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I don't like the way the patch does UrlWriter.set_default_url_options_from_request(request). We've been trying to remove such changes which requires a mutex around dispatching requests.

Thanks.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
I don't like the way the patch does UrlWriter.set_default_url_options_from_request(request). We've been trying to remove such changes which requires a mutex around dispatching requests.
&lt;/p&gt;&lt;p&gt;
Thanks.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-05-20T18:55:59+01:00</created-at>
      <creator-id type="integer">19338</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">148</number>
      <permalink>actionmailer-url-generation-uses-host-port-from-request</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag nil="true"></tag>
      <title>ActionMailer URL generation uses host/port from request</title>
      <updated-at type="datetime">2008-05-20T18:55:59+01:00</updated-at>
      <user-id type="integer">1366</user-id>
      <version type="integer">2</version>
      <user-name>Pratik</user-name>
      <creator-name>Nathan Wilmes</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/148</url>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>09b13cb7f6dcb4c14db79f630da401a95b73bade</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2008-05-08T20:34:39+01:00</created-at>
      <filename>set_url_writer_default_options.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">22141</id>
      <size type="integer">6136</size>
      <uploader-id type="integer">19338</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/22141/set_url_writer_default_options.diff</url>
    </attachment>
  </attachments>
</ticket>
