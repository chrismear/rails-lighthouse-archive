<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">22589</assigned-user-id>
  <attachments-count type="integer">2</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-05-05T19:50:25+01:00</created-at>
  <creator-id type="integer">13680</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">9903</milestone-id>
  <number type="integer">2609</number>
  <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
  <priority type="integer">1742</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>committed</state>
  <tag>2-3-stable dependencies gems patch</tag>
  <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
  <updated-at type="datetime">2009-06-06T07:06:36+01:00</updated-at>
  <user-id type="integer">17393</user-id>
  <version type="integer">19</version>
  <user-name>Repository</user-name>
  <creator-name>Tim Connor</creator-name>
  <assigned-user-name>Matt Jones</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
  <milestone-title>2.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>There is still a &quot;already activated version x.y&quot; problem in the gem loading.  If you have a frozen gem with unfrozen dependencies (for instance if the dependency has native extensions so can't be frozen) you can have a nightmare upgrade problem, where you cannot rake gems:install, because rake is broken by a gem loading problem.

If you bump up your frozen gem to a newer version that requires a newer dependency, everybody else on the team will have rake broken by that dependency mismatch, since you will have had to specify the dependency in your config.gems, otherwise nobody will have installed it, since the parent is frozen.  And now the config.gems loading code will kill rake.</original-body>
  <latest-body>There is still a &quot;already activated version x.y&quot; problem in the gem loading.  If you have a frozen gem with unfrozen dependencies (for instance if the dependency has native extensions so can't be frozen) you can have a nightmare upgrade problem, where you cannot rake gems:install, because rake is broken by a gem loading problem.

If you bump up your frozen gem to a newer version that requires a newer dependency, everybody else on the team will have rake broken by that dependency mismatch, since you will have had to specify the dependency in your config.gems, otherwise nobody will have installed it, since the parent is frozen.  And now the config.gems loading code will kill rake.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;There is still a &quot;already activated version x.y&quot; problem in the
gem loading. If you have a frozen gem with unfrozen dependencies
(for instance if the dependency has native extensions so can't be
frozen) you can have a nightmare upgrade problem, where you cannot
rake gems:install, because rake is broken by a gem loading
problem.&lt;/p&gt;
&lt;p&gt;If you bump up your frozen gem to a newer version that requires
a newer dependency, everybody else on the team will have rake
broken by that dependency mismatch, since you will have had to
specify the dependency in your config.gems, otherwise nobody will
have installed it, since the parent is frozen. And now the
config.gems loading code will kill rake.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>There is still a &quot;already activated version x.y&quot; problem in the gem loading.  If you have a frozen gem with unfrozen dependencies (for instance if the dependency has native extensions so can't be frozen) you can have a nightmare upgrade problem, where you cannot rake gems:install, because rake is broken by a gem loading problem.

If you bump up your frozen gem to a newer version that requires a newer dependency, everybody else on the team will have rake broken by that dependency mismatch, since you will have had to specify the dependency in your config.gems, otherwise nobody will have installed it, since the parent is frozen.  And now the config.gems loading code will kill rake.</body>
      <body-html>&lt;div&gt;&lt;p&gt;There is still a &quot;already activated version x.y&quot; problem in the
gem loading. If you have a frozen gem with unfrozen dependencies
(for instance if the dependency has native extensions so can't be
frozen) you can have a nightmare upgrade problem, where you cannot
rake gems:install, because rake is broken by a gem loading
problem.&lt;/p&gt;
&lt;p&gt;If you bump up your frozen gem to a newer version that requires
a newer dependency, everybody else on the team will have rake
broken by that dependency mismatch, since you will have had to
specify the dependency in your config.gems, otherwise nobody will
have installed it, since the parent is frozen. And now the
config.gems loading code will kill rake.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-05T19:50:25+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-05-05T19:50:27+01:00</updated-at>
      <user-id type="integer">13680</user-id>
      <version type="integer">1</version>
      <user-name>Tim Connor</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>It's not just frozen gems.  If you have gruff installed, for instance, it will require rmagick.  If you specify a newer version of rmagick (for whatever reason) in your config.gems then rake will die.</body>
      <body-html>&lt;div&gt;&lt;p&gt;It's not just frozen gems. If you have gruff installed, for
instance, it will require rmagick. If you specify a newer version
of rmagick (for whatever reason) in your config.gems then rake will
die.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-05T20:36:13+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-05-05T20:36:17+01:00</updated-at>
      <user-id type="integer">13680</user-id>
      <version type="integer">2</version>
      <user-name>Tim Connor</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>The generalized problem is having a gem both as a dependency and specified on it's own will crash rake gems out, if you have an older version of the gem installed than specified on the config.gems line</body>
      <body-html>&lt;div&gt;&lt;p&gt;The generalized problem is having a gem both as a dependency and
specified on it's own will crash rake gems out, if you have an
older version of the gem installed than specified on the
config.gems line&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-05T20:50:01+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-05-05T20:50:04+01:00</updated-at>
      <user-id type="integer">13680</user-id>
      <version type="integer">3</version>
      <user-name>Tim Connor</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Whereas having an outdated dependency installed without specifying it in config.gems will not kill rake outright, but will crash rake gems at the point in it's listing where it hits the dependency.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Whereas having an outdated dependency installed without
specifying it in config.gems will not kill rake outright, but will
crash rake gems at the point in it's listing where it hits the
dependency.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-05T20:53:17+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-05-05T20:53:21+01:00</updated-at>
      <user-id type="integer">13680</user-id>
      <version type="integer">4</version>
      <user-name>Tim Connor</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>This at least fixes the worst of the problem - the fact that you can't even run rake gems to check on what is wrong, or rake gems:install to fix it.  Rake can still be broken in other ways, by config.gems, but that is to be expected with complex dependencies.  It's just a hassle when it can't be fixes by the tasks designed to do so.


http://github.com/timocratic/rails/commit/220d14a29994b745af200cdaa1fd6f0f27afb9dd</body>
      <body-html>&lt;div&gt;&lt;p&gt;This at least fixes the worst of the problem - the fact that you
can't even run rake gems to check on what is wrong, or rake
gems:install to fix it. Rake can still be broken in other ways, by
config.gems, but that is to be expected with complex dependencies.
It's just a hassle when it can't be fixes by the tasks designed to
do so.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/timocratic/rails/commit/220d14a29994b745af200cdaa1fd6f0f27afb9dd&quot;&gt;
http://github.com/timocratic/rai...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-06T19:05:11+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-05-06T19:05:15+01:00</updated-at>
      <user-id type="integer">13680</user-id>
      <version type="integer">5</version>
      <user-name>Tim Connor</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>adding patch as preferred according to contrib guide</body>
      <body-html>&lt;div&gt;&lt;p&gt;adding patch as preferred according to contrib guide&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-06T21:07:24+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 2-3-stable dependencies gems
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems patch</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-05-06T21:07:26+01:00</updated-at>
      <user-id type="integer">13680</user-id>
      <version type="integer">6</version>
      <user-name>Tim Connor</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">22589</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Can you offer more detail on the &quot;crashing out&quot; part? The error you're seeing ('already activated version x.y') shouldn't be coming from the load call, but from add_load_paths.

Note that some of this is not exactly fixable - the current behavior is to activate the frozen version if no requirement prohibits it. The only way around that might be to config.gem the correct version *before* the other gem that depends on it (in your example, put config.gem for rmagick's higher version before config.gem 'gruff').</body>
      <body-html>&lt;div&gt;&lt;p&gt;Can you offer more detail on the &quot;crashing out&quot; part? The error
you're seeing ('already activated version x.y') shouldn't be coming
from the load call, but from add_load_paths.&lt;/p&gt;
&lt;p&gt;Note that some of this is not exactly fixable - the current
behavior is to activate the frozen version if no requirement
prohibits it. The only way around that might be to config.gem the
correct version &lt;em&gt;before&lt;/em&gt; the other gem that depends on it
(in your example, put config.gem for rmagick's higher version
before config.gem 'gruff').&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-07T01:26:32+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems patch</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-05-07T01:26:33+01:00</updated-at>
      <user-id type="integer">22589</user-id>
      <version type="integer">7</version>
      <user-name>Matt Jones</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name>Matt Jones</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">22589</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>The problem isn't just with the load_paths, it's with the require from the dependency when the parent gets loaded.

&quot;rake aborted!
can't activate , already activated ...&quot;

Here is a slightly simpler one (doesn't involve building rmagick) Start a new rails project.  Add config.gem &quot;mechanize&quot; and install the latest version (0.9.2).  Uninstall any version of nokogiri  &gt;= 1.2.1. Install nokogiri 1.2.0.  Now rake will crash even when trying to run rake gems or rake gems:install.

Now freeze rails and apply my patch and rake gems works, which allows you to install/update any needed gem dependencies.</body>
      <body-html>&lt;div&gt;&lt;p&gt;The problem isn't just with the load_paths, it's with the
require from the dependency when the parent gets loaded.&lt;/p&gt;
&lt;p&gt;&quot;rake aborted! can't activate , already activated ...&quot;&lt;/p&gt;
&lt;p&gt;Here is a slightly simpler one (doesn't involve building
rmagick) Start a new rails project. Add config.gem &quot;mechanize&quot; and
install the latest version (0.9.2). Uninstall any version of
nokogiri &amp;gt;= 1.2.1. Install nokogiri 1.2.0. Now rake will crash
even when trying to run rake gems or rake gems:install.&lt;/p&gt;
&lt;p&gt;Now freeze rails and apply my patch and rake gems works, which
allows you to install/update any needed gem dependencies.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-07T05:59:43+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems patch</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-05-07T05:59:47+01:00</updated-at>
      <user-id type="integer">13680</user-id>
      <version type="integer">8</version>
      <user-name>Tim Connor</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name>Matt Jones</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">22589</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>As I later figured out, and commented about, it's not just a problem with frozen gems, but any dependencies when you have an older version of the gem.  And it's easily fixed (at least as far as letting the rake gems tasks run, so that it can fix itself) by not trying to load the gems for the rake gems tasks.</body>
      <body-html>&lt;div&gt;&lt;p&gt;As I later figured out, and commented about, it's not just a
problem with frozen gems, but any dependencies when you have an
older version of the gem. And it's easily fixed (at least as far as
letting the rake gems tasks run, so that it can fix itself) by not
trying to load the gems for the rake gems tasks.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-07T06:07:08+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems patch</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-05-07T06:07:10+01:00</updated-at>
      <user-id type="integer">13680</user-id>
      <version type="integer">9</version>
      <user-name>Tim Connor</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name>Matt Jones</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">22589</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Yes this is a contrived example, but it definitely comes up in real situations, and frequently if you have enough complicated gem dependencies.

My tiny patch doesn't fix that rake gems:install won't pick up and install any dependencies, but it at least makes it work without crashing if you also have them specified separately (as may be the case with something like gruff and rmagick).  This eases maintenance in that you can at least just manually list all of your gems and their dependencies and then rake gems:install will always work as expected.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Yes this is a contrived example, but it definitely comes up in
real situations, and frequently if you have enough complicated gem
dependencies.&lt;/p&gt;
&lt;p&gt;My tiny patch doesn't fix that rake gems:install won't pick up
and install any dependencies, but it at least makes it work without
crashing if you also have them specified separately (as may be the
case with something like gruff and rmagick). This eases maintenance
in that you can at least just manually list all of your gems and
their dependencies and then rake gems:install will always work as
expected.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-07T06:17:40+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems patch</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-05-07T06:17:42+01:00</updated-at>
      <user-id type="integer">13680</user-id>
      <version type="integer">10</version>
      <user-name>Tim Connor</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name>Matt Jones</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">22589</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>&quot;any &lt;missing&gt; dependencies &lt;of already installed gems&gt;&quot; sorry left out some words that might have made my point clearer.</body>
      <body-html>&lt;div&gt;&lt;p&gt;&quot;any dependencies &quot; sorry left out some words that might have
made my point clearer.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-07T06:18:33+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems patch</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-05-07T06:18:36+01:00</updated-at>
      <user-id type="integer">13680</user-id>
      <version type="integer">11</version>
      <user-name>Tim Connor</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name>Matt Jones</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">22589</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Damn, sorry formatting stripped that last post

&quot;any (missing) dependencies (of already installed gems)&quot;</body>
      <body-html>&lt;div&gt;&lt;p&gt;Damn, sorry formatting stripped that last post&lt;/p&gt;
&lt;p&gt;&quot;any (missing) dependencies (of already installed gems)&quot;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-07T06:19:27+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems patch</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-05-07T06:19:28+01:00</updated-at>
      <user-id type="integer">13680</user-id>
      <version type="integer">12</version>
      <user-name>Tim Connor</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name>Matt Jones</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">22589</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Tim:

Your patch looks like it should work, but it is based on your app and not the Rails codebase.

Check out a version of the Rails codebase

@@@
git clone git://github.com/rails/rails.git
@@@

Make your changes, and follow the instructions in the contrib guide for creating a patch.

Even better would be to include two patches, one against master and the other against 2-3-stable.

If you need any help with this, feel free to shoot me an email at ddollar@gmail.com or find me as ddollar in #rails-contrib on Freenode.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Tim:&lt;/p&gt;
&lt;p&gt;Your patch looks like it should work, but it is based on your
app and not the Rails codebase.&lt;/p&gt;
&lt;p&gt;Check out a version of the Rails codebase&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;git clone git://github.com/rails/rails.git&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Make your changes, and follow the instructions in the contrib
guide for creating a patch.&lt;/p&gt;
&lt;p&gt;Even better would be to include two patches, one against master
and the other against 2-3-stable.&lt;/p&gt;
&lt;p&gt;If you need any help with this, feel free to shoot me an email
at &lt;a href=&quot;mailto:ddollar@gmail.com&quot;&gt;ddollar@gmail.com&lt;/a&gt; or find
me as ddollar in #rails-contrib on Freenode.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-21T21:38:32+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems patch</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-05-21T21:38:37+01:00</updated-at>
      <user-id type="integer">8721</user-id>
      <version type="integer">13</version>
      <user-name>David Dollar</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name>Matt Jones</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">22589</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Doh - I know better than that.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Doh - I know better than that.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-21T22:56:16+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems patch</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-05-21T22:56:23+01:00</updated-at>
      <user-id type="integer">13680</user-id>
      <version type="integer">14</version>
      <user-name>Tim Connor</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name>Matt Jones</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">22589</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Good to go, thanks David.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Good to go, thanks David.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-21T23:00:32+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems patch</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-05-21T23:00:35+01:00</updated-at>
      <user-id type="integer">13680</user-id>
      <version type="integer">15</version>
      <user-name>Tim Connor</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name>Matt Jones</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">22589</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>+1</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-05-21T23:13:11+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems patch</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-05-21T23:13:15+01:00</updated-at>
      <user-id type="integer">8721</user-id>
      <version type="integer">16</version>
      <user-name>David Dollar</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name>Matt Jones</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">22589</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>+1</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-06-06T03:33:34+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2-3-stable dependencies gems patch</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-06-06T03:33:37+01:00</updated-at>
      <user-id type="integer">1819</user-id>
      <version type="integer">17</version>
      <user-name>Tammer Saleh</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name>Matt Jones</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">22589</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>(from [6a3f8ae4075042f122d493208f18ecfb797b38ae]) Work around a gem dependency edge case that prevents Rails from booting..

If you have a frozen gem with unfrozen dependencies (for instance if the
dependency has native extensions so can't be frozen) you can have a
nightmare upgrade problem, where you cannot rake gems:install, because
rake is broken by a gem loading problem.

If you bump up your frozen gem to a newer version that requires a newer
dependency, everybody else on the team will have rake broken by that
dependency mismatch, since you will have had to specify the dependency
in your config.gems, otherwise nobody will have installed it, since the
parent is frozen. And now the config.gems loading code will kill rake.

[#2609 state:committed]

Signed-off-by: Jeremy Kemper &lt;jeremy@bitsweat.net&gt;
http://github.com/rails/rails/commit/6a3f8ae4075042f122d493208f18ecfb797b38ae</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/6a3f8ae4075042f122d493208f18ecfb797b38ae&quot;
title=
&quot;Changeset [6a3f8ae4075042f122d493208f18ecfb797b38ae]&quot;&gt;[6a3f8ae4075042f122d493208f18ecfb797b38ae]&lt;/a&gt;)
Work around a gem dependency edge case that prevents Rails from
booting..&lt;/p&gt;
&lt;p&gt;If you have a frozen gem with unfrozen dependencies (for
instance if the&lt;br&gt;
dependency has native extensions so can't be frozen) you can have
a&lt;br&gt;
nightmare upgrade problem, where you cannot rake gems:install,
because&lt;br&gt;
rake is broken by a gem loading problem.&lt;/p&gt;
&lt;p&gt;If you bump up your frozen gem to a newer version that requires
a newer&lt;br&gt;
dependency, everybody else on the team will have rake broken by
that&lt;br&gt;
dependency mismatch, since you will have had to specify the
dependency&lt;br&gt;
in your config.gems, otherwise nobody will have installed it, since
the&lt;br&gt;
parent is frozen. And now the config.gems loading code will kill
rake.&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;/projects/8994/tickets/2609&quot; title=
&quot;Ticket #2609&quot;&gt;#2609&lt;/a&gt; state:committed]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jeremy Kemper &lt;a&gt;jeremy@bitsweat.net&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/6a3f8ae4075042f122d493208f18ecfb797b38ae&quot;&gt;
http://github.com/rails/rails/commit/6a3f8ae4075042f122d493208f18ec...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-06-06T07:05:28+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>2-3-stable dependencies gems patch</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-06-06T07:05:29+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">18</version>
      <user-name>Repository</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name>Matt Jones</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">22589</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>(from [84a755b27e615da4a51b6e4c042491b6d807bcf8]) Work around a gem dependency edge case that prevents Rails from booting..

If you have a frozen gem with unfrozen dependencies (for instance if the
dependency has native extensions so can't be frozen) you can have a
nightmare upgrade problem, where you cannot rake gems:install, because
rake is broken by a gem loading problem.

If you bump up your frozen gem to a newer version that requires a newer
dependency, everybody else on the team will have rake broken by that
dependency mismatch, since you will have had to specify the dependency
in your config.gems, otherwise nobody will have installed it, since the
parent is frozen. And now the config.gems loading code will kill rake.

[#2609 state:committed]

Signed-off-by: Jeremy Kemper &lt;jeremy@bitsweat.net&gt;
http://github.com/rails/rails/commit/84a755b27e615da4a51b6e4c042491b6d807bcf8</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/84a755b27e615da4a51b6e4c042491b6d807bcf8&quot;
title=
&quot;Changeset [84a755b27e615da4a51b6e4c042491b6d807bcf8]&quot;&gt;[84a755b27e615da4a51b6e4c042491b6d807bcf8]&lt;/a&gt;)
Work around a gem dependency edge case that prevents Rails from
booting..&lt;/p&gt;
&lt;p&gt;If you have a frozen gem with unfrozen dependencies (for
instance if the&lt;br&gt;
dependency has native extensions so can't be frozen) you can have
a&lt;br&gt;
nightmare upgrade problem, where you cannot rake gems:install,
because&lt;br&gt;
rake is broken by a gem loading problem.&lt;/p&gt;
&lt;p&gt;If you bump up your frozen gem to a newer version that requires
a newer&lt;br&gt;
dependency, everybody else on the team will have rake broken by
that&lt;br&gt;
dependency mismatch, since you will have had to specify the
dependency&lt;br&gt;
in your config.gems, otherwise nobody will have installed it, since
the&lt;br&gt;
parent is frozen. And now the config.gems loading code will kill
rake.&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;/projects/8994/tickets/2609&quot; title=
&quot;Ticket #2609&quot;&gt;#2609&lt;/a&gt; state:committed]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jeremy Kemper &lt;a href=
&quot;mailto:jeremy@bitsweat.net&quot;&gt;jeremy@bitsweat.net&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/84a755b27e615da4a51b6e4c042491b6d807bcf8&quot;&gt;
http://github.com/rails/rails/commit/84a755b27e615da4a51b6e4c042491...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-06-06T07:06:34+01:00</created-at>
      <creator-id type="integer">13680</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2609</number>
      <permalink>rake-crashes-on-frozen-gem-with-unfrozen-dependencies-of-wrong-version</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>2-3-stable dependencies gems patch</tag>
      <title>rake crashes on frozen gem with unfrozen dependencies of wrong version</title>
      <updated-at type="datetime">2009-06-06T07:06:36+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">19</version>
      <user-name>Repository</user-name>
      <creator-name>Tim Connor</creator-name>
      <assigned-user-name>Matt Jones</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2609</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>264410ebfa6c353ef683e6b53355f7f6c7ea560e</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-05-21T22:56:17+01:00</created-at>
      <filename>master-fix-gem-task-dependency-crash.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">125270</id>
      <size type="integer">673</size>
      <uploader-id type="integer">13680</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/125270/master-fix-gem-task-dependency-crash.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>2e391481297eb448bfbcd434054647bcad8e3348</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-05-21T22:59:25+01:00</created-at>
      <filename>23-fix-gem-task-dependency-crash.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">125272</id>
      <size type="integer">673</size>
      <uploader-id type="integer">13680</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/125272/23-fix-gem-task-dependency-crash.patch</url>
    </attachment>
  </attachments>
</ticket>
