<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">424</assigned-user-id>
  <attachments-count type="integer">0</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2010-02-19T12:18:22+00:00</created-at>
  <creator-id type="integer">40660</creator-id>
  <milestone-due-on type="datetime">2010-11-15T00:00:00+00:00</milestone-due-on>
  <milestone-id type="integer">88038</milestone-id>
  <number type="integer">4002</number>
  <permalink>subdomains-constraits-in-routing-dont-work</permalink>
  <priority type="integer">3</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>routes subdomain</tag>
  <title>Subdomains constraits in routing don't work</title>
  <updated-at type="datetime">2010-10-15T23:01:45+01:00</updated-at>
  <user-id type="integer">85</user-id>
  <version type="integer">14</version>
  <user-name>Jeremy Kemper</user-name>
  <creator-name>Lenary</creator-name>
  <assigned-user-name>Joshua Peek</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/4002</url>
  <milestone-title>3.0.2</milestone-title>
  <priority-name>Low</priority-name>
  <original-body>Hi, 

I checked the rack-mount issues (on github) and didn't find one relating to this, but i decided to open the ticket here.

In the last two days we have come across people in #railsbridge reporting problems with using &lt;tt&gt;:constraints =&gt; {:subdomain =&gt; &quot;foo&quot;}&lt;/tt&gt; or something in routing. 

This hasn't been working. i'll ask them to add some comments, but for the moment they're reporting that using a regular expression on the &lt;tt&gt;:host&lt;/tt&gt; in &lt;tt&gt;:constraints&lt;/tt&gt; is working.</original-body>
  <latest-body>Hi, 

I checked the rack-mount issues (on github) and didn't find one relating to this, but i decided to open the ticket here.

In the last two days we have come across people in #railsbridge reporting problems with using &lt;tt&gt;:constraints =&gt; {:subdomain =&gt; &quot;foo&quot;}&lt;/tt&gt; or something in routing. 

This hasn't been working. i'll ask them to add some comments, but for the moment they're reporting that using a regular expression on the &lt;tt&gt;:host&lt;/tt&gt; in &lt;tt&gt;:constraints&lt;/tt&gt; is working.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I checked the rack-mount issues (on github) and didn't find one
relating to this, but i decided to open the ticket here.&lt;/p&gt;
&lt;p&gt;In the last two days we have come across people in #railsbridge
reporting problems with using &lt;tt&gt;:constraints =&amp;gt; {:subdomain
=&amp;gt; &quot;foo&quot;}&lt;/tt&gt; or something in routing.&lt;/p&gt;
&lt;p&gt;This hasn't been working. i'll ask them to add some comments,
but for the moment they're reporting that using a regular
expression on the &lt;tt&gt;:host&lt;/tt&gt; in &lt;tt&gt;:constraints&lt;/tt&gt; is
working.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Hi, 

I checked the rack-mount issues (on github) and didn't find one relating to this, but i decided to open the ticket here.

In the last two days we have come across people in #railsbridge reporting problems with using &lt;tt&gt;:constraints =&gt; {:subdomain =&gt; &quot;foo&quot;}&lt;/tt&gt; or something in routing. 

This hasn't been working. i'll ask them to add some comments, but for the moment they're reporting that using a regular expression on the &lt;tt&gt;:host&lt;/tt&gt; in &lt;tt&gt;:constraints&lt;/tt&gt; is working.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;I checked the rack-mount issues (on github) and didn't find one
relating to this, but i decided to open the ticket here.&lt;/p&gt;
&lt;p&gt;In the last two days we have come across people in #railsbridge
reporting problems with using &lt;tt&gt;:constraints =&amp;gt; {:subdomain
=&amp;gt; &quot;foo&quot;}&lt;/tt&gt; or something in routing.&lt;/p&gt;
&lt;p&gt;This hasn't been working. i'll ask them to add some comments,
but for the moment they're reporting that using a regular
expression on the &lt;tt&gt;:host&lt;/tt&gt; in &lt;tt&gt;:constraints&lt;/tt&gt; is
working.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-02-19T12:18:22+00:00</created-at>
      <creator-id type="integer">40660</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4002</number>
      <permalink>subdomains-constraits-in-routing-dont-work</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>routes subdomain</tag>
      <title>Subdomains constraits in routing don't work</title>
      <updated-at type="datetime">2010-02-19T12:18:24+00:00</updated-at>
      <user-id type="integer">40660</user-id>
      <version type="integer">1</version>
      <user-name>Lenary</user-name>
      <creator-name>Lenary</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4002</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Lenary, thanks for opening this ticket for me =)

I am currently porting a Rails 2.3.5 App to 3.0.0beta1 and had some trouble with subdomains. I was using subdomain_fu back then. 

As Rails 3.0.0beta1 supports 
:constraints =&gt; {:subdomain =&gt; &quot;foo&quot;}
I tried to use it for subdomain routing. But it failed.

Yehuda Katz mentioned some ways to implement subdomain based routing in Rails 3.0.0beta1 
http://yehudakatz.com/2009/12/26/the-rails-3-router-rack-it-up/
so I setup a Sandbox to test it.

I came across two different errors:
Edge::Application.routes.draw do
  match &quot;/test&quot;, :to =&gt; &quot;foo#show&quot;, :constraints =&gt; {:subdomain =&gt; &quot;foo&quot; }
end

RuntimeError
route set not finalized

And the following when using a regexp for (e.g. :subdomain =&gt; /.+/)

ArgumentError
conditions may only include [:env, :body, :scheme, :script_name, :path_info, :port, :request_method, :query_string, :content_length, :content_type, :session, :session_options, :logger, :media_type, :media_type_params, :content_charset, :host_with_port, :host, :script_name=, :path_info=, :get?, :post?, :put?, :delete?, :head?, :form_data?, :parseable_data?, :GET, :POST, :params, :[], :[]=, :values_at, :referer, :referrer, :user_agent, :cookies, :xhr?, :url, :path, :fullpath, :accept_encoding, :ip, :parse_query, :parse_multipart]



My quick workaround right now:
:contraints =&gt; {:host =&gt; /([a-zA-Z0-9]+\.){2,}+/}
or
contraints(:host =&gt; /([a-zA-Z0-9]+\.){2,}+/) do
end

Installed Gems:
abstract (1.0.0)
  * actionmailer (3.0.0.beta1)
  * actionpack (3.0.0.beta1)
  * activemodel (3.0.0.beta1)
  * activerecord (3.0.0.beta1)
  * activeresource (3.0.0.beta1)
  * activesupport (3.0.0.beta1)
  * arel (0.2.1)
  * authlogic (2.1.3)
  * builder (2.1.2)
  * bundler (0.9.7)
  * compass (0.10.0.pre5)
  * erubis (2.6.5)
  * haml (2.2.20)
  * i18n (0.3.3)
  * mail (2.1.2)
  * memcache-client (1.7.8)
  * mime-types (1.16)
  * mysql (2.8.1)
  * rack (1.1.0)
  * rack-mount (0.5.2)
  * rack-test (0.5.3)
  * rails (3.0.0.beta1)
  * railties (3.0.0.beta1)
  * rake (0.8.7)
  * text-format (1.0.0)
  * text-hyphen (1.0.0)
  * thor (0.13.3)
  * tzinfo (0.3.16)

Hope this helps =)</body>
      <body-html>&lt;div&gt;&lt;p&gt;Lenary, thanks for opening this ticket for me =)&lt;/p&gt;
&lt;p&gt;I am currently porting a Rails 2.3.5 App to 3.0.0beta1 and had
some trouble with subdomains. I was using subdomain_fu back
then.&lt;/p&gt;
&lt;p&gt;As Rails 3.0.0beta1 supports&lt;br&gt;
:constraints =&amp;gt; {:subdomain =&amp;gt; &quot;foo&quot;} I tried to use it for
subdomain routing. But it failed.&lt;/p&gt;
&lt;p&gt;Yehuda Katz mentioned some ways to implement subdomain based
routing in Rails 3.0.0beta1&lt;br&gt;
&lt;a href=
&quot;http://yehudakatz.com/2009/12/26/the-rails-3-router-rack-it-up/&quot;&gt;http://yehudakatz.com/2009/12/26/the-rails-3-router-rack-it-up/&lt;/a&gt;&lt;br&gt;
so I setup a Sandbox to test it.&lt;/p&gt;
&lt;p&gt;I came across two different errors:&lt;br&gt;
Edge::Application.routes.draw do&lt;br&gt;
match &quot;/test&quot;, :to =&amp;gt; &quot;foo#show&quot;, :constraints =&amp;gt; {:subdomain
=&amp;gt; &quot;foo&quot; } end&lt;/p&gt;
&lt;p&gt;RuntimeError&lt;br&gt;
route set not finalized&lt;/p&gt;
&lt;p&gt;And the following when using a regexp for (e.g. :subdomain =&amp;gt;
/.+/)&lt;/p&gt;
&lt;p&gt;ArgumentError&lt;br&gt;
conditions may only include [:env, :body, :scheme, :script_name,
:path_info, :port, :request_method, :query_string, :content_length,
:content_type, :session, :session_options, :logger, :media_type,
:media_type_params, :content_charset, :host_with_port, :host,
:script_name=, :path_info=, :get?, :post?, :put?, :delete?, :head?,
:form_data?, :parseable_data?, :GET, :POST, :params, :[], :[]=,
:values_at, :referer, :referrer, :user_agent, :cookies, :xhr?,
:url, :path, :fullpath, :accept_encoding, :ip, :parse_query,
:parse_multipart]&lt;/p&gt;
&lt;p&gt;My quick workaround right now:&lt;br&gt;
:contraints =&amp;gt; {:host =&amp;gt; /([a-zA-Z0-9]+.){2,}+/} or&lt;br&gt;
contraints(:host =&amp;gt; /([a-zA-Z0-9]+.){2,}+/) do&lt;br&gt;
end&lt;/p&gt;
&lt;p&gt;Installed Gems:&lt;br&gt;
abstract (1.0.0)&lt;br&gt;
* actionmailer (3.0.0.beta1) * actionpack (3.0.0.beta1) *
activemodel (3.0.0.beta1) * activerecord (3.0.0.beta1) *
activeresource (3.0.0.beta1) * activesupport (3.0.0.beta1) * arel
(0.2.1) * authlogic (2.1.3) * builder (2.1.2) * bundler (0.9.7) *
compass (0.10.0.pre5) * erubis (2.6.5) * haml (2.2.20) * i18n
(0.3.3) * mail (2.1.2) * memcache-client (1.7.8) * mime-types
(1.16) * mysql (2.8.1) * rack (1.1.0) * rack-mount (0.5.2) *
rack-test (0.5.3) * rails (3.0.0.beta1) * railties (3.0.0.beta1) *
rake (0.8.7) * text-format (1.0.0) * text-hyphen (1.0.0) * thor
(0.13.3) * tzinfo (0.3.16)&lt;/p&gt;
&lt;p&gt;Hope this helps =)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-02-19T12:38:17+00:00</created-at>
      <creator-id type="integer">40660</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4002</number>
      <permalink>subdomains-constraits-in-routing-dont-work</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>routes subdomain</tag>
      <title>Subdomains constraits in routing don't work</title>
      <updated-at type="datetime">2010-02-19T12:38:20+00:00</updated-at>
      <user-id type="integer">87019</user-id>
      <version type="integer">2</version>
      <user-name>Gregor Robert Russbuelt</user-name>
      <creator-name>Lenary</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4002</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-02-23T21:32:44+00:00</created-at>
      <creator-id type="integer">40660</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4002</number>
      <permalink>subdomains-constraits-in-routing-dont-work</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>routes subdomain</tag>
      <title>Subdomains constraits in routing don't work</title>
      <updated-at type="datetime">2010-02-23T21:32:46+00:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">3</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Lenary</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4002</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Request#subdomain does not exist so I'm not sure why its documented as a &quot;feature&quot;.

This isn't as simple as adding that method. Full url generation needs additional investigation.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Request#subdomain does not exist so I'm not sure why its
documented as a &quot;feature&quot;.&lt;/p&gt;
&lt;p&gt;This isn't as simple as adding that method. Full url generation
needs additional investigation.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-02-24T01:58:38+00:00</created-at>
      <creator-id type="integer">40660</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4002</number>
      <permalink>subdomains-constraits-in-routing-dont-work</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>wontfix</state>
      <tag>routes subdomain</tag>
      <title>Subdomains constraits in routing don't work</title>
      <updated-at type="datetime">2010-02-24T01:58:44+00:00</updated-at>
      <user-id type="integer">424</user-id>
      <version type="integer">4</version>
      <user-name>Joshua Peek</user-name>
      <creator-name>Lenary</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4002</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Follow up on #4003</body>
      <body-html>&lt;div&gt;&lt;p&gt;Follow up on &lt;a href=&quot;/projects/8994/tickets/4003&quot; title=
&quot;Ticket #4003&quot;&gt;#4003&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-02-24T01:59:45+00:00</created-at>
      <creator-id type="integer">40660</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4002</number>
      <permalink>subdomains-constraits-in-routing-dont-work</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>wontfix</state>
      <tag>routes subdomain</tag>
      <title>Subdomains constraits in routing don't work</title>
      <updated-at type="datetime">2010-02-24T01:59:46+00:00</updated-at>
      <user-id type="integer">424</user-id>
      <version type="integer">5</version>
      <user-name>Joshua Peek</user-name>
      <creator-name>Lenary</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4002</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Joshua,
thanks for investigating this.

Isn't the Request#* object handled/provided by rack/rack-mount?

This works:
@@@ ruby
  request.host #=&gt; test.foo.bar.tld
  request.subdomains #=&gt; test.foo
@@@

Or is this something different?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Joshua,&lt;br&gt;
thanks for investigating this.&lt;/p&gt;
&lt;p&gt;Isn't the Request#* object handled/provided by
rack/rack-mount?&lt;/p&gt;
&lt;p&gt;This works:&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;  request.host #=&amp;gt; test.foo.bar.tld
  request.subdomains #=&amp;gt; test.foo&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Or is this something different?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-02-24T09:04:10+00:00</created-at>
      <creator-id type="integer">40660</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4002</number>
      <permalink>subdomains-constraits-in-routing-dont-work</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>wontfix</state>
      <tag>routes subdomain</tag>
      <title>Subdomains constraits in routing don't work</title>
      <updated-at type="datetime">2010-02-24T09:04:12+00:00</updated-at>
      <user-id type="integer">87019</user-id>
      <version type="integer">6</version>
      <user-name>Gregor Robert Russbuelt</user-name>
      <creator-name>Lenary</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4002</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-02-27T17:35:54+00:00</created-at>
      <creator-id type="integer">40660</creator-id>
      <diffable-attributes type="yaml">--- 
:state: wontfix
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4002</number>
      <permalink>subdomains-constraits-in-routing-dont-work</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>routes subdomain</tag>
      <title>Subdomains constraits in routing don't work</title>
      <updated-at type="datetime">2010-02-27T17:35:56+00:00</updated-at>
      <user-id type="integer">12714</user-id>
      <version type="integer">7</version>
      <user-name>Yehuda Katz (wycats)</user-name>
      <creator-name>Lenary</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4002</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>http://github.com/rails/rails/commit/fef7a77386b0e738f3b5c25fd9ab0350a6e56d6c</body>
      <body-html>&lt;div&gt;&lt;p&gt;&lt;a href=
&quot;http://github.com/rails/rails/commit/fef7a77386b0e738f3b5c25fd9ab0350a6e56d6c&quot;&gt;
http://github.com/rails/rails/commit/fef7a77386b0e738f3b5c25fd9ab03...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-03-06T18:56:38+00:00</created-at>
      <creator-id type="integer">40660</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4002</number>
      <permalink>subdomains-constraits-in-routing-dont-work</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>routes subdomain</tag>
      <title>Subdomains constraits in routing don't work</title>
      <updated-at type="datetime">2010-03-06T18:56:40+00:00</updated-at>
      <user-id type="integer">424</user-id>
      <version type="integer">8</version>
      <user-name>Joshua Peek</user-name>
      <creator-name>Lenary</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4002</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Seems like it's not fixed.

`match 'path' =&gt; 'contoller#method', :as =&gt; 'path', :constraints =&gt; {:subdomain =&gt; &quot;up&quot;}`

`rake routes` gives error:

&lt;code&gt;
** Invoke routes (first_time)
** Invoke environment (first_time)
** Execute environment
rake aborted!
conditions may only include [:env, :body, :scheme, :script_name, :path_info, :port, :request_method, :query_string, :content_length, :content_type, :session, :session_options, :logger, :media_type, :media_type_params, :content_charset, :host_with_port, :host, :script_name=, :path_info=, :get?, :post?, :put?, :delete?, :head?, :form_data?, :parseable_data?, :GET, :POST, :params, :[], :[]=, :values_at, :referer, :referrer, :user_agent, :cookies, :xhr?, :url, :path, :fullpath, :accept_encoding, :ip, :taguri=, :taguri, :to_yaml_style, :to_yaml_properties, :to_yaml, :duplicable?, :acts_like?, :blank?, :present?, :presence, :singleton_class, :class_eval, :html_safe?, :with_options, :to_param, :try, :instance_values, :instance_variable_names, :copy_instance_variables_from, :to_json, :as_json, :returning, :is_haml?, :`, :to_query, :subclasses_of, :to_sql, :equality_predicate_sql, :bind, :find_correlate_in, :let, :require_or_load, :require_dependency, :require_association, :load_dependency, :load, :require, :unloadable, :nil?, :===, :=~, :!~, :eql?, :class, :clone, :dup, :taint, :tainted?, :untaint, :untrust, :untrusted?, :trust, :freeze, :frozen?, :to_s, :inspect, :methods, :singleton_methods, :protected_methods, :private_methods, :public_methods, :instance_variables, :instance_variable_get, :instance_variable_set, :instance_variable_defined?, :instance_of?, :kind_of?, :is_a?, :tap, :send, :public_send, :respond_to?, :extend, :display, :method, :public_method, :define_singleton_method, :hash, :__id__, :object_id, :to_enum, :enum_for, :gem, :silence_warnings, :enable_warnings, :with_warnings, :silence_stderr, :silence_stream, :suppress, :j, :jj, :JSON, :require_library_or_gem, :debugger, :breakpoint, :==, :equal?, :!, :!=, :instance_eval, :instance_exec, :__send__]
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rack-mount-0.6.1/lib/rack/mount/route_set.rb:142:in `validate_conditions!'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rack-mount-0.6.1/lib/rack/mount/route_set.rb:52:in `add_route'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rack-mount-0.6.1/lib/rack/mount/generation/route_set.rb:17:in `add_route'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rack-mount-0.6.1/lib/rack/mount/recognition/route_set.rb:19:in `add_route'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/route_set.rb:278:in `add_route'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/mapper.rb:193:in `match'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/mapper.rb:330:in `match'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/mapper.rb:666:in `match'
/Users/user/projects/test/config/routes.rb:6:in `block in &lt;top (required)&gt;'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/route_set.rb:212:in `instance_exec'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/route_set.rb:212:in `draw'
/Users/user/Work/httpget/config/routes.rb:1:in `&lt;top (required)&gt;'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:205:in `load'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:205:in `block in load'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:195:in `block in load_dependency'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:523:in `new_constants_in'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:195:in `load_dependency'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:205:in `load'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/routes_reloader.rb:29:in `block in reload!'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/routes_reloader.rb:29:in `each'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/routes_reloader.rb:29:in `reload!'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/routes_reloader.rb:41:in `reload_if_changed'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/railtie.rb:14:in `block (2 levels) in &lt;class:Railtie&gt;'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/callbacks.rb:438:in `_run_prepare_callbacks'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/callbacks.rb:88:in `run_callbacks'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/callbacks.rb:40:in `initialize'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:74:in `new'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:74:in `build'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:130:in `block in build'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:130:in `each'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:130:in `inject'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:130:in `build'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application.rb:127:in `app'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/finisher.rb:31:in `block in &lt;module:Finisher&gt;'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:25:in `instance_exec'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:25:in `run'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:55:in `block in run_initializers'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:54:in `each'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:54:in `run_initializers'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application.rb:108:in `initialize!'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application.rb:149:in `block in initialize_tasks'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:636:in `call'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:636:in `block in execute'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:631:in `each'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:631:in `execute'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:597:in `block in invoke_with_call_chain'
/opt/local/lib/ruby1.9/1.9.1/monitor.rb:190:in `mon_synchronize'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:590:in `invoke_with_call_chain'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:607:in `block in invoke_prerequisites'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:604:in `each'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:604:in `invoke_prerequisites'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:596:in `block in invoke_with_call_chain'
/opt/local/lib/ruby1.9/1.9.1/monitor.rb:190:in `mon_synchronize'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:590:in `invoke_with_call_chain'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:583:in `invoke'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2051:in `invoke_task'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in `block (2 levels) in top_level'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in `each'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in `block in top_level'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2023:in `top_level'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2001:in `block in run'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:1998:in `run'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/bin/rake:31:in `&lt;top (required)&gt;'
/opt/local/bin/rake:19:in `load'
/opt/local/bin/rake:19:in `&lt;main&gt;'
&lt;/code&gt;




installed gems:
&lt;code&gt;
abstract (1.0.0)
actionmailer (3.0.0.beta)
actionpack (3.0.0.beta)
activemodel (3.0.0.beta)
activerecord (3.0.0.beta)
activeresource (3.0.0.beta)
activesupport (3.0.0.beta)
archive-tar-minitar (0.5.2)
arel (0.3.3)
builder (2.1.2)
bundler (0.9.15)
columnize (0.3.1)
easy_roles (0.4.2)
erubis (2.6.5)
fastthread (1.0.7)
formtastic (0.9.8)
haml-edge (2.3.186)
i18n (0.3.6)
linecache19 (0.5.11)
mail (2.1.5.3)
memcache-client (1.8.1)
mime-types (1.16)
passenger (2.2.11)
polyglot (0.3.1)
rack (1.1.0)
rack-mount (0.6.1)
rack-test (0.5.3)
rails (3.0.0.beta)
rails3-generators (0.5.3)
rails3b (3.0.1)
railties (3.0.0.beta)
rake (0.8.7)
ruby-debug-base19 (0.11.23)
ruby-debug19 (0.11.6)
ruby_core_source (0.1.4)
rubygems-update (1.3.6)
text-format (1.0.0)
text-hyphen (1.0.0)
thor (0.13.4)
treetop (1.4.5)
tzinfo (0.3.18)
&lt;/code&gt;

Gemfile:
&lt;code&gt;
source 'http://gemcutter.org'

gem &quot;rails&quot;, :git =&gt; &quot;git://github.com/rails/rails.git&quot;
gem &quot;haml-edge&quot;, :require =&gt; &quot;haml&quot;
gem &quot;rails3-generators&quot;
gem &quot;simple_form&quot;, :git =&gt; &quot;git://github.com/plataformatec/simple_form.git&quot;
gem &quot;paperclip&quot;, :git =&gt; &quot;git://github.com/JasonKing/paperclip.git&quot;, :branch =&gt; &quot;rails3&quot;
gem &quot;mysql&quot;
gem &quot;easy_roles&quot;
gem &quot;warden&quot;
gem &quot;devise&quot;, :git =&gt; &quot;git://github.com/plataformatec/devise.git&quot;
&lt;/code&gt;</body>
      <body-html>&lt;div&gt;&lt;p&gt;Seems like it's not fixed.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;match 'path' =&amp;gt; 'contoller#method', :as =&amp;gt; 'path',
:constraints =&amp;gt; {:subdomain =&amp;gt; &quot;up&quot;}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;rake routes&lt;/code&gt; gives error:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&lt;br&gt;
&lt;strong&gt;Invoke routes (first_time)&lt;/strong&gt; Invoke environment
(first_time) ** Execute environment rake aborted!&lt;br&gt;
conditions may only include [:env, :body, :scheme, :script_name,
:path_info, :port, :request_method, :query_string, :content_length,
:content_type, :session, :session_options, :logger, :media_type,
:media_type_params, :content_charset, :host_with_port, :host,
:script_name=, :path_info=, :get?, :post?, :put?, :delete?, :head?,
:form_data?, :parseable_data?, :GET, :POST, :params, :[], :[]=,
:values_at, :referer, :referrer, :user_agent, :cookies, :xhr?,
:url, :path, :fullpath, :accept_encoding, :ip, :taguri=, :taguri,
:to_yaml_style, :to_yaml_properties, :to_yaml, :duplicable?,
:acts_like?, :blank?, :present?, :presence, :singleton_class,
:class_eval, :html_safe?, :with_options, :to_param, :try,
:instance_values, :instance_variable_names,
:copy_instance_variables_from, :to_json, :as_json, :returning,
:is_haml?, :&lt;/code&gt;, :to_query, :subclasses_of, :to_sql,
:equality_predicate_sql, :bind, :find_correlate_in, :let,
:require_or_load, :require_dependency, :require_association,
:load_dependency, :load, :require, :unloadable, :nil?, :===, :=~,
:!~, :eql?, :class, :clone, :dup, :taint, :tainted?, :untaint,
:untrust, :untrusted?, :trust, :freeze, :frozen?, :to_s, :inspect,
:methods, :singleton_methods, :protected_methods, :private_methods,
:public_methods, :instance_variables, :instance_variable_get,
:instance_variable_set, :instance_variable_defined?, :instance_of?,
:kind_of?, :is_a?, :tap, :send, :public_send, :respond_to?,
:extend, :display, :method, :public_method,
:define_singleton_method, :hash, :__id__, :object_id, :to_enum,
:enum_for, :gem, :silence_warnings, :enable_warnings,
:with_warnings, :silence_stderr, :silence_stream, :suppress, :j,
:jj, :JSON, :require_library_or_gem, :debugger, :breakpoint, :==,
:equal?, :!, :!=, :instance_eval, :instance_exec,
:__send__]&amp;lt;br/&amp;gt;
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rack-mount-0.6.1/lib/rack/mount/route_set.rb:142:invalidate_conditions!'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rack-mount-0.6.1/lib/rack/mount/route_set.rb:52:in
&lt;code&gt;add_route'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rack-mount-0.6.1/lib/rack/mount/generation/route_set.rb:17:in&lt;/code&gt;add_route'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rack-mount-0.6.1/lib/rack/mount/recognition/route_set.rb:19:in
&lt;code&gt;add_route'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/route_set.rb:278:in&lt;/code&gt;add_route'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/mapper.rb:193:in
&lt;code&gt;match'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/mapper.rb:330:in&lt;/code&gt;match'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/mapper.rb:666:in
&lt;code&gt;match'
/Users/user/projects/test/config/routes.rb:6:in&lt;/code&gt;block in '
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/route_set.rb:212:in
&lt;code&gt;instance_exec'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/route_set.rb:212:in&lt;/code&gt;draw'
/Users/user/Work/httpget/config/routes.rb:1:in &lt;code&gt;&amp;lt;top
(required)&amp;gt;'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:205:in&lt;/code&gt;load'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:205:in
&lt;code&gt;block in load'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:195:in&lt;/code&gt;block
in load_dependency'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:523:in
&lt;code&gt;new_constants_in'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:195:in&lt;/code&gt;load_dependency'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:205:in
&lt;code&gt;load'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/routes_reloader.rb:29:in&lt;/code&gt;block
in reload!'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/routes_reloader.rb:29:in
&lt;code&gt;each'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/routes_reloader.rb:29:in&lt;/code&gt;reload!'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/routes_reloader.rb:41:in
&lt;code&gt;reload_if_changed'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/railtie.rb:14:in&lt;/code&gt;block
(2 levels) in &amp;lt;class:Railtie&amp;gt;'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/callbacks.rb:438:in
&lt;code&gt;_run_prepare_callbacks'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/callbacks.rb:88:in&lt;/code&gt;run_callbacks'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/callbacks.rb:40:in
&lt;code&gt;initialize'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:74:in&lt;/code&gt;new'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:74:in
&lt;code&gt;build'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:130:in&lt;/code&gt;block
in build'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:130:in
&lt;code&gt;each'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:130:in&lt;/code&gt;inject'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:130:in
&lt;code&gt;build'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application.rb:127:in&lt;/code&gt;app'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/finisher.rb:31:in
&lt;code&gt;block in &amp;lt;module:Finisher&amp;gt;'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:25:in&lt;/code&gt;instance_exec'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:25:in
&lt;code&gt;run'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:55:in&lt;/code&gt;block
in run_initializers'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:54:in
&lt;code&gt;each'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:54:in&lt;/code&gt;run_initializers'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application.rb:108:in
&lt;code&gt;initialize!'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application.rb:149:in&lt;/code&gt;block
in initialize_tasks'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:636:in
&lt;code&gt;call'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:636:in&lt;/code&gt;block
in execute'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:631:in
&lt;code&gt;each'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:631:in&lt;/code&gt;execute'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:597:in
&lt;code&gt;block in invoke_with_call_chain'
/opt/local/lib/ruby1.9/1.9.1/monitor.rb:190:in&lt;/code&gt;mon_synchronize'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:590:in
&lt;code&gt;invoke_with_call_chain'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:607:in&lt;/code&gt;block
in invoke_prerequisites'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:604:in
&lt;code&gt;each'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:604:in&lt;/code&gt;invoke_prerequisites'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:596:in
&lt;code&gt;block in invoke_with_call_chain'
/opt/local/lib/ruby1.9/1.9.1/monitor.rb:190:in&lt;/code&gt;mon_synchronize'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:590:in
&lt;code&gt;invoke_with_call_chain'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:583:in&lt;/code&gt;invoke'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2051:in
&lt;code&gt;invoke_task'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in&lt;/code&gt;block
(2 levels) in top_level'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in
&lt;code&gt;each'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in&lt;/code&gt;block
in top_level'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2068:in
&lt;code&gt;standard_exception_handling'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2023:in&lt;/code&gt;top_level'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2001:in
&lt;code&gt;block in run'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2068:in&lt;/code&gt;standard_exception_handling'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:1998:in
&lt;code&gt;run'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/bin/rake:31:in&lt;/code&gt;'
/opt/local/bin/rake:19:in &lt;code&gt;load'
/opt/local/bin/rake:19:in&lt;/code&gt;'&lt;/p&gt;
&lt;p&gt;installed gems:&lt;br&gt;
&lt;code&gt;&lt;br&gt;
abstract (1.0.0)&lt;br&gt;
actionmailer (3.0.0.beta)&lt;br&gt;
actionpack (3.0.0.beta)&lt;br&gt;
activemodel (3.0.0.beta)&lt;br&gt;
activerecord (3.0.0.beta)&lt;br&gt;
activeresource (3.0.0.beta)&lt;br&gt;
activesupport (3.0.0.beta)&lt;br&gt;
archive-tar-minitar (0.5.2)&lt;br&gt;
arel (0.3.3)&lt;br&gt;
builder (2.1.2)&lt;br&gt;
bundler (0.9.15)&lt;br&gt;
columnize (0.3.1)&lt;br&gt;
easy_roles (0.4.2)&lt;br&gt;
erubis (2.6.5)&lt;br&gt;
fastthread (1.0.7)&lt;br&gt;
formtastic (0.9.8)&lt;br&gt;
haml-edge (2.3.186)&lt;br&gt;
i18n (0.3.6)&lt;br&gt;
linecache19 (0.5.11)&lt;br&gt;
mail (2.1.5.3)&lt;br&gt;
memcache-client (1.8.1)&lt;br&gt;
mime-types (1.16)&lt;br&gt;
passenger (2.2.11)&lt;br&gt;
polyglot (0.3.1)&lt;br&gt;
rack (1.1.0)&lt;br&gt;
rack-mount (0.6.1)&lt;br&gt;
rack-test (0.5.3)&lt;br&gt;
rails (3.0.0.beta)&lt;br&gt;
rails3-generators (0.5.3)&lt;br&gt;
rails3b (3.0.1)&lt;br&gt;
railties (3.0.0.beta)&lt;br&gt;
rake (0.8.7)&lt;br&gt;
ruby-debug-base19 (0.11.23)&lt;br&gt;
ruby-debug19 (0.11.6)&lt;br&gt;
ruby_core_source (0.1.4)&lt;br&gt;
rubygems-update (1.3.6)&lt;br&gt;
text-format (1.0.0)&lt;br&gt;
text-hyphen (1.0.0)&lt;br&gt;
thor (0.13.4)&lt;br&gt;
treetop (1.4.5)&lt;br&gt;
tzinfo (0.3.18)&lt;br&gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Gemfile:&lt;br&gt;
&lt;code&gt;&lt;br&gt;
source 'http://gemcutter.org'&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;gem &quot;rails&quot;, :git =&amp;gt; &quot;git://github.com/rails/rails.git&quot;&lt;br&gt;
gem &quot;haml-edge&quot;, :require =&amp;gt; &quot;haml&quot;&lt;br&gt;
gem &quot;rails3-generators&quot;&lt;br&gt;
gem &quot;simple_form&quot;, :git =&amp;gt;
&quot;git://github.com/plataformatec/simple_form.git&quot;&lt;br&gt;
gem &quot;paperclip&quot;, :git =&amp;gt;
&quot;git://github.com/JasonKing/paperclip.git&quot;, :branch =&amp;gt;
&quot;rails3&quot;&lt;br&gt;
gem &quot;mysql&quot;&lt;br&gt;
gem &quot;easy_roles&quot;&lt;br&gt;
gem &quot;warden&quot;&lt;br&gt;
gem &quot;devise&quot;, :git =&amp;gt;
&quot;git://github.com/plataformatec/devise.git&quot;&lt;br&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-04-02T16:39:30+01:00</created-at>
      <creator-id type="integer">40660</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4002</number>
      <permalink>subdomains-constraits-in-routing-dont-work</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>routes subdomain</tag>
      <title>Subdomains constraits in routing don't work</title>
      <updated-at type="datetime">2010-04-02T16:39:32+01:00</updated-at>
      <user-id type="integer">25589</user-id>
      <version type="integer">9</version>
      <user-name>bug.odesk (at gmail)</user-name>
      <creator-name>Lenary</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4002</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>sorry for bad formatting in previous post. here is right one.

&lt;pre&gt;
** Invoke routes (first_time)
** Invoke environment (first_time)
** Execute environment
rake aborted!
conditions may only include [:env, :body, :scheme, :script_name, :path_info, :port, :request_method, :query_string, :content_length, :content_type, :session, :session_options, :logger, :media_type, :media_type_params, :content_charset, :host_with_port, :host, :script_name=, :path_info=, :get?, :post?, :put?, :delete?, :head?, :form_data?, :parseable_data?, :GET, :POST, :params, :[], :[]=, :values_at, :referer, :referrer, :user_agent, :cookies, :xhr?, :url, :path, :fullpath, :accept_encoding, :ip, :taguri=, :taguri, :to_yaml_style, :to_yaml_properties, :to_yaml, :duplicable?, :acts_like?, :blank?, :present?, :presence, :singleton_class, :class_eval, :html_safe?, :with_options, :to_param, :try, :instance_values, :instance_variable_names, :copy_instance_variables_from, :to_json, :as_json, :returning, :is_haml?, :`, :to_query, :subclasses_of, :to_sql, :equality_predicate_sql, :bind, :find_correlate_in, :let, :require_or_load, :require_dependency, :require_association, :load_dependency, :load, :require, :unloadable, :nil?, :===, :=~, :!~, :eql?, :class, :clone, :dup, :taint, :tainted?, :untaint, :untrust, :untrusted?, :trust, :freeze, :frozen?, :to_s, :inspect, :methods, :singleton_methods, :protected_methods, :private_methods, :public_methods, :instance_variables, :instance_variable_get, :instance_variable_set, :instance_variable_defined?, :instance_of?, :kind_of?, :is_a?, :tap, :send, :public_send, :respond_to?, :extend, :display, :method, :public_method, :define_singleton_method, :hash, :__id__, :object_id, :to_enum, :enum_for, :gem, :silence_warnings, :enable_warnings, :with_warnings, :silence_stderr, :silence_stream, :suppress, :j, :jj, :JSON, :require_library_or_gem, :debugger, :breakpoint, :==, :equal?, :!, :!=, :instance_eval, :instance_exec, :__send__]
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rack-mount-0.6.1/lib/rack/mount/route_set.rb:142:in `validate_conditions!'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rack-mount-0.6.1/lib/rack/mount/route_set.rb:52:in `add_route'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rack-mount-0.6.1/lib/rack/mount/generation/route_set.rb:17:in `add_route'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rack-mount-0.6.1/lib/rack/mount/recognition/route_set.rb:19:in `add_route'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/route_set.rb:278:in `add_route'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/mapper.rb:193:in `match'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/mapper.rb:330:in `match'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/mapper.rb:666:in `match'
/Users/user/projects/test/config/routes.rb:6:in `block in &lt;top (required)&gt;'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/route_set.rb:212:in `instance_exec'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/route_set.rb:212:in `draw'
/Users/user/Work/httpget/config/routes.rb:1:in `&lt;top (required)&gt;'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:205:in `load'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:205:in `block in load'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:195:in `block in load_dependency'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:523:in `new_constants_in'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:195:in `load_dependency'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:205:in `load'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/routes_reloader.rb:29:in `block in reload!'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/routes_reloader.rb:29:in `each'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/routes_reloader.rb:29:in `reload!'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/routes_reloader.rb:41:in `reload_if_changed'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/railtie.rb:14:in `block (2 levels) in &lt;class:Railtie&gt;'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/callbacks.rb:438:in `_run_prepare_callbacks'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/callbacks.rb:88:in `run_callbacks'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/callbacks.rb:40:in `initialize'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:74:in `new'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:74:in `build'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:130:in `block in build'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:130:in `each'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:130:in `inject'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:130:in `build'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application.rb:127:in `app'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/finisher.rb:31:in `block in &lt;module:Finisher&gt;'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:25:in `instance_exec'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:25:in `run'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:55:in `block in run_initializers'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:54:in `each'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:54:in `run_initializers'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application.rb:108:in `initialize!'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application.rb:149:in `block in initialize_tasks'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:636:in `call'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:636:in `block in execute'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:631:in `each'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:631:in `execute'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:597:in `block in invoke_with_call_chain'
/opt/local/lib/ruby1.9/1.9.1/monitor.rb:190:in `mon_synchronize'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:590:in `invoke_with_call_chain'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:607:in `block in invoke_prerequisites'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:604:in `each'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:604:in `invoke_prerequisites'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:596:in `block in invoke_with_call_chain'
/opt/local/lib/ruby1.9/1.9.1/monitor.rb:190:in `mon_synchronize'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:590:in `invoke_with_call_chain'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:583:in `invoke'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2051:in `invoke_task'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in `block (2 levels) in top_level'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in `each'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in `block in top_level'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2023:in `top_level'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2001:in `block in run'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:1998:in `run'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/bin/rake:31:in `&lt;top (required)&gt;'
/opt/local/bin/rake:19:in `load'
/opt/local/bin/rake:19:in `&lt;main&gt;'
&lt;/pre&gt;</body>
      <body-html>&lt;div&gt;&lt;p&gt;sorry for bad formatting in previous post. here is right
one.&lt;/p&gt;
&lt;pre&gt;
** Invoke routes (first_time)
** Invoke environment (first_time)
** Execute environment
rake aborted!
conditions may only include [:env, :body, :scheme, :script_name, :path_info, :port, :request_method, :query_string, :content_length, :content_type, :session, :session_options, :logger, :media_type, :media_type_params, :content_charset, :host_with_port, :host, :script_name=, :path_info=, :get?, :post?, :put?, :delete?, :head?, :form_data?, :parseable_data?, :GET, :POST, :params, :[], :[]=, :values_at, :referer, :referrer, :user_agent, :cookies, :xhr?, :url, :path, :fullpath, :accept_encoding, :ip, :taguri=, :taguri, :to_yaml_style, :to_yaml_properties, :to_yaml, :duplicable?, :acts_like?, :blank?, :present?, :presence, :singleton_class, :class_eval, :html_safe?, :with_options, :to_param, :try, :instance_values, :instance_variable_names, :copy_instance_variables_from, :to_json, :as_json, :returning, :is_haml?, :`, :to_query, :subclasses_of, :to_sql, :equality_predicate_sql, :bind, :find_correlate_in, :let, :require_or_load, :require_dependency, :require_association, :load_dependency, :load, :require, :unloadable, :nil?, :===, :=~, :!~, :eql?, :class, :clone, :dup, :taint, :tainted?, :untaint, :untrust, :untrusted?, :trust, :freeze, :frozen?, :to_s, :inspect, :methods, :singleton_methods, :protected_methods, :private_methods, :public_methods, :instance_variables, :instance_variable_get, :instance_variable_set, :instance_variable_defined?, :instance_of?, :kind_of?, :is_a?, :tap, :send, :public_send, :respond_to?, :extend, :display, :method, :public_method, :define_singleton_method, :hash, :__id__, :object_id, :to_enum, :enum_for, :gem, :silence_warnings, :enable_warnings, :with_warnings, :silence_stderr, :silence_stream, :suppress, :j, :jj, :JSON, :require_library_or_gem, :debugger, :breakpoint, :==, :equal?, :!, :!=, :instance_eval, :instance_exec, :__send__]
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rack-mount-0.6.1/lib/rack/mount/route_set.rb:142:in `validate_conditions!'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rack-mount-0.6.1/lib/rack/mount/route_set.rb:52:in `add_route'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rack-mount-0.6.1/lib/rack/mount/generation/route_set.rb:17:in `add_route'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rack-mount-0.6.1/lib/rack/mount/recognition/route_set.rb:19:in `add_route'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/route_set.rb:278:in `add_route'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/mapper.rb:193:in `match'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/mapper.rb:330:in `match'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/mapper.rb:666:in `match'
/Users/user/projects/test/config/routes.rb:6:in `block in '
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/route_set.rb:212:in `instance_exec'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/routing/route_set.rb:212:in `draw'
/Users/user/Work/httpget/config/routes.rb:1:in `'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:205:in `load'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:205:in `block in load'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:195:in `block in load_dependency'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:523:in `new_constants_in'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:195:in `load_dependency'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/dependencies.rb:205:in `load'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/routes_reloader.rb:29:in `block in reload!'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/routes_reloader.rb:29:in `each'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/routes_reloader.rb:29:in `reload!'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/routes_reloader.rb:41:in `reload_if_changed'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/railtie.rb:14:in `block (2 levels) in '
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/callbacks.rb:438:in `_run_prepare_callbacks'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/activesupport/lib/active_support/callbacks.rb:88:in `run_callbacks'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/callbacks.rb:40:in `initialize'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:74:in `new'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:74:in `build'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:130:in `block in build'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:130:in `each'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:130:in `inject'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/actionpack/lib/action_dispatch/middleware/stack.rb:130:in `build'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application.rb:127:in `app'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application/finisher.rb:31:in `block in '
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:25:in `instance_exec'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:25:in `run'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:55:in `block in run_initializers'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:54:in `each'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/initializable.rb:54:in `run_initializers'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application.rb:108:in `initialize!'
/Users/user/.bundle/ruby/1.9.1/bundler/gems/rails-16a5e918a06649ffac24fd5873b875daf66212ad-master/railties/lib/rails/application.rb:149:in `block in initialize_tasks'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:636:in `call'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:636:in `block in execute'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:631:in `each'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:631:in `execute'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:597:in `block in invoke_with_call_chain'
/opt/local/lib/ruby1.9/1.9.1/monitor.rb:190:in `mon_synchronize'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:590:in `invoke_with_call_chain'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:607:in `block in invoke_prerequisites'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:604:in `each'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:604:in `invoke_prerequisites'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:596:in `block in invoke_with_call_chain'
/opt/local/lib/ruby1.9/1.9.1/monitor.rb:190:in `mon_synchronize'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:590:in `invoke_with_call_chain'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:583:in `invoke'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2051:in `invoke_task'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in `block (2 levels) in top_level'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in `each'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in `block in top_level'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2023:in `top_level'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2001:in `block in run'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:1998:in `run'
/opt/local/lib/ruby1.9/gems/1.9.1/gems/rake-0.8.7/bin/rake:31:in `'
/opt/local/bin/rake:19:in `load'
/opt/local/bin/rake:19:in `'
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-04-02T16:41:40+01:00</created-at>
      <creator-id type="integer">40660</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4002</number>
      <permalink>subdomains-constraits-in-routing-dont-work</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>routes subdomain</tag>
      <title>Subdomains constraits in routing don't work</title>
      <updated-at type="datetime">2010-04-02T16:41:44+01:00</updated-at>
      <user-id type="integer">25589</user-id>
      <version type="integer">10</version>
      <user-name>bug.odesk (at gmail)</user-name>
      <creator-name>Lenary</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4002</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I can confirm bug.odesk is right; subdomain constraints are not working on beta2. I am having the exact same problem.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I can confirm bug.odesk is right; subdomain constraints are not
working on beta2. I am having the exact same problem.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-04-03T17:50:37+01:00</created-at>
      <creator-id type="integer">40660</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4002</number>
      <permalink>subdomains-constraits-in-routing-dont-work</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>routes subdomain</tag>
      <title>Subdomains constraits in routing don't work</title>
      <updated-at type="datetime">2010-04-03T17:50:40+01:00</updated-at>
      <user-id type="integer">93317</user-id>
      <version type="integer">11</version>
      <user-name>Nicholas Howell</user-name>
      <creator-name>Lenary</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4002</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Looks like Rack::Mount uses the method list of Rack::Request by default to validate condition keys. This can be overriden by passing in :request_class when the routeset is [created](http://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/routing/route_set.rb#L235).

I'll make a patch in the next couple of days if someone doesn't beat me to it.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Looks like Rack::Mount uses the method list of Rack::Request by
default to validate condition keys. This can be overriden by
passing in :request_class when the routeset is &lt;a href=
&quot;http://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/routing/route_set.rb#L235&quot;&gt;
created&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I'll make a patch in the next couple of days if someone doesn't
beat me to it.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-04-03T18:07:08+01:00</created-at>
      <creator-id type="integer">40660</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4002</number>
      <permalink>subdomains-constraits-in-routing-dont-work</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>routes subdomain</tag>
      <title>Subdomains constraits in routing don't work</title>
      <updated-at type="datetime">2010-04-03T18:07:11+01:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">12</version>
      <user-name>Andrew White</user-name>
      <creator-name>Lenary</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4002</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Looks like I was beaten to it: 
http://github.com/rails/rails/commit/ab8bf9e152ad75c8b358c85e4c95cfde578de127#diff-12

Subdomain constraints now work so this ticket can be closed.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Looks like I was beaten to it:&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/ab8bf9e152ad75c8b358c85e4c95cfde578de127#diff-12&quot;&gt;
http://github.com/rails/rails/commit/ab8bf9e152ad75c8b358c85e4c95cf...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Subdomain constraints now work so this ticket can be closed.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-04-04T08:31:00+01:00</created-at>
      <creator-id type="integer">40660</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4002</number>
      <permalink>subdomains-constraits-in-routing-dont-work</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>routes subdomain</tag>
      <title>Subdomains constraits in routing don't work</title>
      <updated-at type="datetime">2010-04-04T08:31:04+01:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">13</version>
      <user-name>Andrew White</user-name>
      <creator-name>Lenary</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4002</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/31647)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/31647&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-10-15T23:01:45+01:00</created-at>
      <creator-id type="integer">40660</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
:milestone: 27004
</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">4002</number>
      <permalink>subdomains-constraits-in-routing-dont-work</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>routes subdomain</tag>
      <title>Subdomains constraits in routing don't work</title>
      <updated-at type="datetime">2010-10-15T23:01:45+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">14</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Lenary</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4002</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name>Low</priority-name>
    </version>
  </versions>
</ticket>
