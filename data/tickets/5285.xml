<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">19965</assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2010-08-03T15:18:27+01:00</created-at>
  <creator-id type="integer">40656</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">71472</milestone-id>
  <number type="integer">5285</number>
  <permalink>chaining-two-scopes-with-includes-drops-the-second-includes</permalink>
  <priority type="integer">3</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>activerelation rails3rc</tag>
  <title>chaining two scopes with :includes, drops the second :includes </title>
  <updated-at type="datetime">2010-08-14T12:23:35+01:00</updated-at>
  <user-id type="integer">17393</user-id>
  <version type="integer">4</version>
  <user-name>Repository</user-name>
  <creator-name>Sean</creator-name>
  <assigned-user-name>Jos&#233; Valim</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/5285</url>
  <milestone-title>3.x</milestone-title>
  <priority-name>Low</priority-name>
  <original-body>Maybe I'm doing something wrong, but it seems that when chaining scopes that each have an :includes on different tables, that only the first include is converted into a join in the generated SQL; the :include from the second scope is ignored. The scopes both work fine on their own, but fail when combined (since the second join is missing). I've tested it several different ways, and I'm led to believe that there may be a bug. 

Full example here:

http://stackoverflow.com/questions/3393013/problem-activerecord-rails3-chaining-scopes-with-includes

(running rails 3.0.0.beta4).</original-body>
  <latest-body>Maybe I'm doing something wrong, but it seems that when chaining scopes that each have an :includes on different tables, that only the first include is converted into a join in the generated SQL; the :include from the second scope is ignored. The scopes both work fine on their own, but fail when combined (since the second join is missing). I've tested it several different ways, and I'm led to believe that there may be a bug. 

Full example here:

http://stackoverflow.com/questions/3393013/problem-activerecord-rails3-chaining-scopes-with-includes

(running rails 3.0.0.beta4).</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;Maybe I'm doing something wrong, but it seems that when chaining
scopes that each have an :includes on different tables, that only
the first include is converted into a join in the generated SQL;
the :include from the second scope is ignored. The scopes both work
fine on their own, but fail when combined (since the second join is
missing). I've tested it several different ways, and I'm led to
believe that there may be a bug.&lt;/p&gt;
&lt;p&gt;Full example here:&lt;/p&gt;
&lt;p&gt;&lt;a href=
&quot;http://stackoverflow.com/questions/3393013/problem-activerecord-rails3-chaining-scopes-with-includes&quot;&gt;
http://stackoverflow.com/questions/3393013/problem-activerecord-rai...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;(running rails 3.0.0.beta4).&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Maybe I'm doing something wrong, but it seems that when chaining scopes that each have an :includes on different tables, that only the first include is converted into a join in the generated SQL; the :include from the second scope is ignored. The scopes both work fine on their own, but fail when combined (since the second join is missing). I've tested it several different ways, and I'm led to believe that there may be a bug. 

Full example here:

http://stackoverflow.com/questions/3393013/problem-activerecord-rails3-chaining-scopes-with-includes

(running rails 3.0.0.beta4).</body>
      <body-html>&lt;div&gt;&lt;p&gt;Maybe I'm doing something wrong, but it seems that when chaining
scopes that each have an :includes on different tables, that only
the first include is converted into a join in the generated SQL;
the :include from the second scope is ignored. The scopes both work
fine on their own, but fail when combined (since the second join is
missing). I've tested it several different ways, and I'm led to
believe that there may be a bug.&lt;/p&gt;
&lt;p&gt;Full example here:&lt;/p&gt;
&lt;p&gt;&lt;a href=
&quot;http://stackoverflow.com/questions/3393013/problem-activerecord-rails3-chaining-scopes-with-includes&quot;&gt;
http://stackoverflow.com/questions/3393013/problem-activerecord-rai...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;(running rails 3.0.0.beta4).&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-03T15:18:27+01:00</created-at>
      <creator-id type="integer">40656</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5285</number>
      <permalink>chaining-two-scopes-with-includes-drops-the-second-includes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerelation rails3rc</tag>
      <title>chaining two scopes with :includes, drops the second :includes </title>
      <updated-at type="datetime">2010-08-03T15:18:31+01:00</updated-at>
      <user-id type="integer">40656</user-id>
      <version type="integer">1</version>
      <user-name>Sean</user-name>
      <creator-name>Sean</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5285</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40263</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>working on this one.</body>
      <body-html>&lt;div&gt;&lt;p&gt;working on this one.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-04T01:51:42+01:00</created-at>
      <creator-id type="integer">40656</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
:priority: 0
:milestone: 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">5285</number>
      <permalink>chaining-two-scopes-with-includes-drops-the-second-includes</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>activerelation rails3rc</tag>
      <title>chaining two scopes with :includes, drops the second :includes </title>
      <updated-at type="datetime">2010-08-04T01:51:47+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">2</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Sean</creator-name>
      <assigned-user-name>Neeraj Singh</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5285</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Attached is patch with test.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Attached is patch with test.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-04T05:04:40+01:00</created-at>
      <creator-id type="integer">40656</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 40263
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">5285</number>
      <permalink>chaining-two-scopes-with-includes-drops-the-second-includes</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>activerelation rails3rc</tag>
      <title>chaining two scopes with :includes, drops the second :includes </title>
      <updated-at type="datetime">2010-08-04T05:04:41+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">3</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Sean</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5285</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>(from [8fdecaaef210355cb21da08daa44487549888bbf]) Ensure we can nest include calls [#5285 state:resolved]

Signed-off-by: Jos&#233; Valim &lt;jose.valim@gmail.com&gt;
http://github.com/rails/rails/commit/8fdecaaef210355cb21da08daa44487549888bbf</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/8fdecaaef210355cb21da08daa44487549888bbf&quot;
title=
&quot;Changeset [8fdecaaef210355cb21da08daa44487549888bbf]&quot;&gt;[8fdecaaef210355cb21da08daa44487549888bbf]&lt;/a&gt;)
Ensure we can nest include calls [&lt;a href=
&quot;/projects/8994/tickets/5285&quot; title=&quot;Ticket #5285&quot;&gt;#5285&lt;/a&gt;
state:resolved]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jos&amp;eacute; Valim &lt;a href=
&quot;mailto:jose.valim@gmail.com&quot;&gt;jose.valim@gmail.com&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/8fdecaaef210355cb21da08daa44487549888bbf&quot;&gt;
http://github.com/rails/rails/commit/8fdecaaef210355cb21da08daa4448...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-08-14T12:23:28+01:00</created-at>
      <creator-id type="integer">40656</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">5285</number>
      <permalink>chaining-two-scopes-with-includes-drops-the-second-includes</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>activerelation rails3rc</tag>
      <title>chaining two scopes with :includes, drops the second :includes </title>
      <updated-at type="datetime">2010-08-14T12:23:35+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">4</version>
      <user-name>Repository</user-name>
      <creator-name>Sean</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5285</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>a039d7c39f453fa66fb3ce86fe21656c53cc7926</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-08-04T05:04:40+01:00</created-at>
      <filename>5285_fix_for_edge.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">614294</id>
      <size type="integer">4851</size>
      <uploader-id type="integer">40263</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/614294/5285_fix_for_edge.diff</url>
    </attachment>
  </attachments>
</ticket>
