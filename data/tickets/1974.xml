<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">424</assigned-user-id>
  <attachments-count type="integer">3</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-02-14T20:56:45+00:00</created-at>
  <creator-id type="integer">7400</creator-id>
  <milestone-due-on type="datetime">2009-01-31T00:00:00+00:00</milestone-due-on>
  <milestone-id type="integer" nil="true"></milestone-id>
  <number type="integer">1974</number>
  <permalink>layout-picked-from-wrong-view_paths</permalink>
  <priority type="integer">60</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>2.3 actionpack layout view_paths</tag>
  <title>Layout picked from wrong view_paths?</title>
  <updated-at type="datetime">2009-04-13T23:58:54+01:00</updated-at>
  <user-id type="integer">17393</user-id>
  <version type="integer">16</version>
  <user-name>Repository</user-name>
  <creator-name>Sven Fuchs</creator-name>
  <assigned-user-name>Joshua Peek</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
  <priority-name nil="true"></priority-name>
  <original-body>Still not too familiar with ActionPack's internals, so I'm not entirely sure on this but ...

In 2.2.x pick_layout returned a String like &quot;layouts/default&quot; which then would be resolved using the current view's view_paths (which could be changed on a per-request basis).

Now pick_layout already returns a Template instance which is returned untouched from view_paths' find_template. (I guess this is because in 2.3 view_paths are now instantiated as EagerPaths by default?)

Thus, when a new view_path has been added to the current view's view_paths pick_layout will ignore this and instead pick a template based on the controller class' view_paths.

The attached patch is a workaround for this problem but obviously not a good solution. I wonder why pick_layout/active_layout do not use the current view's view_path anyway.</original-body>
  <latest-body>Still not too familiar with ActionPack's internals, so I'm not entirely sure on this but ...

In 2.2.x pick_layout returned a String like &quot;layouts/default&quot; which then would be resolved using the current view's view_paths (which could be changed on a per-request basis).

Now pick_layout already returns a Template instance which is returned untouched from view_paths' find_template. (I guess this is because in 2.3 view_paths are now instantiated as EagerPaths by default?)

Thus, when a new view_path has been added to the current view's view_paths pick_layout will ignore this and instead pick a template based on the controller class' view_paths.

The attached patch is a workaround for this problem but obviously not a good solution. I wonder why pick_layout/active_layout do not use the current view's view_path anyway.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;Still not too familiar with ActionPack's internals, so I'm not
entirely sure on this but ...&lt;/p&gt;
&lt;p&gt;In 2.2.x pick_layout returned a String like &quot;layouts/default&quot;
which then would be resolved using the current view's view_paths
(which could be changed on a per-request basis).&lt;/p&gt;
&lt;p&gt;Now pick_layout already returns a Template instance which is
returned untouched from view_paths' find_template. (I guess this is
because in 2.3 view_paths are now instantiated as EagerPaths by
default?)&lt;/p&gt;
&lt;p&gt;Thus, when a new view_path has been added to the current view's
view_paths pick_layout will ignore this and instead pick a template
based on the controller class' view_paths.&lt;/p&gt;
&lt;p&gt;The attached patch is a workaround for this problem but
obviously not a good solution. I wonder why
pick_layout/active_layout do not use the current view's view_path
anyway.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Still not too familiar with ActionPack's internals, so I'm not entirely sure on this but ...

In 2.2.x pick_layout returned a String like &quot;layouts/default&quot; which then would be resolved using the current view's view_paths (which could be changed on a per-request basis).

Now pick_layout already returns a Template instance which is returned untouched from view_paths' find_template. (I guess this is because in 2.3 view_paths are now instantiated as EagerPaths by default?)

Thus, when a new view_path has been added to the current view's view_paths pick_layout will ignore this and instead pick a template based on the controller class' view_paths.

The attached patch might point out a workaround for this problem but obviously this is not a good solution. I wonder why pick_layout/active_layout do not use the current view's view_path anyway.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Still not too familiar with ActionPack's internals, so I'm not
entirely sure on this but ...&lt;/p&gt;
&lt;p&gt;In 2.2.x pick_layout returned a String like &quot;layouts/default&quot;
which then would be resolved using the current view's view_paths
(which could be changed on a per-request basis).&lt;/p&gt;
&lt;p&gt;Now pick_layout already returns a Template instance which is
returned untouched from view_paths' find_template. (I guess this is
because in 2.3 view_paths are now instantiated as EagerPaths by
default?)&lt;/p&gt;
&lt;p&gt;Thus, when a new view_path has been added to the current view's
view_paths pick_layout will ignore this and instead pick a template
based on the controller class' view_paths.&lt;/p&gt;
&lt;p&gt;The attached patch might point out a workaround for this problem
but obviously this is not a good solution. I wonder why
pick_layout/active_layout do not use the current view's view_path
anyway.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-14T20:56:45+00:00</created-at>
      <creator-id type="integer">7400</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1974</number>
      <permalink>layout-picked-from-wrong-view_paths</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 actionpack layout view_paths</tag>
      <title>Layout picked from wrong view_paths?</title>
      <updated-at type="datetime">2009-02-14T21:11:14+00:00</updated-at>
      <user-id type="integer">7400</user-id>
      <version type="integer">1</version>
      <user-name>Sven Fuchs</user-name>
      <creator-name>Sven Fuchs</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-14T21:08:43+00:00</created-at>
      <creator-id type="integer">7400</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1974</number>
      <permalink>layout-picked-from-wrong-view_paths</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 actionpack layout view_paths</tag>
      <title>Layout picked from wrong view_paths?</title>
      <updated-at type="datetime">2009-02-14T21:08:44+00:00</updated-at>
      <user-id type="integer">1366</user-id>
      <version type="integer">2</version>
      <user-name>Pratik</user-name>
      <creator-name>Sven Fuchs</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Ok, obviously that workaround would need to take into account that there might not be a layout present (changed that). Anyway, it's only there for pointing into the right direction ;)</body>
      <body-html>&lt;div&gt;&lt;p&gt;Ok, obviously that workaround would need to take into account
that there might not be a layout present (changed that). Anyway,
it's only there for pointing into the right direction ;)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-14T21:14:02+00:00</created-at>
      <creator-id type="integer">7400</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1974</number>
      <permalink>layout-picked-from-wrong-view_paths</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 actionpack layout view_paths</tag>
      <title>Layout picked from wrong view_paths?</title>
      <updated-at type="datetime">2009-02-14T21:14:33+00:00</updated-at>
      <user-id type="integer">7400</user-id>
      <version type="integer">3</version>
      <user-name>Sven Fuchs</user-name>
      <creator-name>Sven Fuchs</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>(from [0cb020b4d6d838025859bd60fb8151c8e21b8e84]) workaround for picking layouts based on wrong view_paths [#1974 state:resolved]

Signed-off-by: Joshua Peek &lt;josh@joshpeek.com&gt;
http://github.com/rails/rails/commit/0cb020b4d6d838025859bd60fb8151c8e21b8e84</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from [0cb020b4d6d838025859bd60fb8151c8e21b8e84]) workaround for
picking layouts based on wrong view_paths [&lt;a href=&quot;/projects/8994/tickets/1974&quot; title=&quot;Ticket #1974&quot;&gt;#1974&lt;/a&gt;
state:resolved]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Joshua Peek &lt;a href=&quot;mailto:josh@joshpeek.com&quot;&gt;josh@joshpeek.com&lt;/a&gt; &lt;a href=&quot;http://github.com/rails/rails/commit/0cb020b4d6d838025859bd60fb8151c8e21b8e84&quot;&gt;
http://github.com/rails/rails/co...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-02-15T00:27:33+00:00</created-at>
      <creator-id type="integer">7400</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1974</number>
      <permalink>layout-picked-from-wrong-view_paths</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>2.3 actionpack layout view_paths</tag>
      <title>Layout picked from wrong view_paths?</title>
      <updated-at type="datetime">2009-02-15T00:27:36+00:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">4</version>
      <user-name>Repository</user-name>
      <creator-name>Sven Fuchs</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Nice. Thanks :)</body>
      <body-html>&lt;div&gt;&lt;p&gt;Nice. Thanks :)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-02-15T00:30:38+00:00</created-at>
      <creator-id type="integer">7400</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1974</number>
      <permalink>layout-picked-from-wrong-view_paths</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>2.3 actionpack layout view_paths</tag>
      <title>Layout picked from wrong view_paths?</title>
      <updated-at type="datetime">2009-02-15T00:30:41+00:00</updated-at>
      <user-id type="integer">7400</user-id>
      <version type="integer">5</version>
      <user-name>Sven Fuchs</user-name>
      <creator-name>Sven Fuchs</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Actually this did not really resolve the issue. It obviously only works for layouts that are already present in the class' view_path - they will then be loaded from the location given in the instance's view_path.

When the layout is not present in the class' view_path an exception is raised even though the layout is present in the instance's view_path.

Is there any reason not to use the instance's view_path for looking up the layout? I might have a look into a patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Actually this did not really resolve the issue. It obviously
only works for layouts that are already present in the class'
view_path - they will then be loaded from the location given in the
instance's view_path.&lt;/p&gt;
&lt;p&gt;When the layout is not present in the class' view_path an
exception is raised even though the layout is present in the
instance's view_path.&lt;/p&gt;
&lt;p&gt;Is there any reason not to use the instance's view_path for
looking up the layout? I might have a look into a patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-02-19T17:32:06+00:00</created-at>
      <creator-id type="integer">7400</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1974</number>
      <permalink>layout-picked-from-wrong-view_paths</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>2.3 actionpack layout view_paths</tag>
      <title>Layout picked from wrong view_paths?</title>
      <updated-at type="datetime">2009-02-19T17:32:09+00:00</updated-at>
      <user-id type="integer">7400</user-id>
      <version type="integer">6</version>
      <user-name>Sven Fuchs</user-name>
      <creator-name>Sven Fuchs</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Sven, class-level `view_paths` are probably used due to how inheritable layouts are implemented.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Sven, class-level &lt;code&gt;view_paths&lt;/code&gt; are probably used due
to how inheritable layouts are implemented.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-02-19T19:57:29+00:00</created-at>
      <creator-id type="integer">7400</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1974</number>
      <permalink>layout-picked-from-wrong-view_paths</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>2.3 actionpack layout view_paths</tag>
      <title>Layout picked from wrong view_paths?</title>
      <updated-at type="datetime">2009-02-19T19:57:31+00:00</updated-at>
      <user-id type="integer">46643</user-id>
      <version type="integer">7</version>
      <user-name>thedarkone</user-name>
      <creator-name>Sven Fuchs</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>thedarkone, 

unless i'm mistaken that only affects the &quot;layout name&quot; but not necessarily the selection of an actual template (which now happens because of the recent introduction of EagerPath).

I'll have a closer look into this and try to come up with another patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;thedarkone,&lt;/p&gt;
&lt;p&gt;unless i'm mistaken that only affects the &quot;layout name&quot; but not
necessarily the selection of an actual template (which now happens
because of the recent introduction of EagerPath).&lt;/p&gt;
&lt;p&gt;I'll have a closer look into this and try to come up with
another patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-02-20T10:57:27+00:00</created-at>
      <creator-id type="integer">7400</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1974</number>
      <permalink>layout-picked-from-wrong-view_paths</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>2.3 actionpack layout view_paths</tag>
      <title>Layout picked from wrong view_paths?</title>
      <updated-at type="datetime">2009-02-20T10:57:32+00:00</updated-at>
      <user-id type="integer">7400</user-id>
      <version type="integer">8</version>
      <user-name>Sven Fuchs</user-name>
      <creator-name>Sven Fuchs</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Ok, patch is attached. I'll reopen the ticket.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Ok, patch is attached. I'll reopen the ticket.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-20T14:25:27+00:00</created-at>
      <creator-id type="integer">7400</creator-id>
      <diffable-attributes type="yaml">--- 
:state: resolved
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1974</number>
      <permalink>layout-picked-from-wrong-view_paths</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.3 actionpack layout view_paths</tag>
      <title>Layout picked from wrong view_paths?</title>
      <updated-at type="datetime">2009-02-20T14:25:36+00:00</updated-at>
      <user-id type="integer">7400</user-id>
      <version type="integer">9</version>
      <user-name>Sven Fuchs</user-name>
      <creator-name>Sven Fuchs</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Awesome, it looks a bit cleaner now.

I think some rjs related layout fix got applied after you created this patch. Could you please rebase yours with master and I'll give it another shot.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Awesome, it looks a bit cleaner now.&lt;/p&gt;
&lt;p&gt;I think some rjs related layout fix got applied after you
created this patch. Could you please rebase yours with master and
I'll give it another shot.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-20T17:04:03+00:00</created-at>
      <creator-id type="integer">7400</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1974</number>
      <permalink>layout-picked-from-wrong-view_paths</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.3 actionpack layout view_paths</tag>
      <title>Layout picked from wrong view_paths?</title>
      <updated-at type="datetime">2009-02-20T17:04:06+00:00</updated-at>
      <user-id type="integer">424</user-id>
      <version type="integer">10</version>
      <user-name>Joshua Peek</user-name>
      <creator-name>Sven Fuchs</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Whooops. I thought I would have patched against master but apparently I was on v2.3.0

Hopefully I've got it right now. New patch is attached.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Whooops. I thought I would have patched against master but
apparently I was on v2.3.0&lt;/p&gt;
&lt;p&gt;Hopefully I've got it right now. New patch is attached.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-20T18:35:11+00:00</created-at>
      <creator-id type="integer">7400</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1974</number>
      <permalink>layout-picked-from-wrong-view_paths</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.3 actionpack layout view_paths</tag>
      <title>Layout picked from wrong view_paths?</title>
      <updated-at type="datetime">2009-02-20T18:35:15+00:00</updated-at>
      <user-id type="integer">7400</user-id>
      <version type="integer">11</version>
      <user-name>Sven Fuchs</user-name>
      <creator-name>Sven Fuchs</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Hmmm, i just notice that there's one failing test in the actionmailer tests. Doesn't seem to be related to this patch though. Is that some known bug?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Hmmm, i just notice that there's one failing test in the
actionmailer tests. Doesn't seem to be related to this patch
though. Is that some known bug?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-20T18:38:03+00:00</created-at>
      <creator-id type="integer">7400</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1974</number>
      <permalink>layout-picked-from-wrong-view_paths</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>2.3 actionpack layout view_paths</tag>
      <title>Layout picked from wrong view_paths?</title>
      <updated-at type="datetime">2009-02-20T18:38:05+00:00</updated-at>
      <user-id type="integer">7400</user-id>
      <version type="integer">12</version>
      <user-name>Sven Fuchs</user-name>
      <creator-name>Sven Fuchs</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>(from [8c5cc66a831aadb159f3daaffa4208064c30af0e]) make action_controller/layouts pick templates from the current instance's view_paths instead of the class view_paths [#1974 state:resolved]

Signed-off-by: Joshua Peek &lt;josh@joshpeek.com&gt;
http://github.com/rails/rails/commit/8c5cc66a831aadb159f3daaffa4208064c30af0e</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from [8c5cc66a831aadb159f3daaffa4208064c30af0e]) make
action_controller/layouts pick templates from the current
instance's view_paths instead of the class view_paths [&lt;a href=&quot;/projects/8994/tickets/1974&quot; title=&quot;Ticket #1974&quot;&gt;#1974&lt;/a&gt;
state:resolved]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Joshua Peek &lt;a href=&quot;mailto:josh@joshpeek.com&quot;&gt;josh@joshpeek.com&lt;/a&gt; &lt;a href=&quot;http://github.com/rails/rails/commit/8c5cc66a831aadb159f3daaffa4208064c30af0e&quot;&gt;
http://github.com/rails/rails/co...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-02-20T20:20:02+00:00</created-at>
      <creator-id type="integer">7400</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1974</number>
      <permalink>layout-picked-from-wrong-view_paths</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>2.3 actionpack layout view_paths</tag>
      <title>Layout picked from wrong view_paths?</title>
      <updated-at type="datetime">2009-02-20T20:20:04+00:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">13</version>
      <user-name>Repository</user-name>
      <creator-name>Sven Fuchs</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Josh, you can close #1919 as well since this ticket is essentially the same as mine. You may want to add the extra tests from my patch in light of the regressions we've been having.

One thing to note is that automatic layout assignment doesn't work with per-request view paths with either this patch or my patch. The auto_layout variable is set in the alias chained inherited method and searches the default view path so any automatic layouts that only exist in the per-request view path are not detected.

I'll investigate further to see if I can get it to work.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Josh, you can close &lt;a href=&quot;/projects/8994/tickets/1919&quot; title=&quot;Ticket #1919&quot;&gt;#1919&lt;/a&gt; as well since this ticket is essentially
the same as mine. You may want to add the extra tests from my patch
in light of the regressions we've been having.&lt;/p&gt;
&lt;p&gt;One thing to note is that automatic layout assignment doesn't
work with per-request view paths with either this patch or my
patch. The auto_layout variable is set in the alias chained
inherited method and searches the default view path so any
automatic layouts that only exist in the per-request view path are
not detected.&lt;/p&gt;
&lt;p&gt;I'll investigate further to see if I can get it to work.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-02-21T04:23:36+00:00</created-at>
      <creator-id type="integer">7400</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1974</number>
      <permalink>layout-picked-from-wrong-view_paths</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>2.3 actionpack layout view_paths</tag>
      <title>Layout picked from wrong view_paths?</title>
      <updated-at type="datetime">2009-02-21T04:23:40+00:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">14</version>
      <user-name>Andrew White</user-name>
      <creator-name>Sven Fuchs</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>(from [906aebceedb95d8caa6db6314bc90f605bdfaf2b]) Bring abstract_controller up to date with rails/master

Resolved all the conflicts since 2.3.0 -&gt; HEAD. Following is a list
of commits that could not be applied cleanly or are obviated with the
abstract_controller refactor. They all need to be revisited to ensure
that fixes made in 2.3 do not reappear in 3.0:

2259ecf368e6a6715966f69216e3ee86bf1a82a7
AR not available
  * This will be reimplemented with ActionORM or equivalent

06182ea02e92afad579998aa80144588e8865ac3
implicitly rendering a js response should not use the default layout
[#1844 state:resolved]
  * This will be handled generically

893e9eb99504705419ad6edac14d00e71cef5f12
Improve view rendering performance in development mode and reinstate
template recompiling in production [#1909 state:resolved]
  * We will need to reimplement rails-dev-boost on top of the refactor;
    the changes here are very implementation specific and cannot be
    cleanly applied. The following commits are implicated:

      199e750d46c04970b5e7684998d09405648ecbd4
      3942cb406e1d5db0ac00e03153809cc8dc4cc4db
      f8ea9f85d4f1e3e6f3b5d895bef6b013aa4b0690
      e3b166aab37ddc2fbab030b146eb61713b91bf55
      ae9f258e03c9fd5088da12c1c6cd216cc89a01f7
      44423126c6f6133a1d9cf1d0832b527e8711d40f

0cb020b4d6d838025859bd60fb8151c8e21b8e84
workaround for picking layouts based on wrong view_paths
[#1974 state:resolved]
  * The specifics of this commit no longer apply. Since it is a two-line
    commit, we will reimplement this change.

8c5cc66a831aadb159f3daaffa4208064c30af0e
make action_controller/layouts pick templates from the current instance's
view_paths instead of the class view_paths [#1974 state:resolved]
  * This does not apply at all. It should be trivial to apply the feature
    to the reimplemented ActionController::Base.

87e8b162463f13bd50d27398f020769460a770e3
fix HTML fallback for explicit templates [#2052 state:resolved]
  * There were a number of patches related to this that simply compounded
    each other. Basically none of them apply cleanly, and the underlying
    issue needs to be revisited. After discussing the underlying problem
    with Koz, we will defer these fixes for further discussion.
http://github.com/rails/rails/commit/906aebceedb95d8caa6db6314bc90f605bdfaf2b</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from [906aebceedb95d8caa6db6314bc90f605bdfaf2b]) Bring
abstract_controller up to date with rails/master&lt;/p&gt;
&lt;p&gt;Resolved all the conflicts since 2.3.0 -&amp;gt; HEAD. Following is
a list of commits that could not be applied cleanly or are obviated
with the abstract_controller refactor. They all need to be
revisited to ensure that fixes made in 2.3 do not reappear in
3.0:&lt;/p&gt;
&lt;p&gt;2259ecf368e6a6715966f69216e3ee86bf1a82a7 AR not available * This
will be reimplemented with ActionORM or equivalent&lt;/p&gt;
&lt;p&gt;06182ea02e92afad579998aa80144588e8865ac3 implicitly rendering a
js response should not use the default layout [&lt;a href=&quot;/projects/8994/tickets/1844&quot; title=&quot;Ticket #1844&quot;&gt;#1844&lt;/a&gt;
state:resolved] * This will be handled generically&lt;/p&gt;
&lt;p&gt;893e9eb99504705419ad6edac14d00e71cef5f12 Improve view rendering
performance in development mode and reinstate template recompiling
in production [&lt;a href=&quot;/projects/8994/tickets/1909&quot; title=&quot;Ticket #1909&quot;&gt;#1909&lt;/a&gt; state:resolved] * We will need to
reimplement rails-dev-boost on top of the refactor;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;the changes here are very implementation specific and cannot be
cleanly applied. The following commits are implicated:

  199e750d46c04970b5e7684998d09405648ecbd4
  3942cb406e1d5db0ac00e03153809cc8dc4cc4db
  f8ea9f85d4f1e3e6f3b5d895bef6b013aa4b0690
  e3b166aab37ddc2fbab030b146eb61713b91bf55
  ae9f258e03c9fd5088da12c1c6cd216cc89a01f7
  44423126c6f6133a1d9cf1d0832b527e8711d40f
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;0cb020b4d6d838025859bd60fb8151c8e21b8e84 workaround for picking
layouts based on wrong view_paths [&lt;a href=&quot;/projects/8994/tickets/1974&quot; title=&quot;Ticket #1974&quot;&gt;#1974&lt;/a&gt;
state:resolved] * The specifics of this commit no longer apply.
Since it is a two-line&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;commit, we will reimplement this change.
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;8c5cc66a831aadb159f3daaffa4208064c30af0e make
action_controller/layouts pick templates from the current
instance's view_paths instead of the class view_paths [&lt;a href=&quot;/projects/8994/tickets/1974&quot; title=&quot;Ticket #1974&quot;&gt;#1974&lt;/a&gt;
state:resolved] * This does not apply at all. It should be trivial
to apply the feature&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;to the reimplemented ActionController::Base.
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;87e8b162463f13bd50d27398f020769460a770e3 fix HTML fallback for
explicit templates [&lt;a href=&quot;/projects/8994/tickets/2052&quot; title=&quot;Ticket #2052&quot;&gt;#2052&lt;/a&gt; state:resolved] * There were a number of
patches related to this that simply compounded&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;each other. Basically none of them apply cleanly, and the underlying
issue needs to be revisited. After discussing the underlying problem
with Koz, we will defer these fixes for further discussion.
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/rails/rails/commit/906aebceedb95d8caa6db6314bc90f605bdfaf2b&quot;&gt;
http://github.com/rails/rails/co...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-04-13T23:58:49+01:00</created-at>
      <creator-id type="integer">7400</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1974</number>
      <permalink>layout-picked-from-wrong-view_paths</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>2.3 actionpack layout view_paths</tag>
      <title>Layout picked from wrong view_paths?</title>
      <updated-at type="datetime">2009-04-13T23:58:53+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">15</version>
      <user-name>Repository</user-name>
      <creator-name>Sven Fuchs</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>(from [906aebceedb95d8caa6db6314bc90f605bdfaf2b]) Bring abstract_controller up to date with rails/master

Resolved all the conflicts since 2.3.0 -&gt; HEAD. Following is a list
of commits that could not be applied cleanly or are obviated with the
abstract_controller refactor. They all need to be revisited to ensure
that fixes made in 2.3 do not reappear in 3.0:

2259ecf368e6a6715966f69216e3ee86bf1a82a7
AR not available
  * This will be reimplemented with ActionORM or equivalent

06182ea02e92afad579998aa80144588e8865ac3
implicitly rendering a js response should not use the default layout
[#1844 state:resolved]
  * This will be handled generically

893e9eb99504705419ad6edac14d00e71cef5f12
Improve view rendering performance in development mode and reinstate
template recompiling in production [#1909 state:resolved]
  * We will need to reimplement rails-dev-boost on top of the refactor;
    the changes here are very implementation specific and cannot be
    cleanly applied. The following commits are implicated:

      199e750d46c04970b5e7684998d09405648ecbd4
      3942cb406e1d5db0ac00e03153809cc8dc4cc4db
      f8ea9f85d4f1e3e6f3b5d895bef6b013aa4b0690
      e3b166aab37ddc2fbab030b146eb61713b91bf55
      ae9f258e03c9fd5088da12c1c6cd216cc89a01f7
      44423126c6f6133a1d9cf1d0832b527e8711d40f

0cb020b4d6d838025859bd60fb8151c8e21b8e84
workaround for picking layouts based on wrong view_paths
[#1974 state:resolved]
  * The specifics of this commit no longer apply. Since it is a two-line
    commit, we will reimplement this change.

8c5cc66a831aadb159f3daaffa4208064c30af0e
make action_controller/layouts pick templates from the current instance's
view_paths instead of the class view_paths [#1974 state:resolved]
  * This does not apply at all. It should be trivial to apply the feature
    to the reimplemented ActionController::Base.

87e8b162463f13bd50d27398f020769460a770e3
fix HTML fallback for explicit templates [#2052 state:resolved]
  * There were a number of patches related to this that simply compounded
    each other. Basically none of them apply cleanly, and the underlying
    issue needs to be revisited. After discussing the underlying problem
    with Koz, we will defer these fixes for further discussion.
http://github.com/rails/rails/commit/906aebceedb95d8caa6db6314bc90f605bdfaf2b</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from [906aebceedb95d8caa6db6314bc90f605bdfaf2b]) Bring
abstract_controller up to date with rails/master&lt;/p&gt;
&lt;p&gt;Resolved all the conflicts since 2.3.0 -&amp;gt; HEAD. Following is
a list of commits that could not be applied cleanly or are obviated
with the abstract_controller refactor. They all need to be
revisited to ensure that fixes made in 2.3 do not reappear in
3.0:&lt;/p&gt;
&lt;p&gt;2259ecf368e6a6715966f69216e3ee86bf1a82a7 AR not available * This
will be reimplemented with ActionORM or equivalent&lt;/p&gt;
&lt;p&gt;06182ea02e92afad579998aa80144588e8865ac3 implicitly rendering a
js response should not use the default layout [&lt;a href=&quot;/projects/8994/tickets/1844&quot; title=&quot;Ticket #1844&quot;&gt;#1844&lt;/a&gt;
state:resolved] * This will be handled generically&lt;/p&gt;
&lt;p&gt;893e9eb99504705419ad6edac14d00e71cef5f12 Improve view rendering
performance in development mode and reinstate template recompiling
in production [&lt;a href=&quot;/projects/8994/tickets/1909&quot; title=&quot;Ticket #1909&quot;&gt;#1909&lt;/a&gt; state:resolved] * We will need to
reimplement rails-dev-boost on top of the refactor;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;the changes here are very implementation specific and cannot be
cleanly applied. The following commits are implicated:

  199e750d46c04970b5e7684998d09405648ecbd4
  3942cb406e1d5db0ac00e03153809cc8dc4cc4db
  f8ea9f85d4f1e3e6f3b5d895bef6b013aa4b0690
  e3b166aab37ddc2fbab030b146eb61713b91bf55
  ae9f258e03c9fd5088da12c1c6cd216cc89a01f7
  44423126c6f6133a1d9cf1d0832b527e8711d40f
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;0cb020b4d6d838025859bd60fb8151c8e21b8e84 workaround for picking
layouts based on wrong view_paths [&lt;a href=&quot;/projects/8994/tickets/1974&quot; title=&quot;Ticket #1974&quot;&gt;#1974&lt;/a&gt;
state:resolved] * The specifics of this commit no longer apply.
Since it is a two-line&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;commit, we will reimplement this change.
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;8c5cc66a831aadb159f3daaffa4208064c30af0e make
action_controller/layouts pick templates from the current
instance's view_paths instead of the class view_paths [&lt;a href=&quot;/projects/8994/tickets/1974&quot; title=&quot;Ticket #1974&quot;&gt;#1974&lt;/a&gt;
state:resolved] * This does not apply at all. It should be trivial
to apply the feature&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;to the reimplemented ActionController::Base.
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;87e8b162463f13bd50d27398f020769460a770e3 fix HTML fallback for
explicit templates [&lt;a href=&quot;/projects/8994/tickets/2052&quot; title=&quot;Ticket #2052&quot;&gt;#2052&lt;/a&gt; state:resolved] * There were a number of
patches related to this that simply compounded&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;each other. Basically none of them apply cleanly, and the underlying
issue needs to be revisited. After discussing the underlying problem
with Koz, we will defer these fixes for further discussion.
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/rails/rails/commit/906aebceedb95d8caa6db6314bc90f605bdfaf2b&quot;&gt;
http://github.com/rails/rails/co...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-04-13T23:58:49+01:00</created-at>
      <creator-id type="integer">7400</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">1974</number>
      <permalink>layout-picked-from-wrong-view_paths</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>2.3 actionpack layout view_paths</tag>
      <title>Layout picked from wrong view_paths?</title>
      <updated-at type="datetime">2009-04-13T23:58:54+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">16</version>
      <user-name>Repository</user-name>
      <creator-name>Sven Fuchs</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1974</url>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>a20f10327a5837b40fd42ac5462fa528528231f5</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-02-14T21:14:02+00:00</created-at>
      <filename>0001-workaround-for-picking-layouts-based-on-wrong-view_p-2.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">88920</id>
      <size type="integer">1028</size>
      <uploader-id type="integer">7400</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/88920/0001-workaround-for-picking-layouts-based-on-wrong-view_p-2.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>cbda705f1865da3e1d7ef1fca50d50f9e299fbcc</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-02-20T14:25:27+00:00</created-at>
      <filename>0001-make-action_controller-layouts-pick-templates-from-t.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">91105</id>
      <size type="integer">5633</size>
      <uploader-id type="integer">7400</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/91105/0001-make-action_controller-layouts-pick-templates-from-t.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>2d9b3c2e762d38694c09db473e1b10a56aef45e2</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-02-20T18:35:11+00:00</created-at>
      <filename>0001-make-action_controller-layouts-pick-templates-from-t-master.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">91257</id>
      <size type="integer">5692</size>
      <uploader-id type="integer">7400</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/91257/0001-make-action_controller-layouts-pick-templates-from-t-master.patch</url>
    </attachment>
  </attachments>
</ticket>
