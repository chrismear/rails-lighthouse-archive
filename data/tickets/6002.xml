<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">7341</assigned-user-id>
  <attachments-count type="integer">0</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2010-11-18T14:43:02+00:00</created-at>
  <creator-id type="integer">12050</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">71472</milestone-id>
  <number type="integer">6002</number>
  <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
  <priority type="integer">3</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>committed</state>
  <tag>3.x cookie_store patch</tag>
  <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
  <updated-at type="datetime">2011-04-03T04:58:26+01:00</updated-at>
  <user-id type="integer">74704</user-id>
  <version type="integer">26</version>
  <user-name>Aaron Hamid</user-name>
  <creator-name>Ravil Bayramgalin</creator-name>
  <assigned-user-name>Piotr Sarnacki</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
  <milestone-title>3.x</milestone-title>
  <priority-name>Low</priority-name>
  <original-body>Currently, if you use :all option for cookie store domain, cookies are created with wrong domain when site accessed via ip address or localhost.

For example, if we set
    config.session_store :cookie_store, :key =&gt; '_site_session', :domain =&gt; :all
then cookie will be set with wrong domain '.1.1' after we visit our site via ip address 192.168.1.1.

I've attached a small and simple patch which fixes this behavior.</original-body>
  <latest-body>Currently, if you use :all option for cookie store domain, cookies are created with wrong domain when site accessed via ip address or localhost.

For example, if we set
    config.session_store :cookie_store, :key =&gt; '_site_session', :domain =&gt; :all
then cookie will be set with wrong domain '.1.1' after we visit our site via ip address 192.168.1.1.

I've attached a small and simple patch which fixes this behavior.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;Currently, if you use :all option for cookie store domain,
cookies are created with wrong domain when site accessed via ip
address or localhost.&lt;/p&gt;
&lt;p&gt;For example, if we set&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;config.session_store :cookie_store, :key =&amp;gt; '_site_session', :domain =&amp;gt; :all&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;then cookie will be set with wrong domain '.1.1' after we visit
our site via ip address 192.168.1.1.&lt;/p&gt;
&lt;p&gt;I've attached a small and simple patch which fixes this
behavior.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer">94458</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Currently, if you use :all option for cookie store domain, cookies are created with wrong domain when site accessed via ip address or localhost.

For example, if we set
    config.session_store :cookie_store, :key =&gt; '_site_session', :domain =&gt; :all
then cookie will be set with wrong domain '.1.1' after we visit our site via ip address 192.168.1.1.

I've attached a small and simple patch which fixes this behavior.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Currently, if you use :all option for cookie store domain,
cookies are created with wrong domain when site accessed via ip
address or localhost.&lt;/p&gt;
&lt;p&gt;For example, if we set&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;config.session_store :cookie_store, :key =&amp;gt; '_site_session', :domain =&amp;gt; :all&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;then cookie will be set with wrong domain '.1.1' after we visit
our site via ip address 192.168.1.1.&lt;/p&gt;
&lt;p&gt;I've attached a small and simple patch which fixes this
behavior.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-11-18T14:43:02+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-11-18T14:43:03+00:00</updated-at>
      <user-id type="integer">12050</user-id>
      <version type="integer">1</version>
      <user-name>Ravil Bayramgalin</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Jeff Kreeftmeijer</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">94458</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I'm not sure of a reason, but I can not attach a patch via lighthouse. So you can get it at http://gist.github.com/705069. Sorry, for inconvenience.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I'm not sure of a reason, but I can not attach a patch via
lighthouse. So you can get it at &lt;a href=
&quot;http://gist.github.com/705069&quot;&gt;http://gist.github.com/705069&lt;/a&gt;.
Sorry, for inconvenience.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-11-18T14:51:02+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-11-18T14:51:04+00:00</updated-at>
      <user-id type="integer">12050</user-id>
      <version type="integer">2</version>
      <user-name>Ravil Bayramgalin</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Jeff Kreeftmeijer</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>http://gist.github.com/705069 - I've updated patch to prevent setting of localhost as domain for cookies.</body>
      <body-html>&lt;div&gt;&lt;p&gt;&lt;a href=
&quot;http://gist.github.com/705069&quot;&gt;http://gist.github.com/705069&lt;/a&gt; -
I've updated patch to prevent setting of localhost as domain for
cookies.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-11-18T23:00:20+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 94458
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-11-18T23:00:22+00:00</updated-at>
      <user-id type="integer">12050</user-id>
      <version type="integer">3</version>
      <user-name>Ravil Bayramgalin</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Ravil, please change the regexp to match IPv4 and IPv6 addresses.
Thanks for helping ;).</body>
      <body-html>&lt;div&gt;&lt;p&gt;Ravil, please change the regexp to match IPv4 and IPv6
addresses.&lt;br&gt;
Thanks for helping ;).&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-11-19T16:09:42+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
:state: new
:milestone: 
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-11-19T16:09:54+00:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">4</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>http://gist.github.com/705069 - I've updated patch so explicit domain for cookies with domain :all option is set only when host is a domain name. 

Always glad to help ;)</body>
      <body-html>&lt;div&gt;&lt;p&gt;&lt;a href=
&quot;http://gist.github.com/705069&quot;&gt;http://gist.github.com/705069&lt;/a&gt; -
I've updated patch so explicit domain for cookies with domain :all
option is set only when host is a domain name.&lt;/p&gt;
&lt;p&gt;Always glad to help ;)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-11-19T17:13:03+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-11-19T17:13:06+00:00</updated-at>
      <user-id type="integer">12050</user-id>
      <version type="integer">5</version>
      <user-name>Ravil Bayramgalin</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I think you should set the domain for ipv4 and ipv6 addresses.
And fix the regexp to match this addresses.
Thanks.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I think you should set the domain for ipv4 and ipv6
addresses.&lt;br&gt;
And fix the regexp to match this addresses.&lt;br&gt;
Thanks.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-11-19T20:14:21+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-11-19T20:14:24+00:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">6</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>In irc we've come to conclusion that rails should set nil domain for ipv4/ipv6 addresses. It equals to implicit setting of domain for cookies. Therefore behavior of attached patch is appropriate.

However, Santiago suggested to try and add a check for ip address inside of domain regexp.  Unfortunately upon closer inspection it seems really hard to do if not impossible, so I suggest to use current patch as it is.</body>
      <body-html>&lt;div&gt;&lt;p&gt;In irc we've come to conclusion that rails should set nil domain
for ipv4/ipv6 addresses. It equals to implicit setting of domain
for cookies. Therefore behavior of attached patch is
appropriate.&lt;/p&gt;
&lt;p&gt;However, Santiago suggested to try and add a check for ip
address inside of domain regexp. Unfortunately upon closer
inspection it seems really hard to do if not impossible, so I
suggest to use current patch as it is.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-11-19T23:58:10+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-11-19T23:58:12+00:00</updated-at>
      <user-id type="integer">12050</user-id>
      <version type="integer">7</version>
      <user-name>Ravil Bayramgalin</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>The patch still sets an illegal cookie domain name on localhost, you could improve it a little bit by checking @host =~ /\w\.[a-z]\w/i 
this will make sure there is at least one dot and not all of them are numbers.</body>
      <body-html>&lt;div&gt;&lt;p&gt;The patch still sets an illegal cookie domain name on localhost,
you could improve it a little bit by checking @host =~
/\w.[a-z]\w/i&lt;br&gt;
this will make sure there is at least one dot and not all of them
are numbers.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-06T15:51:51+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-06T15:52:03+00:00</updated-at>
      <user-id type="integer">8551</user-id>
      <version type="integer">8</version>
      <user-name>Fjan</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Domains like lvh.me don't works too. It generate a cookie for lvh.me, and for each subdomains. This is doing my flash messages don't works as it should.

I create a ticket for this. https://rails.lighthouseapp.com/projects/8994/tickets/6120-flash-message-dont-clear</body>
      <body-html>&lt;div&gt;&lt;p&gt;Domains like lvh.me don't works too. It generate a cookie for
lvh.me, and for each subdomains. This is doing my flash messages
don't works as it should.&lt;/p&gt;
&lt;p&gt;I create a ticket for this. &lt;a href=
&quot;https://rails.lighthouseapp.com/projects/8994/tickets/6120-flash-message-dont-clear&quot;&gt;
https://rails.lighthouseapp.com/projects/8994/tickets/6120-flash-me...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-06T16:53:51+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-06T16:54:07+00:00</updated-at>
      <user-id type="integer">60702</user-id>
      <version type="integer">9</version>
      <user-name>Rafael Mendon&#231;a Fran&#231;a</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Fjan, could you give an example why do you think that patch sets illegal cookie domain name on localhost? As you could see in tests from patch I explicitly check this case:

    def test_cookie_with_all_domain_option_using_localhost
      @request.host = &quot;localhost&quot;
      get :set_cookie_with_domain
      assert_response :success
      assert_cookie_header &quot;user_name=rizwanreza; path=/&quot;
    end

And all tests pass. It works because both /^[\d.]+$/ and DOMAIN_REGEXP check a mandatory dot in hostname, if both checks fail then &quot;when&quot; expression returns default value for &quot;else&quot; branch which is nil. Setting options[:domain]=nil makes rails not to set an explicit domain name for cookies therefore we're using an implicit domain name which is completely legal.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Fjan, could you give an example why do you think that patch sets
illegal cookie domain name on localhost? As you could see in tests
from patch I explicitly check this case:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;def test_cookie_with_all_domain_option_using_localhost
  @request.host = &quot;localhost&quot;
  get :set_cookie_with_domain
  assert_response :success
  assert_cookie_header &quot;user_name=rizwanreza; path=/&quot;
end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;And all tests pass. It works because both /^[\d.]+$/ and
DOMAIN_REGEXP check a mandatory dot in hostname, if both checks
fail then &quot;when&quot; expression returns default value for &quot;else&quot; branch
which is nil. Setting options[:domain]=nil makes rails not to set
an explicit domain name for cookies therefore we're using an
implicit domain name which is completely legal.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-07T04:29:07+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-07T04:29:22+00:00</updated-at>
      <user-id type="integer">12050</user-id>
      <version type="integer">10</version>
      <user-name>Ravil Bayramgalin</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Rafael Mendon&#231;a Fran&#231;a, I would gladly provide an additional patch for domain :all handling so you could set an arbitrary TLD length or provide a list of base domain names on which your application is running. But it will be a separate path from this one because of the patch goals.

And to supply a new patch in this direction I need to know will current patch be applied or not so I could use appropriate codebase.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Rafael Mendon&amp;ccedil;a Fran&amp;ccedil;a, I would gladly provide an
additional patch for domain :all handling so you could set an
arbitrary TLD length or provide a list of base domain names on
which your application is running. But it will be a separate path
from this one because of the patch goals.&lt;/p&gt;
&lt;p&gt;And to supply a new patch in this direction I need to know will
current patch be applied or not so I could use appropriate
codebase.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-07T04:34:30+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-07T04:34:44+00:00</updated-at>
      <user-id type="integer">12050</user-id>
      <version type="integer">11</version>
      <user-name>Ravil Bayramgalin</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>@Ravil, you are right, I stand corrected. Would be nice if we can think of a regex that does both checks in one go though.</body>
      <body-html>&lt;div&gt;&lt;p&gt;@Ravil, you are right, I stand corrected. Would be nice if we
can think of a regex that does both checks in one go though.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-07T10:30:10+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-07T10:30:23+00:00</updated-at>
      <user-id type="integer">8551</user-id>
      <version type="integer">12</version>
      <user-name>Fjan</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>@Ravil, thank you. I would really appreciate if you submit another patch for this.</body>
      <body-html>&lt;div&gt;&lt;p&gt;@Ravil, thank you. I would really appreciate if you submit
another patch for this.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-07T12:20:25+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-07T12:20:38+00:00</updated-at>
      <user-id type="integer">60702</user-id>
      <version type="integer">13</version>
      <user-name>Rafael Mendon&#231;a Fran&#231;a</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>@Fjan, yes, it would be nice to make a domain regexp which not conforms to ip address. Initially I had the same idea, unfortunately, during development i quickly discovered that it's not possible. Lets take a look at current domain regexp - ([^.]*)\.([^.]*|..\...|...\...)$

It's pretty self-explanatory if you take a close look. But to exclude ip address from this regexp we would need to add a condition that's not all symbols are digitals (there is at least one non-digital symbol except from dot), and in the same time we still need to match different parts of host to separate domain and subdomain. It's a perfect place for Regexp.intersection, unfortunately, there is no such method only Regexp.union. Lookahead/lookbehind won't work in this case, cause then we won't match a whole string.

But I've found a good alternative to having a one regexp
    (@host !~ /^[\d.]+$/) &amp;&amp; (@host =~ DOMAIN_REGEXP)

So I've rewrote my patch and added commentary so it will be easier to understand at first glance.

New patch is located here https://gist.github.com/734907</body>
      <body-html>&lt;div&gt;&lt;p&gt;@Fjan, yes, it would be nice to make a domain regexp which not
conforms to ip address. Initially I had the same idea,
unfortunately, during development i quickly discovered that it's
not possible. Lets take a look at current domain regexp -
([^.]&lt;em&gt;).([^.]&lt;/em&gt;|.....|......)$&lt;/p&gt;
&lt;p&gt;It's pretty self-explanatory if you take a close look. But to
exclude ip address from this regexp we would need to add a
condition that's not all symbols are digitals (there is at least
one non-digital symbol except from dot), and in the same time we
still need to match different parts of host to separate domain and
subdomain. It's a perfect place for Regexp.intersection,
unfortunately, there is no such method only Regexp.union.
Lookahead/lookbehind won't work in this case, cause then we won't
match a whole string.&lt;/p&gt;
&lt;p&gt;But I've found a good alternative to having a one regexp&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;(@host !~ /^[\d.]+$/) &amp;amp;&amp;amp; (@host =~ DOMAIN_REGEXP)&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;So I've rewrote my patch and added commentary so it will be
easier to understand at first glance.&lt;/p&gt;
&lt;p&gt;New patch is located here &lt;a href=
&quot;https://gist.github.com/734907&quot;&gt;https://gist.github.com/734907&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-09T17:34:46+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-09T17:35:12+00:00</updated-at>
      <user-id type="integer">12050</user-id>
      <version type="integer">14</version>
      <user-name>Ravil Bayramgalin</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>@Rafael, I've adding a second patch which supports supplying list of domains for cookies.

For example, you could set :domain =&gt; %w(.lvh.me .some-other-domain.com) and your cookies will be shared on lvh.me and some-other-domain.com domains.</body>
      <body-html>&lt;div&gt;&lt;p&gt;@Rafael, I've adding a second patch which supports supplying
list of domains for cookies.&lt;/p&gt;
&lt;p&gt;For example, you could set :domain =&amp;gt; %w(.lvh.me
.some-other-domain.com) and your cookies will be shared on lvh.me
and some-other-domain.com domains.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-09T17:38:11+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-09T17:38:23+00:00</updated-at>
      <user-id type="integer">12050</user-id>
      <version type="integer">15</version>
      <user-name>Ravil Bayramgalin</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>@Rafael, oops, sorry forgot to attach a link to second patch https://gist.github.com/734913</body>
      <body-html>&lt;div&gt;&lt;p&gt;@Rafael, oops, sorry forgot to attach a link to second patch
&lt;a href=
&quot;https://gist.github.com/734913&quot;&gt;https://gist.github.com/734913&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-09T17:48:56+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-09T17:49:22+00:00</updated-at>
      <user-id type="integer">12050</user-id>
      <version type="integer">16</version>
      <user-name>Ravil Bayramgalin</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>It's look nice. But my problem is when I have domains like this www.app.me, mysubdomain.app.me. They should share the same cookies with domain .app.me. But they have a domain for each case.</body>
      <body-html>&lt;div&gt;&lt;p&gt;It's look nice. But my problem is when I have domains like this
&lt;a href=&quot;http://www.app.me&quot;&gt;www.app.me&lt;/a&gt;, mysubdomain.app.me.
They should share the same cookies with domain .app.me. But they
have a domain for each case.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-09T17:59:51+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-09T18:00:10+00:00</updated-at>
      <user-id type="integer">60702</user-id>
      <version type="integer">17</version>
      <user-name>Rafael Mendon&#231;a Fran&#231;a</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>To share cookies with subdomains for one domain, you could simply set :domain =&gt; '.app.me' or does this not work for you?</body>
      <body-html>&lt;div&gt;&lt;p&gt;To share cookies with subdomains for one domain, you could
simply set :domain =&amp;gt; '.app.me' or does this not work for
you?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-09T18:05:00+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-09T18:05:13+00:00</updated-at>
      <user-id type="integer">12050</user-id>
      <version type="integer">18</version>
      <user-name>Ravil Bayramgalin</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Sure. This works fine, but I have to set the cookie store for each environment in my application, making the session_store initialer useless.

It would be interesting that the domain could be modified without the need to set the session_store in each environment.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Sure. This works fine, but I have to set the cookie store for
each environment in my application, making the session_store
initialer useless.&lt;/p&gt;
&lt;p&gt;It would be interesting that the domain could be modified
without the need to set the session_store in each environment.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-09T18:13:45+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-09T18:13:59+00:00</updated-at>
      <user-id type="integer">60702</user-id>
      <version type="integer">19</version>
      <user-name>Rafael Mendon&#231;a Fran&#231;a</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Oh, I see. Then if you prefer to set a custom tld length instead of passing a list of domains, give me another day I'll cook up one more patch ;)</body>
      <body-html>&lt;div&gt;&lt;p&gt;Oh, I see. Then if you prefer to set a custom tld length instead
of passing a list of domains, give me another day I'll cook up one
more patch ;)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-09T18:16:15+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-09T18:16:27+00:00</updated-at>
      <user-id type="integer">12050</user-id>
      <version type="integer">20</version>
      <user-name>Ravil Bayramgalin</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Ok. Thanks @Ravil.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Ok. Thanks @Ravil.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-09T18:19:58+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-09T18:20:10+00:00</updated-at>
      <user-id type="integer">60702</user-id>
      <version type="integer">21</version>
      <user-name>Rafael Mendon&#231;a Fran&#231;a</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">40272</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>First patch (https://gist.github.com/734907) looks good to me.

Could you please open a new ticket for the second one? This will get messy if both are discussed here.</body>
      <body-html>&lt;div&gt;&lt;p&gt;First patch (&lt;a href=
&quot;https://gist.github.com/734907&quot;&gt;https://gist.github.com/734907&lt;/a&gt;)
looks good to me.&lt;/p&gt;
&lt;p&gt;Could you please open a new ticket for the second one? This will
get messy if both are discussed here.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-10T08:57:03+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-10T08:57:22+00:00</updated-at>
      <user-id type="integer">7341</user-id>
      <version type="integer">22</version>
      <user-name>Piotr Sarnacki</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Santiago Pastorino</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">7341</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Ok, sure I'll create a separate ticket for additional functionality but can you please merge this one if it looks good? Cause additional functionality is based on changes in first patch anyway.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Ok, sure I'll create a separate ticket for additional
functionality but can you please merge this one if it looks good?
Cause additional functionality is based on changes in first patch
anyway.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-12-15T12:39:19+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 40272
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-15T12:39:33+00:00</updated-at>
      <user-id type="integer">12050</user-id>
      <version type="integer">23</version>
      <user-name>Ravil Bayramgalin</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Piotr Sarnacki</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">7341</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>(from [439c23dce33148064c258eaf6e79f9d4563c88a4]) Fix edge cases for domain :all option on cookie store

Dont set explicit domain for cookies if host is not a domain name

[#6002 state:committed]

Signed-off-by: Santiago Pastorino &lt;santiago@wyeworks.com&gt;
https://github.com/rails/rails/commit/439c23dce33148064c258eaf6e79f9d4563c88a4</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/439c23dce33148064c258eaf6e79f9d4563c88a4&quot;
title=
&quot;Changeset [439c23dce33148064c258eaf6e79f9d4563c88a4]&quot;&gt;[439c23dce33148064c258eaf6e79f9d4563c88a4]&lt;/a&gt;)
Fix edge cases for domain :all option on cookie store&lt;/p&gt;
&lt;p&gt;Dont set explicit domain for cookies if host is not a domain
name&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;/projects/8994/tickets/6002&quot; title=
&quot;Ticket #6002&quot;&gt;#6002&lt;/a&gt; state:committed]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Santiago Pastorino
&lt;a&gt;santiago@wyeworks.com&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;https://github.com/rails/rails/commit/439c23dce33148064c258eaf6e79f9d4563c88a4&quot;&gt;
https://github.com/rails/rails/commit/439c23dce33148064c258eaf6e79f...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-12-15T13:04:48+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-15T13:05:03+00:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">24</version>
      <user-name>Repository</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Piotr Sarnacki</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">7341</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>@Rafael, sorry it took me a long time, but I have finally added requested functionality to set custom tld length. You can see patch at https://rails.lighthouseapp.com/projects/8994-ruby-on-rails/tickets/6196-patch-improve-support-for-non-standard-domain-names</body>
      <body-html>&lt;div&gt;&lt;p&gt;@Rafael, sorry it took me a long time, but I have finally added
requested functionality to set custom tld length. You can see patch
at &lt;a href=
&quot;https://rails.lighthouseapp.com/projects/8994-ruby-on-rails/tickets/6196-patch-improve-support-for-non-standard-domain-names&quot;&gt;
https://rails.lighthouseapp.com/projects/8994-ruby-on-rails/tickets...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-12-19T20:00:08+00:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2010-12-19T20:00:26+00:00</updated-at>
      <user-id type="integer">12050</user-id>
      <version type="integer">25</version>
      <user-name>Ravil Bayramgalin</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Piotr Sarnacki</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">7341</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>this is awesome, thanks Ravil! I spent so much time working around issues related to this.</body>
      <body-html>&lt;div&gt;&lt;p&gt;this is awesome, thanks Ravil! I spent so much time working
around issues related to this.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2011-04-03T04:58:10+01:00</created-at>
      <creator-id type="integer">12050</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">6002</number>
      <permalink>patch-ignore-domain-all-option-if-host-is-ip-address-or-localhost</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>3.x cookie_store patch</tag>
      <title>[PATCH] Ignore domain :all option if host is IP address or localhost</title>
      <updated-at type="datetime">2011-04-03T04:58:26+01:00</updated-at>
      <user-id type="integer">74704</user-id>
      <version type="integer">26</version>
      <user-name>Aaron Hamid</user-name>
      <creator-name>Ravil Bayramgalin</creator-name>
      <assigned-user-name>Piotr Sarnacki</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/6002</url>
      <milestone-title>3.x</milestone-title>
      <priority-name>Low</priority-name>
    </version>
  </versions>
</ticket>
