<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">19965</assigned-user-id>
  <attachments-count type="integer">4</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2011-02-22T08:32:35+00:00</created-at>
  <creator-id type="integer">24025</creator-id>
  <milestone-due-on type="datetime">2010-11-15T00:00:00+00:00</milestone-due-on>
  <milestone-id type="integer">88038</milestone-id>
  <number type="integer">458</number>
  <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
  <priority type="integer">17219</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag nil="true"></tag>
  <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
  <updated-at type="datetime">2011-03-26T02:38:59+00:00</updated-at>
  <user-id type="integer">142823</user-id>
  <version type="integer">34</version>
  <user-name>bingbing</user-name>
  <creator-name>Joran Greef</creator-name>
  <assigned-user-name>Jos&#233; Valim</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
  <milestone-title>3.0.2</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>In Rails 2.1, one would expect that rendering a record (eg. an invoice) as xml, and including a method such as other_ids (eg. item_ids, which yields an array) would result in:

&lt;invoice&gt;
  ...
  &lt;item-ids&gt;
    &lt;item-id&gt;1&lt;/item-id&gt;
    &lt;item-id&gt;2&lt;/item-id&gt;
    ...
  &lt;/item-ids&gt;
&lt;/invoice&gt;

What actually results however is:

&lt;invoice&gt;
  ...
  &lt;item-ids&gt;12&lt;/item-ids&gt;
&lt;/invoice&gt;

In other words, the other_ids method which returns an array is reduced by to_xml to a string containing the concatenated ids.

What's interesting is that to_json doesn't have a problem with any of this and gives [1,2] as would be expected.</original-body>
  <latest-body>In Rails 2.1, one would expect that rendering a record (eg. an invoice) as xml, and including a method such as other_ids (eg. item_ids, which yields an array) would result in:

&lt;invoice&gt;
  ...
  &lt;item-ids&gt;
    &lt;item-id&gt;1&lt;/item-id&gt;
    &lt;item-id&gt;2&lt;/item-id&gt;
    ...
  &lt;/item-ids&gt;
&lt;/invoice&gt;

What actually results however is:

&lt;invoice&gt;
  ...
  &lt;item-ids&gt;12&lt;/item-ids&gt;
&lt;/invoice&gt;

In other words, the other_ids method which returns an array is reduced by to_xml to a string containing the concatenated ids.

What's interesting is that to_json doesn't have a problem with any of this and gives [1,2] as would be expected.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;
In Rails 2.1, one would expect that rendering a record (eg. an invoice) as xml, and including a method such as other_ids (eg. item_ids, which yields an array) would result in:
&lt;/p&gt;&lt;p&gt;
...
&lt;/p&gt;&lt;p&gt;
1
&lt;/p&gt;&lt;p&gt;
2
&lt;/p&gt;&lt;p&gt;
...
&lt;/p&gt;&lt;p&gt;
What actually results however is:
&lt;/p&gt;&lt;p&gt;
...
&lt;/p&gt;&lt;p&gt;
12
&lt;/p&gt;&lt;p&gt;
In other words, the other_ids method which returns an array is reduced by to_xml to a string containing the concatenated ids.
&lt;/p&gt;&lt;p&gt;
What's interesting is that to_json doesn't have a problem with any of this and gives [1,2] as would be expected.
&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>In Rails 2.1, one would expect that rendering a record (eg. an invoice) as xml, and including a method such as other_ids (eg. item_ids, which yields an array) would result in:

@@@ html
&lt;invoice&gt;
  ...
  &lt;item-ids&gt;
    &lt;item-id&gt;1&lt;/item-id&gt;
    &lt;item-id&gt;2&lt;/item-id&gt;
    ...
  &lt;/item-ids&gt;
&lt;/invoice&gt;
@@@

What actually results however is:

@@@ html
&lt;invoice&gt;
  ...
  &lt;item-ids&gt;12&lt;/item-ids&gt;
&lt;/invoice&gt;
@@@

In other words, the other_ids method which returns an array is reduced by to_xml to a string containing the concatenated ids. What's interesting is that to_json doesn't have a problem with any of this and gives [1,2] as would be expected.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
In Rails 2.1, one would expect that rendering a record (eg. an invoice) as xml, and including a method such as other_ids (eg. item_ids, which yields an array) would result in:
&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;html&quot;&gt;&amp;lt;invoice&amp;gt;
  ...
  &amp;lt;item-ids&amp;gt;
    &amp;lt;item-id&amp;gt;1&amp;lt;/item-id&amp;gt;
    &amp;lt;item-id&amp;gt;2&amp;lt;/item-id&amp;gt;
    ...
  &amp;lt;/item-ids&amp;gt;
&amp;lt;/invoice&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;
What actually results however is:
&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;html&quot;&gt;&amp;lt;invoice&amp;gt;
  ...
  &amp;lt;item-ids&amp;gt;12&amp;lt;/item-ids&amp;gt;
&amp;lt;/invoice&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;
In other words, the other_ids method which returns an array is reduced by to_xml to a string containing the concatenated ids. What's interesting is that to_json doesn't have a problem with any of this and gives [1,2] as would be expected.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-07-22T15:19:54+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2008-07-22T15:19:54+01:00</updated-at>
      <user-id type="integer">24025</user-id>
      <version type="integer">1</version>
      <user-name>Joran Greef</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I think that's by design. As far as I see it, Rails converts a few types into &quot;special&quot; types and handles everything else as a string:
@@@ ruby
# taken from ActiveSupport::CoreExtensions::Hash::Conversions
XML_TYPE_NAMES = {
          &quot;Symbol&quot;     =&gt; &quot;symbol&quot;,
          &quot;Fixnum&quot;     =&gt; &quot;integer&quot;,
          &quot;Bignum&quot;     =&gt; &quot;integer&quot;,
          &quot;BigDecimal&quot; =&gt; &quot;decimal&quot;,
          &quot;Float&quot;      =&gt; &quot;float&quot;,
          &quot;Date&quot;       =&gt; &quot;date&quot;,
          &quot;DateTime&quot;   =&gt; &quot;datetime&quot;,
          &quot;Time&quot;       =&gt; &quot;datetime&quot;,
          &quot;TrueClass&quot;  =&gt; &quot;boolean&quot;,
          &quot;FalseClass&quot; =&gt; &quot;boolean&quot;
        } unless defined?(XML_TYPE_NAMES)
@@@

Everything that isn't in this hash will automatically be turned into a string. I guess you could just call serialize the method yourself (which is not very DRY). But I honestly don't know - I think I wouldn't expose associations like this but rather use the :include option.

Just my 2 cents, of course.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
I think that's by design. As far as I see it, Rails converts a few types into &quot;special&quot; types and handles everything else as a string:
&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;# taken from ActiveSupport::CoreExtensions::Hash::Conversions
XML_TYPE_NAMES = {
          &amp;quot;Symbol&amp;quot;     =&amp;gt; &amp;quot;symbol&amp;quot;,
          &amp;quot;Fixnum&amp;quot;     =&amp;gt; &amp;quot;integer&amp;quot;,
          &amp;quot;Bignum&amp;quot;     =&amp;gt; &amp;quot;integer&amp;quot;,
          &amp;quot;BigDecimal&amp;quot; =&amp;gt; &amp;quot;decimal&amp;quot;,
          &amp;quot;Float&amp;quot;      =&amp;gt; &amp;quot;float&amp;quot;,
          &amp;quot;Date&amp;quot;       =&amp;gt; &amp;quot;date&amp;quot;,
          &amp;quot;DateTime&amp;quot;   =&amp;gt; &amp;quot;datetime&amp;quot;,
          &amp;quot;Time&amp;quot;       =&amp;gt; &amp;quot;datetime&amp;quot;,
          &amp;quot;TrueClass&amp;quot;  =&amp;gt; &amp;quot;boolean&amp;quot;,
          &amp;quot;FalseClass&amp;quot; =&amp;gt; &amp;quot;boolean&amp;quot;
        } unless defined?(XML_TYPE_NAMES)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;
Everything that isn't in this hash will automatically be turned into a string. I guess you could just call serialize the method yourself (which is not very DRY). But I honestly don't know - I think I wouldn't expose associations like this but rather use the :include option.
&lt;/p&gt;&lt;p&gt;
Just my 2 cents, of course.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-07-10T20:07:57+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.1 activerecord bug to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2008-07-10T20:07:57+01:00</updated-at>
      <user-id type="integer">18096</user-id>
      <version type="integer">2</version>
      <user-name>Clemens Kofler</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Oops, didn't mean to change the tags - that just happened ... (but I guess it's right that way anyways)</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Oops, didn't mean to change the tags - that just happened ... (but I guess it's right that way anyways)
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-07-10T20:09:01+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.1 activerecord bug to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2008-07-10T20:09:01+01:00</updated-at>
      <user-id type="integer">18096</user-id>
      <version type="integer">3</version>
      <user-name>Clemens Kofler</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Hi Clemens, thanks for the comment. When it comes to type conversion, Rails certainly uses this to elegant effect in the JSON class.

However, the problem is that this is not a design issue (as applied to type conversion or content types). It's a data issue.

In other words, JSON and XML are merely data formats. The data itself should not change. In this case it does.

Rails to_json gets it right (Ruby array -&gt; Javascript array). Rails to_xml gets it wrong (Ruby array -&gt; concatenated string). to_xml gets resource collection arrays right. I see no reason why it can't get this right.

But regardless, it's a problem because :methods =&gt; other_ids is in the Rails docs and is supposed to be able to handle this. And to prove the point, the newly revamped Rails 2.1 to_json (which added :include and :methods support as far as I know) can handle this.

So it's actually quite a discrepancy. To resolve it, we either need to force to_json to concatenate any :methods =&gt; other_ids arrays to strings as to_xml does (which would serve no utilitarian purpose). Or update to_xml to the level that to_json is at in this regard.

Re: using :include vs :methods, I do use :include in other resources, but not for many-to-many resources where it makes more sense to use id references, as these kinds of relationships can often be of a more categorical/static/lookup nature.

In any event, the nature of REST is atomicity (i.e. smaller, simpler, lighter, factorized resources that can be cached and combined more easily with others in different ways as opposed to large data clumps). :methods is far closer to this ideal than :include.

It's important we get this fixed.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Hi Clemens, thanks for the comment. When it comes to type conversion, Rails certainly uses this to elegant effect in the JSON class.
&lt;/p&gt;&lt;p&gt;
However, the problem is that this is not a design issue (as applied to type conversion or content types). It's a data issue.
&lt;/p&gt;&lt;p&gt;
In other words, JSON and XML are merely data formats. The data itself should not change. In this case it does.
&lt;/p&gt;&lt;p&gt;
Rails to_json gets it right (Ruby array -&gt; Javascript array). Rails to_xml gets it wrong (Ruby array -&gt; concatenated string). to_xml gets resource collection arrays right. I see no reason why it can't get this right.
&lt;/p&gt;&lt;p&gt;
But regardless, it's a problem because :methods =&gt; other_ids is in the Rails docs and is supposed to be able to handle this. And to prove the point, the newly revamped Rails 2.1 to_json (which added :include and :methods support as far as I know) can handle this.
&lt;/p&gt;&lt;p&gt;
So it's actually quite a discrepancy. To resolve it, we either need to force to_json to concatenate any :methods =&gt; other_ids arrays to strings as to_xml does (which would serve no utilitarian purpose). Or update to_xml to the level that to_json is at in this regard.
&lt;/p&gt;&lt;p&gt;
Re: using :include vs :methods, I do use :include in other resources, but not for many-to-many resources where it makes more sense to use id references, as these kinds of relationships can often be of a more categorical/static/lookup nature.
&lt;/p&gt;&lt;p&gt;
In any event, the nature of REST is atomicity (i.e. smaller, simpler, lighter, factorized resources that can be cached and combined more easily with others in different ways as opposed to large data clumps). :methods is far closer to this ideal than :include.
&lt;/p&gt;&lt;p&gt;
It's important we get this fixed.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-07-10T20:35:51+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.1 activerecord bug to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2008-07-10T20:35:51+01:00</updated-at>
      <user-id type="integer">24025</user-id>
      <version type="integer">4</version>
      <user-name>Joran Greef</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Staling out, please reopen if this is still a problem.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Staling out, please reopen if this is still a problem.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-10-28T16:31:14+00:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>stale</state>
      <tag>2.1 activerecord bug to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2008-10-28T16:31:17+00:00</updated-at>
      <user-id type="integer">424</user-id>
      <version type="integer">5</version>
      <user-name>Joshua Peek</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Yep, still a problem.

Including the result of an other_ids method for JSON gives an array eg. [1,2,3,4,5]

Including the result of the same other_ids method for XML gives a string eg. &quot;12345&quot;

I'm not yet familiar enough with the workings of ActiveRecord to provide any form of patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Yep, still a problem.&lt;/p&gt;
&lt;p&gt;Including the result of an other_ids method for JSON gives an
array eg. [1,2,3,4,5]&lt;/p&gt;
&lt;p&gt;Including the result of the same other_ids method for XML gives
a string eg. &quot;12345&quot;&lt;/p&gt;
&lt;p&gt;I'm not yet familiar enough with the workings of ActiveRecord to
provide any form of patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-10-28T17:27:49+00:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>stale</state>
      <tag>2.1 activerecord bug to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2008-10-28T17:27:55+00:00</updated-at>
      <user-id type="integer">24025</user-id>
      <version type="integer">6</version>
      <user-name>Joran Greef</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Has this been fixed or is this not going to be addressed? I come up with this problem quite a bit and it'd be awesome if this was solved in Rails 3.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Has this been fixed or is this not going to be addressed? I come
up with this problem quite a bit and it'd be awesome if this was
solved in Rails 3.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-04-21T03:37:33+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 2.1 activerecord bug to_xml
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>stale</state>
      <tag>2.1 3.0 activerecord bug to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-21T03:37:36+01:00</updated-at>
      <user-id type="integer">82933</user-id>
      <version type="integer">7</version>
      <user-name>Garrett Bjerkhoel</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I recently migrated an app from using json to xml and got bit by this one. I will work on it and ,hopefully, will have a patch soon.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I recently migrated an app from using json to xml and got bit by
this one. I will work on it and ,hopefully, will have a patch
soon.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-04-21T17:08:58+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 2.1 3.0 activerecord bug to_xml
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>stale</state>
      <tag>2.3.6 3.0 activerecord bug to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-21T17:09:02+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">8</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>As Clements mentioned earlier any data type that is not in the mentioned list will be treated as string. Two major data types that are causing problems are hash and array.

A recap of the issue. 

class User  
  def lab
    [&quot;a&quot;,&quot;b&quot;]
  end
  def lab2
    {:foo =&gt; 'bar'}
  end
end

User.first.to_xml(:methods =&gt; [:lab, :lab2])
&lt;lab&gt;abc&lt;/lab&gt;
&lt;lab2&gt;foobar&lt;/lab2&gt;

User.first.to_json(:methods =&gt; [:lab, :lab2])
{\&quot;lab\&quot;:[\&quot;a\&quot;,\&quot;b\&quot;,\&quot;c\&quot;]
{}&quot;lab2\&quot;:{\&quot;foo\&quot;:\&quot;bar\&quot;}  

This issue exists in both 2.3.5 branch and rails3 edge.

I understand that in rails community mostly people use json but &quot;to_xml&quot; should be as close to &quot;to_json&quot; as much possible.</body>
      <body-html>&lt;div&gt;&lt;p&gt;As Clements mentioned earlier any data type that is not in the
mentioned list will be treated as string. Two major data types that
are causing problems are hash and array.&lt;/p&gt;
&lt;p&gt;A recap of the issue.&lt;/p&gt;
&lt;p&gt;class User&lt;br&gt;
def lab&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;[&quot;a&quot;,&quot;b&quot;]&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;end def lab2&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;{:foo =&amp;gt; 'bar'}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;end end&lt;/p&gt;
&lt;p&gt;User.first.to_xml(:methods =&amp;gt; [:lab, :lab2])&lt;br&gt;
abc&lt;br&gt;
foobar&lt;/p&gt;
&lt;p&gt;User.first.to_json(:methods =&amp;gt; [:lab, :lab2])&lt;br&gt;
{&lt;a href=&quot;[&quot;&gt;lab&lt;/a&gt; {}&lt;a href=&quot;{&quot;&gt;lab2&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;This issue exists in both 2.3.5 branch and rails3 edge.&lt;/p&gt;
&lt;p&gt;I understand that in rails community mostly people use json but
&quot;to_xml&quot; should be as close to &quot;to_json&quot; as much possible.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-04-21T20:40:23+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>stale</state>
      <tag>2.3.6 3.0 activerecord bug to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-21T20:40:28+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">9</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>lighthouse app team:

Please put preview next to &quot;Update Ticket&quot;. Even better would be a &quot;live preview&quot;.</body>
      <body-html>&lt;div&gt;&lt;p&gt;lighthouse app team:&lt;/p&gt;
&lt;p&gt;Please put preview next to &quot;Update Ticket&quot;. Even better would be
a &quot;live preview&quot;.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-04-21T20:42:27+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>stale</state>
      <tag>2.3.6 3.0 activerecord bug to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-21T20:42:29+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">10</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Attaching a proof of concept patch for 2-3-stable branch.

Please take a look and let me know. If I am heading in the right direction then I will add tests and will also provide patch for rails3 branch.

Assigning this ticket to Jose Valim since he recently did some code cleanup on xml_serializer in rails3 branch. http://github.com/rails/rails/commit/9476daa829f7dd0681121e042dd1356af0d50ca0</body>
      <body-html>&lt;div&gt;&lt;p&gt;Attaching a proof of concept patch for 2-3-stable branch.&lt;/p&gt;
&lt;p&gt;Please take a look and let me know. If I am heading in the right
direction then I will add tests and will also provide patch for
rails3 branch.&lt;/p&gt;
&lt;p&gt;Assigning this ticket to Jose Valim since he recently did some
code cleanup on xml_serializer in rails3 branch. &lt;a href=
&quot;http://github.com/rails/rails/commit/9476daa829f7dd0681121e042dd1356af0d50ca0&quot;&gt;
http://github.com/rails/rails/commit/9476daa829f7dd0681121e042dd135...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-04-22T16:02:34+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>stale</state>
      <tag>2.3.6 3.0 activerecord bug to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-22T16:02:37+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">11</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>With that above patch the output would be like this for hash and array instead of their to_s value.

&lt;code&gt;
&lt;lab2 type=&quot;hash&quot;&gt;{'john' : 'smith','foo' : 'bar'}&lt;/lab2&gt;
&lt;lab type=&quot;array&quot;&gt;['a','b','c']&lt;/lab&gt;
&lt;/code&gt;</body>
      <body-html>&lt;div&gt;&lt;p&gt;With that above patch the output would be like this for hash and
array instead of their to_s value.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&lt;br&gt;
{'john' : 'smith','foo' : 'bar'}&lt;br&gt;
['a','b','c']&lt;br&gt;&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-04-22T16:07:47+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>stale</state>
      <tag>2.3.6 3.0 activerecord bug to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-22T16:07:49+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">12</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>-1.

Today @hash.to_xml@ already works and I would expect a result similar to it. About the array, the result described in this ticket description looks good.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Today &lt;code&gt;hash.to_xml&lt;/code&gt; already works and I would expect
a result similar to it. About the array, the result described in
this ticket description looks good.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-22T16:11:46+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- 
:state: stale
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.6 3.0 activerecord bug to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-22T16:11:51+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">13</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>&gt; &quot;hash.to_xml already works&quot;

Can you elaborate on that?


@@@ ruby
#on 2-3-edge
h = {:foo =&gt; 'bar'}
=&gt; {:foo=&gt;&quot;bar&quot;}
h.to_xml
=&gt; &quot;&lt;hash&gt;\n  &lt;foo&gt;bar&lt;/foo&gt;\n&lt;/hash&gt;\n&quot;
@@@

hash.to_xml prints to_s value. However the values that are printed  for hash when model.to_json is called is entirely different. 

Take a look at this case.

@@@ ruby
class User
 def lab
   %w( a b c)
 end
 def lab2
  {:foo =&gt; 'bar'
 end
end

# current 2-3-edge
User.first.to_xml(:methods =&gt; [:lab, :lab2])
&lt;user&gt;
 &lt;id type=&quot;integer&quot;&gt;1&lt;/id&gt;
 &lt;name&gt;john&lt;/name&gt;
 &lt;lab&gt;abc&lt;/lab&gt;
 &lt;lab2&gt;foobar&lt;/lab2&gt;
&lt;/user&gt;

# current 2-3-edge
User.first.to_json(:methods =&gt; [:lab, :lab2])
&quot;{&quot;user&quot;:{&quot;lab2&quot;:{&quot;foo&quot;:&quot;bar&quot;},&quot;name&quot;:&quot;john&quot;,&quot;id&quot;:1,&quot;lab&quot;:[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;]}}&quot;

@@@

I think the value of to_xml for hash should match with the to_json value as much as possible.

Thanks for quick update.

Am I missing something here?</body>
      <body-html>&lt;div&gt;&lt;blockquote&gt;
&lt;p&gt;&quot;hash.to_xml already works&quot;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Can you elaborate on that?&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;#on 2-3-edge
h = {:foo =&amp;gt; 'bar'}
=&amp;gt; {:foo=&amp;gt;&quot;bar&quot;}
h.to_xml
=&amp;gt; &quot;&amp;lt;hash&amp;gt;\n  &amp;lt;foo&amp;gt;bar&amp;lt;/foo&amp;gt;\n&amp;lt;/hash&amp;gt;\n&quot;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;hash.to_xml prints to_s value. However the values that are
printed for hash when model.to_json is called is entirely
different.&lt;/p&gt;
&lt;p&gt;Take a look at this case.&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;class User
 def lab
   %w( a b c)
 end
 def lab2
  {:foo =&amp;gt; 'bar'
 end
end

# current 2-3-edge
User.first.to_xml(:methods =&amp;gt; [:lab, :lab2])
&amp;lt;user&amp;gt;
 &amp;lt;id type=&quot;integer&quot;&amp;gt;1&amp;lt;/id&amp;gt;
 &amp;lt;name&amp;gt;john&amp;lt;/name&amp;gt;
 &amp;lt;lab&amp;gt;abc&amp;lt;/lab&amp;gt;
 &amp;lt;lab2&amp;gt;foobar&amp;lt;/lab2&amp;gt;
&amp;lt;/user&amp;gt;

# current 2-3-edge
User.first.to_json(:methods =&amp;gt; [:lab, :lab2])
&quot;{&quot;user&quot;:{&quot;lab2&quot;:{&quot;foo&quot;:&quot;bar&quot;},&quot;name&quot;:&quot;john&quot;,&quot;id&quot;:1,&quot;lab&quot;:[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;]}}&quot;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;I think the value of to_xml for hash should match with the
to_json value as much as possible.&lt;/p&gt;
&lt;p&gt;Thanks for quick update.&lt;/p&gt;
&lt;p&gt;Am I missing something here?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-22T16:42:59+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.6 3.0 activerecord bug to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-22T16:43:01+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">14</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I cannot tell Rails 2.3 behavior, but on Rails 3.0:

@@@ ruby
{ :a =&gt; { :b =&gt; :c} }.to_xml #=&gt;
  &quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&lt;hash&gt;\n  &lt;a&gt;\n    &lt;b type=\&quot;symbol\&quot;&gt;c&lt;/b&gt;\n  &lt;/a&gt;\n&lt;/hash&gt;\n&quot;
@@@

This is the behavior I expect when serializing a hash. It should *not* match JSON. It should match XML. The same for an array.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I cannot tell Rails 2.3 behavior, but on Rails 3.0:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;{ :a =&amp;gt; { :b =&amp;gt; :c} }.to_xml #=&amp;gt;
  &quot;&amp;lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&amp;gt;\n&amp;lt;hash&amp;gt;\n  &amp;lt;a&amp;gt;\n    &amp;lt;b type=\&quot;symbol\&quot;&amp;gt;c&amp;lt;/b&amp;gt;\n  &amp;lt;/a&amp;gt;\n&amp;lt;/hash&amp;gt;\n&quot;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;This is the behavior I expect when serializing a hash. It should
&lt;em&gt;not&lt;/em&gt; match JSON. It should match XML. The same for an
array.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-22T16:46:37+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.6 3.0 activerecord bug to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-22T16:46:40+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">15</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Got it. I see what you mean. Thanks.

In that case I will first work on a patch for rails3 and will later work on 2-3 branch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Got it. I see what you mean. Thanks.&lt;/p&gt;
&lt;p&gt;In that case I will first work on a patch for rails3 and will
later work on 2-3 branch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-22T16:58:17+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.6 3.0 activerecord bug to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-22T16:58:20+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">16</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Attaching a patch that takes care of rendering array and hash in proper format. The current patch is only for rails3. If all goes well then I will backport it to 2-3-branch. 

Tests are attached too.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Attaching a patch that takes care of rendering array and hash in
proper format. The current patch is only for rails3. If all goes
well then I will backport it to 2-3-branch.&lt;/p&gt;
&lt;p&gt;Tests are attached too.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-22T21:37:12+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 2.3.6 3.0 activerecord bug to_xml
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.6 3.0 activerecord bug patch to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-22T21:37:16+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">17</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Hey, that's nice! We just need to wrap a few loose ends:

1) Why you removed the yaml test?

2) You should not handle the hash in a conditional inside &quot;add_attributes&quot;. Try to use just XML_FORMATTING;

3) The array formatting should output something like this:

@@@ ruby
  [1,2,3].to_xml #=&gt; &lt;socials type=&quot;array&quot;&gt;&lt;social&gt;1&lt;/social&gt;&lt;social&gt;2&lt;/social&gt;&lt;social&gt;3&lt;/social&gt;&lt;/socials&gt;
@@@

4) And we should add XML_PARSERS, to ensure that arrays and hash can be parsed back.

Good work!</body>
      <body-html>&lt;div&gt;&lt;p&gt;Hey, that's nice! We just need to wrap a few loose ends:&lt;/p&gt;
&lt;p&gt;1) Why you removed the yaml test?&lt;/p&gt;
&lt;p&gt;2) You should not handle the hash in a conditional inside
&quot;add_attributes&quot;. Try to use just XML_FORMATTING;&lt;/p&gt;
&lt;p&gt;3) The array formatting should output something like this:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=
&quot;ruby&quot;&gt;  [1,2,3].to_xml #=&amp;gt; &amp;lt;socials type=&quot;array&quot;&amp;gt;&amp;lt;social&amp;gt;1&amp;lt;/social&amp;gt;&amp;lt;social&amp;gt;2&amp;lt;/social&amp;gt;&amp;lt;social&amp;gt;3&amp;lt;/social&amp;gt;&amp;lt;/socials&amp;gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;4) And we should add XML_PARSERS, to ensure that arrays and hash
can be parsed back.&lt;/p&gt;
&lt;p&gt;Good work!&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-23T07:47:59+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.6 3.0 activerecord bug patch to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-23T07:48:06+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">18</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Thanks for the quick feedback. Will send you a new patch soon.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Thanks for the quick feedback. Will send you a new patch
soon.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-23T09:35:40+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.6 3.0 activerecord bug patch to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-23T09:35:46+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">19</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Attached is a new patch.

1) yaml test has been restored.

2) For the &quot;array&quot; and &quot;hash&quot; data type the content is prebuilt and adding the content to the builder using tag! method escapes all the content. The only way to ensure that content is not escaped is to use &quot;&lt;&lt;&quot; and I could not find a better place to put the logic. If you find a better place where the logic should be shifted then do let me know.

3) Array behaves as you suggested.

4) Completely missed your 4th point when I read your message in the morning. Have not worked on implementing same features in XML_PARSERS. Will wait for your feedback on the work done so far. If everything looks good then I will work on parsing the content back.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Attached is a new patch.&lt;/p&gt;
&lt;p&gt;1) yaml test has been restored.&lt;/p&gt;
&lt;p&gt;2) For the &quot;array&quot; and &quot;hash&quot; data type the content is prebuilt
and adding the content to the builder using tag! method escapes all
the content. The only way to ensure that content is not escaped is
to use &quot;&amp;lt;&amp;lt;&quot; and I could not find a better place to put the
logic. If you find a better place where the logic should be shifted
then do let me know.&lt;/p&gt;
&lt;p&gt;3) Array behaves as you suggested.&lt;/p&gt;
&lt;p&gt;4) Completely missed your 4th point when I read your message in
the morning. Have not worked on implementing same features in
XML_PARSERS. Will wait for your feedback on the work done so far.
If everything looks good then I will work on parsing the content
back.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-23T15:43:06+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.6 3.0 activerecord bug patch to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-23T15:43:08+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">20</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Hey, just want to let you know that I'm discussing your patch with Jeremy Kemper and I hope to have feedback soon.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Hey, just want to let you know that I'm discussing your patch
with Jeremy Kemper and I hope to have feedback soon.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-25T09:08:36+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.6 3.0 activerecord bug patch to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-25T09:08:39+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">21</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Hey mate, your patch is walking in the proper direction, but I guess you misunderstood me about the 2) comment.

Rails already knows how to convert array and hash types to XML and the build_tag method in your patch is kinda duplicating this behavior. Instead, it should be something like this:

@@@ ruby
    formatted_name = reformat_name(attribute.name)
    if attribute.raw_value.respond_to?(:to_xml)
      builder &lt;&lt; attribute.raw_value.to_xml(options.merge(:root =&gt; formatted_name))
    else
      builder.tag!(
        formatted_name,
        attribute.value.to_s,
        attribute.decorations(!options[:skip_types])
      )
    end
@@@

And now you are just going to use Array#to_xml and Hash#to_xml to do the hard work for you. You do not even need to write the formatters! A few gotchas I can think on top of my head: 

1) &quot;attribute.raw_value&quot; is not accessible, so you need to change that (just add it to the attr_accessor list);

2) Array#to_xml only handles arrays where all the elements responds to to_xml. So for instance, [1,2,3].to_xml won't work. So you first need to change Array#to_xml implementation to handle [1,2,3].to_xml. Basically, you have to check if the element in the array responds to to_xml, if not, if there is a XML_FORMATTER and if not, just convert it to string (very similar as you did in your patch).

After our discussion, I'm realizing that this change is really welcome! Feel free to break into different patches. You can for example create one initial patch that ensures [1,2,3].to_xml work as expected and with the proper tests in ActiveSupport test suite. And then you can change the ActiveModel implementation (the ActiveModel tests in the current patch looks great!).

Finally, since we are talking about hashes and arrays, Rails already knows how to parse them so I guess there is no need to write XML_PARSERS (I was wrong earlier :)).

If you have any doubts, please let me know!</body>
      <body-html>&lt;div&gt;&lt;p&gt;Hey mate, your patch is walking in the proper direction, but I
guess you misunderstood me about the 2) comment.&lt;/p&gt;
&lt;p&gt;Rails already knows how to convert array and hash types to XML
and the build_tag method in your patch is kinda duplicating this
behavior. Instead, it should be something like this:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=
&quot;ruby&quot;&gt;    formatted_name = reformat_name(attribute.name)
    if attribute.raw_value.respond_to?(:to_xml)
      builder &amp;lt;&amp;lt; attribute.raw_value.to_xml(options.merge(:root =&amp;gt; formatted_name))
    else
      builder.tag!(
        formatted_name,
        attribute.value.to_s,
        attribute.decorations(!options[:skip_types])
      )
    end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;And now you are just going to use Array#to_xml and Hash#to_xml
to do the hard work for you. You do not even need to write the
formatters! A few gotchas I can think on top of my head:&lt;/p&gt;
&lt;p&gt;1) &quot;attribute.raw_value&quot; is not accessible, so you need to
change that (just add it to the attr_accessor list);&lt;/p&gt;
&lt;p&gt;2) Array#to_xml only handles arrays where all the elements
responds to to_xml. So for instance, [1,2,3].to_xml won't work. So
you first need to change Array#to_xml implementation to handle
[1,2,3].to_xml. Basically, you have to check if the element in the
array responds to to_xml, if not, if there is a XML_FORMATTER and
if not, just convert it to string (very similar as you did in your
patch).&lt;/p&gt;
&lt;p&gt;After our discussion, I'm realizing that this change is really
welcome! Feel free to break into different patches. You can for
example create one initial patch that ensures [1,2,3].to_xml work
as expected and with the proper tests in ActiveSupport test suite.
And then you can change the ActiveModel implementation (the
ActiveModel tests in the current patch looks great!).&lt;/p&gt;
&lt;p&gt;Finally, since we are talking about hashes and arrays, Rails
already knows how to parse them so I guess there is no need to
write XML_PARSERS (I was wrong earlier :)).&lt;/p&gt;
&lt;p&gt;If you have any doubts, please let me know!&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-25T13:07:13+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.6 3.0 activerecord bug patch to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-25T13:07:18+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">22</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Thanks for the detailed feedback. 

I should have checked if array respond to to_xml or not. Well now I know. :-)

As you suggested, I will take baby steps and will create incremental patches. Will ping you in the mailing list  if I have any concerns.

Thanks again for the detailed feedback.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Thanks for the detailed feedback.&lt;/p&gt;
&lt;p&gt;I should have checked if array respond to to_xml or not. Well
now I know. :-)&lt;/p&gt;
&lt;p&gt;As you suggested, I will take baby steps and will create
incremental patches. Will ping you in the mailing list if I have
any concerns.&lt;/p&gt;
&lt;p&gt;Thanks again for the detailed feedback.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-25T14:10:34+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.6 3.0 activerecord bug patch to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-25T14:10:40+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">23</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>No code was required to fix this issue since all the work is now being done by to_xml itself. Look at this ticket for more information.

https://rails.lighthouseapp.com/projects/8994/tickets/4490

Attached is a patch which covers some test cases. Patch is against rails master.</body>
      <body-html>&lt;div&gt;&lt;p&gt;No code was required to fix this issue since all the work is now
being done by to_xml itself. Look at this ticket for more
information.&lt;/p&gt;
&lt;p&gt;&lt;a href=
&quot;https://rails.lighthouseapp.com/projects/8994/tickets/4490&quot;&gt;https://rails.lighthouseapp.com/projects/8994/tickets/4490&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Attached is a patch which covers some test cases. Patch is
against rails master.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-29T22:42:38+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.6 3.0 activerecord bug patch to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-29T22:42:40+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">24</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>(from [883f27aa9a6fae5194400bb8f00e343dcb610270]) test cases for record.to_xml [#458 state:resolved]

Signed-off-by: Jos&#233; Valim &lt;jose.valim@gmail.com&gt;
http://github.com/rails/rails/commit/883f27aa9a6fae5194400bb8f00e343dcb610270</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/883f27aa9a6fae5194400bb8f00e343dcb610270&quot;
title=
&quot;Changeset [883f27aa9a6fae5194400bb8f00e343dcb610270]&quot;&gt;[883f27aa9a6fae5194400bb8f00e343dcb610270]&lt;/a&gt;)
test cases for record.to_xml [&lt;a href=&quot;/projects/8994/tickets/458&quot;
title=&quot;Ticket #458&quot;&gt;#458&lt;/a&gt; state:resolved]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jos&amp;eacute; Valim &lt;a href=
&quot;mailto:jose.valim@gmail.com&quot;&gt;jose.valim@gmail.com&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/883f27aa9a6fae5194400bb8f00e343dcb610270&quot;&gt;
http://github.com/rails/rails/commit/883f27aa9a6fae5194400bb8f00e34...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-04-30T13:28:25+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>2.3.6 3.0 activerecord bug patch to_xml</tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-04-30T13:28:27+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">25</version>
      <user-name>Repository</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Automatic cleanup of spam.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Automatic cleanup of spam.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-10-09T21:55:04+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 2.3.6 3.0 activerecord bug patch to_xml
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">17219</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-10-09T21:55:06+01:00</updated-at>
      <user-id type="integer">14998</user-id>
      <version type="integer">27</version>
      <user-name>Ryan Bigg</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/31647)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/31647&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-10-15T23:01:28+01:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 27004
</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">17219</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-10-15T23:01:28+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">28</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Automatic cleanup of spam.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Automatic cleanup of spam.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-11-07T16:55:54+00:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">17219</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-11-07T16:55:57+00:00</updated-at>
      <user-id type="integer">94458</user-id>
      <version type="integer">30</version>
      <user-name>Jeff Kreeftmeijer</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>&lt;a href=http://www.beautiful-ugg.com &gt;ugg nederland&lt;/a&gt; with a legendary brand, first glimpse of &lt;a href=http://www.beautiful-ugg.com &gt;goedkope ugg&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;ugg laarzen&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;ugg australia nederland&lt;/a&gt;for both &lt;a href=http://www.beautiful-ugg.com &gt;ugg store rotterdam&lt;/a&gt;
&lt;a href=http://www.beautiful-ugg.com &gt;ugg schoenen&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;ugg kopen&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;ugg amsterdam&lt;/a&gt;beer-drinking cartoon appearance is not too cold, and it is a style boots, since many euramerican star street pats have sufficient terengganu Ugg snow handsome appearance and fashionable boots and the earth, Ugg sweep of popular wind continues to explode, &lt;a href=http://www.beautiful-ugg.com &gt;ugg bestellen&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;ugg online kopen&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;ugg online bestellen&lt;/a&gt; Ugg there are many fans.

About Australia Ugg sheep leather &lt;a href=http://www.beautiful-ugg.com &gt;kinder ugg&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;ugg goedkoop&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;ugg maten&lt;/a&gt; history dates back to 1978, called a Brian Smith Australian young surfing member once took a batch of sheep leather boots to America. In the past years, Australia craftsman people always habits in New Zealand seaside sewing sheep leather boots, however, is the young man with the business mind bold attempt will this Australian traditional products to the United States ugg boots sale.

At that time, he only a few several pairs &lt;a href=http://www.beautiful-ugg.com &gt;ugg nl&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;ugg in nederland&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;nep ugg&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;echte ugg&lt;/a&gt; leather boots, with full of passion and self-confidence, began in New York street hawkers. However, the start, he has not been so good luck, one day come down, did not sell a pair of &lt;a href=http://www.beautiful-ugg.com &gt;goedkoopste ugg&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;ugg goedkoopste&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;ugg voor kids&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;maten ugg&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;online ugg bestellen&lt;/a&gt; However, he did not lose heart, even a little stubborn think sure to succeed. He believes that, in the U.S. market will have a belong to his boots of heaven and earth.

So he decided to go to California western, to find opportunities. When he arrived at the destination and found there has been part of that such a man as he, with similar sheep leather boots at the seaside sale. Here he head round business into five customer sold 48 boots. Of course, can say is California developed surfing market attracted these from Australia boutique sheep leather boots. Australia &lt;a href=http://www.beautiful-ugg.com &gt;laarzen ugg&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;ugg amerika&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;uggs for cheap&lt;/a&gt;&lt;a href=http://www.beautiful-ugg.com &gt;ugg warmer schoenen&lt;/a&gt; sheep leather boots begins to become every surfers landed necessary article.</body>
      <body-html>&lt;div&gt;&lt;p&gt;&lt;a href=&quot;http:&quot;&gt;ugg nederland with a legendary brand, first
glimpse of &lt;a href=&quot;http:&quot;&gt;goedkope ugg&lt;a href=&quot;http:&quot;&gt;ugg
laarzen&lt;a href=&quot;http:&quot;&gt;ugg australia nederlandfor both &lt;a href=
&quot;http:&quot;&gt;ugg store rotterdam&lt;br&gt;
&lt;a href=&quot;http:&quot;&gt;ugg schoenen&lt;a href=&quot;http:&quot;&gt;ugg kopen&lt;a href=
&quot;http:&quot;&gt;ugg amsterdambeer-drinking cartoon appearance is not too
cold, and it is a style boots, since many euramerican star street
pats have sufficient terengganu Ugg snow handsome appearance and
fashionable boots and the earth, Ugg sweep of popular wind
continues to explode, &lt;a href=&quot;http:&quot;&gt;ugg bestellen&lt;a href=
&quot;http:&quot;&gt;ugg online kopen&lt;a href=&quot;http:&quot;&gt;ugg online bestellen Ugg
there are many fans.&lt;/p&gt;
&lt;p&gt;About Australia Ugg sheep leather &lt;a href=&quot;http:&quot;&gt;kinder
ugg&lt;a href=&quot;http:&quot;&gt;ugg goedkoop&lt;a href=&quot;http:&quot;&gt;ugg maten history
dates back to 1978, called a Brian Smith Australian young surfing
member once took a batch of sheep leather boots to America. In the
past years, Australia craftsman people always habits in New Zealand
seaside sewing sheep leather boots, however, is the young man with
the business mind bold attempt will this Australian traditional
products to the United States ugg boots sale.&lt;/p&gt;
&lt;p&gt;At that time, he only a few several pairs &lt;a href=&quot;http:&quot;&gt;ugg
nl&lt;a href=&quot;http:&quot;&gt;ugg in nederland&lt;a href=&quot;http:&quot;&gt;nep ugg&lt;a href=
&quot;http:&quot;&gt;echte ugg leather boots, with full of passion and
self-confidence, began in New York street hawkers. However, the
start, he has not been so good luck, one day come down, did not
sell a pair of &lt;a href=&quot;http:&quot;&gt;goedkoopste ugg&lt;a href=&quot;http:&quot;&gt;ugg
goedkoopste&lt;a href=&quot;http:&quot;&gt;ugg voor kids&lt;a href=&quot;http:&quot;&gt;maten
ugg&lt;a href=&quot;http:&quot;&gt;online ugg bestellen However, he did not lose
heart, even a little stubborn think sure to succeed. He believes
that, in the U.S. market will have a belong to his boots of heaven
and earth.&lt;/p&gt;
&lt;p&gt;So he decided to go to California western, to find
opportunities. When he arrived at the destination and found there
has been part of that such a man as he, with similar sheep leather
boots at the seaside sale. Here he head round business into five
customer sold 48 boots. Of course, can say is California developed
surfing market attracted these from Australia boutique sheep
leather boots. Australia &lt;a href=&quot;http:&quot;&gt;laarzen ugg&lt;a href=
&quot;http:&quot;&gt;ugg amerika&lt;a href=&quot;http:&quot;&gt;uggs for cheap&lt;a href=
&quot;http:&quot;&gt;ugg warmer schoenen sheep leather boots begins to become
every surfers landed necessary article.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-12-28T02:34:41+00:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">17219</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2010-12-28T03:36:08+00:00</updated-at>
      <user-id type="integer">130424</user-id>
      <version type="integer">31</version>
      <user-name>tdtgrdhg</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Good &lt;a href=http://www.sale-puma.com&gt;Puma shoes sale&lt;/a&gt; information for &lt;a href=http://www.sale-puma.com&gt;Puma shoes&lt;/a&gt; fans: Yesterday, German sportswear maker Cheap Running Shoes purchased effectively lot of money Brands. The transaction entails the Cobra brand, too as linked inventory, intellectual house and endorsement contracts. It also helps make &lt;a href=http://www.sale-puma.com&gt;puma speed cat&lt;/a&gt; Shoes . They provide you with the utmost game and support all through the feet.You can happen around several types of basketball sneakers such as high-top,low-top and mid-top.The &lt;a href=http://www.sale-puma.com&gt;Puma shoes online&lt;/a&gt; and boots give you best ankle support will support want you to obtain steadiness.
As we konw,Trail &lt;a href=http://www.sale-puma.com&gt;Puma Drift Cat&lt;/a&gt; Shoes black, Trail &lt;a href=http://www.sale-puma.com&gt;Puma future cat&lt;/a&gt; ShoesWhite Black? 50 many years backshore are actually released within a great accomplishment. Trail Running Shoes speed cat shoes?go in add-on to King Pele into planet tournament finals, bottom tennis discs matchrs within pasture inhabit an vital area in hold out in Wimbledon Dun; Its working firms have premier manufacturers and major marketplace positions in distilled spirits, residence and security, and golf products. The reply go all through the &lt;a href=http://www.sale-puma.com&gt;Cheap puma shoes&lt;/a&gt; on sale-here you are able to happen around several distcoun.&lt;a href=http://www.sale-puma.com&gt;puma shoes on sale &lt;/a&gt;.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Good &lt;a href=&quot;http:&quot;&gt;Puma shoes sale information for &lt;a href=
&quot;http:&quot;&gt;Puma shoes fans: Yesterday, German sportswear maker Cheap
Running Shoes purchased effectively lot of money Brands. The
transaction entails the Cobra brand, too as linked inventory,
intellectual house and endorsement contracts. It also helps make
&lt;a href=&quot;http:&quot;&gt;puma speed cat Shoes . They provide you with the
utmost game and support all through the feet.You can happen around
several types of basketball sneakers such as high-top,low-top and
mid-top.The &lt;a href=&quot;http:&quot;&gt;Puma shoes online and boots give you
best ankle support will support want you to obtain steadiness.&lt;br&gt;
As we konw,Trail &lt;a href=&quot;http:&quot;&gt;Puma Drift Cat Shoes black, Trail
&lt;a href=&quot;http:&quot;&gt;Puma future cat ShoesWhite Black? 50 many years
backshore are actually released within a great accomplishment.
Trail Running Shoes speed cat shoes?go in add-on to King Pele into
planet tournament finals, bottom tennis discs matchrs within
pasture inhabit an vital area in hold out in Wimbledon Dun; Its
working firms have premier manufacturers and major marketplace
positions in distilled spirits, residence and security, and golf
products. The reply go all through the &lt;a href=&quot;http:&quot;&gt;Cheap puma
shoes on sale-here you are able to happen around several
distcoun.&lt;a href=&quot;http:&quot;&gt;puma shoes on sale .&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2011-02-16T06:40:34+00:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">17219</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2011-02-22T08:32:35+00:00</updated-at>
      <user-id type="integer">137256</user-id>
      <version type="integer">32</version>
      <user-name>gfsd</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Today, kids as babyish as Ashcan School or nine name-conscious and trend-alert, puma ducati buying at for solid garments rather than just throwing on what&#8217;s pure. Here are just some of the brands and trends your children hungered over 2011. The 80&#8242;s Are Back. You may have noticed a trend this year for evisu jeans, supra shoes, leggings petticoats, oversized tees, and big &lt;a href=http://www.sale-puma.com&gt;puma speed cat&lt;/a&gt; shoes. This is a look that appeals to babies girls-it&#8217;s quirky and yet smart at the same time.
&lt;a href=http://www.sale-puma.com&gt;Puma future cat&lt;/a&gt; with success sets the charm for manner, lifestyle and gambols. This has been believed to serve for an ideal cross flight simulator. This has been fine-looking by most jocks and the Speed Cat is an old name for the industriousness which made &lt;a href=http://www.sale-puma.com&gt;Puma shoes&lt;/a&gt; gain millions with this business. With many people converting more wellness conscious in time, a lot wants also to commit on a good pair of cross trainers. These are very indestructible and forward-looking just like the real carrying out of a real &lt;a href=http://www.sale-puma.com&gt;Puma future cat&lt;/a&gt;. It consumes been systematically on the forefront of design and carrying out when it pertains comfort and style commingled.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Today, kids as babyish as Ashcan School or nine name-conscious
and trend-alert, puma ducati buying at for solid garments rather
than just throwing on what&amp;#8217;s pure. Here are just some of the
brands and trends your children hungered over 2011. The 80&amp;#8242;s
Are Back. You may have noticed a trend this year for evisu jeans,
supra shoes, leggings petticoats, oversized tees, and big &lt;a href=
&quot;http:&quot;&gt;puma speed cat shoes. This is a look that appeals to babies
girls-it&amp;#8217;s quirky and yet smart at the same time.&lt;br&gt;
&lt;a href=&quot;http:&quot;&gt;Puma future cat with success sets the charm for
manner, lifestyle and gambols. This has been believed to serve for
an ideal cross flight simulator. This has been fine-looking by most
jocks and the Speed Cat is an old name for the industriousness
which made &lt;a href=&quot;http:&quot;&gt;Puma shoes gain millions with this
business. With many people converting more wellness conscious in
time, a lot wants also to commit on a good pair of cross trainers.
These are very indestructible and forward-looking just like the
real carrying out of a real &lt;a href=&quot;http:&quot;&gt;Puma future cat. It
consumes been systematically on the forefront of design and
carrying out when it pertains comfort and style commingled.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2011-02-19T01:36:36+00:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">17219</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2011-02-19T09:28:19+00:00</updated-at>
      <user-id type="integer">137759</user-id>
      <version type="integer">33</version>
      <user-name>mklo</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>&lt;b&gt;&lt;a href=&quot;http://www.watcheseshop.com/&quot;&gt;louis vuitton watches&lt;/a&gt;&lt;/b&gt;</body>
      <body-html>&lt;div&gt;&lt;p&gt;&lt;b&gt;&lt;a href=&quot;http://www.watcheseshop.com/&quot;&gt;louis vuitton
watches&lt;/a&gt;&lt;/b&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2011-03-26T02:12:17+00:00</created-at>
      <creator-id type="integer">24025</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">458</number>
      <permalink>record-to_xml-methods-other_ids-yields-incorrect-representation</permalink>
      <priority type="integer">17219</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>record.to_xml(:methods =&gt; other_ids) yields incorrect representation</title>
      <updated-at type="datetime">2011-03-26T02:38:59+00:00</updated-at>
      <user-id type="integer">142823</user-id>
      <version type="integer">34</version>
      <user-name>bingbing</user-name>
      <creator-name>Joran Greef</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/458</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>13c17db1dd550ce6cc1916f0361e823ed6cbe97f</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-04-22T16:02:34+01:00</created-at>
      <filename>2-3-branch.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">493031</id>
      <size type="integer">3004</size>
      <uploader-id type="integer">40263</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/493031/2-3-branch.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>09b0e96658704add64c367fec77c3bc2093ec74c</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-04-22T21:37:12+01:00</created-at>
      <filename>to_xml_patch_against_rails3.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">493745</id>
      <size type="integer">5036</size>
      <uploader-id type="integer">40263</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/493745/to_xml_patch_against_rails3.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>a0a08c5ac5df9bb768e3df8a8073d15861f9884c</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-04-23T15:43:06+01:00</created-at>
      <filename>to_xml_patch_against_rails3.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">494738</id>
      <size type="integer">7149</size>
      <uploader-id type="integer">40263</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/494738/to_xml_patch_against_rails3.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>aa2ce2625ed965243978b7d2df1547b71225e4da</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-04-29T22:42:38+01:00</created-at>
      <filename>test_cases_model_to_xml_against_rails_master.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">504485</id>
      <size type="integer">3179</size>
      <uploader-id type="integer">40263</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/504485/test_cases_model_to_xml_against_rails_master.diff</url>
    </attachment>
  </attachments>
</ticket>
