<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">89656</assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2010-02-21T00:07:22+00:00</created-at>
  <creator-id type="integer">87358</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer" nil="true"></milestone-id>
  <number type="integer">4015</number>
  <permalink>problem-executing-simple-modelto_json</permalink>
  <priority type="integer">3</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>invalid</state>
  <tag>to_json</tag>
  <title>Problem executing simple model#to_json</title>
  <updated-at type="datetime">2010-09-09T13:45:42+01:00</updated-at>
  <user-id type="integer">89656</user-id>
  <version type="integer">5</version>
  <user-name>Rohit Arondekar</user-name>
  <creator-name>L&#237;us Fontenelle</creator-name>
  <assigned-user-name>Rohit Arondekar</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/4015</url>
  <priority-name>Low</priority-name>
  <original-body>I'm trying create and run a simple (&quot;hello world&quot;) app on Rails 3 pre (and Ruby 1.9.1, under RVM). After installation succeed properly, I executed the follow command sequence:

&lt;code&gt;

$ rails ror3test
$ cd ror3test
$ rails generate scaffold user name:string
$ rake db:migrate
$ rails server

&lt;/code&gt;

Until here, all it's ok. So, I added the following line on index action:

&lt;code&gt;
format.json { render :json =&gt; @users.to_json }
&lt;/code&gt;

This is ok too, but if I call to_json method with any argument, like:

&lt;code&gt;
format.json { render :json =&gt; @users.to_json(:methods =&gt; :caps) }
&lt;/code&gt;

or

&lt;code&gt;
format.json { render :json =&gt; @users.to_json(:only =&gt; [:name] }
&lt;/code&gt;

the following error occur:

&lt;code&gt;
TypeError in UsersController#index
  wrong argument type Hash (expected Data)
&lt;/code&gt;

A more detailed error information is attached.</original-body>
  <latest-body>I'm trying create and run a simple (&quot;hello world&quot;) app on Rails 3 pre (and Ruby 1.9.1, under RVM). After installation succeed properly, I executed the follow command sequence:

&lt;code&gt;

$ rails ror3test
$ cd ror3test
$ rails generate scaffold user name:string
$ rake db:migrate
$ rails server

&lt;/code&gt;

Until here, all it's ok. So, I added the following line on index action:

&lt;code&gt;
format.json { render :json =&gt; @users.to_json }
&lt;/code&gt;

This is ok too, but if I call to_json method with any argument, like:

&lt;code&gt;
format.json { render :json =&gt; @users.to_json(:methods =&gt; :caps) }
&lt;/code&gt;

or

&lt;code&gt;
format.json { render :json =&gt; @users.to_json(:only =&gt; [:name] }
&lt;/code&gt;

the following error occur:

&lt;code&gt;
TypeError in UsersController#index
  wrong argument type Hash (expected Data)
&lt;/code&gt;

A more detailed error information is attached.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;I'm trying create and run a simple (&quot;hello world&quot;) app on Rails
3 pre (and Ruby 1.9.1, under RVM). After installation succeed
properly, I executed the follow command sequence:&lt;/p&gt;
&lt;p&gt;$ rails ror3test $ cd ror3test $ rails generate scaffold user
name:string $ rake db:migrate $ rails server&lt;/p&gt;
&lt;p&gt;Until here, all it's ok. So, I added the following line on index
action:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&lt;br&gt;
format.json { render :json =&amp;gt; @users.to_json }&lt;br&gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;This is ok too, but if I call to_json method with any argument,
like:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&lt;br&gt;
format.json { render :json =&amp;gt; @users.to_json(:methods =&amp;gt;
:caps) }&lt;br&gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&lt;br&gt;
format.json { render :json =&amp;gt; @users.to_json(:only =&amp;gt; [:name]
}&lt;br&gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;the following error occur:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&lt;br&gt;
TypeError in UsersController#index&lt;br&gt;
wrong argument type Hash (expected Data)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;A more detailed error information is attached.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I'm trying create and run a simple (&quot;hello world&quot;) app on Rails 3 pre (and Ruby 1.9.1, under RVM). After installation succeed properly, I executed the follow command sequence:

&lt;code&gt;

$ rails ror3test
$ cd ror3test
$ rails generate scaffold user name:string
$ rake db:migrate
$ rails server

&lt;/code&gt;

Until here, all it's ok. So, I added the following line on index action:

&lt;code&gt;
format.json { render :json =&gt; @users.to_json }
&lt;/code&gt;

This is ok too, but if I call to_json method with any argument, like:

&lt;code&gt;
format.json { render :json =&gt; @users.to_json(:methods =&gt; :caps) }
&lt;/code&gt;

or

&lt;code&gt;
format.json { render :json =&gt; @users.to_json(:only =&gt; [:name] }
&lt;/code&gt;

the following error occur:

&lt;code&gt;
TypeError in UsersController#index
  wrong argument type Hash (expected Data)
&lt;/code&gt;

A more detailed error information is attached.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I'm trying create and run a simple (&quot;hello world&quot;) app on Rails
3 pre (and Ruby 1.9.1, under RVM). After installation succeed
properly, I executed the follow command sequence:&lt;/p&gt;
&lt;p&gt;$ rails ror3test $ cd ror3test $ rails generate scaffold user
name:string $ rake db:migrate $ rails server&lt;/p&gt;
&lt;p&gt;Until here, all it's ok. So, I added the following line on index
action:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&lt;br&gt;
format.json { render :json =&amp;gt; @users.to_json }&lt;br&gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;This is ok too, but if I call to_json method with any argument,
like:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&lt;br&gt;
format.json { render :json =&amp;gt; @users.to_json(:methods =&amp;gt;
:caps) }&lt;br&gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&lt;br&gt;
format.json { render :json =&amp;gt; @users.to_json(:only =&amp;gt; [:name]
}&lt;br&gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;the following error occur:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&lt;br&gt;
TypeError in UsersController#index&lt;br&gt;
wrong argument type Hash (expected Data)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;A more detailed error information is attached.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-02-21T00:07:22+00:00</created-at>
      <creator-id type="integer">87358</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4015</number>
      <permalink>problem-executing-simple-modelto_json</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>to_json</tag>
      <title>Problem executing simple model#to_json</title>
      <updated-at type="datetime">2010-02-21T00:07:36+00:00</updated-at>
      <user-id type="integer">87358</user-id>
      <version type="integer">1</version>
      <user-name>L&#237;us Fontenelle</user-name>
      <creator-name>L&#237;us Fontenelle</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4015</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">14998</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I was unable to duplicate this issue on `master`:

@@@
&#10140;  ticket_4015 script/rails g model user name:string
&#10140;  ticket_4015 rake db:migrate
(in /Users/dtrasbo/code/rails/railties/tmp/ticket_4015)
&#10140;  ticket_4015 script/rails g controller users index
&#10140;  ticket_4015 script/rails c
Loading development environment (Rails 3.0.0.beta4)
ruby-1.9.2-preview3 &gt; User.create(:name =&gt; 'David Trasbo')
 =&gt; #&lt;User id: 1, name: &quot;John Smith&quot;, ...&gt; 
ruby-1.9.2-preview3 &gt; User.create(:name =&gt; 'Marc Hejner')
 =&gt; #&lt;User id: 2, name: &quot;David Trasbo&quot;, ...&gt; 
@@@

@@@ ruby
class UsersController &lt; ApplicationController
  def index
    @users = User.all
    respond_to do |format|
      format.json { render :json =&gt; @users.to_json(:only =&gt; :name) }
    end
  end
end
@@@

Response body for `http://localhost:3000/users.json`:

@@@
[{&quot;user&quot;:{&quot;name&quot;:&quot;John Smith&quot;}},{&quot;user&quot;:{&quot;name&quot;:&quot;David Trasbo&quot;}}]
@@@

This ticket can be closed.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I was unable to duplicate this issue on &lt;code&gt;master&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;&amp;#10140;  ticket_4015 script/rails g model user name:string
&amp;#10140;  ticket_4015 rake db:migrate
(in /Users/dtrasbo/code/rails/railties/tmp/ticket_4015)
&amp;#10140;  ticket_4015 script/rails g controller users index
&amp;#10140;  ticket_4015 script/rails c
Loading development environment (Rails 3.0.0.beta4)
ruby-1.9.2-preview3 &amp;gt; User.create(:name =&amp;gt; 'David Trasbo')
 =&amp;gt; #&amp;lt;User id: 1, name: &quot;John Smith&quot;, ...&amp;gt; 
ruby-1.9.2-preview3 &amp;gt; User.create(:name =&amp;gt; 'Marc Hejner')
 =&amp;gt; #&amp;lt;User id: 2, name: &quot;David Trasbo&quot;, ...&amp;gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;class UsersController &amp;lt; ApplicationController
  def index
    @users = User.all
    respond_to do |format|
      format.json { render :json =&amp;gt; @users.to_json(:only =&amp;gt; :name) }
    end
  end
end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Response body for
&lt;code&gt;http://localhost:3000/users.json&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;[{&quot;user&quot;:{&quot;name&quot;:&quot;John Smith&quot;}},{&quot;user&quot;:{&quot;name&quot;:&quot;David Trasbo&quot;}}]&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;This ticket can be closed.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-01T21:54:50+01:00</created-at>
      <creator-id type="integer">87358</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4015</number>
      <permalink>problem-executing-simple-modelto_json</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>to_json</tag>
      <title>Problem executing simple model#to_json</title>
      <updated-at type="datetime">2010-07-01T21:55:11+01:00</updated-at>
      <user-id type="integer">65050</user-id>
      <version type="integer">2</version>
      <user-name>David Trasbo</user-name>
      <creator-name>L&#237;us Fontenelle</creator-name>
      <assigned-user-name>Ryan Bigg</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4015</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">14998</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Gah, you'll probably notice I tried to change some names above, but looked over a couple of places.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Gah, you'll probably notice I tried to change some names above,
but looked over a couple of places.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-01T21:57:54+01:00</created-at>
      <creator-id type="integer">87358</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4015</number>
      <permalink>problem-executing-simple-modelto_json</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>to_json</tag>
      <title>Problem executing simple model#to_json</title>
      <updated-at type="datetime">2010-07-01T21:58:08+01:00</updated-at>
      <user-id type="integer">65050</user-id>
      <version type="integer">3</version>
      <user-name>David Trasbo</user-name>
      <creator-name>L&#237;us Fontenelle</creator-name>
      <assigned-user-name>Ryan Bigg</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4015</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">89656</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Closable, see above.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Closable, see above.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-09-09T13:22:12+01:00</created-at>
      <creator-id type="integer">87358</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 14998
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4015</number>
      <permalink>problem-executing-simple-modelto_json</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>to_json</tag>
      <title>Problem executing simple model#to_json</title>
      <updated-at type="datetime">2010-09-09T13:22:13+01:00</updated-at>
      <user-id type="integer">65050</user-id>
      <version type="integer">4</version>
      <user-name>David Trasbo</user-name>
      <creator-name>L&#237;us Fontenelle</creator-name>
      <assigned-user-name>Rohit Arondekar</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4015</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">89656</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-09-09T13:45:39+01:00</created-at>
      <creator-id type="integer">87358</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
:priority: 0
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4015</number>
      <permalink>problem-executing-simple-modelto_json</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>to_json</tag>
      <title>Problem executing simple model#to_json</title>
      <updated-at type="datetime">2010-09-09T13:45:42+01:00</updated-at>
      <user-id type="integer">89656</user-id>
      <version type="integer">5</version>
      <user-name>Rohit Arondekar</user-name>
      <creator-name>L&#237;us Fontenelle</creator-name>
      <assigned-user-name>Rohit Arondekar</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4015</url>
      <priority-name>Low</priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>985d53c03b66159bf20a9558059dfee89e3a0755</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-02-21T00:07:22+00:00</created-at>
      <filename>usersjson.html</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">418796</id>
      <size type="integer">36903</size>
      <uploader-id type="integer">87358</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/418796/usersjson.html</url>
    </attachment>
  </attachments>
</ticket>
