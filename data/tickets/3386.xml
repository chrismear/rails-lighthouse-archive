<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">0</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-10-17T20:16:48+01:00</created-at>
  <creator-id type="integer">73520</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer" nil="true"></milestone-id>
  <number type="integer">3386</number>
  <permalink>activeresource-not-picking-up-validation-errors-in-234</permalink>
  <priority type="integer">164217</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>duplicate</state>
  <tag>2.3.4 activeresource validations</tag>
  <title>ActiveResource not picking up (validation) errors in 2.3.4</title>
  <updated-at type="datetime">2010-01-19T18:42:03+00:00</updated-at>
  <user-id type="integer">85</user-id>
  <version type="integer">6</version>
  <user-name>Jeremy Kemper</user-name>
  <creator-name>Vanne</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/3386</url>
  <priority-name nil="true"></priority-name>
  <original-body>on the server side (2.3.4 app using ActiveRecord models:

@@@ ruby
  format.xml  { render :xml =&gt; @participant.errors, :status =&gt; :unprocessable_entity }
@@@

received on client side (2.3.4 app using ActiveResource models)
@@@
  HTTP/1.1 422  
  Connection: close
  Content-Type: application/xml; charset=utf-8
  Date: Sat, 17 Oct 2009 18:11:16 GMT
  Server: WEBrick/1.3.1 (Ruby/1.8.7/2008-08-11)
  X-Runtime: 11
  Content-Length: 101
  Cache-Control: no-cache

  &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
  &lt;errors&gt;
    &lt;error&gt;Username cannot be empty!&lt;/error&gt;
  &lt;/errors&gt;
@@@

@participant.save does return false but there are no errors available!

Went back to 2.3.3 on client side and all works well.

See also http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/67d59a432f1d98e3</original-body>
  <latest-body>on the server side (2.3.4 app using ActiveRecord models:

@@@ ruby
  format.xml  { render :xml =&gt; @participant.errors, :status =&gt; :unprocessable_entity }
@@@

received on client side (2.3.4 app using ActiveResource models)
@@@
  HTTP/1.1 422  
  Connection: close
  Content-Type: application/xml; charset=utf-8
  Date: Sat, 17 Oct 2009 18:11:16 GMT
  Server: WEBrick/1.3.1 (Ruby/1.8.7/2008-08-11)
  X-Runtime: 11
  Content-Length: 101
  Cache-Control: no-cache

  &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
  &lt;errors&gt;
    &lt;error&gt;Username cannot be empty!&lt;/error&gt;
  &lt;/errors&gt;
@@@

@participant.save does return false but there are no errors available!

Went back to 2.3.3 on client side and all works well.

See also http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/67d59a432f1d98e3</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;on the server side (2.3.4 app using ActiveRecord models:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=
&quot;ruby&quot;&gt;  format.xml  { render :xml =&amp;gt; @participant.errors, :status =&amp;gt; :unprocessable_entity }&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;received on client side (2.3.4 app using ActiveResource
models)&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;  HTTP/1.1 422&lt;br&gt;
  Connection: close
  Content-Type: application/xml; charset=utf-8
  Date: Sat, 17 Oct 2009 18:11:16 GMT
  Server: WEBrick/1.3.1 (Ruby/1.8.7/2008-08-11)
  X-Runtime: 11
  Content-Length: 101
  Cache-Control: no-cache&lt;br&gt;
&lt;br&gt;


&lt;br&gt;
  &amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
  &amp;lt;errors&amp;gt;&lt;br&gt;
&lt;br&gt;


&lt;/code&gt;
&lt;/pre&gt;
&lt;pre&gt;
&lt;code&gt;&lt;code&gt;&amp;amp;lt;error&amp;amp;gt;Username cannot be empty!&amp;amp;lt;/error&amp;amp;gt;&lt;/code&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;pre&gt;


&lt;br&gt;
  &amp;lt;/errors&amp;gt;
&lt;/pre&gt;
&lt;p&gt;@participant.save does return false but there are no errors
available!&lt;/p&gt;
&lt;p&gt;Went back to 2.3.3 on client side and all works well.&lt;/p&gt;
&lt;p&gt;See also &lt;a href=
&quot;http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/67d59a432f1d98e3&quot;&gt;
http://groups.google.com/group/rubyonrails-talk/browse_thread/threa...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>on the server side (2.3.4 app using ActiveRecord models:

@@@ ruby
  format.xml  { render :xml =&gt; @participant.errors, :status =&gt; :unprocessable_entity }
@@@

received on client side (2.3.4 app using ActiveResource models)
@@@
  HTTP/1.1 422  
  Connection: close
  Content-Type: application/xml; charset=utf-8
  Date: Sat, 17 Oct 2009 18:11:16 GMT
  Server: WEBrick/1.3.1 (Ruby/1.8.7/2008-08-11)
  X-Runtime: 11
  Content-Length: 101
  Cache-Control: no-cache
  &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
  &lt;errors&gt;
  &lt;error&gt;Username cannot be empty!&lt;/error&gt;
  &lt;/errors&gt;
@@@

@participant.save does return false but there are no errors available!

Went back to 2.3.3 on client side and all works well.

See also http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/67d59a432f1d98e3</body>
      <body-html>&lt;div&gt;&lt;p&gt;on the server side (2.3.4 app using ActiveRecord models:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=
&quot;ruby&quot;&gt;  format.xml  { render :xml =&amp;gt; @participant.errors, :status =&amp;gt; :unprocessable_entity }&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;received on client side (2.3.4 app using ActiveResource
models)&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;  HTTP/1.1 422&lt;br&gt;
  Connection: close
  Content-Type: application/xml; charset=utf-8
  Date: Sat, 17 Oct 2009 18:11:16 GMT
  Server: WEBrick/1.3.1 (Ruby/1.8.7/2008-08-11)
  X-Runtime: 11
  Content-Length: 101
  Cache-Control: no-cache
  &amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
  &amp;lt;errors&amp;gt;
  &amp;lt;error&amp;gt;Username cannot be empty!&amp;lt;/error&amp;gt;
  &amp;lt;/errors&amp;gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;@participant.save does return false but there are no errors
available!&lt;/p&gt;
&lt;p&gt;Went back to 2.3.3 on client side and all works well.&lt;/p&gt;
&lt;p&gt;See also &lt;a href=
&quot;http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/67d59a432f1d98e3&quot;&gt;
http://groups.google.com/group/rubyonrails-talk/browse_thread/threa...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-10-17T20:16:48+01:00</created-at>
      <creator-id type="integer">73520</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3386</number>
      <permalink>activeresource-not-picking-up-validation-errors-in-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.4 activeresource validations</tag>
      <title>ActiveResource not picking up (validation) errors in 2.3.4</title>
      <updated-at type="datetime">2009-10-17T20:19:10+01:00</updated-at>
      <user-id type="integer">73520</user-id>
      <version type="integer">1</version>
      <user-name>Vanne</user-name>
      <creator-name>Vanne</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3386</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I'm seeing the same error. It's very possible that this is being caused by the case/when block starting on line 262 of validations.rb

@@@
      case error.response['Content-Type']
      when 'application/xml'
        errors.from_xml(error.response.body)
      when 'application/json'
        errors.from_json(error.response.body)
      end
      false
@@@

I'm about to write a patch, unless someone else has already done it?</body>
      <body-html>&lt;div&gt;&lt;p&gt;I'm seeing the same error. It's very possible that this is being
caused by the case/when block starting on line 262 of
validations.rb&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;      case error.response['Content-Type']
      when 'application/xml'
        errors.from_xml(error.response.body)
      when 'application/json'
        errors.from_json(error.response.body)
      end
      false&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;I'm about to write a patch, unless someone else has already done
it?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-10-23T23:18:08+01:00</created-at>
      <creator-id type="integer">73520</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3386</number>
      <permalink>activeresource-not-picking-up-validation-errors-in-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.4 activeresource validations</tag>
      <title>ActiveResource not picking up (validation) errors in 2.3.4</title>
      <updated-at type="datetime">2009-10-23T23:18:11+01:00</updated-at>
      <user-id type="integer">74265</user-id>
      <version type="integer">2</version>
      <user-name>James Brennan</user-name>
      <creator-name>Vanne</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3386</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>My last post wasn't entirely clear. I'm seeing it fail when the error.response['Content-Type'] = &quot;application/xml; charset=utf-8&quot;</body>
      <body-html>&lt;div&gt;&lt;p&gt;My last post wasn't entirely clear. I'm seeing it fail when the
error.response['Content-Type'] = &quot;application/xml;
charset=utf-8&quot;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-10-23T23:19:19+01:00</created-at>
      <creator-id type="integer">73520</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3386</number>
      <permalink>activeresource-not-picking-up-validation-errors-in-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.4 activeresource validations</tag>
      <title>ActiveResource not picking up (validation) errors in 2.3.4</title>
      <updated-at type="datetime">2009-10-23T23:19:22+01:00</updated-at>
      <user-id type="integer">74265</user-id>
      <version type="integer">3</version>
      <user-name>James Brennan</user-name>
      <creator-name>Vanne</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3386</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I also came across this issue.
When I call this on my remote service:
@@@
    render :xml =&gt; @my_object.errors, :status =&gt; :unprocessable_entity
@@@
render returns following content-type in response header:
@@@
&quot;application/xml; charset=utf-8&quot;
@@@
That obviously won't match line 263 of validations.rb. So I changed the case block to:
@@@
      case error.response['Content-Type']
      when /application\/xml/
        errors.from_xml(error.response.body)
      when /application\/json/
        errors.from_json(error.response.body)
      end
@@@
And now works as expected.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I also came across this issue.&lt;br&gt;
When I call this on my remote service:&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;    render :xml =&amp;gt; @my_object.errors, :status =&amp;gt; :unprocessable_entity&lt;/code&gt;
&lt;/pre&gt;
render returns following content-type in response header:&lt;br&gt;
&lt;pre&gt;
&lt;code&gt;&quot;application/xml; charset=utf-8&quot;&lt;/code&gt;
&lt;/pre&gt;
That obviously won't match line 263 of validations.rb. So I changed
the case block to:&lt;br&gt;
&lt;pre&gt;
&lt;code&gt;      case error.response['Content-Type']&lt;br&gt;
&lt;br&gt;


&lt;/code&gt;
&lt;/pre&gt;
&lt;pre&gt;
&lt;code&gt;&lt;code&gt;  when /application\/xml/
    errors.from_xml(error.response.body)
  when /application\/json/
    errors.from_json(error.response.body)
  end&amp;lt;/code&amp;gt;&lt;/code&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;pre&gt;


&lt;br&gt;
&lt;/pre&gt;
And now works as expected.&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-11-03T12:46:10+00:00</created-at>
      <creator-id type="integer">73520</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3386</number>
      <permalink>activeresource-not-picking-up-validation-errors-in-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.4 activeresource validations</tag>
      <title>ActiveResource not picking up (validation) errors in 2.3.4</title>
      <updated-at type="datetime">2009-11-03T12:46:12+00:00</updated-at>
      <user-id type="integer">75259</user-id>
      <version type="integer">4</version>
      <user-name>&#321;ukasz Pinkosz</user-name>
      <creator-name>Vanne</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3386</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>It looks like this has been fixed in 2-3-stable.

http://github.com/rails/rails/commit/1488c6cc9e6237ce794e3c4a6201627b9fd4ca09</body>
      <body-html>&lt;div&gt;&lt;p&gt;It looks like this has been fixed in 2-3-stable.&lt;/p&gt;
&lt;p&gt;&lt;a href=
&quot;http://github.com/rails/rails/commit/1488c6cc9e6237ce794e3c4a6201627b9fd4ca09&quot;&gt;
http://github.com/rails/rails/commit/1488c6cc9e6237ce794e3c4a620162...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-11-18T17:19:53+00:00</created-at>
      <creator-id type="integer">73520</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3386</number>
      <permalink>activeresource-not-picking-up-validation-errors-in-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3.4 activeresource validations</tag>
      <title>ActiveResource not picking up (validation) errors in 2.3.4</title>
      <updated-at type="datetime">2009-11-18T17:19:55+00:00</updated-at>
      <user-id type="integer">22224</user-id>
      <version type="integer">5</version>
      <user-name>JackC</user-name>
      <creator-name>Vanne</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3386</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>#1956</body>
      <body-html>&lt;div&gt;&lt;p&gt;&lt;a href=&quot;/projects/8994/tickets/1956&quot; title=
&quot;Ticket #1956&quot;&gt;#1956&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-01-19T18:42:01+00:00</created-at>
      <creator-id type="integer">73520</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3386</number>
      <permalink>activeresource-not-picking-up-validation-errors-in-234</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>duplicate</state>
      <tag>2.3.4 activeresource validations</tag>
      <title>ActiveResource not picking up (validation) errors in 2.3.4</title>
      <updated-at type="datetime">2010-01-19T18:42:03+00:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">6</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Vanne</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3386</url>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
</ticket>
