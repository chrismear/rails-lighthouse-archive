<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">19965</assigned-user-id>
  <attachments-count type="integer">5</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-09-16T15:59:09+01:00</created-at>
  <creator-id type="integer">57676</creator-id>
  <milestone-due-on type="datetime">2010-11-15T00:00:00+00:00</milestone-due-on>
  <milestone-id type="integer">88038</milestone-id>
  <number type="integer">3218</number>
  <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
  <priority type="integer">145445</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>committed</state>
  <tag>activerecord default_scope</tag>
  <title>default_scope is having a side affecct on create</title>
  <updated-at type="datetime">2010-10-15T23:01:35+01:00</updated-at>
  <user-id type="integer">85</user-id>
  <version type="integer">21</version>
  <user-name>Jeremy Kemper</user-name>
  <creator-name>johnf</creator-name>
  <assigned-user-name>Jos&#233; Valim</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
  <milestone-title>3.0.2</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>If I have the following

@@@ ruby
class Foo
  default_scope :conditions =&gt; {:bar =&gt; 1}
end
@@@
  
If I try to create a new object

@@@ irb
&gt;&gt; Foo.new(:bar =&gt; 5)
=&gt; #&lt;Foo id: nil, name: nil, bar: 1, created_at: nil, updated_at: nil&gt;
@@@

The object now has bar set to one when I've explicitly asked for it to be set to 5.

It makes sense to set the default if I don't pass it in but not otherwise

At a rough guess in ActiveRecord::Base initialize

@@@ ruby
2438         self.attributes = attributes unless attributes.nil?
2439         self.class.send(:scope, :create).each { |att,value| self.send(&quot;#{att}=&quot;, value) } if self.class.send(:scoped?, :create)

@@@
should be swapped around</original-body>
  <latest-body>If I have the following

@@@ ruby
class Foo
  default_scope :conditions =&gt; {:bar =&gt; 1}
end
@@@
  
If I try to create a new object

@@@ irb
&gt;&gt; Foo.new(:bar =&gt; 5)
=&gt; #&lt;Foo id: nil, name: nil, bar: 1, created_at: nil, updated_at: nil&gt;
@@@

The object now has bar set to one when I've explicitly asked for it to be set to 5.

It makes sense to set the default if I don't pass it in but not otherwise

At a rough guess in ActiveRecord::Base initialize

@@@ ruby
2438         self.attributes = attributes unless attributes.nil?
2439         self.class.send(:scope, :create).each { |att,value| self.send(&quot;#{att}=&quot;, value) } if self.class.send(:scoped?, :create)

@@@
should be swapped around</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;If I have the following&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;class Foo
  default_scope :conditions =&amp;gt; {:bar =&amp;gt; 1}
end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;If I try to create a new object&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;irb&quot;&gt;&amp;gt;&amp;gt; Foo.new(:bar =&amp;gt; 5)
=&amp;gt; #&amp;lt;Foo id: nil, name: nil, bar: 1, created_at: nil, updated_at: nil&amp;gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;The object now has bar set to one when I've explicitly asked for
it to be set to 5.&lt;/p&gt;
&lt;p&gt;It makes sense to set the default if I don't pass it in but not
otherwise&lt;/p&gt;
&lt;p&gt;At a rough guess in ActiveRecord::Base initialize&lt;/p&gt;
&lt;pre&gt;
&lt;code class=
&quot;ruby&quot;&gt;2438         self.attributes = attributes unless attributes.nil?
2439         self.class.send(:scope, :create).each { |att,value| self.send(&quot;#{att}=&quot;, value) } if self.class.send(:scoped?, :create)&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;should be swapped around&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>If I have the following

@@@ ruby
class Foo
  default_scope :conditions =&gt; {:bar =&gt; 1}
end
@@@
  
If I try to create a new object

@@@ irb
&gt;&gt; Foo.new(:bar =&gt; 5)
=&gt; #&lt;Foo id: nil, name: nil, bar: 1, created_at: nil, updated_at: nil&gt;
@@@

The object now has bar set to one when I've explicitly asked for it to be set to 5.

It makes sense to set the default if I don't pass it in but not otherwise

At a rough guess in ActiveRecord::Base initialize

@@@ ruby
2438         self.attributes = attributes unless attributes.nil?
2439         self.class.send(:scope, :create).each { |att,value| self.send(&quot;#{att}=&quot;, value) } if self.class.send(:scoped?, :create)

@@@
should be swapped around</body>
      <body-html>&lt;div&gt;&lt;p&gt;If I have the following&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;class Foo
  default_scope :conditions =&amp;gt; {:bar =&amp;gt; 1}
end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;If I try to create a new object&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;irb&quot;&gt;&amp;gt;&amp;gt; Foo.new(:bar =&amp;gt; 5)
=&amp;gt; #&amp;lt;Foo id: nil, name: nil, bar: 1, created_at: nil, updated_at: nil&amp;gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;The object now has bar set to one when I've explicitly asked for
it to be set to 5.&lt;/p&gt;
&lt;p&gt;It makes sense to set the default if I don't pass it in but not
otherwise&lt;/p&gt;
&lt;p&gt;At a rough guess in ActiveRecord::Base initialize&lt;/p&gt;
&lt;pre&gt;
&lt;code class=
&quot;ruby&quot;&gt;2438         self.attributes = attributes unless attributes.nil?
2439         self.class.send(:scope, :create).each { |att,value| self.send(&quot;#{att}=&quot;, value) } if self.class.send(:scoped?, :create)&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;should be swapped around&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-16T15:59:09+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2010-02-21T02:29:19+00:00</updated-at>
      <user-id type="integer">57676</user-id>
      <version type="integer">1</version>
      <user-name>johnf</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body nil="true"></body>
      <body-html nil="true"></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-25T12:05:22+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: activerecord default_scope
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord bugmash default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2009-09-25T12:48:09+01:00</updated-at>
      <user-id type="integer">7211</user-id>
      <version type="integer">2</version>
      <user-name>CancelProfileIsBroken</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>verified on 2-3-stable

I've attached a failing test.</body>
      <body-html>&lt;div&gt;&lt;p&gt;verified on 2-3-stable&lt;/p&gt;
&lt;p&gt;I've attached a failing test.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-25T18:05:11+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord bugmash default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2009-09-25T18:05:14+01:00</updated-at>
      <user-id type="integer">51191</user-id>
      <version type="integer">3</version>
      <user-name>hsume2 (Henry)</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>+1 verified on 2-3-stable, i guess i am lucky for not running into it up until now.

Attached patches for 2-3-stable and master

I generally allowed the scoped attributes to override existing attributes only:

# if the attribute value is #blank?
# if the attribute is not blank, but the value was initiated via a column default definition.

otherwise the value is not overridden.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 verified on 2-3-stable, i guess i am lucky for not running
into it up until now.&lt;/p&gt;
&lt;p&gt;Attached patches for 2-3-stable and master&lt;/p&gt;
&lt;p&gt;I generally allowed the scoped attributes to override existing
attributes only:&lt;/p&gt;
&lt;h1&gt;if the attribute value is #blank?&lt;/h1&gt;
&lt;h1&gt;if the attribute is not blank, but the value was initiated via
a column default definition.&lt;/h1&gt;
&lt;p&gt;otherwise the value is not overridden.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-25T22:56:29+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord bugmash default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2009-09-25T22:56:35+01:00</updated-at>
      <user-id type="integer">36381</user-id>
      <version type="integer">4</version>
      <user-name>Elad Meidar</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>heh, silly Lighthouse textile :)</body>
      <body-html>&lt;div&gt;&lt;p&gt;heh, silly Lighthouse textile :)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-25T22:56:51+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord bugmash default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2009-09-25T22:56:54+01:00</updated-at>
      <user-id type="integer">36381</user-id>
      <version type="integer">5</version>
      <user-name>Elad Meidar</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>I think I get what you've done. However, I think your implementation conficts with #test_default_values_on_empty_strings in base_test.rb. I've attached a patch (with an additional fail test) that fixes it. (Should apply cleanly to master and 2-3-stable)

Also, note: expecting 50000, as opposed to the default value of 70000 defined in the schema.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I think I get what you've done. However, I think your
implementation conficts with #test_default_values_on_empty_strings
in base_test.rb. I've attached a patch (with an additional fail
test) that fixes it. (Should apply cleanly to master and
2-3-stable)&lt;/p&gt;
&lt;p&gt;Also, note: expecting 50000, as opposed to the default value of
70000 defined in the schema.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-26T01:47:11+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord bugmash default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2009-09-26T01:47:16+01:00</updated-at>
      <user-id type="integer">51191</user-id>
      <version type="integer">6</version>
      <user-name>hsume2 (Henry)</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Sorry, I don't mean conflict.. exactly. More like, the behavior is different from that in #test_default_values_on_empty_strings.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Sorry, I don't mean conflict.. exactly. More like, the behavior
is different from that in
#test_default_values_on_empty_strings.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-26T01:48:47+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord bugmash default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2009-09-26T01:48:49+01:00</updated-at>
      <user-id type="integer">51191</user-id>
      <version type="integer">7</version>
      <user-name>hsume2 (Henry)</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-26T01:53:20+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: activerecord bugmash default_scope
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord bugmash bugmash-review default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2009-09-26T01:53:24+01:00</updated-at>
      <user-id type="integer">36381</user-id>
      <version type="integer">8</version>
      <user-name>Elad Meidar</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Mmmm,
by doing
@@@
-        self.attributes = attributes unless attributes.nil?
         self.class.send(:scope, :create).each { |att,value| self.send(&quot;#{att}=&quot;, value) } if self.class.send(:scoped?, :create)
+        self.attributes = attributes unless attributes.nil?
@@@

you are overriding the attributes from the scope.... the order of steps i did was to ensure that the last value that the user specified, takes affect.

1. default db column value
2. scoped :conditions
3. `initialize`/`find` parameters</body>
      <body-html>&lt;div&gt;&lt;p&gt;Mmmm,&lt;br&gt;
by doing&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;-        self.attributes = attributes unless attributes.nil?&lt;br&gt;
&lt;br&gt;


&lt;/code&gt;
&lt;/pre&gt;
&lt;pre&gt;
&lt;code&gt;&lt;code&gt;     self.class.send(:scope, :create).each { |att,value| self.send(&amp;amp;quot;#{att}=&amp;amp;quot;, value) } if self.class.send(:scoped?, :create)&lt;/code&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;pre&gt;


&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;
&lt;code&gt; self.attributes = attributes unless attributes.nil?&amp;lt;/code&amp;gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;



&lt;br&gt;
you are overriding the attributes from the scope.... the order of steps i did was to ensure that the last value that the user specified, takes affect.

&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;default db column value&lt;br&gt;&lt;/li&gt;
&lt;li&gt;scoped :conditions&lt;br&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;initialize&lt;/code&gt;/&lt;code&gt;find&lt;/code&gt; parameters&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;


&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-26T02:02:12+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord bugmash bugmash-review default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2009-09-26T02:02:17+01:00</updated-at>
      <user-id type="integer">36381</user-id>
      <version type="integer">9</version>
      <user-name>Elad Meidar</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Mmmm,
by doing

@@@

- self.attributes = attributes unless attributes.nil?
  self.class.send(:scope, :create).each { |att,value| self.send(&quot;#{att}=&quot;, value) } if self.class.send(:scoped?, :create)
+ self.attributes = attributes unless attributes.nil?

@@@

you are overriding the attributes from the scope.... the order of steps i did was to ensure that the last value that the user specified, takes affect.

1. default db column value
2. scoped :conditions
3. `initialize`/`find` parameters</body>
      <body-html>&lt;div&gt;&lt;p&gt;Mmmm,&lt;br&gt;
by doing&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;
- self.attributes = attributes unless attributes.nil?
  self.class.send(:scope, :create).each { |att,value| self.send(&quot;#{att}=&quot;, value) } if self.class.send(:scoped?, :create)
+ self.attributes = attributes unless attributes.nil?&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;you are overriding the attributes from the scope.... the order
of steps i did was to ensure that the last value that the user
specified, takes affect.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;default db column value&lt;br&gt;&lt;/li&gt;
&lt;li&gt;scoped :conditions&lt;br&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;initialize&lt;/code&gt;/&lt;code&gt;find&lt;/code&gt; parameters&lt;/li&gt;
&lt;/ol&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-26T02:03:34+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord bugmash bugmash-review default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2009-09-26T02:03:37+01:00</updated-at>
      <user-id type="integer">36381</user-id>
      <version type="integer">10</version>
      <user-name>Elad Meidar</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>+1 on @hsume2' patch, solves it in a much cleaner way than my patches</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 on @hsume2' patch, solves it in a much cleaner way than my
patches&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-26T03:05:00+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord bugmash bugmash-review default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2009-09-26T03:05:02+01:00</updated-at>
      <user-id type="integer">36381</user-id>
      <version type="integer">11</version>
      <user-name>Elad Meidar</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>+1 though the patch no longer applies to 2-3-stable.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 though the patch no longer applies to 2-3-stable.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-26T17:20:02+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord bugmash bugmash-review default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2009-09-26T17:20:03+01:00</updated-at>
      <user-id type="integer">65050</user-id>
      <version type="integer">12</version>
      <user-name>David Trasbo</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>@david, which one did you try?</body>
      <body-html>&lt;div&gt;&lt;p&gt;@david, which one did you try?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-26T17:59:07+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord bugmash bugmash-review default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2009-09-26T17:59:10+01:00</updated-at>
      <user-id type="integer">36381</user-id>
      <version type="integer">13</version>
      <user-name>Elad Meidar</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>+1 to hsume2's master patch

Here's the patch for 2-3 which is basically identical to the master patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 to hsume2's master patch&lt;/p&gt;
&lt;p&gt;Here's the patch for 2-3 which is basically identical to the
master patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-26T18:08:49+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord bugmash bugmash-review default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2009-09-26T18:08:52+01:00</updated-at>
      <user-id type="integer">20273</user-id>
      <version type="integer">14</version>
      <user-name>Josh Sharpe</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">5</attachments-count>
      <body>+1 verified.

Both patches (hsume2's on master and Josh's on 2-3) apply cleanly and all tests pass.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 verified.&lt;/p&gt;
&lt;p&gt;Both patches (hsume2's on master and Josh's on 2-3) apply
cleanly and all tests pass.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-27T04:55:51+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord bugmash bugmash-review default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2009-09-27T04:55:55+01:00</updated-at>
      <user-id type="integer">71121</user-id>
      <version type="integer">15</version>
      <user-name>sr.iniv.t</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">5</attachments-count>
      <body nil="true"></body>
      <body-html nil="true"></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-09-27T12:06:45+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: activerecord bugmash bugmash-review default_scope
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord bugmash-review default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2009-09-27T12:06:48+01:00</updated-at>
      <user-id type="integer">7211</user-id>
      <version type="integer">16</version>
      <user-name>CancelProfileIsBroken</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">5</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-02-21T11:52:29+00:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord bugmash-review default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2010-02-21T11:52:32+00:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">17</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">5</attachments-count>
      <body>Applied on master. Can someone please rebase the patch for 2-3-stable?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Applied on master. Can someone please rebase the patch for
2-3-stable?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-02-26T10:10:28+00:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>activerecord bugmash-review default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2010-02-26T10:10:31+00:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">18</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">5</attachments-count>
      <body>(from [bf9a0ae12b701cba7a8aac2955ce243866ac7bf6]) Fix a bug where default_scope was overriding attributes given on model initialization [#3218 status:resolved]

Signed-off-by: Jos&#233; Valim &lt;jose.valim@gmail.com&gt;
http://github.com/rails/rails/commit/bf9a0ae12b701cba7a8aac2955ce243866ac7bf6</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/bf9a0ae12b701cba7a8aac2955ce243866ac7bf6&quot;
title=
&quot;Changeset [bf9a0ae12b701cba7a8aac2955ce243866ac7bf6]&quot;&gt;[bf9a0ae12b701cba7a8aac2955ce243866ac7bf6]&lt;/a&gt;)
Fix a bug where default_scope was overriding attributes given on
model initialization [&lt;a href=&quot;/projects/8994/tickets/3218&quot; title=
&quot;Ticket #3218&quot;&gt;#3218&lt;/a&gt; status:resolved]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jos&amp;eacute; Valim &lt;a&gt;jose.valim@gmail.com&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/bf9a0ae12b701cba7a8aac2955ce243866ac7bf6&quot;&gt;
http://github.com/rails/rails/commit/bf9a0ae12b701cba7a8aac2955ce24...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-02-26T11:15:04+00:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>activerecord bugmash-review default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2010-02-26T11:15:07+00:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">19</version>
      <user-name>Repository</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">5</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-05-15T18:40:46+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: activerecord bugmash-review default_scope
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>activerecord default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2010-05-15T18:40:48+01:00</updated-at>
      <user-id type="integer">65556</user-id>
      <version type="integer">20</version>
      <user-name>Rizwan Reza</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">5</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/31647)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/31647&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-10-15T23:01:35+01:00</created-at>
      <creator-id type="integer">57676</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
:milestone: 27004
</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">3218</number>
      <permalink>default_scope-is-having-a-side-affecct-on-create</permalink>
      <priority type="integer">145445</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>activerecord default_scope</tag>
      <title>default_scope is having a side affecct on create</title>
      <updated-at type="datetime">2010-10-15T23:01:36+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">21</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>johnf</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3218</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>d713cfd305a2cab1a614605a5d82e57de6dcbbe8</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-09-25T18:05:11+01:00</created-at>
      <filename>active_record_default_scope_overwriting_attributes.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">278870</id>
      <size type="integer">979</size>
      <uploader-id type="integer">51191</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/278870/active_record_default_scope_overwriting_attributes.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>2f7caf9908c7d51947e1e86bd400439a2beaf698</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-09-25T22:56:29+01:00</created-at>
      <filename>LH3218-default_scope_override_values_master.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">279218</id>
      <size type="integer">2460</size>
      <uploader-id type="integer">36381</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/279218/LH3218-default_scope_override_values_master.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>4da95aa79f631cc94a85f26f3460ac633659c8df</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-09-25T22:56:29+01:00</created-at>
      <filename>LH3218-default_scope_override_values_2-3-stable.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">279219</id>
      <size type="integer">6073</size>
      <uploader-id type="integer">36381</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/279219/LH3218-default_scope_override_values_2-3-stable.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>dcf353745eb89495cf22694b75a8fa669ffcef23</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-09-26T01:47:11+01:00</created-at>
      <filename>LH3218-default_scope_overwrite_values_master.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">279301</id>
      <size type="integer">2765</size>
      <uploader-id type="integer">51191</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/279301/LH3218-default_scope_overwrite_values_master.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>b9c379a3019d4907ccc0542460df08e61de13be7</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-09-26T18:08:49+01:00</created-at>
      <filename>LH3218-default_scope_overwrite_values_2-3.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">279404</id>
      <size type="integer">2785</size>
      <uploader-id type="integer">20273</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/279404/LH3218-default_scope_overwrite_values_2-3.diff</url>
    </attachment>
  </attachments>
</ticket>
