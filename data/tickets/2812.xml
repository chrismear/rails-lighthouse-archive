<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-06-17T15:28:12+01:00</created-at>
  <creator-id type="integer">60299</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">71472</milestone-id>
  <number type="integer">2812</number>
  <permalink>patch-add-a-method-to-memcachestore-to-reset-the-connection-to-memcached</permalink>
  <priority type="integer">1911</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>stale</state>
  <tag>bugmash cache patch</tag>
  <title>[patch] Add a method to MemCacheStore to reset the connection to memcached</title>
  <updated-at type="datetime">2011-02-02T18:22:28+00:00</updated-at>
  <user-id type="integer">40272</user-id>
  <version type="integer">9</version>
  <user-name>Santiago Pastorino</user-name>
  <creator-name>Eric Entin</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/2812</url>
  <milestone-title>3.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>When you're using Phusion Passenger's smart spawning mode, file descriptors get shared between all of the new processes. This means that you have to close and re-open any persistent connections (such as memcached) that your Rails app has. If you are using Rails' integrated cache, this is difficult without either monkey-patching ActiveSupport::Cache::MemCacheStore or using instance_variable_get. I don't think either of those are clean solutions so I created this patch, which is literally three lines of code. I didn't include a test for the method because the stats and clear methods of MemCacheStore aren't tested either, and this one's along the same lines. Let me know if I missed anything!</original-body>
  <latest-body>When you're using Phusion Passenger's smart spawning mode, file descriptors get shared between all of the new processes. This means that you have to close and re-open any persistent connections (such as memcached) that your Rails app has. If you are using Rails' integrated cache, this is difficult without either monkey-patching ActiveSupport::Cache::MemCacheStore or using instance_variable_get. I don't think either of those are clean solutions so I created this patch, which is literally three lines of code. I didn't include a test for the method because the stats and clear methods of MemCacheStore aren't tested either, and this one's along the same lines. Let me know if I missed anything!</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;When you're using Phusion Passenger's smart spawning mode, file
descriptors get shared between all of the new processes. This means
that you have to close and re-open any persistent connections (such
as memcached) that your Rails app has. If you are using Rails'
integrated cache, this is difficult without either monkey-patching
ActiveSupport::Cache::MemCacheStore or using instance_variable_get.
I don't think either of those are clean solutions so I created this
patch, which is literally three lines of code. I didn't include a
test for the method because the stats and clear methods of
MemCacheStore aren't tested either, and this one's along the same
lines. Let me know if I missed anything!&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>When you're using Phusion Passenger's smart spawning mode, file descriptors get shared between all of the new processes. This means that you have to close and re-open any persistent connections (such as memcached) that your Rails app has. If you are using Rails' integrated cache, this is difficult without either monkey-patching ActiveSupport::Cache::MemCacheStore or using instance_variable_get. I don't think either of those are clean solutions so I created this patch, which is literally three lines of code. I didn't include a test for the method because the stats and clear methods of MemCacheStore aren't tested either, and this one's along the same lines. Let me know if I missed anything!</body>
      <body-html>&lt;div&gt;&lt;p&gt;When you're using Phusion Passenger's smart spawning mode, file
descriptors get shared between all of the new processes. This means
that you have to close and re-open any persistent connections (such
as memcached) that your Rails app has. If you are using Rails'
integrated cache, this is difficult without either monkey-patching
ActiveSupport::Cache::MemCacheStore or using instance_variable_get.
I don't think either of those are clean solutions so I created this
patch, which is literally three lines of code. I didn't include a
test for the method because the stats and clear methods of
MemCacheStore aren't tested either, and this one's along the same
lines. Let me know if I missed anything!&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-06-17T15:28:12+01:00</created-at>
      <creator-id type="integer">60299</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2812</number>
      <permalink>patch-add-a-method-to-memcachestore-to-reset-the-connection-to-memcached</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>[patch] Add a method to MemCacheStore to reset the connection to memcached</title>
      <updated-at type="datetime">2009-06-17T15:28:15+01:00</updated-at>
      <user-id type="integer">60299</user-id>
      <version type="integer">1</version>
      <user-name>Eric Entin</user-name>
      <creator-name>Eric Entin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2812</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-06-17T18:37:40+01:00</created-at>
      <creator-id type="integer">60299</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2812</number>
      <permalink>patch-add-a-method-to-memcachestore-to-reset-the-connection-to-memcached</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>cache patch</tag>
      <title>[patch] Add a method to MemCacheStore to reset the connection to memcached</title>
      <updated-at type="datetime">2009-06-17T18:37:42+01:00</updated-at>
      <user-id type="integer">60299</user-id>
      <version type="integer">2</version>
      <user-name>Eric Entin</user-name>
      <creator-name>Eric Entin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2812</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>+1</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-15T05:34:18+01:00</created-at>
      <creator-id type="integer">60299</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">2812</number>
      <permalink>patch-add-a-method-to-memcachestore-to-reset-the-connection-to-memcached</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>cache patch</tag>
      <title>[patch] Add a method to MemCacheStore to reset the connection to memcached</title>
      <updated-at type="datetime">2010-04-15T05:34:21+01:00</updated-at>
      <user-id type="integer">20836</user-id>
      <version type="integer">3</version>
      <user-name>Lawrence Pit</user-name>
      <creator-name>Eric Entin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2812</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/19097)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/19097&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-04T18:48:52+01:00</created-at>
      <creator-id type="integer">60299</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 9903
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2812</number>
      <permalink>patch-add-a-method-to-memcachestore-to-reset-the-connection-to-memcached</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>cache patch</tag>
      <title>[patch] Add a method to MemCacheStore to reset the connection to memcached</title>
      <updated-at type="datetime">2010-05-04T18:48:52+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">4</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>Eric Entin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2812</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-09T19:26:34+01:00</created-at>
      <creator-id type="integer">60299</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: cache patch
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2812</number>
      <permalink>patch-add-a-method-to-memcachestore-to-reset-the-connection-to-memcached</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash cache patch</tag>
      <title>[patch] Add a method to MemCacheStore to reset the connection to memcached</title>
      <updated-at type="datetime">2010-05-09T19:26:39+01:00</updated-at>
      <user-id type="integer">22242</user-id>
      <version type="integer">5</version>
      <user-name>Dan Pickett</user-name>
      <creator-name>Eric Entin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2812</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>+1

Would be nice if we could get this backported to a 2.3.x release. It's pretty lame that you have to work around this by either monkeypatching MemCacheStore or doing some nasty hackery.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1&lt;/p&gt;
&lt;p&gt;Would be nice if we could get this backported to a 2.3.x
release. It's pretty lame that you have to work around this by
either monkeypatching MemCacheStore or doing some nasty
hackery.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-18T02:35:02+01:00</created-at>
      <creator-id type="integer">60299</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2812</number>
      <permalink>patch-add-a-method-to-memcachestore-to-reset-the-connection-to-memcached</permalink>
      <priority type="integer">1911</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash cache patch</tag>
      <title>[patch] Add a method to MemCacheStore to reset the connection to memcached</title>
      <updated-at type="datetime">2010-07-18T02:35:06+01:00</updated-at>
      <user-id type="integer">89421</user-id>
      <version type="integer">6</version>
      <user-name>Joel Watson</user-name>
      <creator-name>Eric Entin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2812</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Eric please add tests for this.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Eric please add tests for this.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-19T17:14:13+01:00</created-at>
      <creator-id type="integer">60299</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2812</number>
      <permalink>patch-add-a-method-to-memcachestore-to-reset-the-connection-to-memcached</permalink>
      <priority type="integer">1911</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>bugmash cache patch</tag>
      <title>[patch] Add a method to MemCacheStore to reset the connection to memcached</title>
      <updated-at type="datetime">2010-07-19T17:14:16+01:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">7</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>Eric Entin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2812</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>This issue has been automatically marked as stale because it has not been commented on for at least three months.

The resources of the Rails core team are limited, and so we are asking for your help. If you can still reproduce this error on the 3-0-stable branch or on master, please reply with all of the information you have about it and add &quot;[state:open]&quot; to your comment. This will reopen the ticket for review. Likewise, if you feel that this is a very important feature for Rails to include, please reply with your explanation so we can consider it.

Thank you for all your contributions, and we hope you will understand this step to focus our efforts where they are most helpful.</body>
      <body-html>&lt;div&gt;&lt;p&gt;This issue has been automatically marked as stale because it has
not been commented on for at least three months.&lt;/p&gt;
&lt;p&gt;The resources of the Rails core team are limited, and so we are
asking for your help. If you can still reproduce this error on the
3-0-stable branch or on master, please reply with all of the
information you have about it and add &quot;[state:open]&quot; to your
comment. This will reopen the ticket for review. Likewise, if you
feel that this is a very important feature for Rails to include,
please reply with your explanation so we can consider it.&lt;/p&gt;
&lt;p&gt;Thank you for all your contributions, and we hope you will
understand this step to focus our efforts where they are most
helpful.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2011-02-02T16:51:26+00:00</created-at>
      <creator-id type="integer">60299</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2812</number>
      <permalink>patch-add-a-method-to-memcachestore-to-reset-the-connection-to-memcached</permalink>
      <priority type="integer">1911</priority>
      <project-id type="integer">8994</project-id>
      <state>open</state>
      <tag>bugmash cache patch</tag>
      <title>[patch] Add a method to MemCacheStore to reset the connection to memcached</title>
      <updated-at type="datetime">2011-02-02T18:21:51+00:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">8</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>Eric Entin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2812</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body nil="true"></body>
      <body-html nil="true"></body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2011-02-02T16:51:27+00:00</created-at>
      <creator-id type="integer">60299</creator-id>
      <diffable-attributes type="yaml">--- 
:state: open
</diffable-attributes>
      <milestone-id type="integer">71472</milestone-id>
      <number type="integer">2812</number>
      <permalink>patch-add-a-method-to-memcachestore-to-reset-the-connection-to-memcached</permalink>
      <priority type="integer">1911</priority>
      <project-id type="integer">8994</project-id>
      <state>stale</state>
      <tag>bugmash cache patch</tag>
      <title>[patch] Add a method to MemCacheStore to reset the connection to memcached</title>
      <updated-at type="datetime">2011-02-02T18:22:28+00:00</updated-at>
      <user-id type="integer">40272</user-id>
      <version type="integer">9</version>
      <user-name>Santiago Pastorino</user-name>
      <creator-name>Eric Entin</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/2812</url>
      <milestone-title>3.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>a5e48f14252eab4410faf0df6569906b062217e8</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-06-17T15:28:12+01:00</created-at>
      <filename>mem_cache_store_reset.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">134395</id>
      <size type="integer">1107</size>
      <uploader-id type="integer">60299</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/134395/mem_cache_store_reset.diff</url>
    </attachment>
  </attachments>
</ticket>
