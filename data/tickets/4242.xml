<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">19965</assigned-user-id>
  <attachments-count type="integer">4</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2010-11-25T12:27:55+00:00</created-at>
  <creator-id type="integer">25257</creator-id>
  <milestone-due-on type="datetime">2010-11-15T00:00:00+00:00</milestone-due-on>
  <milestone-id type="integer">88038</milestone-id>
  <number type="integer">4242</number>
  <permalink>nested-child-only-updates-if-parent-changes</permalink>
  <priority type="integer">3</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; bugmash patch &quot;rails 3.0 beta&quot;</tag>
  <title>Nested child only updates if parent changes.</title>
  <updated-at type="datetime">2011-01-05T20:23:25+00:00</updated-at>
  <user-id type="integer">123638</user-id>
  <version type="integer">29</version>
  <user-name>Ivan</user-name>
  <creator-name>chap</creator-name>
  <assigned-user-name>Jos&#233; Valim</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
  <milestone-title>3.0.2</milestone-title>
  <priority-name>Low</priority-name>
  <original-body>Found a bug in rails 3.0.0.beta with accepts_nested_attributes_for

[In this video](http://screencast.com/t/MDVhOWY5 &quot;In this video&quot;) (10 sec) the nested attribute is only updated if it's parent model is changed.

Using rails 3.0.0.beta and full project [is on github](http://github.com/chap/broken_nested_attributes &quot;is on github&quot;).

Summary of models and form:

@@@ ruby
class Project &lt; ActiveRecord::Base
  has_many :tasks
  accepts_nested_attributes_for :tasks
end

class Task &lt; ActiveRecord::Base
  belongs_to :project
  has_many :assignments
  accepts_nested_attributes_for :assignments
end

class Assignment &lt; ActiveRecord::Base
  belongs_to :task
end


form_for(@project) do |f|

  Project: f.text_field :name

  f.fields_for :tasks do |task_form|
    Task: task_form.text_field :name

    task_form.fields_for :assignments do |assignment_form|
      Assignment: assignment_form.text_field :name
    end
  end

  f.submit
end
@@@</original-body>
  <latest-body>Found a bug in rails 3.0.0.beta with accepts_nested_attributes_for

[In this video](http://screencast.com/t/MDVhOWY5 &quot;In this video&quot;) (10 sec) the nested attribute is only updated if it's parent model is changed.

Using rails 3.0.0.beta and full project [is on github](http://github.com/chap/broken_nested_attributes &quot;is on github&quot;).

Summary of models and form:

@@@ ruby
class Project &lt; ActiveRecord::Base
  has_many :tasks
  accepts_nested_attributes_for :tasks
end

class Task &lt; ActiveRecord::Base
  belongs_to :project
  has_many :assignments
  accepts_nested_attributes_for :assignments
end

class Assignment &lt; ActiveRecord::Base
  belongs_to :task
end


form_for(@project) do |f|

  Project: f.text_field :name

  f.fields_for :tasks do |task_form|
    Task: task_form.text_field :name

    task_form.fields_for :assignments do |assignment_form|
      Assignment: assignment_form.text_field :name
    end
  end

  f.submit
end
@@@</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;Found a bug in rails 3.0.0.beta with
accepts_nested_attributes_for&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://screencast.com/t/MDVhOWY5&quot; title=
&quot;In this video&quot;&gt;In this video&lt;/a&gt; (10 sec) the nested attribute is
only updated if it's parent model is changed.&lt;/p&gt;
&lt;p&gt;Using rails 3.0.0.beta and full project &lt;a href=
&quot;http://github.com/chap/broken_nested_attributes&quot; title=
&quot;is on github&quot;&gt;is on github&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Summary of models and form:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;class Project &amp;lt; ActiveRecord::Base
  has_many :tasks
  accepts_nested_attributes_for :tasks
end

class Task &amp;lt; ActiveRecord::Base
  belongs_to :project
  has_many :assignments
  accepts_nested_attributes_for :assignments
end

class Assignment &amp;lt; ActiveRecord::Base
  belongs_to :task
end


form_for(@project) do |f|

  Project: f.text_field :name

  f.fields_for :tasks do |task_form|
    Task: task_form.text_field :name

    task_form.fields_for :assignments do |assignment_form|
      Assignment: assignment_form.text_field :name
    end
  end

  f.submit
end&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Found a bug in rails 3.0.0.beta with accepts_nested_attributes_for

[In this video](http://screencast.com/t/MDVhOWY5 &quot;In this video&quot;) (10 sec) the nested attribute is only updated if it's parent model is changed.

Using rails 3.0.0.beta and full project [is on github](http://github.com/chap/broken_nested_attributes &quot;is on github&quot;).

Summary of models and form:

@@@ ruby
class Project &lt; ActiveRecord::Base
  has_many :tasks
  accepts_nested_attributes_for :tasks
end

class Task &lt; ActiveRecord::Base
  belongs_to :project
  has_many :assignments
  accepts_nested_attributes_for :assignments
end

class Assignment &lt; ActiveRecord::Base
  belongs_to :task
end


form_for(@project) do |f|

  Project: f.text_field :name

  f.fields_for :tasks do |task_form|
    Task: task_form.text_field :name

    task_form.fields_for :assignments do |assignment_form|
      Assignment: assignment_form.text_field :name
    end
  end

  f.submit
end
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;Found a bug in rails 3.0.0.beta with
accepts_nested_attributes_for&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://screencast.com/t/MDVhOWY5&quot; title=
&quot;In this video&quot;&gt;In this video&lt;/a&gt; (10 sec) the nested attribute is
only updated if it's parent model is changed.&lt;/p&gt;
&lt;p&gt;Using rails 3.0.0.beta and full project &lt;a href=
&quot;http://github.com/chap/broken_nested_attributes&quot; title=
&quot;is on github&quot;&gt;is on github&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Summary of models and form:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;class Project &amp;lt; ActiveRecord::Base
  has_many :tasks
  accepts_nested_attributes_for :tasks
end

class Task &amp;lt; ActiveRecord::Base
  belongs_to :project
  has_many :assignments
  accepts_nested_attributes_for :assignments
end

class Assignment &amp;lt; ActiveRecord::Base
  belongs_to :task
end


form_for(@project) do |f|

  Project: f.text_field :name

  f.fields_for :tasks do |task_form|
    Task: task_form.text_field :name

    task_form.fields_for :assignments do |assignment_form|
      Assignment: assignment_form.text_field :name
    end
  end

  f.submit
end&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-03-20T14:51:51+00:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-03-20T14:51:53+00:00</updated-at>
      <user-id type="integer">25257</user-id>
      <version type="integer">1</version>
      <user-name>chap</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Added failing test to project:
http://github.com/chap/broken_nested_attributes/blob/master/test/unit/project_test.rb

@@@ ruby
projects(:one).update_attributes :name =&gt; projects(:one).name,
                                 :tasks_attributes =&gt; [{
                                   :id =&gt; tasks(:one).id,
                                   :name =&gt; tasks(:one).name,
                                   :assignments_attributes =&gt; [{
                                     :id =&gt; assignments(:one).id,
                                    :name =&gt; 'Paul'
                                   }]
                                  }]
assignments(:one).reload
assert_equal 'Paul', assignments(:one).name
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;Added failing test to project:&lt;br&gt;
&lt;a href=
&quot;http://github.com/chap/broken_nested_attributes/blob/master/test/unit/project_test.rb&quot;&gt;
http://github.com/chap/broken_nested_attributes/blob/master/test/un...&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code class=
&quot;ruby&quot;&gt;projects(:one).update_attributes :name =&amp;gt; projects(:one).name,
                                 :tasks_attributes =&amp;gt; [{
                                   :id =&amp;gt; tasks(:one).id,
                                   :name =&amp;gt; tasks(:one).name,
                                   :assignments_attributes =&amp;gt; [{
                                     :id =&amp;gt; assignments(:one).id,
                                    :name =&amp;gt; 'Paul'
                                   }]
                                  }]
assignments(:one).reload
assert_equal 'Paul', assignments(:one).name&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-03-20T15:15:12+00:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-03-20T15:15:13+00:00</updated-at>
      <user-id type="integer">25257</user-id>
      <version type="integer">2</version>
      <user-name>chap</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I can confirm this bug on rails 3 beta2/edge.
If you pull chaps test project from github and have problems with rake: take a look at http://github.com/wycats/bundler/issues/issue/159/#comment_175945</body>
      <body-html>&lt;div&gt;&lt;p&gt;I can confirm this bug on rails 3 beta2/edge.&lt;br&gt;
If you pull chaps test project from github and have problems with
rake: take a look at &lt;a href=
&quot;http://github.com/wycats/bundler/issues/issue/159/#comment_175945&quot;&gt;
http://github.com/wycats/bundler/issues/issue/159/#comment_175945&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-02T10:51:54+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-04-02T10:51:59+01:00</updated-at>
      <user-id type="integer">93116</user-id>
      <version type="integer">3</version>
      <user-name>Dirk Holzapfel</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I can also confirm this bug on Rails 3 beta2/edge.  My parent object only contained foreign keys, so the problem was not obvious at all, glad I found this ticket!</body>
      <body-html>&lt;div&gt;&lt;p&gt;I can also confirm this bug on Rails 3 beta2/edge. My parent
object only contained foreign keys, so the problem was not obvious
at all, glad I found this ticket!&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-05T04:06:05+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-04-05T04:06:09+01:00</updated-at>
      <user-id type="integer">86706</user-id>
      <version type="integer">4</version>
      <user-name>Jeff Bigler</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Good to know I'm not alone.

I think the next step is for one of us to fork the active record repo and create a failing test in the nested attributes test cases:
http://github.com/rails/rails/blob/master/activerecord/test/cases/nested_attributes_test.rb

I got a big week ahead of me, but if nobody's done it by Friday I'll try to get it done.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Good to know I'm not alone.&lt;/p&gt;
&lt;p&gt;I think the next step is for one of us to fork the active record
repo and create a failing test in the nested attributes test
cases:&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/blob/master/activerecord/test/cases/nested_attributes_test.rb&quot;&gt;
http://github.com/rails/rails/blob/master/activerecord/test/cases/n...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I got a big week ahead of me, but if nobody's done it by Friday
I'll try to get it done.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-05T16:22:04+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-04-05T16:22:09+01:00</updated-at>
      <user-id type="integer">25257</user-id>
      <version type="integer">5</version>
      <user-name>chap</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Here is a patch with the failing test cases.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Here is a patch with the failing test cases.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-05T21:25:23+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; &quot;rails 3.0 beta&quot;
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-04-05T21:25:29+01:00</updated-at>
      <user-id type="integer">86706</user-id>
      <version type="integer">6</version>
      <user-name>Jeff Bigler</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I've been able to narrow the problem down to the _associated_records_to_validate_or_save_ method in **activerecord/lib/active_record/autosave_association.rb.**

The line:

association.target.find_all { |record| record.new_record? || record.changed? || record.marked_for_destruction? }

doesn't take into consideration children of the selected record with changes.  I'm still trying to figure out how to modify the code to work appropriately.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've been able to narrow the problem down to the
&lt;em&gt;associated_records_to_validate_or_save&lt;/em&gt; method in
&lt;strong&gt;activerecord/lib/active_record/autosave_association.rb.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The line:&lt;/p&gt;
&lt;p&gt;association.target.find_all { |record| record.new_record? ||
record.changed? || record.marked_for_destruction? }&lt;/p&gt;
&lt;p&gt;doesn't take into consideration children of the selected record
with changes. I'm still trying to figure out how to modify the code
to work appropriately.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-06T06:18:49+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-04-06T06:18:51+01:00</updated-at>
      <user-id type="integer">86706</user-id>
      <version type="integer">7</version>
      <user-name>Jeff Bigler</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Great find Jeff!
For posterity, here's how the method has been modified from 2.3.5 to 3.0.0.beta

@@@ ruby
2.3.5
def associated_records_to_validate_or_save(association, new_record, autosave)
  if new_record
    association
  elsif association.loaded?
    autosave ? association : association.select { |record| record.new_record? }
  else
    autosave ? association.target : association.target.select { |record| record.new_record? }
  end
end
@@@

@@@ ruby
3.0.0.beta
def associated_records_to_validate_or_save(association, new_record, autosave)
  if new_record
    association
  elsif autosave
    association.target.find_all { |record| record.new_record? || record.changed? || record.marked_for_destruction? }
  else
    association.target.find_all { |record| record.new_record? }
  end
end
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;Great find Jeff!&lt;br&gt;
For posterity, here's how the method has been modified from 2.3.5
to 3.0.0.beta&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;2.3.5
def associated_records_to_validate_or_save(association, new_record, autosave)
  if new_record
    association
  elsif association.loaded?
    autosave ? association : association.select { |record| record.new_record? }
  else
    autosave ? association.target : association.target.select { |record| record.new_record? }
  end
end&lt;/code&gt;
&lt;/pre&gt;
&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;3.0.0.beta
def associated_records_to_validate_or_save(association, new_record, autosave)
  if new_record
    association
  elsif autosave
    association.target.find_all { |record| record.new_record? || record.changed? || record.marked_for_destruction? }
  else
    association.target.find_all { |record| record.new_record? }
  end
end&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-06T14:01:48+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-04-06T14:01:52+01:00</updated-at>
      <user-id type="integer">25257</user-id>
      <version type="integer">8</version>
      <user-name>chap</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>OK, I've worked up a patch that fixes the problem without breaking anything.  This patch file includes the updated tests as well as the changes to ActiveRecord to support the nested associations.  Please try it out and let me know if there are any problems.</body>
      <body-html>&lt;div&gt;&lt;p&gt;OK, I've worked up a patch that fixes the problem without
breaking anything. This patch file includes the updated tests as
well as the changes to ActiveRecord to support the nested
associations. Please try it out and let me know if there are any
problems.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-07T23:03:41+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; patch &quot;rails 3.0 beta&quot;
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; fix patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-04-07T23:03:59+01:00</updated-at>
      <user-id type="integer">86706</user-id>
      <version type="integer">9</version>
      <user-name>Jeff Bigler</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Oops, didn't mean to add a &quot;fix&quot; tag.  D'oh!</body>
      <body-html>&lt;div&gt;&lt;p&gt;Oops, didn't mean to add a &quot;fix&quot; tag. D'oh!&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-07T23:05:18+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; fix patch &quot;rails 3.0 beta&quot;
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-04-07T23:05:22+01:00</updated-at>
      <user-id type="integer">86706</user-id>
      <version type="integer">10</version>
      <user-name>Jeff Bigler</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I've updated the patch to work with the latest revision of Rails 3.0 head.  Since no one has responded, I'll try contacting someone via #rails-config.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've updated the patch to work with the latest revision of Rails
3.0 head. Since no one has responded, I'll try contacting someone
via #rails-config.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-18T22:11:45+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-04-18T22:11:48+01:00</updated-at>
      <user-id type="integer">86706</user-id>
      <version type="integer">11</version>
      <user-name>Jeff Bigler</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I was just logging on to file a bug for this. Thanks Jeff, for making a patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I was just logging on to file a bug for this. Thanks Jeff, for
making a patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-22T00:27:55+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-04-22T00:27:59+01:00</updated-at>
      <user-id type="integer">36417</user-id>
      <version type="integer">12</version>
      <user-name>eydaimon</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Hmm, this feels a bit like duplication. I&#8217;d rather be able to call save on a parent, which will run it's before/after filters even if it's not dirty. This way the saving _should_ cascade down to the children&#8230;

I hope that explanation is a bit clear :)</body>
      <body-html>&lt;div&gt;&lt;p&gt;Hmm, this feels a bit like duplication. I&amp;#8217;d rather be able
to call save on a parent, which will run it's before/after filters
even if it's not dirty. This way the saving &lt;em&gt;should&lt;/em&gt; cascade
down to the children&amp;#8230;&lt;/p&gt;
&lt;p&gt;I hope that explanation is a bit clear :)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-27T09:46:02+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-04-27T09:46:07+01:00</updated-at>
      <user-id type="integer">8406</user-id>
      <version type="integer">13</version>
      <user-name>Eloy Duran</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I know what you mean Eloy.  It seemed that the change which broke the original functionality was intended to reduce unnecessary database writes, so I wrote the patch with that goal in mind.  But since it's my first time digging around in the Rails internals, I'm definitely in over my head.  :)</body>
      <body-html>&lt;div&gt;&lt;p&gt;I know what you mean Eloy. It seemed that the change which broke
the original functionality was intended to reduce unnecessary
database writes, so I wrote the patch with that goal in mind. But
since it's my first time digging around in the Rails internals, I'm
definitely in over my head. :)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-27T15:53:08+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-04-27T15:53:10+01:00</updated-at>
      <user-id type="integer">86706</user-id>
      <version type="integer">14</version>
      <user-name>Jeff Bigler</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I think the sanest way to handle this patch is by marking the record as changed whenever association_attributes= are set. The implementation should be simple, the ticket will be solved but without saving the record all the time.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I think the sanest way to handle this patch is by marking the
record as changed whenever association_attributes= are set. The
implementation should be simple, the ticket will be solved but
without saving the record all the time.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-29T13:03:42+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- 
:milestone: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-04-29T13:03:44+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">15</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I am having the same problem when trying to destroy the record. The behaviour seems to be the same as for changing. If I make changes to the parent record, the child record, marked for deletion is successfully deleted, but if I don't change the parent the child is not deleted.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I am having the same problem when trying to destroy the record.
The behaviour seems to be the same as for changing. If I make
changes to the parent record, the child record, marked for deletion
is successfully deleted, but if I don't change the parent the child
is not deleted.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-01T14:57:49+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-05-01T14:57:53+01:00</updated-at>
      <user-id type="integer">97424</user-id>
      <version type="integer">16</version>
      <user-name>Cicero Oliveira</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body></body>
      <body-html></body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-09T18:19:27+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; patch &quot;rails 3.0 beta&quot;
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; bugmash patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-05-09T18:19:30+01:00</updated-at>
      <user-id type="integer">22242</user-id>
      <version type="integer">17</version>
      <user-name>Dan Pickett</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>I've tidied up Jeff's patch, and have also added code to make creating and deleting records in nested associations work as well.  Posting here as proof of concept, this is speced against my application code, but I've not checked how performant it is (although it should not 'open' any associations that are not already in memory)

It's for rails 2.3.5, you can use it by dropping the code into an initializer.

@@@

# this fixes the problem that deeply nested changed records do not trigger a save on parent objects
module ActiveRecord
  module AutosaveAssociation
    def associated_records_to_validate_or_save(association, new_record, autosave)
      if new_record
        association
      elsif autosave
        association.target.select { |record| record.changed_for_autosave? }
      else
        association.target.select { |record| record.new_record? }
      end
    end

    def changed_for_autosave?
      new_record? || changed? || marked_for_destruction? || nested_records_changed_for_autosave?
    end
    
    def nested_records_changed_for_autosave?
      self.class.reflect_on_all_autosave_associations.each do |reflection|
        if association = association_instance_get(reflection.name)
          if [:belongs_to, :has_one].include?(reflection.macro)
            return true if association.changed_for_autosave?
          else
            association.target.each {|ele| return true if ele.changed_for_autosave? }
          end
        end
      end
      false
    end
  end
end
@@@

If this looks ok, I'll work on a patch</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've tidied up Jeff's patch, and have also added code to make
creating and deleting records in nested associations work as well.
Posting here as proof of concept, this is speced against my
application code, but I've not checked how performant it is
(although it should not 'open' any associations that are not
already in memory)&lt;/p&gt;
&lt;p&gt;It's for rails 2.3.5, you can use it by dropping the code into
an initializer.&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;
# this fixes the problem that deeply nested changed records do not trigger a save on parent objects
module ActiveRecord
  module AutosaveAssociation
    def associated_records_to_validate_or_save(association, new_record, autosave)
      if new_record
        association
      elsif autosave
        association.target.select { |record| record.changed_for_autosave? }
      else
        association.target.select { |record| record.new_record? }
      end
    end

    def changed_for_autosave?
      new_record? || changed? || marked_for_destruction? || nested_records_changed_for_autosave?
    end
    
    def nested_records_changed_for_autosave?
      self.class.reflect_on_all_autosave_associations.each do |reflection|
        if association = association_instance_get(reflection.name)
          if [:belongs_to, :has_one].include?(reflection.macro)
            return true if association.changed_for_autosave?
          else
            association.target.each {|ele| return true if ele.changed_for_autosave? }
          end
        end
      end
      false
    end
  end
end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;If this looks ok, I'll work on a patch&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-15T15:13:49+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; bugmash patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-05-15T15:13:52+01:00</updated-at>
      <user-id type="integer">1023</user-id>
      <version type="integer">18</version>
      <user-name>Ian White</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Ian, your code looks cleaner, but I'm wondering wether a patch that marks the current record as dirty when association_attributes= would perform better.

Isn't &quot;association.target.each { |ele|&quot; makes all autosave association be loaded and retrieved from the database? Or target brings only the objects that were already instantiated?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Ian, your code looks cleaner, but I'm wondering wether a patch
that marks the current record as dirty when association_attributes=
would perform better.&lt;/p&gt;
&lt;p&gt;Isn't &quot;association.target.each { |ele|&quot; makes all autosave
association be loaded and retrieved from the database? Or target
brings only the objects that were already instantiated?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-15T15:21:12+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; bugmash patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-05-15T15:21:17+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">19</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>(replied via email, but the reply doesn't seem to have showed up here, so I'll post here as well - apologies if there is duplication)

Hi Jos&#233;,

I believe that the conditional (association = association_instance_get...) should guard against instantiating an association that is not already in memory.

To answer your question about #target, my understanding from the code is that #target just returns the ivar in its current state from an assoc proxy.  This would mean that no extra records are loaded up, just the records that have been loaded/created by the #&lt;association&gt;_attributes= method.

The problems, as I see it, with marking a record as dirty when attributes are changed  are (i) if the subsidiary records are not changed by the #attributes= , the record is saved anyway,and (ii) changing a record by traversal in memory (e.g. in console: @blog.posts.first.comments.first.name = &quot;changed&quot;) would not trigger an autosave.

Cheers,
Ian</body>
      <body-html>&lt;div&gt;&lt;p&gt;(replied via email, but the reply doesn't seem to have showed up
here, so I'll post here as well - apologies if there is
duplication)&lt;/p&gt;
&lt;p&gt;Hi Jos&amp;eacute;,&lt;/p&gt;
&lt;p&gt;I believe that the conditional (association =
association_instance_get...) should guard against instantiating an
association that is not already in memory.&lt;/p&gt;
&lt;p&gt;To answer your question about #target, my understanding from the
code is that #target just returns the ivar in its current state
from an assoc proxy. This would mean that no extra records are
loaded up, just the records that have been loaded/created by the
#_attributes= method.&lt;/p&gt;
&lt;p&gt;The problems, as I see it, with marking a record as dirty when
attributes are changed are (i) if the subsidiary records are not
changed by the #attributes= , the record is saved anyway,and (ii)
changing a record by traversal in memory (e.g. in console:
@blog.posts.first.comments.first.name = &quot;changed&quot;) would not
trigger an autosave.&lt;/p&gt;
&lt;p&gt;Cheers,&lt;br&gt;
Ian&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-15T15:43:21+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; bugmash patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-05-15T15:43:24+01:00</updated-at>
      <user-id type="integer">1023</user-id>
      <version type="integer">20</version>
      <user-name>Ian White</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Awesome! So please do provide a patch! :)</body>
      <body-html>&lt;div&gt;&lt;p&gt;Awesome! So please do provide a patch! :)&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-15T15:45:37+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; bugmash patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-05-15T15:45:40+01:00</updated-at>
      <user-id type="integer">19965</user-id>
      <version type="integer">21</version>
      <user-name>Jos&#233; Valim</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Ok, here's 2 patches, one against 2-3-stable, and one against master.

The patch tests cases where the grand-parent is has_many, and where the great-grandparent is has_one, and also tests that no extra queries are done in the collection of changed records phase.

the existing tests all pass with these patches applied.

Let me know if these need any more work.

Cheers,
Ian</body>
      <body-html>&lt;div&gt;&lt;p&gt;Ok, here's 2 patches, one against 2-3-stable, and one against
master.&lt;/p&gt;
&lt;p&gt;The patch tests cases where the grand-parent is has_many, and
where the great-grandparent is has_one, and also tests that no
extra queries are done in the collection of changed records
phase.&lt;/p&gt;
&lt;p&gt;the existing tests all pass with these patches applied.&lt;/p&gt;
&lt;p&gt;Let me know if these need any more work.&lt;/p&gt;
&lt;p&gt;Cheers,&lt;br&gt;
Ian&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-18T10:36:02+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; bugmash patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-05-18T10:36:04+01:00</updated-at>
      <user-id type="integer">1023</user-id>
      <version type="integer">22</version>
      <user-name>Ian White</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>(from [a5696e36c6b49381e84184fcc2f164285a26a166]) Nested records (re: autosave) are now updated even when the intermediate parent record is unchanged [#4242]

Signed-off-by: Jos&#233; Valim &lt;jose.valim@gmail.com&gt;
http://github.com/rails/rails/commit/a5696e36c6b49381e84184fcc2f164285a26a166</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/a5696e36c6b49381e84184fcc2f164285a26a166&quot;
title=
&quot;Changeset [a5696e36c6b49381e84184fcc2f164285a26a166]&quot;&gt;[a5696e36c6b49381e84184fcc2f164285a26a166]&lt;/a&gt;)
Nested records (re: autosave) are now updated even when the
intermediate parent record is unchanged [&lt;a href=
&quot;/projects/8994/tickets/4242&quot; title=&quot;Ticket #4242&quot;&gt;#4242&lt;/a&gt;]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jos&amp;eacute; Valim &lt;a&gt;jose.valim@gmail.com&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/a5696e36c6b49381e84184fcc2f164285a26a166&quot;&gt;
http://github.com/rails/rails/commit/a5696e36c6b49381e84184fcc2f164...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-05-18T15:12:37+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; bugmash patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-05-18T15:12:39+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">23</version>
      <user-name>Repository</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>(from [b439d85a19c02eefab1ee308fff334ac1049524d]) Nested records (re: autosave) are now updated even when the intermediate parent record is unchanged [#4242 state:resolved]

Signed-off-by: Jos&#233; Valim &lt;jose.valim@gmail.com&gt;
http://github.com/rails/rails/commit/b439d85a19c02eefab1ee308fff334ac1049524d</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/b439d85a19c02eefab1ee308fff334ac1049524d&quot;
title=
&quot;Changeset [b439d85a19c02eefab1ee308fff334ac1049524d]&quot;&gt;[b439d85a19c02eefab1ee308fff334ac1049524d]&lt;/a&gt;)
Nested records (re: autosave) are now updated even when the
intermediate parent record is unchanged [&lt;a href=
&quot;/projects/8994/tickets/4242&quot; title=&quot;Ticket #4242&quot;&gt;#4242&lt;/a&gt;
state:resolved]&lt;/p&gt;
&lt;p&gt;Signed-off-by: Jos&amp;eacute; Valim &lt;a&gt;jose.valim@gmail.com&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/b439d85a19c02eefab1ee308fff334ac1049524d&quot;&gt;
http://github.com/rails/rails/commit/b439d85a19c02eefab1ee308fff334...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-05-18T15:13:27+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; bugmash patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-05-18T15:13:30+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">24</version>
      <user-name>Repository</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Nice work Ian!</body>
      <body-html>&lt;div&gt;&lt;p&gt;Nice work Ian!&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-05-18T15:32:34+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; bugmash patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-05-18T15:32:39+01:00</updated-at>
      <user-id type="integer">8406</user-id>
      <version type="integer">25</version>
      <user-name>Eloy Duran</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>Thanks Ian!</body>
      <body-html>&lt;div&gt;&lt;p&gt;Thanks Ian!&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-05-20T13:59:24+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; bugmash patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-05-20T13:59:25+01:00</updated-at>
      <user-id type="integer">86706</user-id>
      <version type="integer">26</version>
      <user-name>Jeff Bigler</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title nil="true"></milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>[[bulk edit](/projects/8994/bulk_edits/31647)]</body>
      <body-html>&lt;div&gt;&lt;p&gt;[&lt;a href=&quot;/projects/8994/bulk_edits/31647&quot;&gt;bulk edit&lt;/a&gt;]&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-10-15T23:01:49+01:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
:milestone: 27004
</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; bugmash patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-10-15T23:01:49+01:00</updated-at>
      <user-id type="integer">85</user-id>
      <version type="integer">27</version>
      <user-name>Jeremy Kemper</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>&lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap uggs&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap uggs the only boot sale&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;uggs for cheap&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap ugg&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;ugg boots cheap&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap kids uggs&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap classic tall ugg boots 5815 mulberry&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;uggs cheap&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;uk cheap ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;super cheap ugg classic mini boots&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap ugg boots with zips&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap ugg sunburst boots&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;really cheap ugg classic mini&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap ugg boots for $64&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;ugg boots for cheap&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;ugg slippers cheap&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap authentic uggs&lt;/a&gt;,
&lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap ugg boots for sale in uk&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap ugg boots mulberry&lt;/a&gt; So You Can Buy It Now!

&lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;cheap ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots on sale&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg brand boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots uk&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots sale&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg australia boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;discount ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;what stores sell ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots on sale authorized&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;us ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;mens ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;australian ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg cove boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;fur inside ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;kids ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg bailey boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;adirondack tall ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;shopping for ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg mini boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;womens ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;lowest price ugg boots&lt;/a&gt;,&lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt; baby ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg style boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;knock off ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots discount&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg cove boots sale&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;discounted ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg roseberry boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;purple ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots sydney&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots cheap&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots store&lt;/a&gt; SO Cheap With Free Shipping!

&lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;UGG Store&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;UGG Store Outlet&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;UK UGG Store&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;ugg factory store&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;ugg outlet stores&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;what stores sell ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;ugg outlet store locations in pa hit bg&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;ugg store&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;ugg boots store&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;shoe stores ugg australia sandals kids&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;boot shoes store ugg hit bg&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;ugg store locater&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;shoe stores ugg australia kids&lt;/a&gt; Thats ugg store uk online shop!

&lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;tall boots&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;cardy ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;uggs sale&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;classic cardy ugg&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg classic cardy&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg cardy&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg cardy boots on sale&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg classic cardy boots&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg cardy chocolate&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg cardy sale&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg classic cardy tall&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg boots cardy&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;classic cardy ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;classic cardy ugg boots cream&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg cardy boot&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg cardy boots&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;adirondack tall ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg classic tall boots&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg classic tall&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg mosaic tall&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg tall boot sale&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;cheap classic tall ugg boots 5815 mulberry&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;classic tall ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg classic tall boot&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg classic cardy tall&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;sundance tall ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg boots classic tall&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg adirondack tall&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg classic tall wool&lt;/a&gt;. Have You Best Choice, Buy It Now!


&lt;a href=&quot;http://www.uggshop.net&quot;&gt;UGG Classic Short&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;UGG Short Boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;Short uggs&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;UGG Shop online&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;authentic ugg australia women's classic short #5825 - black sheepskin&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg classic short boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg fern suede classic short&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;classic short ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;classic short ugg in grey&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg short boots fushia&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg boots 8 short&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg ultra short black&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;eggplant short ugg&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;short classic ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;short ugg boots chestnut womens&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg boots black short&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg classic short black paisley&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg classic short boot&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg ultra short sku&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg women's classic short&lt;/a&gt;, Buy It Now! 

&lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;UGG Bailey Button&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;UGG Bailey Button Boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;UGG Bailey Button Triplet&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;UGG Bailey Button Bomber&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;UGG Boots 5803, UGG Boots 1873&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;UGG Boots USA&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;bailey button ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button boots bomber&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button boot&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button boots at macys&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg boots - bailey button novelty- kids grey&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg australia bailey button&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button crinkle leather&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button boots on sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button triplet boot&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button blackberry wine&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;discount ugg bailey button&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg australia bailey button boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button 5803 grey size 10&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button boot grey&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button cheap&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button triple&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg boots - bailey button novelty&lt;/a&gt;, Buy It Now!</body>
      <body-html>&lt;div&gt;&lt;p&gt;&lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap ugg boots&lt;/a&gt;,
&lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap uggs&lt;/a&gt;, &lt;a href=
&quot;http://www.cheapuggshop.com&quot;&gt;cheap uggs the only boot sale&lt;/a&gt;,
&lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;uggs for cheap&lt;/a&gt;, &lt;a href=
&quot;http://www.cheapuggshop.com&quot;&gt;cheap ugg&lt;/a&gt;, &lt;a href=
&quot;http://www.cheapuggshop.com&quot;&gt;ugg boots cheap&lt;/a&gt;, &lt;a href=
&quot;http://www.cheapuggshop.com&quot;&gt;cheap kids uggs&lt;/a&gt;, &lt;a href=
&quot;http://www.cheapuggshop.com&quot;&gt;cheap classic tall ugg boots 5815
mulberry&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;uggs cheap&lt;/a&gt;,
&lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;uk cheap ugg boots&lt;/a&gt;,
&lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;super cheap ugg classic mini
boots&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap ugg boots
with zips&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap ugg
sunburst boots&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;really
cheap ugg classic mini&lt;/a&gt;, &lt;a href=
&quot;http://www.cheapuggshop.com&quot;&gt;cheap ugg boots for $64&lt;/a&gt;, &lt;a href=
&quot;http://www.cheapuggshop.com&quot;&gt;ugg boots for cheap&lt;/a&gt;, &lt;a href=
&quot;http://www.cheapuggshop.com&quot;&gt;ugg slippers cheap&lt;/a&gt;, &lt;a href=
&quot;http://www.cheapuggshop.com&quot;&gt;cheap authentic uggs&lt;/a&gt;,&lt;br&gt;
&lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap ugg boots for sale in
uk&lt;/a&gt;, &lt;a href=&quot;http://www.cheapuggshop.com&quot;&gt;cheap ugg boots
mulberry&lt;/a&gt; So You Can Buy It Now!&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-boots-uk.com&quot;&gt;cheap ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots on sale&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg brand boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots uk&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots sale&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg australia boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-boots-uk.com&quot;&gt;discount ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.ugg-boots-uk.com&quot;&gt;what stores sell ugg boots&lt;/a&gt;,
&lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots on sale
authorized&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;us ugg
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;mens ugg
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;australian ugg
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg cove
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;fur inside ugg
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;kids ugg
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg bailey
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;adirondack tall
ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;shopping for
ugg boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg mini
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;womens ugg
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;lowest price ugg
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;baby ugg
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg style
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;knock off ugg
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots
discount&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg cove boots
sale&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;discounted ugg
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg roseberry
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;purple ugg
boots&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots
sydney&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots
cheap&lt;/a&gt;, &lt;a href=&quot;http://www.ugg-boots-uk.com&quot;&gt;ugg boots
store&lt;/a&gt; SO Cheap With Free Shipping!&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;UGG Store&lt;/a&gt;, &lt;a href=
&quot;http://www.uggbootseshop.com&quot;&gt;UGG Store Outlet&lt;/a&gt;, &lt;a href=
&quot;http://www.uggbootseshop.com&quot;&gt;UK UGG Store&lt;/a&gt;, &lt;a href=
&quot;http://www.uggbootseshop.com&quot;&gt;ugg factory store&lt;/a&gt;, &lt;a href=
&quot;http://www.uggbootseshop.com&quot;&gt;ugg outlet stores&lt;/a&gt;, &lt;a href=
&quot;http://www.uggbootseshop.com&quot;&gt;what stores sell ugg boots&lt;/a&gt;,
&lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;ugg outlet store locations
in pa hit bg&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;ugg
store&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;ugg boots
store&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;shoe stores ugg
australia sandals kids&lt;/a&gt;, &lt;a href=
&quot;http://www.uggbootseshop.com&quot;&gt;boot shoes store ugg hit bg&lt;/a&gt;,
&lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;ugg store locater&lt;/a&gt;,
&lt;a href=&quot;http://www.uggbootseshop.com&quot;&gt;shoe stores ugg australia
kids&lt;/a&gt; Thats ugg store uk online shop!&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;tall boots&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;cardy ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;uggs sale&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;classic cardy ugg&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;ugg classic cardy&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;ugg cardy&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;ugg cardy boots on sale&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;ugg classic cardy boots&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;ugg cardy chocolate&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;ugg cardy sale&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;ugg classic cardy tall&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;ugg boots cardy&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;classic cardy ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;classic cardy ugg boots cream&lt;/a&gt;,
&lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg cardy boot&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;ugg cardy boots&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;adirondack tall ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;ugg classic tall boots&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;ugg classic tall&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;ugg mosaic tall&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;ugg tall boot sale&lt;/a&gt;, &lt;a href=
&quot;http://www.auuggboots.com&quot;&gt;cheap classic tall ugg boots 5815
mulberry&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;classic tall ugg
boots&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg classic tall
boot&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg classic cardy
tall&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;sundance tall ugg
boots&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg boots classic
tall&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg adirondack
tall&lt;/a&gt;, &lt;a href=&quot;http://www.auuggboots.com&quot;&gt;ugg classic tall
wool&lt;/a&gt;. Have You Best Choice, Buy It Now!&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.uggshop.net&quot;&gt;UGG Classic Short&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshop.net&quot;&gt;UGG Short Boots&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshop.net&quot;&gt;Short uggs&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshop.net&quot;&gt;UGG Shop online&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshop.net&quot;&gt;authentic ugg australia women's classic
short&lt;/a&gt; &lt;a href=&quot;/projects/8994/tickets/5825&quot; title=
&quot;Ticket #5825&quot;&gt;#5825&lt;/a&gt; - black sheepskin,&lt;br&gt;
&lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg classic short boots&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg fern suede classic short&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshop.net&quot;&gt;classic short ugg boots&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshop.net&quot;&gt;classic short ugg in grey&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg short boots fushia&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg boots 8 short&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshop.net&quot;&gt;ugg ultra short black&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshop.net&quot;&gt;eggplant short ugg&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshop.net&quot;&gt;short classic ugg boots&lt;/a&gt;, &lt;a href=
&quot;http://www.uggshop.net&quot;&gt;short ugg boots chestnut womens&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg boots black short&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg classic short black
paisley&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg classic short
boot&lt;/a&gt;, &lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg ultra short sku&lt;/a&gt;,
&lt;a href=&quot;http://www.uggshop.net&quot;&gt;ugg women's classic short&lt;/a&gt;, Buy
It Now!&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;UGG Bailey Button&lt;/a&gt;,
&lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;UGG Bailey Button Boots&lt;/a&gt;,
&lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;UGG Bailey Button Triplet&lt;/a&gt;,
&lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;UGG Bailey Button Bomber&lt;/a&gt;,
&lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;UGG Boots 5803, UGG Boots
1873&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;UGG Boots USA&lt;/a&gt;,
&lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;bailey button ugg boots&lt;/a&gt;,
&lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button boots
bomber&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button
boot&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button
boots at macys&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg boots
- bailey button novelty- kids grey&lt;/a&gt;, &lt;a href=
&quot;http://www.uggbootsusa.com&quot;&gt;ugg australia bailey button&lt;/a&gt;,
&lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button crinkle
leather&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button
boots on sale&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey
button triplet boot&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg
bailey button blackberry wine&lt;/a&gt;, &lt;a href=
&quot;http://www.uggbootsusa.com&quot;&gt;discount ugg bailey button&lt;/a&gt;,
&lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg australia bailey button
boots&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button
5803 grey size 10&lt;/a&gt;, &lt;a href=&quot;http://www.uggbootsusa.com&quot;&gt;ugg
bailey button boot grey&lt;/a&gt;, &lt;a href=
&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button cheap&lt;/a&gt;, &lt;a href=
&quot;http://www.uggbootsusa.com&quot;&gt;ugg bailey button triple&lt;/a&gt;, &lt;a href=
&quot;http://www.uggbootsusa.com&quot;&gt;ugg boots - bailey button novelty&lt;/a&gt;,
Buy It Now!&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-11-25T12:13:20+00:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; bugmash patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2010-11-25T12:27:55+00:00</updated-at>
      <user-id type="integer">126682</user-id>
      <version type="integer">28</version>
      <user-name>sunnyabc</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">19965</assigned-user-id>
      <attachments-count type="integer">4</attachments-count>
      <body>I'm using Rails 3.0.3 and still having the same problem.



class Project &lt; ActiveRecord::Base
  has_many :tasks, :dependent =&gt; :destroy, :inverse_of =&gt; :project, :autosave =&gt; true
  accepts_nested_attributes_for :tasks
end

class Task &lt; ActiveRecord::Base
  belongs_to :project, :inverse_of =&gt; :tasks
  has_many :assignments, :dependent =&gt; :destroy, :inverse_of =&gt; :task, :autosave =&gt; true
  accepts_nested_attributes_for :assignments
end

class Assignment &lt; ActiveRecord::Base
  belongs_to :task, :inverse_of =&gt; assignments
end

assert_equal, &quot;yyy&quot;, Assignment.find(1).nome  # =&gt; true
project = projects(:one)
project.tasks_attributes = [{:id =&gt; 1, :assignments_attributes =&gt; [{:id =&gt; 1, :name = &quot;xxx&quot;}]
                            }
                           ]
assert project.valid? # =&gt; true
assert_equal true, project.save # =&gt; true

assert_equal &quot;xxx&quot;, Assignment.find(1).nome  # =&gt; false</body>
      <body-html>&lt;div&gt;&lt;p&gt;I'm using Rails 3.0.3 and still having the same problem.&lt;/p&gt;
&lt;p&gt;class Project &amp;lt; ActiveRecord::Base&lt;br&gt;
has_many :tasks, :dependent =&amp;gt; :destroy, :inverse_of =&amp;gt;
:project, :autosave =&amp;gt; true accepts_nested_attributes_for :tasks
end&lt;/p&gt;
&lt;p&gt;class Task &amp;lt; ActiveRecord::Base&lt;br&gt;
belongs_to :project, :inverse_of =&amp;gt; :tasks has_many
:assignments, :dependent =&amp;gt; :destroy, :inverse_of =&amp;gt; :task,
:autosave =&amp;gt; true accepts_nested_attributes_for :assignments
end&lt;/p&gt;
&lt;p&gt;class Assignment &amp;lt; ActiveRecord::Base&lt;br&gt;
belongs_to :task, :inverse_of =&amp;gt; assignments end&lt;/p&gt;
&lt;p&gt;assert_equal, &quot;yyy&quot;, Assignment.find(1).nome # =&amp;gt; true&lt;br&gt;
project = projects(:one)&lt;br&gt;
project.tasks_attributes = [{:id =&amp;gt; 1, :assignments_attributes
=&amp;gt; [{:id =&amp;gt; 1, :name = &quot;xxx&quot;}]&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;                        }
                       ]&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;assert project.valid? # =&amp;gt; true&lt;br&gt;
assert_equal true, project.save # =&amp;gt; true&lt;/p&gt;
&lt;p&gt;assert_equal &quot;xxx&quot;, Assignment.find(1).nome # =&amp;gt; false&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2011-01-05T20:22:58+00:00</created-at>
      <creator-id type="integer">25257</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">88038</milestone-id>
      <number type="integer">4242</number>
      <permalink>nested-child-only-updates-if-parent-changes</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>accepts_nested_attributes_for &quot;accepts_nested_attributes_for fields_for&quot; bugmash patch &quot;rails 3.0 beta&quot;</tag>
      <title>Nested child only updates if parent changes.</title>
      <updated-at type="datetime">2011-01-05T20:23:25+00:00</updated-at>
      <user-id type="integer">123638</user-id>
      <version type="integer">29</version>
      <user-name>Ivan</user-name>
      <creator-name>chap</creator-name>
      <assigned-user-name>Jos&#233; Valim</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/4242</url>
      <milestone-title>3.0.2</milestone-title>
      <priority-name>Low</priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>d9cb5e6bd4314fe49ea2e4b4171d9a273b52daae</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-04-05T21:25:23+01:00</created-at>
      <filename>nested_attributes_test_patch.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">471709</id>
      <size type="integer">8630</size>
      <uploader-id type="integer">86706</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/471709/nested_attributes_test_patch.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>1d752373a3f3383be305f351794e29e627c0f514</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-04-18T22:11:45+01:00</created-at>
      <filename>nested_attributes_patch.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">486751</id>
      <size type="integer">10623</size>
      <uploader-id type="integer">86706</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/486751/nested_attributes_patch.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>e5e8fcfbba834a5ce9746552a3dab5eadbd92152</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-05-18T10:36:02+01:00</created-at>
      <filename>2-3-stable_ticket_4242.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">524711</id>
      <size type="integer">8281</size>
      <uploader-id type="integer">1023</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/524711/2-3-stable_ticket_4242.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>45eaf19801905000ba5a656faf8347966a34dce6</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-05-18T10:36:02+01:00</created-at>
      <filename>master_ticket_4242.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">524712</id>
      <size type="integer">8248</size>
      <uploader-id type="integer">1023</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/524712/master_ticket_4242.diff</url>
    </attachment>
  </attachments>
</ticket>
