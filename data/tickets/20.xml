<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">424</assigned-user-id>
  <attachments-count type="integer">3</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2008-04-18T22:55:40+01:00</created-at>
  <creator-id type="integer">192</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer" nil="true"></milestone-id>
  <number type="integer">20</number>
  <permalink>improve-mailer-generator-and-add-tests</permalink>
  <priority type="integer">11086</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>generators mailer patch tested</tag>
  <title>improve mailer generator and add tests</title>
  <updated-at type="datetime">2008-04-21T15:16:00+01:00</updated-at>
  <user-id type="integer">4642</user-id>
  <version type="integer">9</version>
  <user-name>Cody Fauser</user-name>
  <creator-name>Mislav</creator-name>
  <assigned-user-name>Joshua Peek</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/20</url>
  <priority-name nil="true"></priority-name>
  <original-body>This is what mailer generator used to generate:

@@@ ruby
class Notifier &lt; ActionMailer::Base
  def reset_password()
    @subject = &quot;...&quot;
    @from    = &quot;...&quot;
    # ...
  end
end
@@@

You see that it used instance variables, while the documentation clearly advocates usage of methods. This patch changes output to:

@@@ ruby
  def reset_password()
    subject &quot;...&quot;
    from    &quot;...&quot;
    # ...
  end
@@@

It also cleans up the generator test suite, removing quite a lot duplication, and adds mailer test for the first time.</original-body>
  <latest-body>This is what mailer generator used to generate:

@@@ ruby
class Notifier &lt; ActionMailer::Base
  def reset_password()
    @subject = &quot;...&quot;
    @from    = &quot;...&quot;
    # ...
  end
end
@@@

You see that it used instance variables, while the documentation clearly advocates usage of methods. This patch changes output to:

@@@ ruby
  def reset_password()
    subject &quot;...&quot;
    from    &quot;...&quot;
    # ...
  end
@@@

It also cleans up the generator test suite, removing quite a lot duplication, and adds mailer test for the first time.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;
This is what mailer generator used to generate:
&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;class Notifier &amp;lt; ActionMailer::Base
  def reset_password()
    @subject = &amp;quot;...&amp;quot;
    @from    = &amp;quot;...&amp;quot;
    # ...
  end
end&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;
You see that it used instance variables, while the documentation clearly advocates usage of methods. This patch changes output to:
&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;  def reset_password()
    subject &amp;quot;...&amp;quot;
    from    &amp;quot;...&amp;quot;
    # ...
  end&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;
It also cleans up the generator test suite, removing quite a lot duplication, and adds mailer test for the first time.
&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>This is what mailer generator used to generate:

@@@ ruby
class Notifier &lt; ActionMailer::Base
  def reset_password()
    @subject = &quot;...&quot;
    @from    = &quot;...&quot;
    # ...
  end
end
@@@

You see that it used instance variables, while the documentation clearly advocates usage of methods. This patch changes output to:

@@@ ruby
  def reset_password()
    subject &quot;...&quot;
    from    &quot;...&quot;
    # ...
  end
@@@

It also cleans up the generator test suite, removing quite a lot duplication, and adds mailer test for the first time.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
This is what mailer generator used to generate:
&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;class Notifier &amp;lt; ActionMailer::Base
  def reset_password()
    @subject = &amp;quot;...&amp;quot;
    @from    = &amp;quot;...&amp;quot;
    # ...
  end
end&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;
You see that it used instance variables, while the documentation clearly advocates usage of methods. This patch changes output to:
&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;  def reset_password()
    subject &amp;quot;...&amp;quot;
    from    &amp;quot;...&amp;quot;
    # ...
  end&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;
It also cleans up the generator test suite, removing quite a lot duplication, and adds mailer test for the first time.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-04-18T22:55:40+01:00</created-at>
      <creator-id type="integer">192</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">20</number>
      <permalink>improve-mailer-generator-and-add-tests</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>improve mailer generator and add tests</title>
      <updated-at type="datetime">2008-04-18T22:55:40+01:00</updated-at>
      <user-id type="integer">192</user-id>
      <version type="integer">1</version>
      <user-name>Mislav</user-name>
      <creator-name>Mislav</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/20</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Added third commit. This is how the generated mailer now looks like:

@@@
script/generate mailer notifier reset_password
@@@

In @app/models/notifier.rb@:

@@@ ruby
class Notifier &lt; ActionMailer::Base
  
  # change to your domain name
  default_url_options[:host] = 'example.com'

  def reset_password(sent_at = Time.now)
    subject    'Notifier#reset_password'
    recipients ''
    from       ''
    sent_on    sent_at
    
    body       :greeting =&gt; 'Hi,'
  end

end
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Added third commit. This is how the generated mailer now looks like:
&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;&quot;&gt;script/generate mailer notifier reset_password&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;
In @app/models/notifier.rb@:
&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;class Notifier &amp;lt; ActionMailer::Base
  
  # change to your domain name
  default_url_options[:host] = 'example.com'

  def reset_password(sent_at = Time.now)
    subject    'Notifier#reset_password'
    recipients ''
    from       ''
    sent_on    sent_at
    
    body       :greeting =&amp;gt; 'Hi,'
  end

end&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-04-18T23:11:34+01:00</created-at>
      <creator-id type="integer">192</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">20</number>
      <permalink>improve-mailer-generator-and-add-tests</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag nil="true"></tag>
      <title>improve mailer generator and add tests</title>
      <updated-at type="datetime">2008-04-18T23:11:34+01:00</updated-at>
      <user-id type="integer">192</user-id>
      <version type="integer">2</version>
      <user-name>Mislav</user-name>
      <creator-name>Mislav</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/20</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>http://github.com/rails/rails/commit/36eecda8d0b5ebd3341692868b8faeec8fbce9d0
http://github.com/rails/rails/commit/dfdb9f738e9842752c340634622624544efe18c1</body>
      <body-html>&lt;div&gt;&lt;p&gt;
&lt;a href=&quot;http://github.com/rails/rails/commit/36eecda8d0b5ebd3341692868b8faeec8fbce9d0&quot;&gt;http://github.com/rails/rails/co...&lt;/a&gt;
&lt;/p&gt;&lt;p&gt;
&lt;a href=&quot;http://github.com/rails/rails/commit/dfdb9f738e9842752c340634622624544efe18c1&quot;&gt;http://github.com/rails/rails/co...&lt;/a&gt;
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-04-18T23:17:16+01:00</created-at>
      <creator-id type="integer">192</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">20</number>
      <permalink>improve-mailer-generator-and-add-tests</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>improve mailer generator and add tests</title>
      <updated-at type="datetime">2008-04-18T23:17:16+01:00</updated-at>
      <user-id type="integer">424</user-id>
      <version type="integer">3</version>
      <user-name>Joshua Peek</user-name>
      <creator-name>Mislav</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/20</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Got the third too, thanks!

http://github.com/rails/rails/commit/69a5c1df8293fc8de2cec0fc9fa18181cb9ad469</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Got the third too, thanks!
&lt;/p&gt;&lt;p&gt;
&lt;a href=&quot;http://github.com/rails/rails/commit/69a5c1df8293fc8de2cec0fc9fa18181cb9ad469&quot;&gt;http://github.com/rails/rails/co...&lt;/a&gt;
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-04-18T23:20:55+01:00</created-at>
      <creator-id type="integer">192</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">20</number>
      <permalink>improve-mailer-generator-and-add-tests</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>improve mailer generator and add tests</title>
      <updated-at type="datetime">2008-04-18T23:20:55+01:00</updated-at>
      <user-id type="integer">424</user-id>
      <version type="integer">4</version>
      <user-name>Joshua Peek</user-name>
      <creator-name>Mislav</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/20</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Question, how did you diff those patches? It included your name and email at the top which is really nice.

Can you doc the process under &quot;Ticket Guidelines&quot;:http://rails.lighthouseapp.com/projects/8994/ticket-guidelines Authorship.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Question, how did you diff those patches? It included your name and email at the top which is really nice.
&lt;/p&gt;&lt;p&gt;
Can you doc the process under &lt;a href=&quot;http://rails.lighthouseapp.com/projects/8994/ticket-guidelines&quot;&gt;Ticket Guidelines&lt;/a&gt; Authorship.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-04-18T23:22:47+01:00</created-at>
      <creator-id type="integer">192</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">20</number>
      <permalink>improve-mailer-generator-and-add-tests</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>improve mailer generator and add tests</title>
      <updated-at type="datetime">2008-04-18T23:22:47+01:00</updated-at>
      <user-id type="integer">424</user-id>
      <version type="integer">5</version>
      <user-name>Joshua Peek</user-name>
      <creator-name>Mislav</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/20</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>@@@
git format-patch HEAD~3
@@@

I can't edit Ticket Guidelines, only core team can.</body>
      <body-html>&lt;div&gt;&lt;pre&gt;&lt;code class=&quot;&quot;&gt;git format-patch HEAD~3&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;
I can't edit Ticket Guidelines, only core team can.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-04-18T23:53:50+01:00</created-at>
      <creator-id type="integer">192</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">20</number>
      <permalink>improve-mailer-generator-and-add-tests</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>improve mailer generator and add tests</title>
      <updated-at type="datetime">2008-04-18T23:53:50+01:00</updated-at>
      <user-id type="integer">192</user-id>
      <version type="integer">6</version>
      <user-name>Mislav</user-name>
      <creator-name>Mislav</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/20</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Great changes overall. However, I did notice one small potential issue. I don't think the default_url_options[:host] call should be placed in the mailer. This seems to promote setting the host in each mailer, but the host is likely to be the same in most cases. Also, default_url_options is a mattr_accessor so the settings in each mailer will overwrite each other, which is likely to be confusing for the developer.

It seems more useful to use something like the following in the application's configuration:

@@@ ruby
config.action_mailer.default_url_options = { :host =&gt; 'myhost.com' }
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Great changes overall. However, I did notice one small potential issue. I don't think the default_url_options[:host] call should be placed in the mailer. This seems to promote setting the host in each mailer, but the host is likely to be the same in most cases. Also, default_url_options is a mattr_accessor so the settings in each mailer will overwrite each other, which is likely to be confusing for the developer.
&lt;/p&gt;&lt;p&gt;
It seems more useful to use something like the following in the application's configuration:
&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;config.action_mailer.default_url_options = { :host =&amp;gt; 'myhost.com' }&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-04-21T13:09:32+01:00</created-at>
      <creator-id type="integer">192</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">20</number>
      <permalink>improve-mailer-generator-and-add-tests</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>improve mailer generator and add tests</title>
      <updated-at type="datetime">2008-04-21T13:09:32+01:00</updated-at>
      <user-id type="integer">4642</user-id>
      <version type="integer">7</version>
      <user-name>Cody Fauser</user-name>
      <creator-name>Mislav</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/20</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Well, I generally agree. We only have to update docs for ActionMailer and we can remove `default_url_options` from generator.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Well, I generally agree. We only have to update docs for ActionMailer and we can remove `default_url_options` from generator.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-04-21T13:15:56+01:00</created-at>
      <creator-id type="integer">192</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">20</number>
      <permalink>improve-mailer-generator-and-add-tests</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>improve mailer generator and add tests</title>
      <updated-at type="datetime">2008-04-21T13:15:56+01:00</updated-at>
      <user-id type="integer">192</user-id>
      <version type="integer">8</version>
      <user-name>Mislav</user-name>
      <creator-name>Mislav</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/20</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">424</assigned-user-id>
      <attachments-count type="integer">3</attachments-count>
      <body>Please take a look at #32. I created a patch which updates the documentation and removes the default_url_options call from the generator.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Please take a look at &lt;a href=&quot;/projects/8994/tickets/32&quot; title=&quot;Ticket #32&quot;&gt;#32&lt;/a&gt;. I created a patch which updates the documentation and removes the default_url_options call from the generator.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-04-21T15:16:00+01:00</created-at>
      <creator-id type="integer">192</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">20</number>
      <permalink>improve-mailer-generator-and-add-tests</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag nil="true"></tag>
      <title>improve mailer generator and add tests</title>
      <updated-at type="datetime">2008-04-21T15:16:00+01:00</updated-at>
      <user-id type="integer">4642</user-id>
      <version type="integer">9</version>
      <user-name>Cody Fauser</user-name>
      <creator-name>Mislav</creator-name>
      <assigned-user-name>Joshua Peek</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/20</url>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>5b8885d09ecb963dd735b590d847411a0385d081</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2008-04-18T22:55:40+01:00</created-at>
      <filename>0001-cleanup-generator-tests-by-extracting-repeated-code.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">19252</id>
      <size type="integer">32159</size>
      <uploader-id type="integer">192</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/19252/0001-cleanup-generator-tests-by-extracting-repeated-code.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>1ef45404cd33fbc5e3c34849f02fdb6c2848c518</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2008-04-18T22:55:59+01:00</created-at>
      <filename>0002-change-mailer-in-generator-not-to-use-instance-varia.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">19253</id>
      <size type="integer">2368</size>
      <uploader-id type="integer">192</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/19253/0002-change-mailer-in-generator-not-to-use-instance-varia.patch</url>
    </attachment>
    <attachment type="Attachment">
      <code>86eefd18fc73bbdb31a7f6ca2ea550c50b70cd5d</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2008-04-18T23:11:34+01:00</created-at>
      <filename>0003-add-example-for-default_url_options-host-to-genera.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">19254</id>
      <size type="integer">2110</size>
      <uploader-id type="integer">192</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/19254/0003-add-example-for-default_url_options-host-to-genera.patch</url>
    </attachment>
  </attachments>
</ticket>
