<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">1366</assigned-user-id>
  <attachments-count type="integer">2</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2008-07-11T04:27:45+01:00</created-at>
  <creator-id type="integer">21105</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">9903</milestone-id>
  <number type="integer">602</number>
  <permalink>quoting-issues-in-ar-s-association-preload</permalink>
  <priority type="integer">90</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>2.1 activerecord eager_loading enhancement patch quoting</tag>
  <title>Quoting issues in AR's association preload</title>
  <updated-at type="datetime">2008-07-15T23:56:36+01:00</updated-at>
  <user-id type="integer">17393</user-id>
  <version type="integer">7</version>
  <user-name>Repository</user-name>
  <creator-name>Tiago Macedo</creator-name>
  <assigned-user-name>Pratik</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/602</url>
  <milestone-title>2.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>If you look at the source code, there's even a FIXME there:

       # FIXME: quoting
       def preload_belongs_to_association(records, reflection, preload_options={})

The new eager loading mechanisms incorrectly quotes all primary keys when doing a preload. Obviously this shouldn't be done (at least) for integers and floats.

The information about the &quot;numeric&quot; columns [:integer, :float] was found in 
ActiveRecord::ConnectionAdapters::Quoting#quote

This patch doesn't include tests (but didn't break any either) as I couldn't find a decent way to test this.


This is similar to this fix: http://dev.rubyonrails.org/changeset/7588 for Rails 1.x</original-body>
  <latest-body>If you look at the source code, there's even a FIXME there:

       # FIXME: quoting
       def preload_belongs_to_association(records, reflection, preload_options={})

The new eager loading mechanisms incorrectly quotes all primary keys when doing a preload. Obviously this shouldn't be done (at least) for integers and floats.

The information about the &quot;numeric&quot; columns [:integer, :float] was found in 
ActiveRecord::ConnectionAdapters::Quoting#quote

This patch doesn't include tests (but didn't break any either) as I couldn't find a decent way to test this.


This is similar to this fix: http://dev.rubyonrails.org/changeset/7588 for Rails 1.x</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;
If you look at the source code, there's even a FIXME there:
&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;
FIXME: quoting
&lt;/li&gt;&lt;/ol&gt;
&lt;p&gt;
def preload_belongs_to_association(records, reflection, preload_options={})
&lt;/p&gt;&lt;p&gt;
The new eager loading mechanisms incorrectly quotes all primary keys when doing a preload. Obviously this shouldn't be done (at least) for integers and floats.
&lt;/p&gt;&lt;p&gt;
The information about the &quot;numeric&quot; columns [:integer, :float] was found in
&lt;/p&gt;&lt;p&gt;
ActiveRecord::ConnectionAdapters::Quoting#quote
&lt;/p&gt;&lt;p&gt;
This patch doesn't include tests (but didn't break any either) as I couldn't find a decent way to test this.
&lt;/p&gt;&lt;p&gt;
This is similar to this fix: &lt;a href=&quot;http://dev.rubyonrails.org/changeset/7588&quot;&gt;http://dev.rubyonrails.org/chang...&lt;/a&gt; for Rails 1.x
&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>If you look at the source code, there's even a FIXME there:

       # FIXME: quoting
       def preload_belongs_to_association(records, reflection, preload_options={})

The new eager loading mechanisms incorrectly quotes all primary keys when doing a preload. Obviously this shouldn't be done (at least) for integers and floats.

The information about the &quot;numeric&quot; columns [:integer, :float] was found in 
ActiveRecord::ConnectionAdapters::Quoting#quote

This patch doesn't include tests (but didn't break any either) as I couldn't find a decent way to test this.


This is similar to this fix: http://dev.rubyonrails.org/changeset/7588 for Rails 1.x</body>
      <body-html>&lt;div&gt;&lt;p&gt;
If you look at the source code, there's even a FIXME there:
&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;
FIXME: quoting
&lt;/li&gt;&lt;/ol&gt;
&lt;p&gt;
def preload_belongs_to_association(records, reflection, preload_options={})
&lt;/p&gt;&lt;p&gt;
The new eager loading mechanisms incorrectly quotes all primary keys when doing a preload. Obviously this shouldn't be done (at least) for integers and floats.
&lt;/p&gt;&lt;p&gt;
The information about the &quot;numeric&quot; columns [:integer, :float] was found in
&lt;/p&gt;&lt;p&gt;
ActiveRecord::ConnectionAdapters::Quoting#quote
&lt;/p&gt;&lt;p&gt;
This patch doesn't include tests (but didn't break any either) as I couldn't find a decent way to test this.
&lt;/p&gt;&lt;p&gt;
This is similar to this fix: &lt;a href=&quot;http://dev.rubyonrails.org/changeset/7588&quot;&gt;http://dev.rubyonrails.org/chang...&lt;/a&gt; for Rails 1.x
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-07-11T04:27:46+01:00</created-at>
      <creator-id type="integer">21105</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">602</number>
      <permalink>quoting-issues-in-ar-s-association-preload</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.1 activerecord eager_loading enhancement patch quoting</tag>
      <title>Quoting issues in AR's association preload</title>
      <updated-at type="datetime">2008-07-11T04:27:46+01:00</updated-at>
      <user-id type="integer">21105</user-id>
      <version type="integer">1</version>
      <user-name>Tiago Macedo</user-name>
      <creator-name>Tiago Macedo</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/602</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Previous patch had a bug if the primary key was a float. This patch fixes it.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Previous patch had a bug if the primary key was a float. This patch fixes it.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-07-11T15:45:29+01:00</created-at>
      <creator-id type="integer">21105</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">602</number>
      <permalink>quoting-issues-in-ar-s-association-preload</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.1 activerecord eager_loading enhancement patch quoting</tag>
      <title>Quoting issues in AR's association preload</title>
      <updated-at type="datetime">2008-07-11T15:45:29+01:00</updated-at>
      <user-id type="integer">21105</user-id>
      <version type="integer">2</version>
      <user-name>Tiago Macedo</user-name>
      <creator-name>Tiago Macedo</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/602</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Hey Tiago,

Could you add a failing test case in AR test suite please ? The test should fail before applying and pass after.

Thanks.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Hey Tiago,
&lt;/p&gt;&lt;p&gt;
Could you add a failing test case in AR test suite please ? The test should fail before applying and pass after.
&lt;/p&gt;&lt;p&gt;
Thanks.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-07-11T22:45:47+01:00</created-at>
      <creator-id type="integer">21105</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">602</number>
      <permalink>quoting-issues-in-ar-s-association-preload</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>2.1 activerecord eager_loading enhancement patch quoting</tag>
      <title>Quoting issues in AR's association preload</title>
      <updated-at type="datetime">2008-07-11T22:45:47+01:00</updated-at>
      <user-id type="integer">1366</user-id>
      <version type="integer">3</version>
      <user-name>Pratik</user-name>
      <creator-name>Tiago Macedo</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/602</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Squashed the commits, added test using features provided by #325 (assert_sql), also added quoting for the primary_key column. Also verified that test fails without the preload code changes.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Squashed the commits, added test using features provided by &lt;a href=&quot;/projects/8994/tickets/325&quot; title=&quot;Ticket #325&quot;&gt;#325&lt;/a&gt; (assert_sql), also added quoting for the primary_key column. Also verified that test fails without the preload code changes.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-07-14T20:33:17+01:00</created-at>
      <creator-id type="integer">21105</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">602</number>
      <permalink>quoting-issues-in-ar-s-association-preload</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>2.1 activerecord eager_loading enhancement patch quoting</tag>
      <title>Quoting issues in AR's association preload</title>
      <updated-at type="datetime">2008-07-14T20:33:17+01:00</updated-at>
      <user-id type="integer">14890</user-id>
      <version type="integer">4</version>
      <user-name>Tarmo T&#228;nav</user-name>
      <creator-name>Tiago Macedo</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/602</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>Thanks for the help.

I didn't even notice the primary_key wasn't quoted ;)</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Thanks for the help.
&lt;/p&gt;&lt;p&gt;
I didn't even notice the primary_key wasn't quoted ;)
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-07-14T21:33:54+01:00</created-at>
      <creator-id type="integer">21105</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">602</number>
      <permalink>quoting-issues-in-ar-s-association-preload</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>incomplete</state>
      <tag>2.1 activerecord eager_loading enhancement patch quoting</tag>
      <title>Quoting issues in AR's association preload</title>
      <updated-at type="datetime">2008-07-14T21:33:54+01:00</updated-at>
      <user-id type="integer">21105</user-id>
      <version type="integer">5</version>
      <user-name>Tiago Macedo</user-name>
      <creator-name>Tiago Macedo</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/602</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>(from [76df9fa0680d62ce41fa6f3b743c605101d101d2]) Fix integer quoting issues in association preload. [#602 state:resolved]

Signed-off-by: Pratik Naik &lt;pratiknaik@gmail.com&gt;
http://github.com/rails/rails/commit/76df9fa0680d62ce41fa6f3b743c605101d101d2</body>
      <body-html>&lt;div&gt;&lt;p&gt;
(from [76df9fa0680d62ce41fa6f3b743c605101d101d2]) Fix integer quoting issues in association preload. [#602 state:resolved]
&lt;/p&gt;&lt;p&gt;
Signed-off-by: Pratik Naik 
&lt;/p&gt;&lt;p&gt;
&lt;a href=&quot;http://github.com/rails/rails/commit/76df9fa0680d62ce41fa6f3b743c605101d101d2&quot;&gt;http://github.com/rails/rails/co...&lt;/a&gt;
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-07-14T23:36:09+01:00</created-at>
      <creator-id type="integer">21105</creator-id>
      <diffable-attributes type="yaml">--- 
:state: incomplete
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">602</number>
      <permalink>quoting-issues-in-ar-s-association-preload</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>2.1 activerecord eager_loading enhancement patch quoting</tag>
      <title>Quoting issues in AR's association preload</title>
      <updated-at type="datetime">2008-07-14T23:36:09+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">6</version>
      <user-name>Repository</user-name>
      <creator-name>Tiago Macedo</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/602</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">2</attachments-count>
      <body>(from [84baada079fa7e68750c1e386f9849d2d47b59e1]) Fix integer quoting issues in association preload. [#602 state:resolved]

Signed-off-by: Pratik Naik &lt;pratiknaik@gmail.com&gt;
http://github.com/rails/rails/commit/84baada079fa7e68750c1e386f9849d2d47b59e1</body>
      <body-html>&lt;div&gt;&lt;p&gt;
(from [84baada079fa7e68750c1e386f9849d2d47b59e1]) Fix integer quoting issues in association preload. [#602 state:resolved]
&lt;/p&gt;&lt;p&gt;
Signed-off-by: Pratik Naik 
&lt;/p&gt;&lt;p&gt;
&lt;a href=&quot;http://github.com/rails/rails/commit/84baada079fa7e68750c1e386f9849d2d47b59e1&quot;&gt;http://github.com/rails/rails/co...&lt;/a&gt;
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-07-15T23:56:36+01:00</created-at>
      <creator-id type="integer">21105</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">602</number>
      <permalink>quoting-issues-in-ar-s-association-preload</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>2.1 activerecord eager_loading enhancement patch quoting</tag>
      <title>Quoting issues in AR's association preload</title>
      <updated-at type="datetime">2008-07-15T23:56:36+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">7</version>
      <user-name>Repository</user-name>
      <creator-name>Tiago Macedo</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/602</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>9ed2cf1627102f28d84163ebd3cc5aaf18ca24ba</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2008-07-11T15:45:29+01:00</created-at>
      <filename>fixing_quoting_in_association_preload_v2.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">32085</id>
      <size type="integer">3378</size>
      <uploader-id type="integer">21105</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/32085/fixing_quoting_in_association_preload_v2.diff</url>
    </attachment>
    <attachment type="Attachment">
      <code>6432789282e36f4e53fed91a608a8830ee181b32</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2008-07-14T20:33:17+01:00</created-at>
      <filename>0002-Fixing-integer-quoting-issues-in-association-preload.patch</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">32541</id>
      <size type="integer">2828</size>
      <uploader-id type="integer">14890</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/32541/0002-Fixing-integer-quoting-issues-in-association-preload.patch</url>
    </attachment>
  </attachments>
</ticket>
