<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">0</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2010-07-14T09:34:44+01:00</created-at>
  <creator-id type="integer">107192</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer" nil="true"></milestone-id>
  <number type="integer">5110</number>
  <permalink>dirty-attributes-and-string-manipulation</permalink>
  <priority type="integer">3</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>invalid</state>
  <tag>activerecord dirty &quot;rails 2.3.8&quot; rails3</tag>
  <title>Dirty Attributes and string manipulation</title>
  <updated-at type="datetime">2010-07-29T14:19:13+01:00</updated-at>
  <user-id type="integer">40263</user-id>
  <version type="integer">4</version>
  <user-name>Neeraj Singh</user-name>
  <creator-name>Lee Irving</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/5110</url>
  <priority-name>Low</priority-name>
  <original-body>Just found what I believe is a bug.

With ActiveRecord modify the value of a string field with

@project.title
&gt; &quot;HelloWorld&quot;

@project.title[0] = &quot;h&quot;
&gt; &quot;helloWorld&quot;

@project.changed? 
&gt; false

This means that saving the record does not write the change.

Work around is 

title = @project.title.clone

title[0] = &quot;h&quot;

@project.title = title

@project.changed?
&gt; true</original-body>
  <latest-body>Just found what I believe is a bug.

With ActiveRecord modify the value of a string field with

@project.title
&gt; &quot;HelloWorld&quot;

@project.title[0] = &quot;h&quot;
&gt; &quot;helloWorld&quot;

@project.changed? 
&gt; false

This means that saving the record does not write the change.

Work around is 

title = @project.title.clone

title[0] = &quot;h&quot;

@project.title = title

@project.changed?
&gt; true</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;Just found what I believe is a bug.&lt;/p&gt;
&lt;p&gt;With ActiveRecord modify the value of a string field with&lt;/p&gt;
&lt;p&gt;@project.title&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&quot;HelloWorld&quot;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;@project.title[0] = &quot;h&quot;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&quot;helloWorld&quot;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;@project.changed?&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;false&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This means that saving the record does not write the change.&lt;/p&gt;
&lt;p&gt;Work around is&lt;/p&gt;
&lt;p&gt;title = @project.title.clone&lt;/p&gt;
&lt;p&gt;title[0] = &quot;h&quot;&lt;/p&gt;
&lt;p&gt;@project.title = title&lt;/p&gt;
&lt;p&gt;@project.changed?&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;true&lt;/p&gt;
&lt;/blockquote&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Just found what I believe is a bug.

With ActiveRecord modify the value of a string field with

@project.title
&gt; &quot;HelloWorld&quot;

@project.title[0] = &quot;h&quot;
&gt; &quot;helloWorld&quot;

@project.changed? 
&gt; false

This means that saving the record does not write the change.

Work around is 

title = @project.title.clone

title[0] = &quot;h&quot;

@project.title = title

@project.changed?
&gt; true</body>
      <body-html>&lt;div&gt;&lt;p&gt;Just found what I believe is a bug.&lt;/p&gt;
&lt;p&gt;With ActiveRecord modify the value of a string field with&lt;/p&gt;
&lt;p&gt;@project.title&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&quot;HelloWorld&quot;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;@project.title[0] = &quot;h&quot;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&quot;helloWorld&quot;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;@project.changed?&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;false&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This means that saving the record does not write the change.&lt;/p&gt;
&lt;p&gt;Work around is&lt;/p&gt;
&lt;p&gt;title = @project.title.clone&lt;/p&gt;
&lt;p&gt;title[0] = &quot;h&quot;&lt;/p&gt;
&lt;p&gt;@project.title = title&lt;/p&gt;
&lt;p&gt;@project.changed?&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;true&lt;/p&gt;
&lt;/blockquote&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-14T09:34:44+01:00</created-at>
      <creator-id type="integer">107192</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5110</number>
      <permalink>dirty-attributes-and-string-manipulation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord dirty &quot;rails 2.3.8&quot;</tag>
      <title>Dirty Attributes and string manipulation</title>
      <updated-at type="datetime">2010-07-14T11:35:26+01:00</updated-at>
      <user-id type="integer">107192</user-id>
      <version type="integer">1</version>
      <user-name>Lee Irving</user-name>
      <creator-name>Lee Irving</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5110</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>You're right, the strangest thing is that the original value is lost:

@project.title_was
=&gt; &quot;helloWorld&quot;

Also this affects Rails 3</body>
      <body-html>&lt;div&gt;&lt;p&gt;You're right, the strangest thing is that the original value is
lost:&lt;/p&gt;
&lt;p&gt;@project.title_was =&amp;gt; &quot;helloWorld&quot;&lt;/p&gt;
&lt;p&gt;Also this affects Rails 3&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-14T15:11:19+01:00</created-at>
      <creator-id type="integer">107192</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: activerecord dirty &quot;rails 2.3.8&quot;
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5110</number>
      <permalink>dirty-attributes-and-string-manipulation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord dirty &quot;rails 2.3.8&quot; rails3</tag>
      <title>Dirty Attributes and string manipulation</title>
      <updated-at type="datetime">2010-07-14T15:11:23+01:00</updated-at>
      <user-id type="integer">33716</user-id>
      <version type="integer">2</version>
      <user-name>Ivan Torres (mexpolk)</user-name>
      <creator-name>Lee Irving</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5110</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Doing some tests it turns out that if the String instance is the same, then the change is not detected. If the string is another instance it works as expected:

@@@ ruby
  # This wont work
  @project.title
  =&gt; &quot;Rails&quot;
  @project.title &lt;&lt; &quot; test&quot;
  =&gt; &quot;Rails test&quot;
  @project.title_was
  =&gt; &quot;Rails test&quot;
  @project.title_changed?
  =&gt; false

  # This works
  @project.reload
  @project.title += &quot; test&quot;
  =&gt; &quot;Rails test&quot;
  @project.title_was
  =&gt; &quot;Rails&quot;
  @project.title_changed?
  =&gt; true
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;Doing some tests it turns out that if the String instance is the
same, then the change is not detected. If the string is another
instance it works as expected:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;ruby&quot;&gt;  # This wont work
  @project.title
  =&amp;gt; &quot;Rails&quot;
  @project.title &amp;lt;&amp;lt; &quot; test&quot;
  =&amp;gt; &quot;Rails test&quot;
  @project.title_was
  =&amp;gt; &quot;Rails test&quot;
  @project.title_changed?
  =&amp;gt; false

  # This works
  @project.reload
  @project.title += &quot; test&quot;
  =&amp;gt; &quot;Rails test&quot;
  @project.title_was
  =&amp;gt; &quot;Rails&quot;
  @project.title_changed?
  =&amp;gt; true&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-14T16:54:52+01:00</created-at>
      <creator-id type="integer">107192</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5110</number>
      <permalink>dirty-attributes-and-string-manipulation</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord dirty &quot;rails 2.3.8&quot; rails3</tag>
      <title>Dirty Attributes and string manipulation</title>
      <updated-at type="datetime">2010-07-14T16:54:54+01:00</updated-at>
      <user-id type="integer">33716</user-id>
      <version type="integer">3</version>
      <user-name>Ivan Torres (mexpolk)</user-name>
      <creator-name>Lee Irving</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5110</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Here is your answer.

http://github.com/lifo/docrails/commit/1a6d76223bf6a022a5755e645742ac84788e6668</body>
      <body-html>&lt;div&gt;&lt;p&gt;Here is your answer.&lt;/p&gt;
&lt;p&gt;&lt;a href=
&quot;http://github.com/lifo/docrails/commit/1a6d76223bf6a022a5755e645742ac84788e6668&quot;&gt;
http://github.com/lifo/docrails/commit/1a6d76223bf6a022a5755e645742...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-07-29T14:19:12+01:00</created-at>
      <creator-id type="integer">107192</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
:state: new
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5110</number>
      <permalink>dirty-attributes-and-string-manipulation</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>activerecord dirty &quot;rails 2.3.8&quot; rails3</tag>
      <title>Dirty Attributes and string manipulation</title>
      <updated-at type="datetime">2010-07-29T14:19:13+01:00</updated-at>
      <user-id type="integer">40263</user-id>
      <version type="integer">4</version>
      <user-name>Neeraj Singh</user-name>
      <creator-name>Lee Irving</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5110</url>
      <priority-name>Low</priority-name>
    </version>
  </versions>
</ticket>
