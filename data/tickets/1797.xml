<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">141</assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-01-26T15:07:53+00:00</created-at>
  <creator-id type="integer">10258</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">9903</milestone-id>
  <number type="integer">1797</number>
  <permalink>mysql-reconnect-value-doesnt-stick</permalink>
  <priority type="integer">1062</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>committed</state>
  <tag>activerecord mysql patch</tag>
  <title>MySQL reconnect value doesn't stick</title>
  <updated-at type="datetime">2009-01-26T20:58:00+00:00</updated-at>
  <user-id type="integer">17393</user-id>
  <version type="integer">3</version>
  <user-name>Repository</user-name>
  <creator-name>Dov Murik</creator-name>
  <assigned-user-name>Michael Koziarski</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/1797</url>
  <milestone-title>2.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>The MySQL reconnect value which was added in commit 9051da90e4da2ab0db16530a7f7568e24a0ccaed doesn't stick, because the mysql gem sets it to false inside real_connect().

The attached patch fixes this problem, and also allows the user to set the value of the reconnect attribute by adding

    reconnect: true

to `database.yml` (again, this is relevant to mysql only).

The default of this attribute is **false** in order not to change the behaviour of existing applications.

See discussion in http://groups.google.com/group/rubyonrails-core/browse_thread/thread/49d2a7e9c96cb9f4

Related to #1293


Note that I ran the tests of this patch on Mac OS X 10.5.6 and MySQL 5.0.67 .</original-body>
  <latest-body>The MySQL reconnect value which was added in commit 9051da90e4da2ab0db16530a7f7568e24a0ccaed doesn't stick, because the mysql gem sets it to false inside real_connect().

The attached patch fixes this problem, and also allows the user to set the value of the reconnect attribute by adding

    reconnect: true

to `database.yml` (again, this is relevant to mysql only).

The default of this attribute is **false** in order not to change the behaviour of existing applications.

See discussion in http://groups.google.com/group/rubyonrails-core/browse_thread/thread/49d2a7e9c96cb9f4

Related to #1293


Note that I ran the tests of this patch on Mac OS X 10.5.6 and MySQL 5.0.67 .</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;The MySQL reconnect value which was added in commit
9051da90e4da2ab0db16530a7f7568e24a0ccaed doesn't stick, because the
mysql gem sets it to false inside real_connect().&lt;/p&gt;
&lt;p&gt;The attached patch fixes this problem, and also allows the user
to set the value of the reconnect attribute by adding&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;reconnect: true
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;to &lt;code&gt;database.yml&lt;/code&gt; (again, this is relevant to mysql
only).&lt;/p&gt;
&lt;p&gt;The default of this attribute is &lt;strong&gt;false&lt;/strong&gt; in order
not to change the behaviour of existing applications.&lt;/p&gt;
&lt;p&gt;See discussion in &lt;a href=&quot;http://groups.google.com/group/rubyonrails-core/browse_thread/thread/49d2a7e9c96cb9f4&quot;&gt;
http://groups.google.com/group/r...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Related to &lt;a href=&quot;/projects/8994/tickets/1293&quot; title=&quot;Ticket #1293&quot;&gt;#1293&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Note that I ran the tests of this patch on Mac OS X 10.5.6 and
MySQL 5.0.67 .&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>The MySQL reconnect value which was added in commit 9051da90e4da2ab0db16530a7f7568e24a0ccaed doesn't stick, because the mysql gem sets it to false inside real_connect().

The attached patch fixes this problem, and also allows the user to set the value of the reconnect attribute by adding

    reconnect: true

to `database.yml` (again, this is relevant to mysql only).

The default of this attribute is **false** in order not to change the behaviour of existing applications.

See discussion in http://groups.google.com/group/rubyonrails-core/browse_thread/thread/49d2a7e9c96cb9f4

Related to #1293


Note that I ran the tests of this patch on Mac OS X 10.5.6 and MySQL 5.0.67 .</body>
      <body-html>&lt;div&gt;&lt;p&gt;The MySQL reconnect value which was added in commit
9051da90e4da2ab0db16530a7f7568e24a0ccaed doesn't stick, because the
mysql gem sets it to false inside real_connect().&lt;/p&gt;
&lt;p&gt;The attached patch fixes this problem, and also allows the user
to set the value of the reconnect attribute by adding&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;reconnect: true
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;to &lt;code&gt;database.yml&lt;/code&gt; (again, this is relevant to mysql
only).&lt;/p&gt;
&lt;p&gt;The default of this attribute is &lt;strong&gt;false&lt;/strong&gt; in order
not to change the behaviour of existing applications.&lt;/p&gt;
&lt;p&gt;See discussion in &lt;a href=&quot;http://groups.google.com/group/rubyonrails-core/browse_thread/thread/49d2a7e9c96cb9f4&quot;&gt;
http://groups.google.com/group/r...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Related to &lt;a href=&quot;/projects/8994/tickets/1293&quot; title=&quot;Ticket #1293&quot;&gt;#1293&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Note that I ran the tests of this patch on Mac OS X 10.5.6 and
MySQL 5.0.67 .&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-01-26T15:07:53+00:00</created-at>
      <creator-id type="integer">10258</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1797</number>
      <permalink>mysql-reconnect-value-doesnt-stick</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activerecord mysql patch</tag>
      <title>MySQL reconnect value doesn't stick</title>
      <updated-at type="datetime">2009-01-26T15:07:55+00:00</updated-at>
      <user-id type="integer">10258</user-id>
      <version type="integer">1</version>
      <user-name>Dov Murik</user-name>
      <creator-name>Dov Murik</creator-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1797</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>(from [e5c211c5eb6e8f1651130b7aa0a5291e5d184ab4]) Mysql#reconnect is set according to the 'reconnect' key in the connection spec.

The 'reconenct' boolean option is read from the connection specification
and is used to set the reconnect attribute of Mysql.  The default is
false in order not to change existing application behaviour.

Also, reconnect is set AFTER real_connect is called, so its value sticks
(the mysql gem sets reconnect to false inside real_connect).

Signed-off-by: Michael Koziarski &lt;michael@koziarski.com&gt;
[#1797 state:committed]
http://github.com/rails/rails/commit/e5c211c5eb6e8f1651130b7aa0a5291e5d184ab4</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from [e5c211c5eb6e8f1651130b7aa0a5291e5d184ab4])
Mysql#reconnect is set according to the 'reconnect' key in the
connection spec.&lt;/p&gt;
&lt;p&gt;The 'reconenct' boolean option is read from the connection
specification and is used to set the reconnect attribute of Mysql.
The default is false in order not to change existing application
behaviour.&lt;/p&gt;
&lt;p&gt;Also, reconnect is set AFTER real_connect is called, so its
value sticks (the mysql gem sets reconnect to false inside
real_connect).&lt;/p&gt;
&lt;p&gt;Signed-off-by: Michael Koziarski &lt;a href=&quot;mailto:michael@koziarski.com&quot;&gt;michael@koziarski.com&lt;/a&gt; [&lt;a href=&quot;/projects/8994/tickets/1797&quot; title=&quot;Ticket #1797&quot;&gt;#1797&lt;/a&gt;
state:committed] &lt;a href=&quot;http://github.com/rails/rails/commit/e5c211c5eb6e8f1651130b7aa0a5291e5d184ab4&quot;&gt;
http://github.com/rails/rails/co...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-01-26T20:57:59+00:00</created-at>
      <creator-id type="integer">10258</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1797</number>
      <permalink>mysql-reconnect-value-doesnt-stick</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>activerecord mysql patch</tag>
      <title>MySQL reconnect value doesn't stick</title>
      <updated-at type="datetime">2009-01-26T20:57:59+00:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">2</version>
      <user-name>Repository</user-name>
      <creator-name>Dov Murik</creator-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1797</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>(from [5fe6635e05a18b312c47fe6bbbaf88fd62e7703d]) Mysql#reconnect is set according to the 'reconnect' key in the connection spec.

The 'reconenct' boolean option is read from the connection specification
and is used to set the reconnect attribute of Mysql.  The default is
false in order not to change existing application behaviour.

Also, reconnect is set AFTER real_connect is called, so its value sticks
(the mysql gem sets reconnect to false inside real_connect).

Signed-off-by: Michael Koziarski &lt;michael@koziarski.com&gt;
[#1797 state:committed]
http://github.com/rails/rails/commit/5fe6635e05a18b312c47fe6bbbaf88fd62e7703d</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from [5fe6635e05a18b312c47fe6bbbaf88fd62e7703d])
Mysql#reconnect is set according to the 'reconnect' key in the
connection spec.&lt;/p&gt;
&lt;p&gt;The 'reconenct' boolean option is read from the connection
specification and is used to set the reconnect attribute of Mysql.
The default is false in order not to change existing application
behaviour.&lt;/p&gt;
&lt;p&gt;Also, reconnect is set AFTER real_connect is called, so its
value sticks (the mysql gem sets reconnect to false inside
real_connect).&lt;/p&gt;
&lt;p&gt;Signed-off-by: Michael Koziarski &lt;a href=&quot;mailto:michael@koziarski.com&quot;&gt;michael@koziarski.com&lt;/a&gt; [&lt;a href=&quot;/projects/8994/tickets/1797&quot; title=&quot;Ticket #1797&quot;&gt;#1797&lt;/a&gt;
state:committed] &lt;a href=&quot;http://github.com/rails/rails/commit/5fe6635e05a18b312c47fe6bbbaf88fd62e7703d&quot;&gt;
http://github.com/rails/rails/co...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-01-26T20:57:59+00:00</created-at>
      <creator-id type="integer">10258</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1797</number>
      <permalink>mysql-reconnect-value-doesnt-stick</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>activerecord mysql patch</tag>
      <title>MySQL reconnect value doesn't stick</title>
      <updated-at type="datetime">2009-01-26T20:58:00+00:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">3</version>
      <user-name>Repository</user-name>
      <creator-name>Dov Murik</creator-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1797</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>aab7ca0b8d99f9b5ae5fb0c48d73bdcab86f241e</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-01-26T15:07:53+00:00</created-at>
      <filename>mysql-reconnect-fix.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">81628</id>
      <size type="integer">4023</size>
      <uploader-id type="integer">10258</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/81628/mysql-reconnect-fix.diff</url>
    </attachment>
  </attachments>
</ticket>
