<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">141</assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-02-02T21:59:51+00:00</created-at>
  <creator-id type="integer">19954</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">9903</milestone-id>
  <number type="integer">1849</number>
  <permalink>fields_for-with-nested-attributes-association-should-accept-explicitly-passed-objects</permalink>
  <priority type="integer">1065</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>committed</state>
  <tag>2.3 attributes nested patch</tag>
  <title>fields_for with nested attributes association should accept explicitly passed objects</title>
  <updated-at type="datetime">2009-02-06T00:48:57+00:00</updated-at>
  <user-id type="integer">17393</user-id>
  <version type="integer">7</version>
  <user-name>Repository</user-name>
  <creator-name>Pascal Ehlert</creator-name>
  <assigned-user-name>Michael Koziarski</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/1849</url>
  <milestone-title>2.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>Currently when you pass an explicit object to nested attributes' fields_for helper, it will simply be ignored.

This patch yields it as the builder's object in the block.

One could argue whether this is actually needed or not (you can use build outside of the template after all), but for compatibility with the existing fields_for it does make sense to me. Should be a no-brainer.</original-body>
  <latest-body>Currently when you pass an explicit object to nested attributes' fields_for helper, it will simply be ignored.

This patch yields it as the builder's object in the block.

One could argue whether this is actually needed or not (you can use build outside of the template after all), but for compatibility with the existing fields_for it does make sense to me. Should be a no-brainer.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;Currently when you pass an explicit object to nested attributes'
fields_for helper, it will simply be ignored.&lt;/p&gt;
&lt;p&gt;This patch yields it as the builder's object in the block.&lt;/p&gt;
&lt;p&gt;One could argue whether this is actually needed or not (you can
use build outside of the template after all), but for compatibility
with the existing fields_for it does make sense to me. Should be a
no-brainer.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Currently when you pass an explicit object to nested attributes' fields_for helper, it will simply be ignored.

This patch yields it as the builder's object in the block.

One could argue whether this is actually needed or not (you can use build outside of the template after all), but for compatibility with the existing fields_for it does make sense to me. Should be a no-brainer.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Currently when you pass an explicit object to nested attributes'
fields_for helper, it will simply be ignored.&lt;/p&gt;
&lt;p&gt;This patch yields it as the builder's object in the block.&lt;/p&gt;
&lt;p&gt;One could argue whether this is actually needed or not (you can
use build outside of the template after all), but for compatibility
with the existing fields_for it does make sense to me. Should be a
no-brainer.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-02T21:59:52+00:00</created-at>
      <creator-id type="integer">19954</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1849</number>
      <permalink>fields_for-with-nested-attributes-association-should-accept-explicitly-passed-objects</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 attributes nested patch</tag>
      <title>fields_for with nested attributes association should accept explicitly passed objects</title>
      <updated-at type="datetime">2009-02-02T21:59:55+00:00</updated-at>
      <user-id type="integer">19954</user-id>
      <version type="integer">1</version>
      <user-name>Pascal Ehlert</user-name>
      <creator-name>Pascal Ehlert</creator-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1849</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Should have mentioned that this only applies for one-to-one associations..</body>
      <body-html>&lt;div&gt;&lt;p&gt;Should have mentioned that this only applies for one-to-one
associations..&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-02T22:09:13+00:00</created-at>
      <creator-id type="integer">19954</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1849</number>
      <permalink>fields_for-with-nested-attributes-association-should-accept-explicitly-passed-objects</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 attributes nested patch</tag>
      <title>fields_for with nested attributes association should accept explicitly passed objects</title>
      <updated-at type="datetime">2009-02-02T22:09:16+00:00</updated-at>
      <user-id type="integer">19954</user-id>
      <version type="integer">2</version>
      <user-name>Pascal Ehlert</user-name>
      <creator-name>Pascal Ehlert</creator-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1849</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>+1 Applies clean, tests run and looks good to me.</body>
      <body-html>&lt;div&gt;&lt;p&gt;+1 Applies clean, tests run and looks good to me.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-03T00:00:11+00:00</created-at>
      <creator-id type="integer">19954</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1849</number>
      <permalink>fields_for-with-nested-attributes-association-should-accept-explicitly-passed-objects</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 attributes nested patch</tag>
      <title>fields_for with nested attributes association should accept explicitly passed objects</title>
      <updated-at type="datetime">2009-02-03T00:00:15+00:00</updated-at>
      <user-id type="integer">8406</user-id>
      <version type="integer">3</version>
      <user-name>Eloy Duran</user-name>
      <creator-name>Pascal Ehlert</creator-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1849</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Wouldn't this only work with ActiveRecord objects?  Not sure if that's
a deal breaker here, but seems like we should be able to work with it
another way.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Wouldn't this only work with ActiveRecord objects? Not sure if
that's a deal breaker here, but seems like we should be able to
work with it another way.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-03T05:50:20+00:00</created-at>
      <creator-id type="integer">19954</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1849</number>
      <permalink>fields_for-with-nested-attributes-association-should-accept-explicitly-passed-objects</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 attributes nested patch</tag>
      <title>fields_for with nested attributes association should accept explicitly passed objects</title>
      <updated-at type="datetime">2009-02-03T05:50:21+00:00</updated-at>
      <user-id type="integer">141</user-id>
      <version type="integer">4</version>
      <user-name>Michael Koziarski</user-name>
      <creator-name>Pascal Ehlert</creator-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1849</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>That's true, it works for all objects that respond to &quot;new_record?&quot;.. 

You may have noticed that I've been inspired by the existing code here which is why I thought it would be a reasonable assumption.

I didn't like this too much myself, but I think in order to work with form helpers, attributes should have a #new_record? method anyway.

Maybe we can just put a note somewhere in the rdoc of form_for?</body>
      <body-html>&lt;div&gt;&lt;p&gt;That's true, it works for all objects that respond to
&quot;new_record?&quot;..&lt;/p&gt;
&lt;p&gt;You may have noticed that I've been inspired by the existing
code here which is why I thought it would be a reasonable
assumption.&lt;/p&gt;
&lt;p&gt;I didn't like this too much myself, but I think in order to work
with form helpers, attributes should have a #new_record? method
anyway.&lt;/p&gt;
&lt;p&gt;Maybe we can just put a note somewhere in the rdoc of
form_for?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-03T05:59:24+00:00</created-at>
      <creator-id type="integer">19954</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1849</number>
      <permalink>fields_for-with-nested-attributes-association-should-accept-explicitly-passed-objects</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 attributes nested patch</tag>
      <title>fields_for with nested attributes association should accept explicitly passed objects</title>
      <updated-at type="datetime">2009-02-03T05:59:28+00:00</updated-at>
      <user-id type="integer">19954</user-id>
      <version type="integer">5</version>
      <user-name>Pascal Ehlert</user-name>
      <creator-name>Pascal Ehlert</creator-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1849</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>@Michael: Well ActiveRecord and DataMapper and any objecty which responds to new_record?. (The same kind of stuff happens on line 261 btw.)

It's not a deal breaker though, we need an ID for new records as well. So since we are already assuming the new_record? method, I chose to use that to check if an object is a record or not.</body>
      <body-html>&lt;div&gt;&lt;p&gt;@Michael: Well ActiveRecord and DataMapper and any objecty which
responds to new_record?. (The same kind of stuff happens on line
261 btw.)&lt;/p&gt;
&lt;p&gt;It's not a deal breaker though, we need an ID for new records as
well. So since we are already assuming the new_record? method, I
chose to use that to check if an object is a record or not.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-02-03T09:50:43+00:00</created-at>
      <creator-id type="integer">19954</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1849</number>
      <permalink>fields_for-with-nested-attributes-association-should-accept-explicitly-passed-objects</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.3 attributes nested patch</tag>
      <title>fields_for with nested attributes association should accept explicitly passed objects</title>
      <updated-at type="datetime">2009-02-03T09:50:48+00:00</updated-at>
      <user-id type="integer">8406</user-id>
      <version type="integer">6</version>
      <user-name>Eloy Duran</user-name>
      <creator-name>Pascal Ehlert</creator-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1849</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">141</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>(from [d15d53cf810014b90827015ecd0e601176492fb7]) Allowing an object to be passed explicitly to a fields_for with nested_attributes on one-to-one associations

Signed-off-by: Michael Koziarski &lt;michael@koziarski.com&gt;
[#1849 state:committed]
http://github.com/rails/rails/commit/d15d53cf810014b90827015ecd0e601176492fb7</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from [d15d53cf810014b90827015ecd0e601176492fb7]) Allowing an
object to be passed explicitly to a fields_for with
nested_attributes on one-to-one associations&lt;/p&gt;
&lt;p&gt;Signed-off-by: Michael Koziarski &lt;a href=&quot;mailto:michael@koziarski.com&quot;&gt;michael@koziarski.com&lt;/a&gt; [&lt;a href=&quot;/projects/8994/tickets/1849&quot; title=&quot;Ticket #1849&quot;&gt;#1849&lt;/a&gt;
state:committed] &lt;a href=&quot;http://github.com/rails/rails/commit/d15d53cf810014b90827015ecd0e601176492fb7&quot;&gt;
http://github.com/rails/rails/co...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-02-06T00:48:55+00:00</created-at>
      <creator-id type="integer">19954</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1849</number>
      <permalink>fields_for-with-nested-attributes-association-should-accept-explicitly-passed-objects</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>committed</state>
      <tag>2.3 attributes nested patch</tag>
      <title>fields_for with nested attributes association should accept explicitly passed objects</title>
      <updated-at type="datetime">2009-02-06T00:48:57+00:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">7</version>
      <user-name>Repository</user-name>
      <creator-name>Pascal Ehlert</creator-name>
      <assigned-user-name>Michael Koziarski</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1849</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>148657cf88b020a0a20c5d61eca284eeb8367e18</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2009-02-02T21:59:52+00:00</created-at>
      <filename>fields_for_with_explicit_object.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">84142</id>
      <size type="integer">1939</size>
      <uploader-id type="integer">19954</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/84142/fields_for_with_explicit_object.diff</url>
    </attachment>
  </attachments>
</ticket>
