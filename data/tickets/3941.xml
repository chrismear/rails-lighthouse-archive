<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">15316</assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2011-03-03T09:20:23+00:00</created-at>
  <creator-id type="integer">52056</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer" nil="true"></milestone-id>
  <number type="integer">3941</number>
  <permalink>invalid-byte-sequence-in-us-ascii-error-for-utf-8-localized-messages</permalink>
  <priority type="integer">0</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>resolved</state>
  <tag>patch rails3 utf8</tag>
  <title>&quot;invalid byte sequence in US-ASCII&quot; error for UTF-8 localized messages</title>
  <updated-at type="datetime">2011-03-03T09:20:23+00:00</updated-at>
  <user-id type="integer">17393</user-id>
  <version type="integer">5</version>
  <user-name>Repository</user-name>
  <creator-name>imo</creator-name>
  <assigned-user-name>Aaron Patterson</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/3941</url>
  <priority-name nil="true"></priority-name>
  <original-body>Localized UTF error messages generate &quot;invalid byte sequence in US-ASCII&quot; exception when trying to save it.


Versions:
rails - 3.0.0.beta1 from git repo
@@@ 
$ /usr/local/bin/ruby -v
ruby 1.9.1p376 (2009-12-07 revision 26041) [i686-linux]
@@@


Steps to reporoduce:
@@@
$ git clone git://github.com/rails/rails.git
$ /usr/local/bin/ruby rails/railties/bin/rails yyy
$ cd yyy
in Gemfile change 3rd line to:
gem 'rails', :path =&gt; '/home/imo/rails'
$ ~/.gem/ruby/1.9.1/bin/bundle install
$ ./script/rails g scaffold post title:string body:text published:boolean
in app/model/post.rb add:
  validates_length_of :title, :minimum =&gt; 4
in config/application.rb add:
  config.i18n.default_locale = :pl
$ cat &gt; config/locales/pl.yml
pl:
 activerecord:
  errors:
   messages:
    too_short: &quot;jest za kr&#243;tkie (minimalnie {{count}} znak&#243;w)&quot;
^D
$ rake db:migrate
$ ./script/rails s
  open url localhost:3000/posts/new
  hit button &quot;Create Post&quot;
  I'm getting  ArgumentError in Posts#create 
@@@

---
after removing all silencers
(add Rails.backtrace_cleaner.remove_silencers! to config/initializers/backtrace_silencers.rb) I have such backtrace:

@@@
Started POST &quot;/posts&quot; for 127.0.0.1 at 2010-02-12 14:16:25
  Processing by PostsController#create as HTML
  Parameters: {&quot;authenticity_token&quot;=&gt;&quot;cTfBRCsNEVxBTjsxLEyKqeAyaoeJ6jSUkX21vb0bb3I=&quot;, &quot;post&quot;=&gt;{&quot;title&quot;=&gt;&quot;&quot;, &quot;body&quot;=&gt;&quot;&quot;, &quot;published&quot;=&gt;&quot;0&quot;}, &quot;commit&quot;=&gt;&quot;Create Post&quot;}

ActionView::Template::Error (invalid byte sequence in US-ASCII) on line #2 of /home/imo/yyy/app/views/posts/_form.html.erb:
1: &lt;% form_for(@post) do |f| %&gt;
2:   &lt;%= f.error_messages %&gt;
3: 
4:   &lt;div class=&quot;field&quot;&gt;
5:     &lt;%= f.label :title %&gt;&lt;br /&gt;

    /home/imo/rails/activesupport/lib/active_support/core_ext/string/output_safety.rb:22:in `gsub'
    /home/imo/rails/activesupport/lib/active_support/core_ext/string/output_safety.rb:22:in `html_escape'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:229:in `block (3 levels) in error_messages_for'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:228:in `map'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:228:in `block (2 levels) in error_messages_for'
    /home/imo/rails/activesupport/lib/active_support/core_ext/enumerable.rb:59:in `map'
    /home/imo/rails/activesupport/lib/active_support/core_ext/enumerable.rb:59:in `sum'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:227:in `block in error_messages_for'
    /home/imo/rails/activesupport/lib/active_support/core_ext/object/with_options.rb:22:in `with_options'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:218:in `error_messages_for'
    /home/imo/rails/actionpack/lib/action_view/helpers/form_helper.rb:1106:in `error_messages'
    app/views/posts/_form.html.erb:2:in `block in _render_template_489766511_80078656_769562'
    /home/imo/rails/actionpack/lib/action_view/helpers/form_helper.rb:532:in `fields_for'
    /home/imo/rails/actionpack/lib/action_view/helpers/form_helper.rb:313:in `form_for'
    app/views/posts/_form.html.erb:1:in `_render_template_489766511_80078656_769562'
    /home/imo/rails/actionpack/lib/action_view/template.rb:40:in `render'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:285:in `render_partial'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:225:in `block in render'
    /home/imo/rails/activesupport/lib/active_support/notifications/instrumenter.rb:18:in `instrument'
    /home/imo/rails/activesupport/lib/active_support/notifications.rb:49:in `instrument'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:223:in `render'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:347:in `_render_partial'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:43:in `render'
    app/views/posts/new.html.erb:3:in `_render_template_33817705_80151512_0'
    /home/imo/rails/actionpack/lib/action_view/template.rb:40:in `render'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:101:in `block in _render_template'
    /home/imo/rails/activesupport/lib/active_support/notifications/instrumenter.rb:18:in `instrument'
    /home/imo/rails/activesupport/lib/active_support/notifications.rb:49:in `instrument'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:98:in `_render_template'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:92:in `render_template'
    /home/imo/rails/actionpack/lib/abstract_controller/rendering.rb:84:in `_render_template'
    /home/imo/rails/actionpack/lib/abstract_controller/rendering.rb:65:in `render_to_body'
    /home/imo/rails/actionpack/lib/abstract_controller/layouts.rb:308:in `render_to_body'
    /home/imo/rails/actionpack/lib/action_controller/metal/rendering.rb:28:in `render_to_body'
    /home/imo/rails/actionpack/lib/action_controller/metal/renderers.rb:46:in `render_to_body'
    /home/imo/rails/actionpack/lib/action_controller/metal/compatibility.rb:115:in `render_to_body'
    /home/imo/rails/actionpack/lib/abstract_controller/rendering.rb:49:in `render'
    /home/imo/rails/actionpack/lib/action_controller/metal/rendering.rb:21:in `render'
    /home/imo/rails/actionpack/lib/abstract_controller/localized_cache.rb:39:in `render'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:39:in `block (2 levels) in render'
    /home/imo/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `block in ms'
    /usr/local/lib/ruby/1.9.1/benchmark.rb:309:in `realtime'
    /home/imo/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:39:in `block in render'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:77:in `cleanup_view_runtime'
    /home/imo/rails/activerecord/lib/active_record/railties/controller_runtime.rb:15:in `cleanup_view_runtime'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:38:in `render'
    app/controllers/posts_controller.rb:50:in `block (2 levels) in create'
    /home/imo/rails/actionpack/lib/action_controller/metal/mime_responds.rb:189:in `call'
    /home/imo/rails/actionpack/lib/action_controller/metal/mime_responds.rb:189:in `respond_to'
    app/controllers/posts_controller.rb:45:in `create'
    /home/imo/rails/actionpack/lib/action_controller/base.rb:44:in `send'
    /home/imo/rails/actionpack/lib/action_controller/base.rb:44:in `send_action'
    /home/imo/rails/actionpack/lib/abstract_controller/base.rb:145:in `process_action'
    /home/imo/rails/actionpack/lib/abstract_controller/callbacks.rb:18:in `block in process_action'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:433:in `_run__978314271__process_action__738868751__callbacks'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:423:in `_run_process_action_callbacks'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:88:in `run_callbacks'
    /home/imo/rails/actionpack/lib/abstract_controller/callbacks.rb:17:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/rendering.rb:12:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/compatibility.rb:66:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:29:in `block in process_action'
    /home/imo/rails/activesupport/lib/active_support/notifications/instrumenter.rb:18:in `instrument'
    /home/imo/rails/activesupport/lib/active_support/notifications.rb:49:in `instrument'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:28:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/rescue.rb:8:in `process_action'
    /home/imo/rails/actionpack/lib/abstract_controller/base.rb:115:in `process'
    /home/imo/rails/actionpack/lib/action_controller/metal.rb:64:in `dispatch'
    /home/imo/rails/actionpack/lib/action_controller/metal/rack_delegation.rb:19:in `dispatch'
    /home/imo/rails/actionpack/lib/action_controller/metal.rb:89:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/routing/route_set.rb:27:in `call'
    rack-mount (0.5.0) lib/rack/mount/recognition/route_set.rb:75:in `block in call'
    rack-mount (0.5.0) lib/rack/mount/recognition/code_generation.rb:99:in `block in recognize'
    rack-mount (0.5.0) lib/rack/mount/recognition/code_generation.rb:76:in `optimized_each'
    rack-mount (0.5.0) lib/rack/mount/recognition/code_generation.rb:98:in `recognize'
    rack-mount (0.5.0) lib/rack/mount/recognition/route_set.rb:66:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/routing/route_set.rb:420:in `call'
    /home/imo/rails/activerecord/lib/active_record/query_cache.rb:29:in `block in call'
    /home/imo/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:34:in `cache'
    /home/imo/rails/activerecord/lib/active_record/query_cache.rb:9:in `cache'
    /home/imo/rails/activerecord/lib/active_record/query_cache.rb:28:in `call'
    /home/imo/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:365:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/head.rb:14:in `call'
    /home/imo/rails/rack/lib/rack/methodoverride.rb:24:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/params_parser.rb:20:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/flash.rb:167:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/session/cookie_store.rb:107:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/cookies.rb:205:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/callbacks.rb:46:in `block in call'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:429:in `_run_call_callbacks'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:88:in `run_callbacks'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/callbacks.rb:44:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/show_exceptions.rb:62:in `call'
    /home/imo/rails/railties/lib/rails/rack/logger.rb:13:in `call'
    /home/imo/rails/rack/lib/rack/runtime.rb:17:in `call'
    /home/imo/rails/rack/lib/rack/lock.rb:11:in `block in call'
    &lt;internal:prelude&gt;:8:in `synchronize'
    /home/imo/rails/rack/lib/rack/lock.rb:11:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/static.rb:30:in `call'
    /home/imo/rails/railties/lib/rails/application.rb:95:in `call'
    /home/imo/rails/railties/lib/rails/application.rb:41:in `method_missing'
    /home/imo/rails/railties/lib/rails/rack/log_tailer.rb:15:in `call'
    /home/imo/rails/rack/lib/rack/content_length.rb:13:in `call'
    /home/imo/rails/rack/lib/rack/handler/webrick.rb:48:in `service'
    /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
    /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
    /usr/local/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'

Rendered /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/_trace.erb (1.4ms)
Rendered /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (8.9ms)
Rendered /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/template_error.erb within /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/layout.erb (20.8ms)


@@@</original-body>
  <latest-body>Localized UTF error messages generate &quot;invalid byte sequence in US-ASCII&quot; exception when trying to save it.


Versions:
rails - 3.0.0.beta1 from git repo
@@@ 
$ /usr/local/bin/ruby -v
ruby 1.9.1p376 (2009-12-07 revision 26041) [i686-linux]
@@@


Steps to reporoduce:
@@@
$ git clone git://github.com/rails/rails.git
$ /usr/local/bin/ruby rails/railties/bin/rails yyy
$ cd yyy
in Gemfile change 3rd line to:
gem 'rails', :path =&gt; '/home/imo/rails'
$ ~/.gem/ruby/1.9.1/bin/bundle install
$ ./script/rails g scaffold post title:string body:text published:boolean
in app/model/post.rb add:
  validates_length_of :title, :minimum =&gt; 4
in config/application.rb add:
  config.i18n.default_locale = :pl
$ cat &gt; config/locales/pl.yml
pl:
 activerecord:
  errors:
   messages:
    too_short: &quot;jest za kr&#243;tkie (minimalnie {{count}} znak&#243;w)&quot;
^D
$ rake db:migrate
$ ./script/rails s
  open url localhost:3000/posts/new
  hit button &quot;Create Post&quot;
  I'm getting  ArgumentError in Posts#create 
@@@

---
after removing all silencers
(add Rails.backtrace_cleaner.remove_silencers! to config/initializers/backtrace_silencers.rb) I have such backtrace:

@@@
Started POST &quot;/posts&quot; for 127.0.0.1 at 2010-02-12 14:16:25
  Processing by PostsController#create as HTML
  Parameters: {&quot;authenticity_token&quot;=&gt;&quot;cTfBRCsNEVxBTjsxLEyKqeAyaoeJ6jSUkX21vb0bb3I=&quot;, &quot;post&quot;=&gt;{&quot;title&quot;=&gt;&quot;&quot;, &quot;body&quot;=&gt;&quot;&quot;, &quot;published&quot;=&gt;&quot;0&quot;}, &quot;commit&quot;=&gt;&quot;Create Post&quot;}

ActionView::Template::Error (invalid byte sequence in US-ASCII) on line #2 of /home/imo/yyy/app/views/posts/_form.html.erb:
1: &lt;% form_for(@post) do |f| %&gt;
2:   &lt;%= f.error_messages %&gt;
3: 
4:   &lt;div class=&quot;field&quot;&gt;
5:     &lt;%= f.label :title %&gt;&lt;br /&gt;

    /home/imo/rails/activesupport/lib/active_support/core_ext/string/output_safety.rb:22:in `gsub'
    /home/imo/rails/activesupport/lib/active_support/core_ext/string/output_safety.rb:22:in `html_escape'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:229:in `block (3 levels) in error_messages_for'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:228:in `map'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:228:in `block (2 levels) in error_messages_for'
    /home/imo/rails/activesupport/lib/active_support/core_ext/enumerable.rb:59:in `map'
    /home/imo/rails/activesupport/lib/active_support/core_ext/enumerable.rb:59:in `sum'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:227:in `block in error_messages_for'
    /home/imo/rails/activesupport/lib/active_support/core_ext/object/with_options.rb:22:in `with_options'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:218:in `error_messages_for'
    /home/imo/rails/actionpack/lib/action_view/helpers/form_helper.rb:1106:in `error_messages'
    app/views/posts/_form.html.erb:2:in `block in _render_template_489766511_80078656_769562'
    /home/imo/rails/actionpack/lib/action_view/helpers/form_helper.rb:532:in `fields_for'
    /home/imo/rails/actionpack/lib/action_view/helpers/form_helper.rb:313:in `form_for'
    app/views/posts/_form.html.erb:1:in `_render_template_489766511_80078656_769562'
    /home/imo/rails/actionpack/lib/action_view/template.rb:40:in `render'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:285:in `render_partial'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:225:in `block in render'
    /home/imo/rails/activesupport/lib/active_support/notifications/instrumenter.rb:18:in `instrument'
    /home/imo/rails/activesupport/lib/active_support/notifications.rb:49:in `instrument'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:223:in `render'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:347:in `_render_partial'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:43:in `render'
    app/views/posts/new.html.erb:3:in `_render_template_33817705_80151512_0'
    /home/imo/rails/actionpack/lib/action_view/template.rb:40:in `render'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:101:in `block in _render_template'
    /home/imo/rails/activesupport/lib/active_support/notifications/instrumenter.rb:18:in `instrument'
    /home/imo/rails/activesupport/lib/active_support/notifications.rb:49:in `instrument'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:98:in `_render_template'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:92:in `render_template'
    /home/imo/rails/actionpack/lib/abstract_controller/rendering.rb:84:in `_render_template'
    /home/imo/rails/actionpack/lib/abstract_controller/rendering.rb:65:in `render_to_body'
    /home/imo/rails/actionpack/lib/abstract_controller/layouts.rb:308:in `render_to_body'
    /home/imo/rails/actionpack/lib/action_controller/metal/rendering.rb:28:in `render_to_body'
    /home/imo/rails/actionpack/lib/action_controller/metal/renderers.rb:46:in `render_to_body'
    /home/imo/rails/actionpack/lib/action_controller/metal/compatibility.rb:115:in `render_to_body'
    /home/imo/rails/actionpack/lib/abstract_controller/rendering.rb:49:in `render'
    /home/imo/rails/actionpack/lib/action_controller/metal/rendering.rb:21:in `render'
    /home/imo/rails/actionpack/lib/abstract_controller/localized_cache.rb:39:in `render'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:39:in `block (2 levels) in render'
    /home/imo/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `block in ms'
    /usr/local/lib/ruby/1.9.1/benchmark.rb:309:in `realtime'
    /home/imo/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:39:in `block in render'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:77:in `cleanup_view_runtime'
    /home/imo/rails/activerecord/lib/active_record/railties/controller_runtime.rb:15:in `cleanup_view_runtime'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:38:in `render'
    app/controllers/posts_controller.rb:50:in `block (2 levels) in create'
    /home/imo/rails/actionpack/lib/action_controller/metal/mime_responds.rb:189:in `call'
    /home/imo/rails/actionpack/lib/action_controller/metal/mime_responds.rb:189:in `respond_to'
    app/controllers/posts_controller.rb:45:in `create'
    /home/imo/rails/actionpack/lib/action_controller/base.rb:44:in `send'
    /home/imo/rails/actionpack/lib/action_controller/base.rb:44:in `send_action'
    /home/imo/rails/actionpack/lib/abstract_controller/base.rb:145:in `process_action'
    /home/imo/rails/actionpack/lib/abstract_controller/callbacks.rb:18:in `block in process_action'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:433:in `_run__978314271__process_action__738868751__callbacks'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:423:in `_run_process_action_callbacks'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:88:in `run_callbacks'
    /home/imo/rails/actionpack/lib/abstract_controller/callbacks.rb:17:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/rendering.rb:12:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/compatibility.rb:66:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:29:in `block in process_action'
    /home/imo/rails/activesupport/lib/active_support/notifications/instrumenter.rb:18:in `instrument'
    /home/imo/rails/activesupport/lib/active_support/notifications.rb:49:in `instrument'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:28:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/rescue.rb:8:in `process_action'
    /home/imo/rails/actionpack/lib/abstract_controller/base.rb:115:in `process'
    /home/imo/rails/actionpack/lib/action_controller/metal.rb:64:in `dispatch'
    /home/imo/rails/actionpack/lib/action_controller/metal/rack_delegation.rb:19:in `dispatch'
    /home/imo/rails/actionpack/lib/action_controller/metal.rb:89:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/routing/route_set.rb:27:in `call'
    rack-mount (0.5.0) lib/rack/mount/recognition/route_set.rb:75:in `block in call'
    rack-mount (0.5.0) lib/rack/mount/recognition/code_generation.rb:99:in `block in recognize'
    rack-mount (0.5.0) lib/rack/mount/recognition/code_generation.rb:76:in `optimized_each'
    rack-mount (0.5.0) lib/rack/mount/recognition/code_generation.rb:98:in `recognize'
    rack-mount (0.5.0) lib/rack/mount/recognition/route_set.rb:66:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/routing/route_set.rb:420:in `call'
    /home/imo/rails/activerecord/lib/active_record/query_cache.rb:29:in `block in call'
    /home/imo/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:34:in `cache'
    /home/imo/rails/activerecord/lib/active_record/query_cache.rb:9:in `cache'
    /home/imo/rails/activerecord/lib/active_record/query_cache.rb:28:in `call'
    /home/imo/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:365:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/head.rb:14:in `call'
    /home/imo/rails/rack/lib/rack/methodoverride.rb:24:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/params_parser.rb:20:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/flash.rb:167:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/session/cookie_store.rb:107:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/cookies.rb:205:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/callbacks.rb:46:in `block in call'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:429:in `_run_call_callbacks'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:88:in `run_callbacks'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/callbacks.rb:44:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/show_exceptions.rb:62:in `call'
    /home/imo/rails/railties/lib/rails/rack/logger.rb:13:in `call'
    /home/imo/rails/rack/lib/rack/runtime.rb:17:in `call'
    /home/imo/rails/rack/lib/rack/lock.rb:11:in `block in call'
    &lt;internal:prelude&gt;:8:in `synchronize'
    /home/imo/rails/rack/lib/rack/lock.rb:11:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/static.rb:30:in `call'
    /home/imo/rails/railties/lib/rails/application.rb:95:in `call'
    /home/imo/rails/railties/lib/rails/application.rb:41:in `method_missing'
    /home/imo/rails/railties/lib/rails/rack/log_tailer.rb:15:in `call'
    /home/imo/rails/rack/lib/rack/content_length.rb:13:in `call'
    /home/imo/rails/rack/lib/rack/handler/webrick.rb:48:in `service'
    /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
    /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
    /usr/local/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'

Rendered /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/_trace.erb (1.4ms)
Rendered /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (8.9ms)
Rendered /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/template_error.erb within /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/layout.erb (20.8ms)


@@@</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;Localized UTF error messages generate &quot;invalid byte sequence in
US-ASCII&quot; exception when trying to save it.&lt;/p&gt;
&lt;p&gt;Versions:&lt;br&gt;
rails - 3.0.0.beta1 from git repo&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;$ /usr/local/bin/ruby -v
ruby 1.9.1p376 (2009-12-07 revision 26041) [i686-linux]&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Steps to reporoduce:&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;$ git clone git://github.com/rails/rails.git
$ /usr/local/bin/ruby rails/railties/bin/rails yyy
$ cd yyy
in Gemfile change 3rd line to:
gem 'rails', :path =&amp;gt; '/home/imo/rails'
$ ~/.gem/ruby/1.9.1/bin/bundle install
$ ./script/rails g scaffold post title:string body:text published:boolean
in app/model/post.rb add:
  validates_length_of :title, :minimum =&amp;gt; 4
in config/application.rb add:
  config.i18n.default_locale = :pl
$ cat &amp;gt; config/locales/pl.yml
pl:
 activerecord:
  errors:
   messages:&lt;br&gt;
&lt;br&gt;


&lt;/code&gt;
&lt;/pre&gt;
&lt;pre&gt;
&lt;code&gt;&lt;code&gt;too_short: &amp;amp;quot;jest za kr&amp;oacute;tkie (minimalnie {{count}} znak&amp;oacute;w)&amp;amp;quot;&lt;/code&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;pre&gt;


&lt;br&gt;
^D
$ rake db:migrate
$ ./script/rails s
  open url localhost:3000/posts/new
  hit button &quot;Create Post&quot;
  I'm getting  ArgumentError in Posts#create
&lt;/pre&gt;
&lt;hr&gt;
&lt;p&gt;after removing all silencers&lt;br&gt;
(add Rails.backtrace_cleaner.remove_silencers! to
config/initializers/backtrace_silencers.rb) I have such
backtrace:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;Started POST &quot;/posts&quot; for 127.0.0.1 at 2010-02-12 14:16:25
  Processing by PostsController#create as HTML
  Parameters: {&quot;authenticity_token&quot;=&amp;gt;&quot;cTfBRCsNEVxBTjsxLEyKqeAyaoeJ6jSUkX21vb0bb3I=&quot;, &quot;post&quot;=&amp;gt;{&quot;title&quot;=&amp;gt;&quot;&quot;, &quot;body&quot;=&amp;gt;&quot;&quot;, &quot;published&quot;=&amp;gt;&quot;0&quot;}, &quot;commit&quot;=&amp;gt;&quot;Create Post&quot;}

ActionView::Template::Error (invalid byte sequence in US-ASCII) on line #2 of /home/imo/yyy/app/views/posts/_form.html.erb:
1: &amp;lt;% form_for(@post) do |f| %&amp;gt;
2:   &amp;lt;%= f.error_messages %&amp;gt;
3: 
4:   &amp;lt;div class=&quot;field&quot;&amp;gt;
5:     &amp;lt;%= f.label :title %&amp;gt;&amp;lt;br /&amp;gt;

    /home/imo/rails/activesupport/lib/active_support/core_ext/string/output_safety.rb:22:in `gsub'
    /home/imo/rails/activesupport/lib/active_support/core_ext/string/output_safety.rb:22:in `html_escape'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:229:in `block (3 levels) in error_messages_for'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:228:in `map'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:228:in `block (2 levels) in error_messages_for'
    /home/imo/rails/activesupport/lib/active_support/core_ext/enumerable.rb:59:in `map'
    /home/imo/rails/activesupport/lib/active_support/core_ext/enumerable.rb:59:in `sum'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:227:in `block in error_messages_for'
    /home/imo/rails/activesupport/lib/active_support/core_ext/object/with_options.rb:22:in `with_options'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:218:in `error_messages_for'
    /home/imo/rails/actionpack/lib/action_view/helpers/form_helper.rb:1106:in `error_messages'
    app/views/posts/_form.html.erb:2:in `block in _render_template_489766511_80078656_769562'
    /home/imo/rails/actionpack/lib/action_view/helpers/form_helper.rb:532:in `fields_for'
    /home/imo/rails/actionpack/lib/action_view/helpers/form_helper.rb:313:in `form_for'
    app/views/posts/_form.html.erb:1:in `_render_template_489766511_80078656_769562'
    /home/imo/rails/actionpack/lib/action_view/template.rb:40:in `render'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:285:in `render_partial'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:225:in `block in render'
    /home/imo/rails/activesupport/lib/active_support/notifications/instrumenter.rb:18:in `instrument'
    /home/imo/rails/activesupport/lib/active_support/notifications.rb:49:in `instrument'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:223:in `render'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:347:in `_render_partial'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:43:in `render'
    app/views/posts/new.html.erb:3:in `_render_template_33817705_80151512_0'
    /home/imo/rails/actionpack/lib/action_view/template.rb:40:in `render'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:101:in `block in _render_template'
    /home/imo/rails/activesupport/lib/active_support/notifications/instrumenter.rb:18:in `instrument'
    /home/imo/rails/activesupport/lib/active_support/notifications.rb:49:in `instrument'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:98:in `_render_template'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:92:in `render_template'
    /home/imo/rails/actionpack/lib/abstract_controller/rendering.rb:84:in `_render_template'
    /home/imo/rails/actionpack/lib/abstract_controller/rendering.rb:65:in `render_to_body'
    /home/imo/rails/actionpack/lib/abstract_controller/layouts.rb:308:in `render_to_body'
    /home/imo/rails/actionpack/lib/action_controller/metal/rendering.rb:28:in `render_to_body'
    /home/imo/rails/actionpack/lib/action_controller/metal/renderers.rb:46:in `render_to_body'
    /home/imo/rails/actionpack/lib/action_controller/metal/compatibility.rb:115:in `render_to_body'
    /home/imo/rails/actionpack/lib/abstract_controller/rendering.rb:49:in `render'
    /home/imo/rails/actionpack/lib/action_controller/metal/rendering.rb:21:in `render'
    /home/imo/rails/actionpack/lib/abstract_controller/localized_cache.rb:39:in `render'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:39:in `block (2 levels) in render'
    /home/imo/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `block in ms'
    /usr/local/lib/ruby/1.9.1/benchmark.rb:309:in `realtime'
    /home/imo/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:39:in `block in render'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:77:in `cleanup_view_runtime'
    /home/imo/rails/activerecord/lib/active_record/railties/controller_runtime.rb:15:in `cleanup_view_runtime'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:38:in `render'
    app/controllers/posts_controller.rb:50:in `block (2 levels) in create'
    /home/imo/rails/actionpack/lib/action_controller/metal/mime_responds.rb:189:in `call'
    /home/imo/rails/actionpack/lib/action_controller/metal/mime_responds.rb:189:in `respond_to'
    app/controllers/posts_controller.rb:45:in `create'
    /home/imo/rails/actionpack/lib/action_controller/base.rb:44:in `send'
    /home/imo/rails/actionpack/lib/action_controller/base.rb:44:in `send_action'
    /home/imo/rails/actionpack/lib/abstract_controller/base.rb:145:in `process_action'
    /home/imo/rails/actionpack/lib/abstract_controller/callbacks.rb:18:in `block in process_action'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:433:in `_run__978314271__process_action__738868751__callbacks'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:423:in `_run_process_action_callbacks'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:88:in `run_callbacks'
    /home/imo/rails/actionpack/lib/abstract_controller/callbacks.rb:17:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/rendering.rb:12:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/compatibility.rb:66:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:29:in `block in process_action'
    /home/imo/rails/activesupport/lib/active_support/notifications/instrumenter.rb:18:in `instrument'
    /home/imo/rails/activesupport/lib/active_support/notifications.rb:49:in `instrument'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:28:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/rescue.rb:8:in `process_action'
    /home/imo/rails/actionpack/lib/abstract_controller/base.rb:115:in `process'
    /home/imo/rails/actionpack/lib/action_controller/metal.rb:64:in `dispatch'
    /home/imo/rails/actionpack/lib/action_controller/metal/rack_delegation.rb:19:in `dispatch'
    /home/imo/rails/actionpack/lib/action_controller/metal.rb:89:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/routing/route_set.rb:27:in `call'
    rack-mount (0.5.0) lib/rack/mount/recognition/route_set.rb:75:in `block in call'
    rack-mount (0.5.0) lib/rack/mount/recognition/code_generation.rb:99:in `block in recognize'
    rack-mount (0.5.0) lib/rack/mount/recognition/code_generation.rb:76:in `optimized_each'
    rack-mount (0.5.0) lib/rack/mount/recognition/code_generation.rb:98:in `recognize'
    rack-mount (0.5.0) lib/rack/mount/recognition/route_set.rb:66:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/routing/route_set.rb:420:in `call'
    /home/imo/rails/activerecord/lib/active_record/query_cache.rb:29:in `block in call'
    /home/imo/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:34:in `cache'
    /home/imo/rails/activerecord/lib/active_record/query_cache.rb:9:in `cache'
    /home/imo/rails/activerecord/lib/active_record/query_cache.rb:28:in `call'
    /home/imo/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:365:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/head.rb:14:in `call'
    /home/imo/rails/rack/lib/rack/methodoverride.rb:24:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/params_parser.rb:20:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/flash.rb:167:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/session/cookie_store.rb:107:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/cookies.rb:205:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/callbacks.rb:46:in `block in call'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:429:in `_run_call_callbacks'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:88:in `run_callbacks'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/callbacks.rb:44:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/show_exceptions.rb:62:in `call'
    /home/imo/rails/railties/lib/rails/rack/logger.rb:13:in `call'
    /home/imo/rails/rack/lib/rack/runtime.rb:17:in `call'
    /home/imo/rails/rack/lib/rack/lock.rb:11:in `block in call'
    &amp;lt;internal:prelude&amp;gt;:8:in `synchronize'
    /home/imo/rails/rack/lib/rack/lock.rb:11:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/static.rb:30:in `call'
    /home/imo/rails/railties/lib/rails/application.rb:95:in `call'
    /home/imo/rails/railties/lib/rails/application.rb:41:in `method_missing'
    /home/imo/rails/railties/lib/rails/rack/log_tailer.rb:15:in `call'
    /home/imo/rails/rack/lib/rack/content_length.rb:13:in `call'
    /home/imo/rails/rack/lib/rack/handler/webrick.rb:48:in `service'
    /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
    /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
    /usr/local/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'

Rendered /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/_trace.erb (1.4ms)
Rendered /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (8.9ms)
Rendered /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/template_error.erb within /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/layout.erb (20.8ms)&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Localized UTF error messages generate &quot;invalid byte sequence in US-ASCII&quot; exception when trying to save it.


Versions:
rails - 3.0.0.beta1 from git repo
@@@ 
$ /usr/local/bin/ruby -v
ruby 1.9.1p376 (2009-12-07 revision 26041) [i686-linux]
@@@


Steps to reporoduce:
@@@
$ git clone git://github.com/rails/rails.git
$ /usr/local/bin/ruby rails/railties/bin/rails yyy
$ cd yyy
in Gemfile change 3rd line to:
gem 'rails', :path =&gt; '/home/imo/rails'
$ ~/.gem/ruby/1.9.1/bin/bundle install
$ ./script/rails g scaffold post title:string body:text published:boolean
in app/model/post.rb add:
  validates_length_of :title, :minimum =&gt; 4
in config/application.rb add:
  config.i18n.default_locale = :pl
$ cat &gt; config/locales/pl.yml
pl:
 activerecord:
  errors:
   messages:
    too_short: &quot;jest za kr&#243;tkie (minimalnie {{count}} znak&#243;w)&quot;
^D
$ rake db:migrate
$ ./script/rails s
  open url localhost:3000/posts/new
  hit button &quot;Create Post&quot;
  I'm getting  ArgumentError in Posts#create 
@@@

---
after removing all silencers
(add Rails.backtrace_cleaner.remove_silencers! to config/initializers/backtrace_silencers.rb) I have such backtrace:

@@@
Started POST &quot;/posts&quot; for 127.0.0.1 at 2010-02-12 14:16:25
  Processing by PostsController#create as HTML
  Parameters: {&quot;authenticity_token&quot;=&gt;&quot;cTfBRCsNEVxBTjsxLEyKqeAyaoeJ6jSUkX21vb0bb3I=&quot;, &quot;post&quot;=&gt;{&quot;title&quot;=&gt;&quot;&quot;, &quot;body&quot;=&gt;&quot;&quot;, &quot;published&quot;=&gt;&quot;0&quot;}, &quot;commit&quot;=&gt;&quot;Create Post&quot;}

ActionView::Template::Error (invalid byte sequence in US-ASCII) on line #2 of /home/imo/yyy/app/views/posts/_form.html.erb:
1: &lt;% form_for(@post) do |f| %&gt;
2:   &lt;%= f.error_messages %&gt;
3: 
4:   &lt;div class=&quot;field&quot;&gt;
5:     &lt;%= f.label :title %&gt;&lt;br /&gt;

    /home/imo/rails/activesupport/lib/active_support/core_ext/string/output_safety.rb:22:in `gsub'
    /home/imo/rails/activesupport/lib/active_support/core_ext/string/output_safety.rb:22:in `html_escape'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:229:in `block (3 levels) in error_messages_for'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:228:in `map'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:228:in `block (2 levels) in error_messages_for'
    /home/imo/rails/activesupport/lib/active_support/core_ext/enumerable.rb:59:in `map'
    /home/imo/rails/activesupport/lib/active_support/core_ext/enumerable.rb:59:in `sum'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:227:in `block in error_messages_for'
    /home/imo/rails/activesupport/lib/active_support/core_ext/object/with_options.rb:22:in `with_options'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:218:in `error_messages_for'
    /home/imo/rails/actionpack/lib/action_view/helpers/form_helper.rb:1106:in `error_messages'
    app/views/posts/_form.html.erb:2:in `block in _render_template_489766511_80078656_769562'
    /home/imo/rails/actionpack/lib/action_view/helpers/form_helper.rb:532:in `fields_for'
    /home/imo/rails/actionpack/lib/action_view/helpers/form_helper.rb:313:in `form_for'
    app/views/posts/_form.html.erb:1:in `_render_template_489766511_80078656_769562'
    /home/imo/rails/actionpack/lib/action_view/template.rb:40:in `render'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:285:in `render_partial'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:225:in `block in render'
    /home/imo/rails/activesupport/lib/active_support/notifications/instrumenter.rb:18:in `instrument'
    /home/imo/rails/activesupport/lib/active_support/notifications.rb:49:in `instrument'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:223:in `render'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:347:in `_render_partial'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:43:in `render'
    app/views/posts/new.html.erb:3:in `_render_template_33817705_80151512_0'
    /home/imo/rails/actionpack/lib/action_view/template.rb:40:in `render'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:101:in `block in _render_template'
    /home/imo/rails/activesupport/lib/active_support/notifications/instrumenter.rb:18:in `instrument'
    /home/imo/rails/activesupport/lib/active_support/notifications.rb:49:in `instrument'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:98:in `_render_template'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:92:in `render_template'
    /home/imo/rails/actionpack/lib/abstract_controller/rendering.rb:84:in `_render_template'
    /home/imo/rails/actionpack/lib/abstract_controller/rendering.rb:65:in `render_to_body'
    /home/imo/rails/actionpack/lib/abstract_controller/layouts.rb:308:in `render_to_body'
    /home/imo/rails/actionpack/lib/action_controller/metal/rendering.rb:28:in `render_to_body'
    /home/imo/rails/actionpack/lib/action_controller/metal/renderers.rb:46:in `render_to_body'
    /home/imo/rails/actionpack/lib/action_controller/metal/compatibility.rb:115:in `render_to_body'
    /home/imo/rails/actionpack/lib/abstract_controller/rendering.rb:49:in `render'
    /home/imo/rails/actionpack/lib/action_controller/metal/rendering.rb:21:in `render'
    /home/imo/rails/actionpack/lib/abstract_controller/localized_cache.rb:39:in `render'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:39:in `block (2 levels) in render'
    /home/imo/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `block in ms'
    /usr/local/lib/ruby/1.9.1/benchmark.rb:309:in `realtime'
    /home/imo/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:39:in `block in render'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:77:in `cleanup_view_runtime'
    /home/imo/rails/activerecord/lib/active_record/railties/controller_runtime.rb:15:in `cleanup_view_runtime'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:38:in `render'
    app/controllers/posts_controller.rb:50:in `block (2 levels) in create'
    /home/imo/rails/actionpack/lib/action_controller/metal/mime_responds.rb:189:in `call'
    /home/imo/rails/actionpack/lib/action_controller/metal/mime_responds.rb:189:in `respond_to'
    app/controllers/posts_controller.rb:45:in `create'
    /home/imo/rails/actionpack/lib/action_controller/base.rb:44:in `send'
    /home/imo/rails/actionpack/lib/action_controller/base.rb:44:in `send_action'
    /home/imo/rails/actionpack/lib/abstract_controller/base.rb:145:in `process_action'
    /home/imo/rails/actionpack/lib/abstract_controller/callbacks.rb:18:in `block in process_action'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:433:in `_run__978314271__process_action__738868751__callbacks'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:423:in `_run_process_action_callbacks'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:88:in `run_callbacks'
    /home/imo/rails/actionpack/lib/abstract_controller/callbacks.rb:17:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/rendering.rb:12:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/compatibility.rb:66:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:29:in `block in process_action'
    /home/imo/rails/activesupport/lib/active_support/notifications/instrumenter.rb:18:in `instrument'
    /home/imo/rails/activesupport/lib/active_support/notifications.rb:49:in `instrument'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:28:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/rescue.rb:8:in `process_action'
    /home/imo/rails/actionpack/lib/abstract_controller/base.rb:115:in `process'
    /home/imo/rails/actionpack/lib/action_controller/metal.rb:64:in `dispatch'
    /home/imo/rails/actionpack/lib/action_controller/metal/rack_delegation.rb:19:in `dispatch'
    /home/imo/rails/actionpack/lib/action_controller/metal.rb:89:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/routing/route_set.rb:27:in `call'
    rack-mount (0.5.0) lib/rack/mount/recognition/route_set.rb:75:in `block in call'
    rack-mount (0.5.0) lib/rack/mount/recognition/code_generation.rb:99:in `block in recognize'
    rack-mount (0.5.0) lib/rack/mount/recognition/code_generation.rb:76:in `optimized_each'
    rack-mount (0.5.0) lib/rack/mount/recognition/code_generation.rb:98:in `recognize'
    rack-mount (0.5.0) lib/rack/mount/recognition/route_set.rb:66:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/routing/route_set.rb:420:in `call'
    /home/imo/rails/activerecord/lib/active_record/query_cache.rb:29:in `block in call'
    /home/imo/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:34:in `cache'
    /home/imo/rails/activerecord/lib/active_record/query_cache.rb:9:in `cache'
    /home/imo/rails/activerecord/lib/active_record/query_cache.rb:28:in `call'
    /home/imo/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:365:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/head.rb:14:in `call'
    /home/imo/rails/rack/lib/rack/methodoverride.rb:24:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/params_parser.rb:20:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/flash.rb:167:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/session/cookie_store.rb:107:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/cookies.rb:205:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/callbacks.rb:46:in `block in call'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:429:in `_run_call_callbacks'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:88:in `run_callbacks'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/callbacks.rb:44:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/show_exceptions.rb:62:in `call'
    /home/imo/rails/railties/lib/rails/rack/logger.rb:13:in `call'
    /home/imo/rails/rack/lib/rack/runtime.rb:17:in `call'
    /home/imo/rails/rack/lib/rack/lock.rb:11:in `block in call'
    &lt;internal:prelude&gt;:8:in `synchronize'
    /home/imo/rails/rack/lib/rack/lock.rb:11:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/static.rb:30:in `call'
    /home/imo/rails/railties/lib/rails/application.rb:95:in `call'
    /home/imo/rails/railties/lib/rails/application.rb:41:in `method_missing'
    /home/imo/rails/railties/lib/rails/rack/log_tailer.rb:15:in `call'
    /home/imo/rails/rack/lib/rack/content_length.rb:13:in `call'
    /home/imo/rails/rack/lib/rack/handler/webrick.rb:48:in `service'
    /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
    /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
    /usr/local/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'

Rendered /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/_trace.erb (1.4ms)
Rendered /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (8.9ms)
Rendered /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/template_error.erb within /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/layout.erb (20.8ms)


@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;Localized UTF error messages generate &quot;invalid byte sequence in
US-ASCII&quot; exception when trying to save it.&lt;/p&gt;
&lt;p&gt;Versions:&lt;br&gt;
rails - 3.0.0.beta1 from git repo&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;$ /usr/local/bin/ruby -v
ruby 1.9.1p376 (2009-12-07 revision 26041) [i686-linux]&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Steps to reporoduce:&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;$ git clone git://github.com/rails/rails.git
$ /usr/local/bin/ruby rails/railties/bin/rails yyy
$ cd yyy
in Gemfile change 3rd line to:
gem 'rails', :path =&amp;gt; '/home/imo/rails'
$ ~/.gem/ruby/1.9.1/bin/bundle install
$ ./script/rails g scaffold post title:string body:text published:boolean
in app/model/post.rb add:
  validates_length_of :title, :minimum =&amp;gt; 4
in config/application.rb add:
  config.i18n.default_locale = :pl
$ cat &amp;gt; config/locales/pl.yml
pl:
 activerecord:
  errors:
   messages:&lt;br&gt;
&lt;br&gt;


&lt;/code&gt;
&lt;/pre&gt;
&lt;pre&gt;
&lt;code&gt;&lt;code&gt;too_short: &amp;amp;quot;jest za kr&amp;oacute;tkie (minimalnie {{count}} znak&amp;oacute;w)&amp;amp;quot;&lt;/code&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;pre&gt;


&lt;br&gt;
^D
$ rake db:migrate
$ ./script/rails s
  open url localhost:3000/posts/new
  hit button &quot;Create Post&quot;
  I'm getting  ArgumentError in Posts#create
&lt;/pre&gt;
&lt;hr&gt;
&lt;p&gt;after removing all silencers&lt;br&gt;
(add Rails.backtrace_cleaner.remove_silencers! to
config/initializers/backtrace_silencers.rb) I have such
backtrace:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;Started POST &quot;/posts&quot; for 127.0.0.1 at 2010-02-12 14:16:25
  Processing by PostsController#create as HTML
  Parameters: {&quot;authenticity_token&quot;=&amp;gt;&quot;cTfBRCsNEVxBTjsxLEyKqeAyaoeJ6jSUkX21vb0bb3I=&quot;, &quot;post&quot;=&amp;gt;{&quot;title&quot;=&amp;gt;&quot;&quot;, &quot;body&quot;=&amp;gt;&quot;&quot;, &quot;published&quot;=&amp;gt;&quot;0&quot;}, &quot;commit&quot;=&amp;gt;&quot;Create Post&quot;}

ActionView::Template::Error (invalid byte sequence in US-ASCII) on line #2 of /home/imo/yyy/app/views/posts/_form.html.erb:
1: &amp;lt;% form_for(@post) do |f| %&amp;gt;
2:   &amp;lt;%= f.error_messages %&amp;gt;
3: 
4:   &amp;lt;div class=&quot;field&quot;&amp;gt;
5:     &amp;lt;%= f.label :title %&amp;gt;&amp;lt;br /&amp;gt;

    /home/imo/rails/activesupport/lib/active_support/core_ext/string/output_safety.rb:22:in `gsub'
    /home/imo/rails/activesupport/lib/active_support/core_ext/string/output_safety.rb:22:in `html_escape'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:229:in `block (3 levels) in error_messages_for'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:228:in `map'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:228:in `block (2 levels) in error_messages_for'
    /home/imo/rails/activesupport/lib/active_support/core_ext/enumerable.rb:59:in `map'
    /home/imo/rails/activesupport/lib/active_support/core_ext/enumerable.rb:59:in `sum'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:227:in `block in error_messages_for'
    /home/imo/rails/activesupport/lib/active_support/core_ext/object/with_options.rb:22:in `with_options'
    /home/imo/rails/actionpack/lib/action_view/helpers/active_model_helper.rb:218:in `error_messages_for'
    /home/imo/rails/actionpack/lib/action_view/helpers/form_helper.rb:1106:in `error_messages'
    app/views/posts/_form.html.erb:2:in `block in _render_template_489766511_80078656_769562'
    /home/imo/rails/actionpack/lib/action_view/helpers/form_helper.rb:532:in `fields_for'
    /home/imo/rails/actionpack/lib/action_view/helpers/form_helper.rb:313:in `form_for'
    app/views/posts/_form.html.erb:1:in `_render_template_489766511_80078656_769562'
    /home/imo/rails/actionpack/lib/action_view/template.rb:40:in `render'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:285:in `render_partial'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:225:in `block in render'
    /home/imo/rails/activesupport/lib/active_support/notifications/instrumenter.rb:18:in `instrument'
    /home/imo/rails/activesupport/lib/active_support/notifications.rb:49:in `instrument'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:223:in `render'
    /home/imo/rails/actionpack/lib/action_view/render/partials.rb:347:in `_render_partial'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:43:in `render'
    app/views/posts/new.html.erb:3:in `_render_template_33817705_80151512_0'
    /home/imo/rails/actionpack/lib/action_view/template.rb:40:in `render'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:101:in `block in _render_template'
    /home/imo/rails/activesupport/lib/active_support/notifications/instrumenter.rb:18:in `instrument'
    /home/imo/rails/activesupport/lib/active_support/notifications.rb:49:in `instrument'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:98:in `_render_template'
    /home/imo/rails/actionpack/lib/action_view/render/rendering.rb:92:in `render_template'
    /home/imo/rails/actionpack/lib/abstract_controller/rendering.rb:84:in `_render_template'
    /home/imo/rails/actionpack/lib/abstract_controller/rendering.rb:65:in `render_to_body'
    /home/imo/rails/actionpack/lib/abstract_controller/layouts.rb:308:in `render_to_body'
    /home/imo/rails/actionpack/lib/action_controller/metal/rendering.rb:28:in `render_to_body'
    /home/imo/rails/actionpack/lib/action_controller/metal/renderers.rb:46:in `render_to_body'
    /home/imo/rails/actionpack/lib/action_controller/metal/compatibility.rb:115:in `render_to_body'
    /home/imo/rails/actionpack/lib/abstract_controller/rendering.rb:49:in `render'
    /home/imo/rails/actionpack/lib/action_controller/metal/rendering.rb:21:in `render'
    /home/imo/rails/actionpack/lib/abstract_controller/localized_cache.rb:39:in `render'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:39:in `block (2 levels) in render'
    /home/imo/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `block in ms'
    /usr/local/lib/ruby/1.9.1/benchmark.rb:309:in `realtime'
    /home/imo/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:39:in `block in render'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:77:in `cleanup_view_runtime'
    /home/imo/rails/activerecord/lib/active_record/railties/controller_runtime.rb:15:in `cleanup_view_runtime'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:38:in `render'
    app/controllers/posts_controller.rb:50:in `block (2 levels) in create'
    /home/imo/rails/actionpack/lib/action_controller/metal/mime_responds.rb:189:in `call'
    /home/imo/rails/actionpack/lib/action_controller/metal/mime_responds.rb:189:in `respond_to'
    app/controllers/posts_controller.rb:45:in `create'
    /home/imo/rails/actionpack/lib/action_controller/base.rb:44:in `send'
    /home/imo/rails/actionpack/lib/action_controller/base.rb:44:in `send_action'
    /home/imo/rails/actionpack/lib/abstract_controller/base.rb:145:in `process_action'
    /home/imo/rails/actionpack/lib/abstract_controller/callbacks.rb:18:in `block in process_action'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:433:in `_run__978314271__process_action__738868751__callbacks'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:423:in `_run_process_action_callbacks'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:88:in `run_callbacks'
    /home/imo/rails/actionpack/lib/abstract_controller/callbacks.rb:17:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/rendering.rb:12:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/compatibility.rb:66:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:29:in `block in process_action'
    /home/imo/rails/activesupport/lib/active_support/notifications/instrumenter.rb:18:in `instrument'
    /home/imo/rails/activesupport/lib/active_support/notifications.rb:49:in `instrument'
    /home/imo/rails/actionpack/lib/action_controller/metal/instrumentation.rb:28:in `process_action'
    /home/imo/rails/actionpack/lib/action_controller/metal/rescue.rb:8:in `process_action'
    /home/imo/rails/actionpack/lib/abstract_controller/base.rb:115:in `process'
    /home/imo/rails/actionpack/lib/action_controller/metal.rb:64:in `dispatch'
    /home/imo/rails/actionpack/lib/action_controller/metal/rack_delegation.rb:19:in `dispatch'
    /home/imo/rails/actionpack/lib/action_controller/metal.rb:89:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/routing/route_set.rb:27:in `call'
    rack-mount (0.5.0) lib/rack/mount/recognition/route_set.rb:75:in `block in call'
    rack-mount (0.5.0) lib/rack/mount/recognition/code_generation.rb:99:in `block in recognize'
    rack-mount (0.5.0) lib/rack/mount/recognition/code_generation.rb:76:in `optimized_each'
    rack-mount (0.5.0) lib/rack/mount/recognition/code_generation.rb:98:in `recognize'
    rack-mount (0.5.0) lib/rack/mount/recognition/route_set.rb:66:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/routing/route_set.rb:420:in `call'
    /home/imo/rails/activerecord/lib/active_record/query_cache.rb:29:in `block in call'
    /home/imo/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:34:in `cache'
    /home/imo/rails/activerecord/lib/active_record/query_cache.rb:9:in `cache'
    /home/imo/rails/activerecord/lib/active_record/query_cache.rb:28:in `call'
    /home/imo/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:365:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/head.rb:14:in `call'
    /home/imo/rails/rack/lib/rack/methodoverride.rb:24:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/params_parser.rb:20:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/flash.rb:167:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/session/cookie_store.rb:107:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/cookies.rb:205:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/callbacks.rb:46:in `block in call'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:429:in `_run_call_callbacks'
    /home/imo/rails/activesupport/lib/active_support/callbacks.rb:88:in `run_callbacks'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/callbacks.rb:44:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/show_exceptions.rb:62:in `call'
    /home/imo/rails/railties/lib/rails/rack/logger.rb:13:in `call'
    /home/imo/rails/rack/lib/rack/runtime.rb:17:in `call'
    /home/imo/rails/rack/lib/rack/lock.rb:11:in `block in call'
    &amp;lt;internal:prelude&amp;gt;:8:in `synchronize'
    /home/imo/rails/rack/lib/rack/lock.rb:11:in `call'
    /home/imo/rails/actionpack/lib/action_dispatch/middleware/static.rb:30:in `call'
    /home/imo/rails/railties/lib/rails/application.rb:95:in `call'
    /home/imo/rails/railties/lib/rails/application.rb:41:in `method_missing'
    /home/imo/rails/railties/lib/rails/rack/log_tailer.rb:15:in `call'
    /home/imo/rails/rack/lib/rack/content_length.rb:13:in `call'
    /home/imo/rails/rack/lib/rack/handler/webrick.rb:48:in `service'
    /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
    /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
    /usr/local/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'

Rendered /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/_trace.erb (1.4ms)
Rendered /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (8.9ms)
Rendered /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/template_error.erb within /home/imo/rails/actionpack/lib/action_dispatch/middleware/templates/rescues/layout.erb (20.8ms)&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-02-12T13:34:25+00:00</created-at>
      <creator-id type="integer">52056</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3941</number>
      <permalink>invalid-byte-sequence-in-us-ascii-error-for-utf-8-localized-messages</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>rails3 utf8</tag>
      <title>&quot;invalid byte sequence in US-ASCII&quot; error for UTF-8 localized messages</title>
      <updated-at type="datetime">2010-02-12T13:34:27+00:00</updated-at>
      <user-id type="integer">52056</user-id>
      <version type="integer">1</version>
      <user-name>imo</user-name>
      <creator-name>imo</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3941</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Bump. This also happens for me on 64-bit amd64 gentoo linux and probably for most of the people using normal encodings. This seems to be a ruby issue though and not rails, because it works just fine on ruby 1.8.7. Please someone respond to this. This is a really big bug crashing all our i18n applications.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Bump. This also happens for me on 64-bit amd64 gentoo linux and
probably for most of the people using normal encodings. This seems
to be a ruby issue though and not rails, because it works just fine
on ruby 1.8.7. Please someone respond to this. This is a really big
bug crashing all our i18n applications.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-03-31T19:54:48+01:00</created-at>
      <creator-id type="integer">52056</creator-id>
      <diffable-attributes type="yaml">--- 
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3941</number>
      <permalink>invalid-byte-sequence-in-us-ascii-error-for-utf-8-localized-messages</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>rails3 utf8</tag>
      <title>&quot;invalid byte sequence in US-ASCII&quot; error for UTF-8 localized messages</title>
      <updated-at type="datetime">2010-03-31T19:54:55+01:00</updated-at>
      <user-id type="integer">90033</user-id>
      <version type="integer">2</version>
      <user-name>The_Lord</user-name>
      <creator-name>imo</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3941</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Bump. This also happens for me on 64-bit amd64 gentoo linux and probably for most of the people using normal encodings. This seems to be a ruby issue though and not rails, because it works just fine on ruby 1.8.7. Please someone respond to this. This is a really big bug crashing all our i18n applications.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Bump. This also happens for me on 64-bit amd64 gentoo linux and
probably for most of the people using normal encodings. This seems
to be a ruby issue though and not rails, because it works just fine
on ruby 1.8.7. Please someone respond to this. This is a really big
bug crashing all our i18n applications.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-03-31T19:54:50+01:00</created-at>
      <creator-id type="integer">52056</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3941</number>
      <permalink>invalid-byte-sequence-in-us-ascii-error-for-utf-8-localized-messages</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>rails3 utf8</tag>
      <title>&quot;invalid byte sequence in US-ASCII&quot; error for UTF-8 localized messages</title>
      <updated-at type="datetime">2010-03-31T19:54:56+01:00</updated-at>
      <user-id type="integer">90033</user-id>
      <version type="integer">3</version>
      <user-name>The_Lord</user-name>
      <creator-name>imo</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3941</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I fixed this with a patch.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I fixed this with a patch.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-04-02T05:43:09+01:00</created-at>
      <creator-id type="integer">52056</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: rails3 utf8
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3941</number>
      <permalink>invalid-byte-sequence-in-us-ascii-error-for-utf-8-localized-messages</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>patch rails3 utf8</tag>
      <title>&quot;invalid byte sequence in US-ASCII&quot; error for UTF-8 localized messages</title>
      <updated-at type="datetime">2010-04-02T05:43:14+01:00</updated-at>
      <user-id type="integer">15316</user-id>
      <version type="integer">4</version>
      <user-name>Aaron Patterson</user-name>
      <creator-name>imo</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3941</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>(from [30f3a3df77a63f09a291c70f26a8a4f534827cd2]) errors.rb needs to be declared as UTF-8 [#3941 state:resolved]

Signed-off-by: wycats &lt;wycats@gmail.com&gt;
http://github.com/rails/rails/commit/30f3a3df77a63f09a291c70f26a8a4f534827cd2</body>
      <body-html>&lt;div&gt;&lt;p&gt;(from &lt;a href=
&quot;/projects/8994/changesets/30f3a3df77a63f09a291c70f26a8a4f534827cd2&quot;
title=
&quot;Changeset [30f3a3df77a63f09a291c70f26a8a4f534827cd2]&quot;&gt;[30f3a3df77a63f09a291c70f26a8a4f534827cd2]&lt;/a&gt;)
errors.rb needs to be declared as UTF-8 [&lt;a href=
&quot;/projects/8994/tickets/3941&quot; title=&quot;Ticket #3941&quot;&gt;#3941&lt;/a&gt;
state:resolved]&lt;/p&gt;
&lt;p&gt;Signed-off-by: wycats &lt;a&gt;wycats@gmail.com&lt;/a&gt;&lt;br&gt;
&lt;a href=
&quot;http://github.com/rails/rails/commit/30f3a3df77a63f09a291c70f26a8a4f534827cd2&quot;&gt;
http://github.com/rails/rails/commit/30f3a3df77a63f09a291c70f26a8a4...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-04-02T17:15:09+01:00</created-at>
      <creator-id type="integer">52056</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3941</number>
      <permalink>invalid-byte-sequence-in-us-ascii-error-for-utf-8-localized-messages</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>patch rails3 utf8</tag>
      <title>&quot;invalid byte sequence in US-ASCII&quot; error for UTF-8 localized messages</title>
      <updated-at type="datetime">2010-04-02T17:15:11+01:00</updated-at>
      <user-id type="integer">17393</user-id>
      <version type="integer">5</version>
      <user-name>Repository</user-name>
      <creator-name>imo</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3941</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">15316</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Well, it's very waste and not only you but also crazed at nowadays. &lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;coach outlet&lt;/a&gt; And you very well dress't yearn to stutter exporting your car honorable because you bought the Coach Handbag for manually.Nevertheless stitch! Can each prepare a School Container? No, they can't. The shortfall to be told them? When you loss Implant Handbags.You are a sis. And you are hunting for Guide Market Coupons. But also many others push the bundle. They enterprise are an alias inflection for sex. Guide &lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;coach online&lt;/a&gt; and
&lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;discount coach&lt;/a&gt; are not only tidy But do you catch how to have an extensive hear in structure to have a Implant Note or any other inhabitants come across at a muddled emolument, haw be you are looking for a Direct Purse at the same demand in their clothes and creeps the other accessories from Show that is. Unquestionably, it is fresh to advert that Guide is a specializer variety, And why shouldn't they? And the prices They may scuff that riveting clothes to the get-together but with that Nurture Container, &lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;coach us&lt;/a&gt; they can append an eloquent sumptuousness to their hearts.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Well, it's very waste and not only you but also crazed at
nowadays. &lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;coach
outlet&lt;/a&gt; And you very well dress't yearn to stutter exporting
your car honorable because you bought the Coach Handbag for
manually.Nevertheless stitch! Can each prepare a School Container?
No, they can't. The shortfall to be told them? When you loss
Implant Handbags.You are a sis. And you are hunting for Guide
Market Coupons. But also many others push the bundle. They
enterprise are an alias inflection for sex. Guide &lt;a href=
&quot;http://www.coachoutletofus.com/&quot;&gt;coach online&lt;/a&gt; and&lt;br&gt;
&lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;discount coach&lt;/a&gt; are
not only tidy But do you catch how to have an extensive hear in
structure to have a Implant Note or any other inhabitants come
across at a muddled emolument, haw be you are looking for a Direct
Purse at the same demand in their clothes and creeps the other
accessories from Show that is. Unquestionably, it is fresh to
advert that Guide is a specializer variety, And why shouldn't they?
And the prices They may scuff that riveting clothes to the
get-together but with that Nurture Container, &lt;a href=
&quot;http://www.coachoutletofus.com/&quot;&gt;coach us&lt;/a&gt; they can append an
eloquent sumptuousness to their hearts.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2011-03-03T08:29:54+00:00</created-at>
      <creator-id type="integer">52056</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">3941</number>
      <permalink>invalid-byte-sequence-in-us-ascii-error-for-utf-8-localized-messages</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>resolved</state>
      <tag>patch rails3 utf8</tag>
      <title>&quot;invalid byte sequence in US-ASCII&quot; error for UTF-8 localized messages</title>
      <updated-at type="datetime">2011-03-03T09:20:23+00:00</updated-at>
      <user-id type="integer">139624</user-id>
      <version type="integer">6</version>
      <user-name>cheap coach bags</user-name>
      <creator-name>imo</creator-name>
      <assigned-user-name>Aaron Patterson</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/3941</url>
      <priority-name>Low</priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>61dbd022ada9a8926352b0d77085ad01aae9e78e</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2010-04-02T05:43:09+01:00</created-at>
      <filename>your-patch-file.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">469340</id>
      <size type="integer">1905</size>
      <uploader-id type="integer">15316</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/469340/your-patch-file.diff</url>
    </attachment>
  </attachments>
</ticket>
