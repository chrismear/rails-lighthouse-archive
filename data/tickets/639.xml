<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">1366</assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2011-03-03T09:20:24+00:00</created-at>
  <creator-id type="integer">8721</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">9903</milestone-id>
  <number type="integer">639</number>
  <permalink>memory-cache-storage-cache_classes-false-weirdness</permalink>
  <priority type="integer">121</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>invalid</state>
  <tag nil="true"></tag>
  <title>Memory cache storage + (cache_classes = false) = Weirdness</title>
  <updated-at type="datetime">2011-03-26T02:45:42+00:00</updated-at>
  <user-id type="integer">142823</user-id>
  <version type="integer">17</version>
  <user-name>bingbing</user-name>
  <creator-name>David Dollar</creator-name>
  <assigned-user-name>Pratik</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/639</url>
  <milestone-title>2.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>Patch included:

creates a 'Development' cache storage that changes behavior based on the 
cache_classes setting

When cache_classes is set to fault, much weirdness
happens by keeping instances of objects in memory
and then wiping/reloading their class definitions
out from underneath them. This patch creates a
&quot;Development&quot; store that is used by default in the
development environment that forces cache misses
when cache_classes = false</original-body>
  <latest-body>Patch included:

creates a 'Development' cache storage that changes behavior based on the 
cache_classes setting

When cache_classes is set to fault, much weirdness
happens by keeping instances of objects in memory
and then wiping/reloading their class definitions
out from underneath them. This patch creates a
&quot;Development&quot; store that is used by default in the
development environment that forces cache misses
when cache_classes = false</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;
Patch included:
&lt;/p&gt;&lt;p&gt;
creates a 'Development' cache storage that changes behavior based on the
&lt;/p&gt;&lt;p&gt;
cache_classes setting
&lt;/p&gt;&lt;p&gt;
When cache_classes is set to fault, much weirdness
&lt;/p&gt;&lt;p&gt;
happens by keeping instances of objects in memory
&lt;/p&gt;&lt;p&gt;
and then wiping/reloading their class definitions
&lt;/p&gt;&lt;p&gt;
out from underneath them. This patch creates a
&lt;/p&gt;&lt;p&gt;
&quot;Development&quot; store that is used by default in the
&lt;/p&gt;&lt;p&gt;
development environment that forces cache misses
&lt;/p&gt;&lt;p&gt;
when cache_classes = false
&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Patch included:

creates a 'Development' cache storage that changes behavior based on the cache_classes setting

When cache_classes is set to false, much weirdness happens by keeping instances of objects in memory and then wiping/reloading their class definitions out from underneath them. This patch creates a &quot;Development&quot; store that is used by default in the development environment that forces cache misses when cache_classes = false</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Patch included:
&lt;/p&gt;&lt;p&gt;
creates a 'Development' cache storage that changes behavior based on the cache_classes setting
&lt;/p&gt;&lt;p&gt;
When cache_classes is set to false, much weirdness happens by keeping instances of objects in memory and then wiping/reloading their class definitions out from underneath them. This patch creates a &quot;Development&quot; store that is used by default in the development environment that forces cache misses when cache_classes = false
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-07-17T04:52:10+01:00</created-at>
      <creator-id type="integer">8721</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">639</number>
      <permalink>memory-cache-storage-cache_classes-false-weirdness</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>activesupport patch railties</tag>
      <title>Memory cache storage + (cache_classes = false) = Weirdness</title>
      <updated-at type="datetime">2008-07-17T04:52:10+01:00</updated-at>
      <user-id type="integer">8721</user-id>
      <version type="integer">1</version>
      <user-name>David Dollar</user-name>
      <creator-name>David Dollar</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/639</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>This would only happen if perform_caching is set to true in development mode. Right ?</body>
      <body-html>&lt;div&gt;&lt;p&gt;
This would only happen if perform_caching is set to true in development mode. Right ?
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-07-18T01:33:26+01:00</created-at>
      <creator-id type="integer">8721</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">639</number>
      <permalink>memory-cache-storage-cache_classes-false-weirdness</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>activesupport patch railties</tag>
      <title>Memory cache storage + (cache_classes = false) = Weirdness</title>
      <updated-at type="datetime">2008-07-18T01:33:26+01:00</updated-at>
      <user-id type="integer">1366</user-id>
      <version type="integer">2</version>
      <user-name>Pratik</user-name>
      <creator-name>David Dollar</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/639</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>If not, could you please post a test case or something ?

Thanks.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
If not, could you please post a test case or something ?
&lt;/p&gt;&lt;p&gt;
Thanks.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-07-18T01:33:53+01:00</created-at>
      <creator-id type="integer">8721</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">639</number>
      <permalink>memory-cache-storage-cache_classes-false-weirdness</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>activesupport patch railties</tag>
      <title>Memory cache storage + (cache_classes = false) = Weirdness</title>
      <updated-at type="datetime">2008-07-18T01:33:53+01:00</updated-at>
      <user-id type="integer">1366</user-id>
      <version type="integer">3</version>
      <user-name>Pratik</user-name>
      <creator-name>David Dollar</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/639</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>It happens with default settings when using Rails.cache

It may be hard to generate a test case since the problem spans both  
activesupport and actionpack but I'll try.

--
David Dollar
ddollar@gmail.com

On Jul 17, 2008, at 8:33 PM, Lighthouse &lt;support@lighthouseapp.com&gt;  
wrote:</body>
      <body-html>&lt;div&gt;&lt;p&gt;
It happens with default settings when using Rails.cache
&lt;/p&gt;&lt;p&gt;
It may be hard to generate a test case since the problem spans both
&lt;/p&gt;&lt;p&gt;
activesupport and actionpack but I'll try.
&lt;/p&gt;&lt;p&gt;
--
&lt;/p&gt;&lt;p&gt;
David Dollar
&lt;/p&gt;&lt;p&gt;
&lt;a href=&quot;mailto:ddollar@gmail.com&quot;&gt;ddollar@gmail.com&lt;/a&gt;
&lt;/p&gt;&lt;p&gt;
On Jul 17, 2008, at 8:33 PM, Lighthouse 
&lt;/p&gt;&lt;p&gt;
wrote:
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-07-18T02:15:07+01:00</created-at>
      <creator-id type="integer">8721</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">639</number>
      <permalink>memory-cache-storage-cache_classes-false-weirdness</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>activesupport patch railties</tag>
      <title>Memory cache storage + (cache_classes = false) = Weirdness</title>
      <updated-at type="datetime">2008-07-18T02:15:07+01:00</updated-at>
      <user-id type="integer">8721</user-id>
      <version type="integer">4</version>
      <user-name>David Dollar</user-name>
      <creator-name>David Dollar</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/639</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Or just paste me the relevant controller/action code from a rails app. Doesn't have to be a test case in Rails test suite.

Thanks.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Or just paste me the relevant controller/action code from a rails app. Doesn't have to be a test case in Rails test suite.
&lt;/p&gt;&lt;p&gt;
Thanks.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-07-18T02:24:10+01:00</created-at>
      <creator-id type="integer">8721</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">639</number>
      <permalink>memory-cache-storage-cache_classes-false-weirdness</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>activesupport patch railties</tag>
      <title>Memory cache storage + (cache_classes = false) = Weirdness</title>
      <updated-at type="datetime">2008-07-18T02:24:10+01:00</updated-at>
      <user-id type="integer">1366</user-id>
      <version type="integer">5</version>
      <user-name>Pratik</user-name>
      <creator-name>David Dollar</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/639</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Information about reproducing the failure is here:

http://pastie.org/236503</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Information about reproducing the failure is here:
&lt;/p&gt;&lt;p&gt;
&lt;a href=&quot;http://pastie.org/236503&quot;&gt;http://pastie.org/236503&lt;/a&gt;
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-07-18T15:54:18+01:00</created-at>
      <creator-id type="integer">8721</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">639</number>
      <permalink>memory-cache-storage-cache_classes-false-weirdness</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>activesupport patch railties</tag>
      <title>Memory cache storage + (cache_classes = false) = Weirdness</title>
      <updated-at type="datetime">2008-07-18T15:54:18+01:00</updated-at>
      <user-id type="integer">8721</user-id>
      <version type="integer">6</version>
      <user-name>David Dollar</user-name>
      <creator-name>David Dollar</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/639</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Not sure why this is marked invalid. This behavior is clearly still happening in edge. David Dollar stated the problem clearly above, but I'll try again to make the case...

Given the following conditions, common to a dev environment:

* config.cache_classes = false
* config.action_controller.perform_caching = false
* (:memory_store selected by default)

If you attempt to use Rails.cache.fetch in your application, like this:

@@@ ruby

def index
  @authors = Rails.cache.fetch(:authors) { Author.find(:all) }
end

@@@

You will get errors after the first request, either `create_time_zone_conversion...` or `stack level too deep` errors (depending on the complexity of your app). These are caused by the combination of Rails.cache caching + cache_classes = false.

My impression is that when `perform_caching = false`, caching should not actually be performed, and `cache.read` should return nil. This is not the case, as David Dollar points out above.

There are two problems here:
1. `perform_caching = false` performs caching, which causes problems if cache_classes is off
2. The case of `perform_caching = true` but `cache_classes = false`

It seems we could solve 1. without yet solving 2. In #785 Ryan Bates pointed this out, but the thread was then distracted by the (2) issue.

Many other tickets (#785, #1290, #1339) talk around this issue but seem to get distracted by the class continuity/caching issue. It's certainly a frustrating issue for anyone trying to add &quot;Rails.cache.fetch&quot;-style caching in the development environment.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Not sure why this is marked invalid. This behavior is clearly
still happening in edge. David Dollar stated the problem clearly
above, but I'll try again to make the case...&lt;/p&gt;
&lt;p&gt;Given the following conditions, common to a dev environment:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;config.cache_classes = false&lt;/li&gt;
&lt;li&gt;config.action_controller.perform_caching = false&lt;/li&gt;
&lt;li&gt;(:memory_store selected by default)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If you attempt to use Rails.cache.fetch in your application,
like this:&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;

def index
  @authors = Rails.cache.fetch(:authors) { Author.find(:all) }
end

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You will get errors after the first request, either
&lt;code&gt;create_time_zone_conversion...&lt;/code&gt; or &lt;code&gt;stack level
too deep&lt;/code&gt; errors (depending on the complexity of your app).
These are caused by the combination of Rails.cache caching +
cache_classes = false.&lt;/p&gt;
&lt;p&gt;My impression is that when &lt;code&gt;perform_caching = false&lt;/code&gt;,
caching should not actually be performed, and
&lt;code&gt;cache.read&lt;/code&gt; should return nil. This is not the case, as
David Dollar points out above.&lt;/p&gt;
&lt;p&gt;There are two problems here: 1. &lt;code&gt;perform_caching =
false&lt;/code&gt; performs caching, which causes problems if
cache_classes is off 2. The case of &lt;code&gt;perform_caching =
true&lt;/code&gt; but &lt;code&gt;cache_classes = false&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;It seems we could solve 1. without yet solving 2. In &lt;a href=&quot;/projects/8994/tickets/785&quot; title=&quot;Ticket #785&quot;&gt;#785&lt;/a&gt; Ryan
Bates pointed this out, but the thread was then distracted by the
(2) issue.&lt;/p&gt;
&lt;p&gt;Many other tickets (#785, &lt;a href=&quot;/projects/8994/tickets/1290&quot; title=&quot;Ticket #1290&quot;&gt;#1290&lt;/a&gt;, &lt;a href=&quot;/projects/8994/tickets/1339&quot; title=&quot;Ticket #1339&quot;&gt;#1339&lt;/a&gt;) talk
around this issue but seem to get distracted by the class
continuity/caching issue. It's certainly a frustrating issue for
anyone trying to add &quot;Rails.cache.fetch&quot;-style caching in the
development environment.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-11-11T21:20:40+00:00</created-at>
      <creator-id type="integer">8721</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">639</number>
      <permalink>memory-cache-storage-cache_classes-false-weirdness</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>activesupport patch railties</tag>
      <title>Memory cache storage + (cache_classes = false) = Weirdness</title>
      <updated-at type="datetime">2009-03-11T03:10:26+00:00</updated-at>
      <user-id type="integer">22427</user-id>
      <version type="integer">7</version>
      <user-name>David Reese</user-name>
      <creator-name>David Dollar</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/639</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>darn formatting. attaching rest of last comment below.


You will get errors after the first request, either `create_time_zone_conversion...` or `stack level too deep` errors (depending on the complexity of your app). These are caused by the combination of Rails.cache caching + cache_classes = false.

My impression is that when `perform_caching = false`, caching should not actually be performed, and `cache.read` should return nil. This is not the case, as David Dollar points out above.

There are two problems here:
1. `perform_caching = false` performs caching, which causes problems if cache_classes is off
2. The case of `perform_caching = true` but `cache_classes = false`

It seems we could solve 1. without yet solving 2. In #785 Ryan Bates pointed this out, but the thread was then distracted by the (2) issue.

Many other tickets (#785, #1290, #1339) talk around this issue but seem to get distracted by the class continuity/caching issue. It's certainly a frustrating issue for anyone trying to add &quot;Rails.cache.fetch&quot;-style caching in the development environment.</body>
      <body-html>&lt;div&gt;&lt;p&gt;darn formatting. attaching rest of last comment below.&lt;/p&gt;
&lt;p&gt;You will get errors after the first request, either
&lt;code&gt;create_time_zone_conversion...&lt;/code&gt; or &lt;code&gt;stack level
too deep&lt;/code&gt; errors (depending on the complexity of your app).
These are caused by the combination of Rails.cache caching +
cache_classes = false.&lt;/p&gt;
&lt;p&gt;My impression is that when &lt;code&gt;perform_caching = false&lt;/code&gt;,
caching should not actually be performed, and
&lt;code&gt;cache.read&lt;/code&gt; should return nil. This is not the case, as
David Dollar points out above.&lt;/p&gt;
&lt;p&gt;There are two problems here: 1. &lt;code&gt;perform_caching =
false&lt;/code&gt; performs caching, which causes problems if
cache_classes is off 2. The case of &lt;code&gt;perform_caching =
true&lt;/code&gt; but &lt;code&gt;cache_classes = false&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;It seems we could solve 1. without yet solving 2. In &lt;a href=&quot;/projects/8994/tickets/785&quot; title=&quot;Ticket #785&quot;&gt;#785&lt;/a&gt; Ryan
Bates pointed this out, but the thread was then distracted by the
(2) issue.&lt;/p&gt;
&lt;p&gt;Many other tickets (#785, &lt;a href=&quot;/projects/8994/tickets/1290&quot; title=&quot;Ticket #1290&quot;&gt;#1290&lt;/a&gt;, &lt;a href=&quot;/projects/8994/tickets/1339&quot; title=&quot;Ticket #1339&quot;&gt;#1339&lt;/a&gt;) talk
around this issue but seem to get distracted by the class
continuity/caching issue. It's certainly a frustrating issue for
anyone trying to add &quot;Rails.cache.fetch&quot;-style caching in the
development environment.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-11-11T23:02:36+00:00</created-at>
      <creator-id type="integer">8721</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">639</number>
      <permalink>memory-cache-storage-cache_classes-false-weirdness</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>activesupport patch railties</tag>
      <title>Memory cache storage + (cache_classes = false) = Weirdness</title>
      <updated-at type="datetime">2008-11-11T23:02:38+00:00</updated-at>
      <user-id type="integer">22427</user-id>
      <version type="integer">8</version>
      <user-name>David Reese</user-name>
      <creator-name>David Dollar</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/639</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>For anyone that happens to run across this ticket later:

If you use  

@@@ ruby
@authors = cache(:authors) { Author.find(:all) }
@@@

the problem goes away.</body>
      <body-html>&lt;div&gt;&lt;p&gt;For anyone that happens to run across this ticket later:&lt;/p&gt;
&lt;p&gt;If you use&lt;br&gt;&lt;/p&gt;


&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;
@authors = cache(:authors) { Author.find(:all) }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;the problem goes away.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-03-11T04:11:30+00:00</created-at>
      <creator-id type="integer">8721</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">639</number>
      <permalink>memory-cache-storage-cache_classes-false-weirdness</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>activesupport patch railties</tag>
      <title>Memory cache storage + (cache_classes = false) = Weirdness</title>
      <updated-at type="datetime">2009-03-11T05:06:32+00:00</updated-at>
      <user-id type="integer">8721</user-id>
      <version type="integer">9</version>
      <user-name>David Dollar</user-name>
      <creator-name>David Dollar</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/639</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Thanks David for posting that work around.  I can confirm that it works, even with memcached parameters like :expires_in.

For example you can convert this:

@@@
@region = Rails.cache.fetch(current_subdomain, :expires_in=&gt;1.week) do
  Region.find_by_subdomain(current_subdomain)
end
@@@

to this:

@@@
@region = cache(current_subdomain, :expires_in=&gt;1.week) do
  Region.find_by_subdomain(current_subdomain)
end
@@@

And it will start working again.

This is a pretty big problem and I agree with David Reese, I don't think it should be marked invalid.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Thanks David for posting that work around. I can confirm that it
works, even with memcached parameters like :expires_in.&lt;/p&gt;
&lt;p&gt;For example you can convert this:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;@region = Rails.cache.fetch(current_subdomain, :expires_in=&amp;gt;1.week) do
  Region.find_by_subdomain(current_subdomain)
end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;to this:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;@region = cache(current_subdomain, :expires_in=&amp;gt;1.week) do
  Region.find_by_subdomain(current_subdomain)
end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;And it will start working again.&lt;/p&gt;
&lt;p&gt;This is a pretty big problem and I agree with David Reese, I
don't think it should be marked invalid.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-07-25T12:45:04+01:00</created-at>
      <creator-id type="integer">8721</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">639</number>
      <permalink>memory-cache-storage-cache_classes-false-weirdness</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>activesupport patch railties</tag>
      <title>Memory cache storage + (cache_classes = false) = Weirdness</title>
      <updated-at type="datetime">2009-07-25T12:45:09+01:00</updated-at>
      <user-id type="integer">57403</user-id>
      <version type="integer">10</version>
      <user-name>Brian Armstrong</user-name>
      <creator-name>David Dollar</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/639</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Automatic cleanup of spam.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Automatic cleanup of spam.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-10-09T21:46:32+01:00</created-at>
      <creator-id type="integer">8721</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: activesupport patch railties
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">639</number>
      <permalink>memory-cache-storage-cache_classes-false-weirdness</permalink>
      <priority type="integer">121</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag nil="true"></tag>
      <title>Memory cache storage + (cache_classes = false) = Weirdness</title>
      <updated-at type="datetime">2010-10-09T21:46:34+01:00</updated-at>
      <user-id type="integer">14998</user-id>
      <version type="integer">12</version>
      <user-name>Ryan Bigg</user-name>
      <creator-name>David Dollar</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/639</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Automatic cleanup of spam.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Automatic cleanup of spam.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-11-07T16:51:34+00:00</created-at>
      <creator-id type="integer">8721</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">639</number>
      <permalink>memory-cache-storage-cache_classes-false-weirdness</permalink>
      <priority type="integer">121</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag nil="true"></tag>
      <title>Memory cache storage + (cache_classes = false) = Weirdness</title>
      <updated-at type="datetime">2010-11-07T16:51:39+00:00</updated-at>
      <user-id type="integer">94458</user-id>
      <version type="integer">14</version>
      <user-name>Jeff Kreeftmeijer</user-name>
      <creator-name>David Dollar</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/639</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Well, it's very waste and not only you but also crazed at nowadays. &lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;coach outlet&lt;/a&gt; And you very well dress't yearn to stutter exporting your car honorable because you bought the Coach Handbag for manually.Nevertheless stitch! Can each prepare a School Container? No, they can't. The shortfall to be told them? When you loss Implant Handbags.You are a sis. And you are hunting for Guide Market Coupons. But also many others push the bundle. They enterprise are an alias inflection for sex. Guide &lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;coach online&lt;/a&gt; and
&lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;discount coach&lt;/a&gt; are not only tidy But do you catch how to have an extensive hear in structure to have a Implant Note or any other inhabitants come across at a muddled emolument, haw be you are looking for a Direct Purse at the same demand in their clothes and creeps the other accessories from Show that is. Unquestionably, it is fresh to advert that Guide is a specializer variety, And why shouldn't they? And the prices They may scuff that riveting clothes to the get-together but with that Nurture Container, &lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;coach us&lt;/a&gt; they can append an eloquent sumptuousness to their hearts.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Well, it's very waste and not only you but also crazed at
nowadays. &lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;coach
outlet&lt;/a&gt; And you very well dress't yearn to stutter exporting
your car honorable because you bought the Coach Handbag for
manually.Nevertheless stitch! Can each prepare a School Container?
No, they can't. The shortfall to be told them? When you loss
Implant Handbags.You are a sis. And you are hunting for Guide
Market Coupons. But also many others push the bundle. They
enterprise are an alias inflection for sex. Guide &lt;a href=
&quot;http://www.coachoutletofus.com/&quot;&gt;coach online&lt;/a&gt; and&lt;br&gt;
&lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;discount coach&lt;/a&gt; are
not only tidy But do you catch how to have an extensive hear in
structure to have a Implant Note or any other inhabitants come
across at a muddled emolument, haw be you are looking for a Direct
Purse at the same demand in their clothes and creeps the other
accessories from Show that is. Unquestionably, it is fresh to
advert that Guide is a specializer variety, And why shouldn't they?
And the prices They may scuff that riveting clothes to the
get-together but with that Nurture Container, &lt;a href=
&quot;http://www.coachoutletofus.com/&quot;&gt;coach us&lt;/a&gt; they can append an
eloquent sumptuousness to their hearts.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2011-03-03T08:33:10+00:00</created-at>
      <creator-id type="integer">8721</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">639</number>
      <permalink>memory-cache-storage-cache_classes-false-weirdness</permalink>
      <priority type="integer">121</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag nil="true"></tag>
      <title>Memory cache storage + (cache_classes = false) = Weirdness</title>
      <updated-at type="datetime">2011-03-03T09:20:24+00:00</updated-at>
      <user-id type="integer">139624</user-id>
      <version type="integer">15</version>
      <user-name>cheap coach bags</user-name>
      <creator-name>David Dollar</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/639</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Well, it's very waste and not only you but also crazed at nowadays. &lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;coach outlet&lt;/a&gt; And you very well dress't yearn to stutter exporting your car honorable because you bought the Coach Handbag for manually.Nevertheless stitch! Can each prepare a School Container? No, they can't. The shortfall to be told them? When you loss Implant Handbags.You are a sis. And you are hunting for Guide Market Coupons. But also many others push the bundle. They enterprise are an alias inflection for sex. Guide &lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;coach online&lt;/a&gt; and
&lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;discount coach&lt;/a&gt; are not only tidy But do you catch how to have an extensive hear in structure to have a Implant Note or any other inhabitants come across at a muddled emolument, haw be you are looking for a Direct Purse at the same demand in their clothes and creeps the other accessories from Show that is. Unquestionably, it is fresh to advert that Guide is a specializer variety, And why shouldn't they? And the prices They may scuff that riveting clothes to the get-together but with that Nurture Container, &lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;coach us&lt;/a&gt; they can append an eloquent sumptuousness to their hearts.</body>
      <body-html>&lt;div&gt;&lt;p&gt;Well, it's very waste and not only you but also crazed at
nowadays. &lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;coach
outlet&lt;/a&gt; And you very well dress't yearn to stutter exporting
your car honorable because you bought the Coach Handbag for
manually.Nevertheless stitch! Can each prepare a School Container?
No, they can't. The shortfall to be told them? When you loss
Implant Handbags.You are a sis. And you are hunting for Guide
Market Coupons. But also many others push the bundle. They
enterprise are an alias inflection for sex. Guide &lt;a href=
&quot;http://www.coachoutletofus.com/&quot;&gt;coach online&lt;/a&gt; and&lt;br&gt;
&lt;a href=&quot;http://www.coachoutletofus.com/&quot;&gt;discount coach&lt;/a&gt; are
not only tidy But do you catch how to have an extensive hear in
structure to have a Implant Note or any other inhabitants come
across at a muddled emolument, haw be you are looking for a Direct
Purse at the same demand in their clothes and creeps the other
accessories from Show that is. Unquestionably, it is fresh to
advert that Guide is a specializer variety, And why shouldn't they?
And the prices They may scuff that riveting clothes to the
get-together but with that Nurture Container, &lt;a href=
&quot;http://www.coachoutletofus.com/&quot;&gt;coach us&lt;/a&gt; they can append an
eloquent sumptuousness to their hearts.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2011-03-03T08:33:32+00:00</created-at>
      <creator-id type="integer">8721</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">639</number>
      <permalink>memory-cache-storage-cache_classes-false-weirdness</permalink>
      <priority type="integer">121</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag nil="true"></tag>
      <title>Memory cache storage + (cache_classes = false) = Weirdness</title>
      <updated-at type="datetime">2011-03-03T09:20:24+00:00</updated-at>
      <user-id type="integer">139624</user-id>
      <version type="integer">16</version>
      <user-name>cheap coach bags</user-name>
      <creator-name>David Dollar</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/639</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>&lt;b&gt;&lt;a href=&quot;http://www.watcheseshop.com/&quot;&gt;louis vuitton watches&lt;/a&gt;&lt;/b&gt;</body>
      <body-html>&lt;div&gt;&lt;p&gt;&lt;b&gt;&lt;a href=&quot;http://www.watcheseshop.com/&quot;&gt;louis vuitton
watches&lt;/a&gt;&lt;/b&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2011-03-26T02:14:59+00:00</created-at>
      <creator-id type="integer">8721</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">639</number>
      <permalink>memory-cache-storage-cache_classes-false-weirdness</permalink>
      <priority type="integer">121</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag nil="true"></tag>
      <title>Memory cache storage + (cache_classes = false) = Weirdness</title>
      <updated-at type="datetime">2011-03-26T02:45:42+00:00</updated-at>
      <user-id type="integer">142823</user-id>
      <version type="integer">17</version>
      <user-name>bingbing</user-name>
      <creator-name>David Dollar</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/639</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>61c666ee450cf6cb959d8e4994d9cbae877dc60c</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2008-07-17T04:50:43+01:00</created-at>
      <filename>development-cache-store.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">33169</id>
      <size type="integer">3289</size>
      <uploader-id type="integer">8721</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/33169/development-cache-store.diff</url>
    </attachment>
  </attachments>
</ticket>
