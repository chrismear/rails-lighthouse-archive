<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer">1366</assigned-user-id>
  <attachments-count type="integer">0</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2009-01-12T19:42:06+00:00</created-at>
  <creator-id type="integer">15704</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">9903</milestone-id>
  <number type="integer">1739</number>
  <permalink>schema_migrationsversion-is-an-integer-in-test-db</permalink>
  <priority type="integer">1047</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>invalid</state>
  <tag>2.1.1 2.3.5 migrations schema</tag>
  <title>schema_migrations.version is an INTEGER in test db</title>
  <updated-at type="datetime">2010-08-05T20:56:11+01:00</updated-at>
  <user-id type="integer">16475</user-id>
  <version type="integer">3</version>
  <user-name>Ben Woosley</user-name>
  <creator-name>Gaius Centus Novus</creator-name>
  <assigned-user-name>Pratik</assigned-user-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/1739</url>
  <milestone-title>2.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>On MySQL, I'm getting a strange bug in test, but not in dev.  I can run `rake db:migrate` or `rake db:schema:load` just fine.

In test, I get &quot;Mysql::Error: Duplicate entry '2147483647' for key 1: INSERT INTO `ts_schema_migrations` (version) VALUES ('20081008010000').&quot;

On further investigation, the `version` column in `ts_schema_migrations` in my dev database is a `VARCHAR(255)`.  In the test database, it's an `INTEGER`.

WHY???!?!?!?!?</original-body>
  <latest-body>On MySQL, I'm getting a strange bug in test, but not in dev.  I can run `rake db:migrate` or `rake db:schema:load` just fine.

In test, I get &quot;Mysql::Error: Duplicate entry '2147483647' for key 1: INSERT INTO `ts_schema_migrations` (version) VALUES ('20081008010000').&quot;

On further investigation, the `version` column in `ts_schema_migrations` in my dev database is a `VARCHAR(255)`.  In the test database, it's an `INTEGER`.

WHY???!?!?!?!?</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;On MySQL, I'm getting a strange bug in test, but not in dev. I
can run &lt;code&gt;rake db:migrate&lt;/code&gt; or &lt;code&gt;rake
db:schema:load&lt;/code&gt; just fine.&lt;/p&gt;
&lt;p&gt;In test, I get &quot;Mysql::Error: Duplicate entry '2147483647' for
key 1: INSERT INTO &lt;code&gt;ts_schema_migrations&lt;/code&gt; (version)
VALUES ('20081008010000').&quot;&lt;/p&gt;
&lt;p&gt;On further investigation, the &lt;code&gt;version&lt;/code&gt; column in
&lt;code&gt;ts_schema_migrations&lt;/code&gt; in my dev database is a
&lt;code&gt;VARCHAR(255)&lt;/code&gt;. In the test database, it's an
&lt;code&gt;INTEGER&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;WHY???!?!?!?!?&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>On MySQL, I'm getting a strange bug in test, but not in dev.  I can run `rake db:migrate` or `rake db:schema:load` just fine.

In test, I get &quot;Mysql::Error: Duplicate entry '2147483647' for key 1: INSERT INTO `ts_schema_migrations` (version) VALUES ('20081008010000').&quot;

On further investigation, the `version` column in `ts_schema_migrations` in my dev database is a `VARCHAR(255)`.  In the test database, it's an `INTEGER`.

WHY???!?!?!?!?</body>
      <body-html>&lt;div&gt;&lt;p&gt;On MySQL, I'm getting a strange bug in test, but not in dev. I
can run &lt;code&gt;rake db:migrate&lt;/code&gt; or &lt;code&gt;rake
db:schema:load&lt;/code&gt; just fine.&lt;/p&gt;
&lt;p&gt;In test, I get &quot;Mysql::Error: Duplicate entry '2147483647' for
key 1: INSERT INTO &lt;code&gt;ts_schema_migrations&lt;/code&gt; (version)
VALUES ('20081008010000').&quot;&lt;/p&gt;
&lt;p&gt;On further investigation, the &lt;code&gt;version&lt;/code&gt; column in
&lt;code&gt;ts_schema_migrations&lt;/code&gt; in my dev database is a
&lt;code&gt;VARCHAR(255)&lt;/code&gt;. In the test database, it's an
&lt;code&gt;INTEGER&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;WHY???!?!?!?!?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2009-01-12T19:42:07+00:00</created-at>
      <creator-id type="integer">15704</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1739</number>
      <permalink>schema_migrationsversion-is-an-integer-in-test-db</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>2.1.1 migrations schema</tag>
      <title>schema_migrations.version is an INTEGER in test db</title>
      <updated-at type="datetime">2009-01-12T19:42:11+00:00</updated-at>
      <user-id type="integer">15704</user-id>
      <version type="integer">1</version>
      <user-name>Gaius Centus Novus</user-name>
      <creator-name>Gaius Centus Novus</creator-name>
      <assigned-user-name nil="true"></assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1739</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>You should submit a failing test or a patch - http://guides.rails.info/contributing_to_rails.html

Thanks !</body>
      <body-html>&lt;div&gt;&lt;p&gt;You should submit a failing test or a patch - &lt;a href=&quot;http://guides.rails.info/contributing_to_rails.html&quot;&gt;http://guides.rails.info/contrib...&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Thanks !&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2009-03-13T11:08:31+00:00</created-at>
      <creator-id type="integer">15704</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
:assigned_user: 
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1739</number>
      <permalink>schema_migrationsversion-is-an-integer-in-test-db</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>2.1.1 migrations schema</tag>
      <title>schema_migrations.version is an INTEGER in test db</title>
      <updated-at type="datetime">2009-03-13T11:08:32+00:00</updated-at>
      <user-id type="integer">1366</user-id>
      <version type="integer">2</version>
      <user-name>Pratik</user-name>
      <creator-name>Gaius Centus Novus</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1739</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer">1366</assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I ran into the same problem in 2.3.5, and it seems to be an issue with the prefix, as it was resolved once I dropped the prefix and monkey-patched the migrator to look for the prefix-less schema_migrations table. e.g:

    module ActiveRecord
      class Migrator
        class &lt;&lt; self
          def schema_migrations_table_name
            return 'schema_migrations' if Base.connection.table_exists?('schema_migrations')
            Base.table_name_prefix + 'schema_migrations' + Base.table_name_suffix
          end
        end
      end
    end</body>
      <body-html>&lt;div&gt;&lt;p&gt;I ran into the same problem in 2.3.5, and it seems to be an
issue with the prefix, as it was resolved once I dropped the prefix
and monkey-patched the migrator to look for the prefix-less
schema_migrations table. e.g:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;module ActiveRecord
  class Migrator
    class &amp;lt;&amp;lt; self
      def schema_migrations_table_name
        return 'schema_migrations' if Base.connection.table_exists?('schema_migrations')
        Base.table_name_prefix + 'schema_migrations' + Base.table_name_suffix
      end
    end
  end
end&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-08-05T20:56:08+01:00</created-at>
      <creator-id type="integer">15704</creator-id>
      <diffable-attributes type="yaml">--- 
:tag: 2.1.1 migrations schema
:priority: 0
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">1739</number>
      <permalink>schema_migrationsversion-is-an-integer-in-test-db</permalink>
      <priority type="integer">1047</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>2.1.1 2.3.5 migrations schema</tag>
      <title>schema_migrations.version is an INTEGER in test db</title>
      <updated-at type="datetime">2010-08-05T20:56:11+01:00</updated-at>
      <user-id type="integer">16475</user-id>
      <version type="integer">3</version>
      <user-name>Ben Woosley</user-name>
      <creator-name>Gaius Centus Novus</creator-name>
      <assigned-user-name>Pratik</assigned-user-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/1739</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
</ticket>
