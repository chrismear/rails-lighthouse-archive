<html>
<head>
<title>integration</title>
<style>
body {background-color: #F5F5DC}
#banner {margin-top: 0}
pre {font-weight: bold; margin: 0; padding: 0}
pre.stdin {color: #800080; margin-top: 1em; padding: 0}
pre.irb {color: #800080; padding: 0}
pre.stdout {color: #000; padding: 0}
pre.logger {color: #088; padding: 0}
pre.hilight {color: #000; background-color: #FF0; padding: 0}
pre.stderr {color: #F00; padding: 0}
div.body {border-style: solid; border-color: #800080; padding: 0.5em}
.issue, .traceback {background:#FDD; border: 4px solid #F00; 
            font-weight: bold; margin-top: 1em; padding: 0.5em}
div.body, .issue, .traceback {
  -webkit-border-radius: 0.7em; -moz-border-radius: 0.7em;}
ul.toc {list-style: none}
ul a {text-decoration: none}
ul a:hover {text-decoration: underline; color: #000;
            background-color: #F5F5DC}
a.toc h2 {background-color: #981A21; color:#FFF; padding: 6px}
ul a:visited {color: #000}
h2 {clear: both}
p.note {font-style: italic}
p.overview {border-width: 2px; border-color: #000;
  border-style: solid; border-radius: 4em;
  background-color: #CCF; margin: 1.5em 1.5em; padding: 1em 2em; 
-webkit-border-radius: 1.5em; -moz-border-radius: 4em;}
body { background-color: #fff; color: #333; }

body, p, ol, ul, td {
  font-family: verdana, arial, helvetica, sans-serif;
  font-size:   13px;
  line-height: 18px;
}

pre {
  background-color: #eee;
  padding: 10px;
  font-size: 11px;
}

a { color: #000; }
a:visited { color: #666; }
a:hover { color: #fff; background-color:#000; }

div.field, div.actions {
  margin-bottom: 10px;
}

.notice {
  color: green;
}

.fieldWithErrors {
  padding: 2px;
  background-color: red;
  display: table;
}

#errorExplanation {
  width: 400px;
  border: 2px solid red;
  padding: 7px;
  padding-bottom: 12px;
  margin-bottom: 20px;
  background-color: #f0f0f0;
}

#errorExplanation h2 {
  text-align: left;
  font-weight: bold;
  padding: 5px 5px 5px 15px;
  font-size: 12px;
  margin: -7px;
  background-color: #c00;
  color: #fff;
}

#errorExplanation p {
  color: #333;
  margin-bottom: 0;
  padding: 5px;
}

#errorExplanation ul li {
  font-size: 12px;
  list-style: square;
}
</style>
</head><body>
    <a class="toc" id="section-1">
  <h2>Valid Authenticity Token</h2>
</a>
<p class="note">Start with a new project</p>
<pre class="stdin">ruby -rubygems /home/rubys/git/rails/railties/bin/rails testapp</pre>
<pre class="logger">      create  </pre>
<pre class="logger">      create  README</pre>
<pre class="logger">      create  .gitignore</pre>
<pre class="logger">      create  Rakefile</pre>
<pre class="logger">      create  config.ru</pre>
<pre class="logger">      create  Gemfile</pre>
<pre class="logger">      create  app</pre>
<pre class="logger">      create  app/controllers/application_controller.rb</pre>
<pre class="logger">      create  app/helpers/application_helper.rb</pre>
<pre class="logger">      create  app/models</pre>
<pre class="logger">      create  app/views/layouts</pre>
<pre class="logger">      create  config</pre>
<pre class="logger">      create  config/routes.rb</pre>
<pre class="logger">      create  config/application.rb</pre>
<pre class="logger">      create  config/environment.rb</pre>
<pre class="logger">      create  config/environments</pre>
<pre class="logger">      create  config/environments/test.rb</pre>
<pre class="logger">      create  config/environments/production.rb</pre>
<pre class="logger">      create  config/environments/development.rb</pre>
<pre class="logger">      create  config/initializers</pre>
<pre class="logger">      create  config/initializers/backtrace_silencers.rb</pre>
<pre class="logger">      create  config/initializers/mime_types.rb</pre>
<pre class="logger">      create  config/initializers/cookie_verification_secret.rb</pre>
<pre class="logger">      create  config/initializers/inflections.rb</pre>
<pre class="logger">      create  config/initializers/session_store.rb</pre>
<pre class="logger">      create  config/locales</pre>
<pre class="logger">      create  config/locales/en.yml</pre>
<pre class="logger">      create  config/boot.rb</pre>
<pre class="logger">      create  config/database.yml</pre>
<pre class="logger">      create  db</pre>
<pre class="logger">      create  db/seeds.rb</pre>
<pre class="logger">      create  doc</pre>
<pre class="logger">      create  doc/README_FOR_APP</pre>
<pre class="logger">      create  lib</pre>
<pre class="logger">      create  lib/tasks</pre>
<pre class="logger">      create  lib/tasks/.gitkeep</pre>
<pre class="logger">      create  log</pre>
<pre class="logger">      create  log/server.log</pre>
<pre class="logger">      create  log/production.log</pre>
<pre class="logger">      create  log/development.log</pre>
<pre class="logger">      create  log/test.log</pre>
<pre class="logger">      create  public</pre>
<pre class="logger">      create  public/422.html</pre>
<pre class="logger">      create  public/404.html</pre>
<pre class="logger">      create  public/robots.txt</pre>
<pre class="logger">      create  public/500.html</pre>
<pre class="logger">      create  public/index.html</pre>
<pre class="logger">      create  public/favicon.ico</pre>
<pre class="logger">      create  public/images</pre>
<pre class="logger">      create  public/images/rails.png</pre>
<pre class="logger">      create  public/stylesheets</pre>
<pre class="logger">      create  public/stylesheets/.gitkeep</pre>
<pre class="logger">      create  public/javascripts</pre>
<pre class="logger">      create  public/javascripts/controls.js</pre>
<pre class="logger">      create  public/javascripts/rails.js</pre>
<pre class="logger">      create  public/javascripts/application.js</pre>
<pre class="logger">      create  public/javascripts/prototype.js</pre>
<pre class="logger">      create  public/javascripts/effects.js</pre>
<pre class="logger">      create  public/javascripts/dragdrop.js</pre>
<pre class="logger">      create  script</pre>
<pre class="logger">      create  script/rails</pre>
<pre class="logger">      create  test</pre>
<pre class="logger">      create  test/performance/browsing_test.rb</pre>
<pre class="logger">      create  test/test_helper.rb</pre>
<pre class="logger">      create  test/unit</pre>
<pre class="logger">      create  test/fixtures</pre>
<pre class="logger">      create  test/functional</pre>
<pre class="logger">      create  test/integration</pre>
<pre class="logger">      create  tmp</pre>
<pre class="logger">      create  tmp/sessions</pre>
<pre class="logger">      create  tmp/sockets</pre>
<pre class="logger">      create  tmp/cache</pre>
<pre class="logger">      create  tmp/pids</pre>
<pre class="logger">      create  vendor/plugins</pre>
<pre class="logger">      create  vendor/plugins/.gitkeep</pre>
<target/>
<pre class="stdin">bundle install</pre>
<pre class="stdout">Resolving dependencies</pre>
<pre class="stdout">Installing abstract (1.0.0) from system gems </pre>
<pre class="stdout">Installing actionmailer (3.0.0.beta1) from source code at /home/rubys/git/rails </pre>
<pre class="stdout">Installing actionpack (3.0.0.beta1) from source code at /home/rubys/git/rails </pre>
<pre class="stdout">Installing activemodel (3.0.0.beta1) from source code at /home/rubys/git/rails </pre>
<pre class="stdout">Installing activerecord (3.0.0.beta1) from source code at /home/rubys/git/rails </pre>
<pre class="stdout">Installing activeresource (3.0.0.beta1) from source code at /home/rubys/git/rails </pre>
<pre class="stdout">Installing activesupport (3.0.0.beta1) from source code at /home/rubys/git/rails </pre>
<pre class="stdout">Installing arel (0.2.1) from system gems </pre>
<pre class="stdout">Installing builder (2.1.2) from system gems </pre>
<pre class="stdout">Installing bundler (0.9.10) from system gems </pre>
<pre class="stdout">Installing erubis (2.6.5) from system gems </pre>
<pre class="stdout">Installing i18n (0.3.5) from system gems </pre>
<pre class="stdout">Installing mail (2.1.3) from system gems </pre>
<pre class="stdout">Installing memcache-client (1.7.8) from system gems </pre>
<pre class="stdout">Installing mime-types (1.16) from system gems </pre>
<pre class="stdout">Installing rack (1.1.0) from system gems </pre>
<pre class="stdout">Installing rack-mount (0.5.2) from system gems </pre>
<pre class="stdout">Installing rack-test (0.5.3) from system gems </pre>
<pre class="stdout">Installing rails (3.0.0.beta1) from source code at /home/rubys/git/rails </pre>
<pre class="stdout">Installing railties (3.0.0.beta1) from source code at /home/rubys/git/rails </pre>
<pre class="stdout">Installing rake (0.8.7) from system gems </pre>
<pre class="stdout">Installing sqlite3-ruby (1.2.5) from system gems </pre>
<pre class="stdout">Installing text-format (1.0.0) from system gems </pre>
<pre class="stdout">Installing text-hyphen (1.0.0) from system gems </pre>
<pre class="stdout">Installing thor (0.13.4) from system gems </pre>
<pre class="stdout">Installing tzinfo (0.3.16) from system gems </pre>
<pre class="logger">Your bundle is complete!</pre>
<p class="note">About as simple of a scaffold as you can get</p>
<target/>
<pre class="stdin">rails generate scaffold product title:string</pre>
<pre class="logger">      invoke  active_record</pre>
<pre class="logger">      create    db/migrate/20100306014055_create_products.rb</pre>
<pre class="logger">      create    app/models/product.rb</pre>
<pre class="logger">      invoke    test_unit</pre>
<pre class="logger">      create      test/unit/product_test.rb</pre>
<pre class="logger">      create      test/fixtures/products.yml</pre>
<pre class="logger">       route  resources :products</pre>
<pre class="logger">      invoke  scaffold_controller</pre>
<pre class="logger">      create    app/controllers/products_controller.rb</pre>
<pre class="logger">      invoke    erb</pre>
<pre class="logger">      create      app/views/products</pre>
<pre class="logger">      create      app/views/products/index.html.erb</pre>
<pre class="logger">      create      app/views/products/edit.html.erb</pre>
<pre class="logger">      create      app/views/products/show.html.erb</pre>
<pre class="logger">      create      app/views/products/new.html.erb</pre>
<pre class="logger">      create      app/views/products/_form.html.erb</pre>
<pre class="logger">      create      app/views/layouts/products.html.erb</pre>
<pre class="logger">      invoke    test_unit</pre>
<pre class="logger">      create      test/functional/products_controller_test.rb</pre>
<pre class="logger">      invoke    helper</pre>
<pre class="logger">      create      app/helpers/products_helper.rb</pre>
<pre class="logger">      invoke      test_unit</pre>
<pre class="logger">      create        test/unit/helpers/products_helper_test.rb</pre>
<pre class="logger">      invoke  stylesheets</pre>
<pre class="logger">      create    public/stylesheets/scaffold.css</pre>
<target/>
<pre class="stdin">rake db:migrate</pre>
<pre>mv 20100306014055_create_products.rb 20100301000001_create_products.rb</pre>
<pre class="stdout">(in /home/rubys/tmp/work/testapp)</pre>
<pre class="stdout">==  CreateProducts: migrating =================================================</pre>
<pre class="stdout">-- create_table(:products)</pre>
<pre class="stdout">   -&gt; 0.0027s</pre>
<pre class="stdout">==  CreateProducts: migrated (0.0029s) ========================================</pre>
<pre class="stdout"> </pre>
<target/>
<pre class="stdin">rake db:test:prepare</pre>
<pre class="stdout">(in /home/rubys/tmp/work/testapp)</pre>
<p class="note">A very simple integration test</p>
<pre class="stdin">edit test/integration/product_integration_test.rb</pre>
<pre class="hilight">require 'test_helper'</pre>
<pre class="hilight"> </pre>
<pre class="hilight">class ProductIntegrationTest &lt; ActionController::IntegrationTest</pre>
<pre class="hilight">  test 'creating a product' do</pre>
<pre class="hilight">    post_via_redirect '/products', :product =&gt; {:title =&gt; 'Widget'}</pre>
<pre class="hilight">    assert_response :success</pre>
<pre class="hilight">  end</pre>
<pre class="hilight">end</pre>
<p class="note">run it</p>
<target/>
<pre class="stdin">rake test:integration</pre>
<pre class="stdout">(in /home/rubys/tmp/work/testapp)</pre>
<pre class="stdout">Loaded suite /home/rubys/.rvm/gems/ruby-1.8.7-p249%global/gems/rake-0.8.7/lib/rake/rake_test_loader</pre>
<pre class="stdout">Started</pre>
<pre class="stdout">E</pre>
<pre class="stdout">Finished in 0.144512 seconds.</pre>
<pre class="stdout"> </pre>
<pre class="stdout">  1) Error:</pre>
<pre class="stdout">test_creating_a_product(ProductIntegrationTest):</pre>
<pre class="stdout">ActionController::InvalidAuthenticityToken: ActionController::InvalidAuthenticityToken</pre>
<pre class="stdout"> </pre>
<pre class="stdout"> </pre>
<pre class="stdout">1 tests, 0 assertions, 0 failures, 1 errors</pre>
<pre class="stderr">rake aborted!</pre>
<pre class="stderr">Command failed with status (1): [/home/rubys/.rvm/rubies/ruby-1.8.7-p249/bi...]</pre>
<pre class="stderr"></pre>
<pre class="stderr">(See full trace by running task with --trace)</pre>
<pre class="traceback">&lt;/1 tests, 1 assertions, 0 failures, 0 errors/&gt; expected but was
&lt;"(in /home/rubys/tmp/work/testapp)"&gt;.

Traceback:
  /home/rubys/tmp/integration.rb:30
  /home/rubys/git/gorp/lib/gorp/test.rb:156:in `call'
  /home/rubys/git/gorp/lib/gorp/test.rb:156:in `rake'
  /home/rubys/tmp/integration.rb:29</pre>
<a class="toc" id="env">
  <h2>Environment</h2>
</a>
<pre class="stdout">Sat, 06 Mar 2010 01:41:06 GMT</pre>
<pre class="stdin">/home/rubys/.rvm/rubies/ruby-1.8.7-p249/bin/ruby -v</pre>
<pre class="stdout">ruby 1.8.7 (2010-01-10 patchlevel 249) [x86_64-linux]</pre>
<pre class="stdin">gem -v</pre>
<pre class="stdout">1.3.6</pre>
<pre class="stdin">bundle show</pre>
<pre class="stdout">Gems included by the bundle:</pre>
<pre class="stdout">  * abstract (1.0.0)</pre>
<pre class="stdout">  * actionmailer (3.0.0.beta1)</pre>
<pre class="stdout">  * actionpack (3.0.0.beta1)</pre>
<pre class="stdout">  * activemodel (3.0.0.beta1)</pre>
<pre class="stdout">  * activerecord (3.0.0.beta1)</pre>
<pre class="stdout">  * activeresource (3.0.0.beta1)</pre>
<pre class="stdout">  * activesupport (3.0.0.beta1)</pre>
<pre class="stdout">  * arel (0.2.1)</pre>
<pre class="stdout">  * builder (2.1.2)</pre>
<pre class="stdout">  * bundler (0.9.10)</pre>
<pre class="stdout">  * erubis (2.6.5)</pre>
<pre class="stdout">  * i18n (0.3.5)</pre>
<pre class="stdout">  * mail (2.1.3)</pre>
<pre class="stdout">  * memcache-client (1.7.8)</pre>
<pre class="stdout">  * mime-types (1.16)</pre>
<pre class="stdout">  * rack (1.1.0)</pre>
<pre class="stdout">  * rack-mount (0.5.2)</pre>
<pre class="stdout">  * rack-test (0.5.3)</pre>
<pre class="stdout">  * rails (3.0.0.beta1)</pre>
<pre class="stdout">  * railties (3.0.0.beta1)</pre>
<pre class="stdout">  * rake (0.8.7)</pre>
<pre class="stdout">  * sqlite3-ruby (1.2.5)</pre>
<pre class="stdout">  * text-format (1.0.0)</pre>
<pre class="stdout">  * text-hyphen (1.0.0)</pre>
<pre class="stdout">  * thor (0.13.4)</pre>
<pre class="stdout">  * tzinfo (0.3.16)</pre>
<pre class="stdin">rake about</pre>
<pre class="stdout">(in /home/rubys/tmp/work/testapp)</pre>
<pre class="stdout">About your application's environment</pre>
<pre class="stdout">Ruby version              1.8.7 (x86_64-linux)</pre>
<pre class="stdout">RubyGems version          1.3.6</pre>
<pre class="stdout">Rack version              1.1</pre>
<pre class="stdout">Rails version             3.0.0.beta1</pre>
<pre class="stdout">Active Record version     3.0.0.beta1</pre>
<pre class="stdout">Action Pack version       3.0.0.beta1</pre>
<pre class="stdout">Active Resource version   3.0.0.beta1</pre>
<pre class="stdout">Action Mailer version     3.0.0.beta1</pre>
<pre class="stdout">Active Support version    3.0.0.beta1</pre>
<pre class="stdout">Middleware                ActionDispatch::Static, Rack::Lock, Rack::Runtime, Rails::Rack::Logger, ActionDispatch::ShowExceptions, ActionDispatch::RemoteIp, Rack::Sendfile, ActionDispatch::Callbacks, ActionDispatch::Cookies, ActionDispatch::Session::CookieStore, ActionDispatch::Flash, ActionDispatch::ParamsParser, Rack::MethodOverride, ActionDispatch::Head</pre>
<pre class="stdout">Application root          /home/rubys/tmp/work/testapp</pre>
<pre class="stdout">Environment               development</pre>
<pre class="stdin">git log -1</pre>
<pre class="stdout">
commit <a href="http://github.com/rails/rails/commit/67512b9489593ddcd1c0c87ba0052380355b5400">67512b9489593ddcd1c0c87ba0052380355b5400</a></pre>
<pre class="stdout">Author: Stijn Mathysen &lt;stijn@skylight.be&gt;</pre>
<pre class="stdout">Date:   Fri Mar 5 08:04:25 2010 +0100</pre>
<pre class="stdout"></pre>
<pre class="stdout">    Removed the + sign as an accepted character from the parameterize method, as a + sign is interpreted by the browser as a space, possibly resulting in a "ArgumentError: illegal character in key"</pre>
<pre class="stdout">    </pre>
<pre class="stdout">    [#4080 state:committed]</pre>
<pre class="stdout">    </pre>
<pre class="stdout">    Signed-off-by: Jeremy Kemper &lt;jeremy@bitsweat.net&gt;</pre>

  </body>
</html>