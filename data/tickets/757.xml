<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">1</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2008-08-04T19:51:11+01:00</created-at>
  <creator-id type="integer">28037</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer">9903</milestone-id>
  <number type="integer">757</number>
  <permalink>rake-test-wipes-out-the-entire-development-db</permalink>
  <priority type="integer">219</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>duplicate</state>
  <tag>rake tests</tag>
  <title>rake test wipes out the entire development db</title>
  <updated-at type="datetime">2008-08-22T21:24:40+01:00</updated-at>
  <user-id type="integer">14890</user-id>
  <version type="integer">7</version>
  <user-name>Tarmo T&#228;nav</user-name>
  <creator-name>leiyou</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/757</url>
  <milestone-title>2.x</milestone-title>
  <priority-name nil="true"></priority-name>
  <original-body>this happens in rails-2-1-stable, using sqlite3 adaptor, I've applied a temp fix, but i am not sure whether it's the right thing to do.

Thanks guys</original-body>
  <latest-body>this happens in rails-2-1-stable, using sqlite3 adaptor, I've applied a temp fix, but i am not sure whether it's the right thing to do.

Thanks guys</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;
this happens in rails-2-1-stable, using sqlite3 adaptor, I've applied a temp fix, but i am not sure whether it's the right thing to do.
&lt;/p&gt;&lt;p&gt;
Thanks guys
&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>this happens in rails-2-1-stable, using sqlite3 adaptor, I've applied a temp fix, but i am not sure whether it's the right thing to do.

Thanks guys</body>
      <body-html>&lt;div&gt;&lt;p&gt;
this happens in rails-2-1-stable, using sqlite3 adaptor, I've applied a temp fix, but i am not sure whether it's the right thing to do.
&lt;/p&gt;&lt;p&gt;
Thanks guys
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-08-04T19:51:11+01:00</created-at>
      <creator-id type="integer">28037</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">757</number>
      <permalink>rake-test-wipes-out-the-entire-development-db</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>rake tests</tag>
      <title>rake test wipes out the entire development db</title>
      <updated-at type="datetime">2008-08-04T19:51:11+01:00</updated-at>
      <user-id type="integer">28037</user-id>
      <version type="integer">1</version>
      <user-name>leiyou</user-name>
      <creator-name>leiyou</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/757</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Are you certain this problem isn't specific to your application? Check your database.yml file to make sure the test db is different from the development one.

Also make sure this is at the top of your test_helper file to ensure you're running in the test environment.

@@@ ruby
ENV[&quot;RAILS_ENV&quot;] = &quot;test&quot;
@@@</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Are you certain this problem isn't specific to your application? Check your database.yml file to make sure the test db is different from the development one.
&lt;/p&gt;&lt;p&gt;
Also make sure this is at the top of your test_helper file to ensure you're running in the test environment.
&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;ENV[&amp;quot;RAILS_ENV&amp;quot;] = &amp;quot;test&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-08-04T23:59:38+01:00</created-at>
      <creator-id type="integer">28037</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">757</number>
      <permalink>rake-test-wipes-out-the-entire-development-db</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>rake tests</tag>
      <title>rake test wipes out the entire development db</title>
      <updated-at type="datetime">2008-08-04T23:59:38+01:00</updated-at>
      <user-id type="integer">5701</user-id>
      <version type="integer">2</version>
      <user-name>Ryan Bates</user-name>
      <creator-name>leiyou</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/757</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Hi Ryan,

the test db is certainly different from the development, and 
there is a ENV[&quot;RAILS_ENV&quot;] = 'test' on top of test_helper.rb.

the problem happens in the rake task db:test:prepare I believe.</body>
      <body-html>&lt;div&gt;&lt;p&gt;
Hi Ryan,
&lt;/p&gt;&lt;p&gt;
the test db is certainly different from the development, and
&lt;/p&gt;&lt;p&gt;
there is a ENV[&quot;RAILS_ENV&quot;] = 'test' on top of test_helper.rb.
&lt;/p&gt;&lt;p&gt;
the problem happens in the rake task db:test:prepare I believe.
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-08-05T14:23:30+01:00</created-at>
      <creator-id type="integer">28037</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">757</number>
      <permalink>rake-test-wipes-out-the-entire-development-db</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>rake tests</tag>
      <title>rake test wipes out the entire development db</title>
      <updated-at type="datetime">2008-08-05T14:23:30+01:00</updated-at>
      <user-id type="integer">28037</user-id>
      <version type="integer">3</version>
      <user-name>leiyou</user-name>
      <creator-name>leiyou</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/757</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>also, i am on the gem version of rake 0.8.1</body>
      <body-html>&lt;div&gt;&lt;p&gt;
also, i am on the gem version of rake 0.8.1
&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-08-05T14:27:06+01:00</created-at>
      <creator-id type="integer">28037</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">757</number>
      <permalink>rake-test-wipes-out-the-entire-development-db</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>rake tests</tag>
      <title>rake test wipes out the entire development db</title>
      <updated-at type="datetime">2008-08-05T14:27:06+01:00</updated-at>
      <user-id type="integer">28037</user-id>
      <version type="integer">4</version>
      <user-name>leiyou</user-name>
      <creator-name>leiyou</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/757</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>I've run into the exact same problem using Mysql. It looks like it is only an issue on the 2.1 stable branch. The posted change from db:schema:load to db:test:clone works for me. 

Offending commit:
http://github.com/rails/rails/commit/b6d0eba5790552f4c9ef6a1abe0befd8be454ada</body>
      <body-html>&lt;div&gt;&lt;p&gt;I've run into the exact same problem using Mysql. It looks like it is only an issue on the 2.1 stable branch. The posted change from db:schema:load to db:test:clone works for me.&lt;/p&gt;

&lt;p&gt;Offending commit:
&lt;a href=&quot;http://github.com/rails/rails/commit/b6d0eba5790552f4c9ef6a1abe0befd8be454ada&quot;&gt;http://github.com/rails/rails/co...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-08-18T21:01:33+01:00</created-at>
      <creator-id type="integer">28037</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">757</number>
      <permalink>rake-test-wipes-out-the-entire-development-db</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>rake tests</tag>
      <title>rake test wipes out the entire development db</title>
      <updated-at type="datetime">2008-08-18T21:01:33+01:00</updated-at>
      <user-id type="integer">17573</user-id>
      <version type="integer">5</version>
      <user-name>Chris Gaffney</user-name>
      <creator-name>leiyou</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/757</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>This actually looks like a duplicate of #670

http://rails.lighthouseapp.com/projects/8994/tickets/670-loud-migrations-test-db-prep</body>
      <body-html>&lt;div&gt;&lt;p&gt;This actually looks like a duplicate of &lt;a href=&quot;/projects/8994/tickets/670&quot; title=&quot;Ticket #670&quot;&gt;#670&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://rails.lighthouseapp.com/projects/8994/tickets/670-loud-migrations-test-db-prep&quot;&gt;http://rails.lighthouseapp.com/p...&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2008-08-18T21:11:59+01:00</created-at>
      <creator-id type="integer">28037</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">757</number>
      <permalink>rake-test-wipes-out-the-entire-development-db</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>rake tests</tag>
      <title>rake test wipes out the entire development db</title>
      <updated-at type="datetime">2008-08-18T21:11:59+01:00</updated-at>
      <user-id type="integer">17573</user-id>
      <version type="integer">6</version>
      <user-name>Chris Gaffney</user-name>
      <creator-name>leiyou</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/757</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">1</attachments-count>
      <body>Closing as duplicate of #670</body>
      <body-html>&lt;div&gt;&lt;p&gt;Closing as duplicate of &lt;a href=&quot;/projects/8994/tickets/670&quot; title=&quot;Ticket #670&quot;&gt;#670&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2008-08-22T21:24:40+01:00</created-at>
      <creator-id type="integer">28037</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer">9903</milestone-id>
      <number type="integer">757</number>
      <permalink>rake-test-wipes-out-the-entire-development-db</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>duplicate</state>
      <tag>rake tests</tag>
      <title>rake test wipes out the entire development db</title>
      <updated-at type="datetime">2008-08-22T21:24:40+01:00</updated-at>
      <user-id type="integer">14890</user-id>
      <version type="integer">7</version>
      <user-name>Tarmo T&#228;nav</user-name>
      <creator-name>leiyou</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/757</url>
      <milestone-title>2.x</milestone-title>
      <priority-name nil="true"></priority-name>
    </version>
  </versions>
  <attachments type="array">
    <attachment type="Attachment">
      <code>63c598b1a61513595a5b4f989020afbf5ab7bf67</code>
      <content-type>text/plain</content-type>
      <created-at type="datetime">2008-08-04T19:51:11+01:00</created-at>
      <filename>databases.rake.diff</filename>
      <height type="integer" nil="true"></height>
      <id type="integer">36951</id>
      <size type="integer">273</size>
      <uploader-id type="integer">28037</uploader-id>
      <width type="integer" nil="true"></width>
      <url>http://rails.lighthouseapp.com/attachments/36951/databases.rake.diff</url>
    </attachment>
  </attachments>
</ticket>
