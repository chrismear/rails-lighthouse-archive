<?xml version="1.0" encoding="UTF-8"?>
<ticket>
  <assigned-user-id type="integer" nil="true"></assigned-user-id>
  <attachments-count type="integer">0</attachments-count>
  <closed type="boolean">true</closed>
  <created-at type="datetime">2010-08-10T06:30:59+01:00</created-at>
  <creator-id type="integer">64254</creator-id>
  <milestone-due-on type="datetime" nil="true"></milestone-due-on>
  <milestone-id type="integer" nil="true"></milestone-id>
  <number type="integer">5134</number>
  <permalink>delete-method-in-link_to-causes-invalidauthenticitytoken-error</permalink>
  <priority type="integer">3</priority>
  <project-id type="integer">8994</project-id>
  <raw-data type="binary" nil="true" encoding="base64"></raw-data>
  <state>invalid</state>
  <tag>delete link_to</tag>
  <title>Delete method in link_to causes InvalidAuthenticityToken error</title>
  <updated-at type="datetime">2010-09-01T15:27:04+01:00</updated-at>
  <user-id type="integer">36348</user-id>
  <version type="integer">7</version>
  <user-name>Rob Eastham</user-name>
  <creator-name>wout</creator-name>
  <url>http://rails.lighthouseapp.com/projects/8994/tickets/5134</url>
  <priority-name>Low</priority-name>
  <original-body>On one of my apps I recently converted to rails 3 (to be in production next month) I get InvalidAuthenticityToken errors on link_to with :method =&gt; :delete. When the link_to is replaced by a button_to (so when a form is used instead) it works perfectly. I can reproduce it in all other apps as well.

Running Ruby EE 1.8.7, Rails 3 beta4 on Mongrel in osx 10.6.</original-body>
  <latest-body>On one of my apps I recently converted to rails 3 (to be in production next month) I get InvalidAuthenticityToken errors on link_to with :method =&gt; :delete. When the link_to is replaced by a button_to (so when a form is used instead) it works perfectly. I can reproduce it in all other apps as well.

Running Ruby EE 1.8.7, Rails 3 beta4 on Mongrel in osx 10.6.</latest-body>
  <original-body-html>&lt;div&gt;&lt;p&gt;On one of my apps I recently converted to rails 3 (to be in
production next month) I get InvalidAuthenticityToken errors on
link_to with :method =&amp;gt; :delete. When the link_to is replaced by
a button_to (so when a form is used instead) it works perfectly. I
can reproduce it in all other apps as well.&lt;/p&gt;
&lt;p&gt;Running Ruby EE 1.8.7, Rails 3 beta4 on Mongrel in osx 10.6.&lt;/p&gt;&lt;/div&gt;</original-body-html>
  <versions type="array">
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>On one of my apps I recently converted to rails 3 (to be in production next month) I get InvalidAuthenticityToken errors on link_to with :method =&gt; :delete. When the link_to is replaced by a button_to (so when a form is used instead) it works perfectly. I can reproduce it in all other apps as well.

Running Ruby EE 1.8.7, Rails 3 beta4 on Mongrel in osx 10.6.</body>
      <body-html>&lt;div&gt;&lt;p&gt;On one of my apps I recently converted to rails 3 (to be in
production next month) I get InvalidAuthenticityToken errors on
link_to with :method =&amp;gt; :delete. When the link_to is replaced by
a button_to (so when a form is used instead) it works perfectly. I
can reproduce it in all other apps as well.&lt;/p&gt;
&lt;p&gt;Running Ruby EE 1.8.7, Rails 3 beta4 on Mongrel in osx 10.6.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-07-16T20:29:16+01:00</created-at>
      <creator-id type="integer">64254</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5134</number>
      <permalink>delete-method-in-link_to-causes-invalidauthenticitytoken-error</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>delete link_to</tag>
      <title>Delete method in link_to causes InvalidAuthenticityToken error</title>
      <updated-at type="datetime">2010-07-16T20:29:21+01:00</updated-at>
      <user-id type="integer">64254</user-id>
      <version type="integer">1</version>
      <user-name>wout</user-name>
      <creator-name>wout</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5134</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>just posting in here to note that I came across the same issue and also the same fix (using button_to instead of link_to). 
I'm currently running Rails3.0.0rc Ruby 1.9.2dev osx 10.6</body>
      <body-html>&lt;div&gt;&lt;p&gt;just posting in here to note that I came across the same issue
and also the same fix (using button_to instead of link_to).&lt;br&gt;
I'm currently running Rails3.0.0rc Ruby 1.9.2dev osx 10.6&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-09T03:26:29+01:00</created-at>
      <creator-id type="integer">64254</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5134</number>
      <permalink>delete-method-in-link_to-causes-invalidauthenticitytoken-error</permalink>
      <priority type="integer">0</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>delete link_to</tag>
      <title>Delete method in link_to causes InvalidAuthenticityToken error</title>
      <updated-at type="datetime">2010-08-09T03:26:32+01:00</updated-at>
      <user-id type="integer">110716</user-id>
      <version type="integer">2</version>
      <user-name>nathaniel</user-name>
      <creator-name>wout</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5134</url>
      <priority-name nil="true"></priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>Creating a scaffold in RC which has a link_to using the :method =&gt; delete option works fine. The code is &amp;mdash;

@@@ ruby
  &lt;%= link_to 'Destroy', post, :confirm =&gt; 'Are you sure?', :method =&gt; :delete %&gt;
@@@

The corresponding HTML generated is &amp;mdash;

@@@ html
&lt;a rel=&quot;nofollow&quot; data-method=&quot;delete&quot; data-confirm=&quot;Are you sure?&quot; href=&quot;/posts/2&quot;&gt;Destroy&lt;/a&gt;
@@@

Anything else that needs to be done to reproduce this issue? Can you try it on a fresh app created using RC?</body>
      <body-html>&lt;div&gt;&lt;p&gt;Creating a scaffold in RC which has a link_to using the :method
=&amp;gt; delete option works fine. The code is &amp;mdash;&lt;/p&gt;
&lt;pre&gt;
&lt;code class=
&quot;ruby&quot;&gt;  &amp;lt;%= link_to 'Destroy', post, :confirm =&amp;gt; 'Are you sure?', :method =&amp;gt; :delete %&amp;gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;The corresponding HTML generated is &amp;mdash;&lt;/p&gt;
&lt;pre&gt;
&lt;code class=
&quot;html&quot;&gt;&amp;lt;a rel=&quot;nofollow&quot; data-method=&quot;delete&quot; data-confirm=&quot;Are you sure?&quot; href=&quot;/posts/2&quot;&amp;gt;Destroy&amp;lt;/a&amp;gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Anything else that needs to be done to reproduce this issue? Can
you try it on a fresh app created using RC?&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-09T11:49:45+01:00</created-at>
      <creator-id type="integer">64254</creator-id>
      <diffable-attributes type="yaml">--- 
:priority: 0
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5134</number>
      <permalink>delete-method-in-link_to-causes-invalidauthenticitytoken-error</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>delete link_to</tag>
      <title>Delete method in link_to causes InvalidAuthenticityToken error</title>
      <updated-at type="datetime">2010-08-09T11:49:48+01:00</updated-at>
      <user-id type="integer">89656</user-id>
      <version type="integer">3</version>
      <user-name>Rohit Arondekar</user-name>
      <creator-name>wout</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5134</url>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I can also confirm this bug. Futhermore it seems that if you put:

  &lt;%= link_to 'Destroy', post, :confirm =&gt; 'Are you sure?', :method =&gt; :delete %&gt;

It generate additional hidden form, but if you use post_path(post) instead it does not generate it.

The generated HTML seems to be correct, I think it's more a bug with javascript that handles these kind of links.

This needs much higher priority...</body>
      <body-html>&lt;div&gt;&lt;p&gt;I can also confirm this bug. Futhermore it seems that if you
put:&lt;/p&gt;
&lt;p&gt;&amp;lt;%= link_to 'Destroy', post, :confirm =&amp;gt; 'Are you sure?',
:method =&amp;gt; :delete %&amp;gt;&lt;/p&gt;
&lt;p&gt;It generate additional hidden form, but if you use
post_path(post) instead it does not generate it.&lt;/p&gt;
&lt;p&gt;The generated HTML seems to be correct, I think it's more a bug
with javascript that handles these kind of links.&lt;/p&gt;
&lt;p&gt;This needs much higher priority...&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-13T15:34:40+01:00</created-at>
      <creator-id type="integer">64254</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5134</number>
      <permalink>delete-method-in-link_to-causes-invalidauthenticitytoken-error</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>delete link_to</tag>
      <title>Delete method in link_to causes InvalidAuthenticityToken error</title>
      <updated-at type="datetime">2010-08-13T15:34:42+01:00</updated-at>
      <user-id type="integer">111497</user-id>
      <version type="integer">4</version>
      <user-name>Andrius Chamentauskas</user-name>
      <creator-name>wout</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5134</url>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>This just happened on a new project that I started in the RC. I had to change it to button_to, though that's probably a little better anyway, since it doesn't rely on javascript to work.</body>
      <body-html>&lt;div&gt;&lt;p&gt;This just happened on a new project that I started in the RC. I
had to change it to button_to, though that's probably a little
better anyway, since it doesn't rely on javascript to work.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">false</closed>
      <created-at type="datetime">2010-08-19T22:32:17+01:00</created-at>
      <creator-id type="integer">64254</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5134</number>
      <permalink>delete-method-in-link_to-causes-invalidauthenticitytoken-error</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>new</state>
      <tag>delete link_to</tag>
      <title>Delete method in link_to causes InvalidAuthenticityToken error</title>
      <updated-at type="datetime">2010-08-19T22:32:19+01:00</updated-at>
      <user-id type="integer">109973</user-id>
      <version type="integer">5</version>
      <user-name>plasko</user-name>
      <creator-name>wout</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5134</url>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>I came across this the other day - you need to add &lt;%= csrf_meta_tag %&gt; to your layout file. The reason button_to works is that it creates an inline form which includes the hidden input auth token. The csrf_meta_tag helper adds a meta tag to the header which the rails.js code reads when it submits the form.</body>
      <body-html>&lt;div&gt;&lt;p&gt;I came across this the other day - you need to add &amp;lt;%=
csrf_meta_tag %&amp;gt; to your layout file. The reason button_to works
is that it creates an inline form which includes the hidden input
auth token. The csrf_meta_tag helper adds a meta tag to the header
which the rails.js code reads when it submits the form.&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-08-19T23:43:43+01:00</created-at>
      <creator-id type="integer">64254</creator-id>
      <diffable-attributes type="yaml">--- 
:state: new
</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5134</number>
      <permalink>delete-method-in-link_to-causes-invalidauthenticitytoken-error</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>delete link_to</tag>
      <title>Delete method in link_to causes InvalidAuthenticityToken error</title>
      <updated-at type="datetime">2010-08-19T23:43:48+01:00</updated-at>
      <user-id type="integer">7697</user-id>
      <version type="integer">6</version>
      <user-name>Andrew White</user-name>
      <creator-name>wout</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5134</url>
      <priority-name>Low</priority-name>
    </version>
    <version type="Ticket::Version">
      <assigned-user-id type="integer" nil="true"></assigned-user-id>
      <attachments-count type="integer">0</attachments-count>
      <body>If &lt;%= csrf_meta_tag %&gt; alone does not seem to be helping then perhaps you have a conflict with jQuery. That's what it turned out to be for me. I wrote a bit more detail along with code required for a the solution on another related [StackOverflow](http://stackoverflow.com/questions/2458841/link-to-syntax-with-rails3-link-to-remote-and-basic-javascript-not-working-in-a &quot;'Ta Rob!'&quot;)</body>
      <body-html>&lt;div&gt;&lt;p&gt;If &amp;lt;%= csrf_meta_tag %&amp;gt; alone does not seem to be helping
then perhaps you have a conflict with jQuery. That's what it turned
out to be for me. I wrote a bit more detail along with code
required for a the solution on another related &lt;a href=
&quot;http://stackoverflow.com/questions/2458841/link-to-syntax-with-rails3-link-to-remote-and-basic-javascript-not-working-in-a&quot;
title=&quot;'Ta Rob!'&quot;&gt;StackOverflow&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</body-html>
      <closed type="boolean">true</closed>
      <created-at type="datetime">2010-09-01T15:27:01+01:00</created-at>
      <creator-id type="integer">64254</creator-id>
      <diffable-attributes type="yaml">--- {}

</diffable-attributes>
      <milestone-id type="integer" nil="true"></milestone-id>
      <number type="integer">5134</number>
      <permalink>delete-method-in-link_to-causes-invalidauthenticitytoken-error</permalink>
      <priority type="integer">3</priority>
      <project-id type="integer">8994</project-id>
      <state>invalid</state>
      <tag>delete link_to</tag>
      <title>Delete method in link_to causes InvalidAuthenticityToken error</title>
      <updated-at type="datetime">2010-09-01T15:27:04+01:00</updated-at>
      <user-id type="integer">36348</user-id>
      <version type="integer">7</version>
      <user-name>Rob Eastham</user-name>
      <creator-name>wout</creator-name>
      <url>http://rails.lighthouseapp.com/projects/8994/tickets/5134</url>
      <priority-name>Low</priority-name>
    </version>
  </versions>
</ticket>
